var Oh=(E,Qt,Ce)=>{if(!Qt.has(E))throw TypeError("Cannot "+Ce)};var we=(E,Qt,Ce)=>(Oh(E,Qt,"read from private field"),Ce?Ce.call(E):Qt.get(E)),Pe=(E,Qt,Ce)=>{if(Qt.has(E))throw TypeError("Cannot add the same private member more than once");Qt instanceof WeakSet?Qt.add(E):Qt.set(E,Ce)},ze=(E,Qt,Ce,_a)=>(Oh(E,Qt,"write to private field"),_a?_a.call(E,Ce):Qt.set(E,Ce),Ce);var zh=(E,Qt,Ce)=>(Oh(E,Qt,"access private method"),Ce);(function(E,Qt){typeof exports=="object"&&typeof module<"u"?Qt(exports):typeof define=="function"&&define.amd?define(["exports"],Qt):(E=typeof globalThis<"u"?globalThis:E||self,Qt(E.zui={}))})(this,function(E){var Bo,Ho,Hs,Ws,Ks,Us,Vs,qs,Wo,pm,Ko,mm,On,zn;"use strict";const Qt="",Ce="",_a="",Ib="",Db="",Rb="",Lb="",Ob="",zb="",Fb="",jb="",Bb="",vm="3.0.0",bm="production",nn=document,cr=window,Fh=nn.documentElement,Gn=nn.createElement.bind(nn),jh=Gn("div"),va=Gn("table"),wm=Gn("tbody"),Bh=Gn("tr"),{isArray:hr,prototype:Hh}=Array,{concat:Cm,filter:ba,indexOf:Wh,map:Kh,push:km,slice:Uh,some:wa,splice:Sm}=Hh,xm=/^#(?:[\w-]|\\.|[^\x00-\xa0])*$/,$m=/^\.(?:[\w-]|\\.|[^\x00-\xa0])*$/,Tm=/<.+>/,Nm=/^\w+$/;function Ca(i,t){const e=Em(t);return!i||!e&&!Yn(t)&&!Jt(t)?[]:!e&&$m.test(i)?t.getElementsByClassName(i.slice(1).replace(/\\/g,"")):!e&&Nm.test(i)?t.getElementsByTagName(i):t.querySelectorAll(i)}class ur{constructor(t,e){if(!t)return;if(ka(t))return t;let n=t;if(de(t)){const s=e||nn;if(n=xm.test(t)&&Yn(s)?s.getElementById(t.slice(1).replace(/\\/g,"")):Tm.test(t)?Xh(t):ka(s)?s.find(t):de(s)?g(s).find(t):Ca(t,s),!n)return}else if(Qn(t))return this.ready(t);(n.nodeType||n===cr)&&(n=[n]),this.length=n.length;for(let s=0,r=this.length;s<r;s++)this[s]=n[s]}init(t,e){return new ur(t,e)}}const st=ur.prototype,g=st.init;g.fn=g.prototype=st,st.length=0,st.splice=Sm,typeof Symbol=="function"&&(st[Symbol.iterator]=Hh[Symbol.iterator]);function ka(i){return i instanceof ur}function Ci(i){return!!i&&i===i.window}function Yn(i){return!!i&&i.nodeType===9}function Em(i){return!!i&&i.nodeType===11}function Jt(i){return!!i&&i.nodeType===1}function Mm(i){return!!i&&i.nodeType===3}function Pm(i){return typeof i=="boolean"}function Qn(i){return typeof i=="function"}function de(i){return typeof i=="string"}function ke(i){return i===void 0}function ss(i){return i===null}function Vh(i){return!isNaN(parseFloat(i))&&isFinite(i)}function Sa(i){if(typeof i!="object"||i===null)return!1;const t=Object.getPrototypeOf(i);return t===null||t===Object.prototype}g.isWindow=Ci,g.isFunction=Qn,g.isArray=hr,g.isNumeric=Vh,g.isPlainObject=Sa;function re(i,t,e){if(e){let n=i.length;for(;n--;)if(t.call(i[n],n,i[n])===!1)return i}else if(Sa(i)){const n=Object.keys(i);for(let s=0,r=n.length;s<r;s++){const o=n[s];if(t.call(i[o],o,i[o])===!1)return i}}else for(let n=0,s=i.length;n<s;n++)if(t.call(i[n],n,i[n])===!1)return i;return i}g.each=re,st.each=function(i){return re(this,i)},st.empty=function(){return this.each((i,t)=>{for(;t.firstChild;)t.removeChild(t.firstChild)})};function dr(...i){const t=Pm(i[0])?i.shift():!1,e=i.shift(),n=i.length;if(!e)return{};if(!n)return dr(t,g,e);for(let s=0;s<n;s++){const r=i[s];for(const o in r)t&&(hr(r[o])||Sa(r[o]))?((!e[o]||e[o].constructor!==r[o].constructor)&&(e[o]=new r[o].constructor),dr(t,e[o],r[o])):e[o]=r[o]}return e}g.extend=dr,st.extend=function(i){return dr(st,i)};const Am=/\S+/g;function fr(i){return de(i)?i.match(Am)||[]:[]}st.toggleClass=function(i,t){const e=fr(i),n=!ke(t);return this.each((s,r)=>{Jt(r)&&re(e,(o,a)=>{n?t?r.classList.add(a):r.classList.remove(a):r.classList.toggle(a)})})},st.addClass=function(i){return this.toggleClass(i,!0)},st.removeAttr=function(i){const t=fr(i);return this.each((e,n)=>{Jt(n)&&re(t,(s,r)=>{n.removeAttribute(r)})})};function Im(i,t){if(i){if(de(i)){if(arguments.length<2){if(!this[0]||!Jt(this[0]))return;const e=this[0].getAttribute(i);return ss(e)?void 0:e}return ke(t)?this:ss(t)?this.removeAttr(i):this.each((e,n)=>{Jt(n)&&n.setAttribute(i,t)})}for(const e in i)this.attr(e,i[e]);return this}}st.attr=Im,st.removeClass=function(i){return arguments.length?this.toggleClass(i,!1):this.attr("class","")},st.hasClass=function(i){return!!i&&wa.call(this,t=>Jt(t)&&t.classList.contains(i))},st.get=function(i){return ke(i)?Uh.call(this):(i=Number(i),this[i<0?i+this.length:i])},st.eq=function(i){return g(this.get(i))},st.first=function(){return this.eq(0)},st.last=function(){return this.eq(-1)};function Dm(i){return ke(i)?this.get().map(t=>Jt(t)||Mm(t)?t.textContent:"").join(""):this.each((t,e)=>{Jt(e)&&(e.textContent=i)})}st.text=Dm;function sn(i,t,e){if(!Jt(i))return;const n=cr.getComputedStyle(i,null);return e?n.getPropertyValue(t)||void 0:n[t]||i.style[t]}function Ke(i,t){return parseInt(sn(i,t),10)||0}function qh(i,t){return Ke(i,`border${t?"Left":"Top"}Width`)+Ke(i,`padding${t?"Left":"Top"}`)+Ke(i,`padding${t?"Right":"Bottom"}`)+Ke(i,`border${t?"Right":"Bottom"}Width`)}const xa={};function Rm(i){if(xa[i])return xa[i];const t=Gn(i);nn.body.insertBefore(t,null);const e=sn(t,"display");return nn.body.removeChild(t),xa[i]=e!=="none"?e:"block"}function Gh(i){return sn(i,"display")==="none"}function Yh(i,t){const e=i&&(i.matches||i.webkitMatchesSelector||i.msMatchesSelector);return!!e&&!!t&&e.call(i,t)}function pr(i){return de(i)?(t,e)=>Yh(e,i):Qn(i)?i:ka(i)?(t,e)=>i.is(e):i?(t,e)=>e===i:()=>!1}st.filter=function(i){const t=pr(i);return g(ba.call(this,(e,n)=>t.call(e,n,e)))};function yn(i,t){return t?i.filter(t):i}st.detach=function(i){return yn(this,i).each((t,e)=>{e.parentNode&&e.parentNode.removeChild(e)}),this};const Lm=/^\s*<(\w+)[^>]*>/,Om=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,Qh={"*":jh,tr:wm,td:Bh,th:Bh,thead:va,tbody:va,tfoot:va};function Xh(i){if(!de(i))return[];if(Om.test(i))return[Gn(RegExp.$1)];const t=Lm.test(i)&&RegExp.$1,e=Qh[t]||Qh["*"];return e.innerHTML=i,g(e.childNodes).detach().get()}g.parseHTML=Xh,st.has=function(i){const t=de(i)?(e,n)=>Ca(i,n).length:(e,n)=>n.contains(i);return this.filter(t)},st.not=function(i){const t=pr(i);return this.filter((e,n)=>(!de(i)||Jt(n))&&!t.call(n,e,n))};function rn(i,t,e,n){const s=[],r=Qn(t),o=n&&pr(n);for(let a=0,l=i.length;a<l;a++)if(r){const h=t(i[a]);h.length&&km.apply(s,h)}else{let h=i[a][t];for(;h!=null&&!(n&&o(-1,h));)s.push(h),h=e?h[t]:null}return s}function Zh(i){return i.multiple&&i.options?rn(ba.call(i.options,t=>t.selected&&!t.disabled&&!t.parentNode.disabled),"value"):i.value||""}function zm(i){return arguments.length?this.each((t,e)=>{const n=e.multiple&&e.options;if(n||cu.test(e.type)){const s=hr(i)?Kh.call(i,String):ss(i)?[]:[String(i)];n?re(e.options,(r,o)=>{o.selected=s.indexOf(o.value)>=0},!0):e.checked=s.indexOf(e.value)>=0}else e.value=ke(i)||ss(i)?"":i}):this[0]&&Zh(this[0])}st.val=zm,st.is=function(i){const t=pr(i);return wa.call(this,(e,n)=>t.call(e,n,e))},g.guid=1;function Ue(i){return i.length>1?ba.call(i,(t,e,n)=>Wh.call(n,t)===e):i}g.unique=Ue,st.add=function(i,t){return g(Ue(this.get().concat(g(i,t).get())))},st.children=function(i){return yn(g(Ue(rn(this,t=>t.children))),i)},st.parent=function(i){return yn(g(Ue(rn(this,"parentNode"))),i)},st.index=function(i){const t=i?g(i)[0]:this[0],e=i?this:g(t).parent().children();return Wh.call(e,t)},st.closest=function(i){const t=this.filter(i);if(t.length)return t;const e=this.parent();return e.length?e.closest(i):t},st.siblings=function(i){return yn(g(Ue(rn(this,t=>g(t).parent().children().not(t)))),i)},st.find=function(i){return g(Ue(rn(this,t=>Ca(i,t))))};const Fm=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,jm=/^$|^module$|\/(java|ecma)script/i,Bm=["type","src","nonce","noModule"];function Hm(i,t){const e=g(i);e.filter("script").add(e.find("script")).each((n,s)=>{if(jm.test(s.type)&&Fh.contains(s)){const r=Gn("script");r.text=s.textContent.replace(Fm,""),re(Bm,(o,a)=>{s[a]&&(r[a]=s[a])}),t.head.insertBefore(r,null),t.head.removeChild(r)}})}function Wm(i,t,e,n,s){n?i.insertBefore(t,e?i.firstChild:null):i.nodeName==="HTML"?i.parentNode.replaceChild(t,i):i.parentNode.insertBefore(t,e?i:i.nextSibling),s&&Hm(t,i.ownerDocument)}function _n(i,t,e,n,s,r,o,a){return re(i,(l,h)=>{re(g(h),(f,d)=>{re(g(t),(m,y)=>{const b=e?d:y,S=e?y:d,x=e?f:m;Wm(b,x?S.cloneNode(!0):S,n,s,!x)},a)},o)},r),t}st.after=function(){return _n(arguments,this,!1,!1,!1,!0,!0)},st.append=function(){return _n(arguments,this,!1,!1,!0)};function Km(i){if(!arguments.length)return this[0]&&this[0].innerHTML;if(ke(i))return this;const t=/<script[\s>]/.test(i);return this.each((e,n)=>{Jt(n)&&(t?g(n).empty().append(i):n.innerHTML=i)})}st.html=Km,st.appendTo=function(i){return _n(arguments,this,!0,!1,!0)},st.wrapInner=function(i){return this.each((t,e)=>{const n=g(e),s=n.contents();s.length?s.wrapAll(i):n.append(i)})},st.before=function(){return _n(arguments,this,!1,!0)},st.wrapAll=function(i){let t=g(i),e=t[0];for(;e.children.length;)e=e.firstElementChild;return this.first().before(t),this.appendTo(e)},st.wrap=function(i){return this.each((t,e)=>{const n=g(i)[0];g(e).wrapAll(t?n.cloneNode(!0):n)})},st.insertAfter=function(i){return _n(arguments,this,!0,!1,!1,!1,!1,!0)},st.insertBefore=function(i){return _n(arguments,this,!0,!0)},st.prepend=function(){return _n(arguments,this,!1,!0,!0,!0,!0)},st.prependTo=function(i){return _n(arguments,this,!0,!0,!0,!1,!1,!0)},st.contents=function(){return g(Ue(rn(this,i=>i.tagName==="IFRAME"?[i.contentDocument]:i.tagName==="TEMPLATE"?i.content.childNodes:i.childNodes)))},st.next=function(i,t,e){return yn(g(Ue(rn(this,"nextElementSibling",t,e))),i)},st.nextAll=function(i){return this.next(i,!0)},st.nextUntil=function(i,t){return this.next(t,!0,i)},st.parents=function(i,t){return yn(g(Ue(rn(this,"parentElement",!0,t))),i)},st.parentsUntil=function(i,t){return this.parents(t,i)},st.prev=function(i,t,e){return yn(g(Ue(rn(this,"previousElementSibling",t,e))),i)},st.prevAll=function(i){return this.prev(i,!0)},st.prevUntil=function(i,t){return this.prev(t,!0,i)},st.map=function(i){return g(Cm.apply([],Kh.call(this,(t,e)=>i.call(t,e,t))))},st.clone=function(){return this.map((i,t)=>t.cloneNode(!0))},st.offsetParent=function(){return this.map((i,t)=>{let e=t.offsetParent;for(;e&&sn(e,"position")==="static";)e=e.offsetParent;return e||Fh})},st.slice=function(i,t){return g(Uh.call(this,i,t))};const Um=/-([a-z])/g;function $a(i){return i.replace(Um,(t,e)=>e.toUpperCase())}st.ready=function(i){const t=()=>setTimeout(i,0,g);return nn.readyState!=="loading"?t():nn.addEventListener("DOMContentLoaded",t),this},st.unwrap=function(){return this.parent().each((i,t)=>{if(t.tagName==="BODY")return;const e=g(t);e.replaceWith(e.children())}),this},st.offset=function(){const i=this[0];if(!i)return;const t=i.getBoundingClientRect();return{top:t.top+cr.pageYOffset,left:t.left+cr.pageXOffset}},st.position=function(){const i=this[0];if(!i)return;const t=sn(i,"position")==="fixed",e=t?i.getBoundingClientRect():this.offset();if(!t){const n=i.ownerDocument;let s=i.offsetParent||n.documentElement;for(;(s===n.body||s===n.documentElement)&&sn(s,"position")==="static";)s=s.parentNode;if(s!==i&&Jt(s)){const r=g(s).offset();e.top-=r.top+Ke(s,"borderTopWidth"),e.left-=r.left+Ke(s,"borderLeftWidth")}}return{top:e.top-Ke(i,"marginTop"),left:e.left-Ke(i,"marginLeft")}};const Jh={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};st.prop=function(i,t){if(i){if(de(i))return i=Jh[i]||i,arguments.length<2?this[0]&&this[0][i]:this.each((e,n)=>{n[i]=t});for(const e in i)this.prop(e,i[e]);return this}},st.removeProp=function(i){return this.each((t,e)=>{delete e[Jh[i]||i]})};const Vm=/^--/;function Ta(i){return Vm.test(i)}const Na={},{style:qm}=jh,Gm=["webkit","moz","ms"];function Ym(i,t=Ta(i)){if(t)return i;if(!Na[i]){const e=$a(i),n=`${e[0].toUpperCase()}${e.slice(1)}`,s=`${e} ${Gm.join(`${n} `)}${n}`.split(" ");re(s,(r,o)=>{if(o in qm)return Na[i]=o,!1})}return Na[i]}const Qm={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function tu(i,t,e=Ta(i)){return!e&&!Qm[i]&&Vh(t)?`${t}px`:t}function Xm(i,t){if(de(i)){const e=Ta(i);return i=Ym(i,e),arguments.length<2?this[0]&&sn(this[0],i,e):i?(t=tu(i,t,e),this.each((n,s)=>{Jt(s)&&(e?s.style.setProperty(i,t):s.style[i]=t)})):this}for(const e in i)this.css(e,i[e]);return this}st.css=Xm;function eu(i,t){try{return i(t)}catch{return t}}const Zm=/^\s+|\s+$/;function nu(i,t){const e=i.dataset[t]||i.dataset[$a(t)];return Zm.test(e)?e:eu(JSON.parse,e)}function Jm(i,t,e){e=eu(JSON.stringify,e),i.dataset[$a(t)]=e}function tg(i,t){if(!i){if(!this[0])return;const e={};for(const n in this[0].dataset)e[n]=nu(this[0],n);return e}if(de(i))return arguments.length<2?this[0]&&nu(this[0],i):ke(t)?this:this.each((e,n)=>{Jm(n,i,t)});for(const e in i)this.data(e,i[e]);return this}st.data=tg;function iu(i,t){const e=i.documentElement;return Math.max(i.body[`scroll${t}`],e[`scroll${t}`],i.body[`offset${t}`],e[`offset${t}`],e[`client${t}`])}re([!0,!1],(i,t)=>{re(["Width","Height"],(e,n)=>{const s=`${t?"outer":"inner"}${n}`;st[s]=function(r){if(this[0])return Ci(this[0])?t?this[0][`inner${n}`]:this[0].document.documentElement[`client${n}`]:Yn(this[0])?iu(this[0],n):this[0][`${t?"offset":"client"}${n}`]+(r&&t?Ke(this[0],`margin${e?"Top":"Left"}`)+Ke(this[0],`margin${e?"Bottom":"Right"}`):0)}})}),re(["Width","Height"],(i,t)=>{const e=t.toLowerCase();st[e]=function(n){if(!this[0])return ke(n)?void 0:this;if(!arguments.length)return Ci(this[0])?this[0].document.documentElement[`client${t}`]:Yn(this[0])?iu(this[0],t):this[0].getBoundingClientRect()[e]-qh(this[0],!i);const s=parseInt(n,10);return this.each((r,o)=>{if(!Jt(o))return;const a=sn(o,"boxSizing");o.style[e]=tu(e,s+(a==="border-box"?qh(o,!i):0))})}});const su="___cd";st.toggle=function(i){return this.each((t,e)=>{if(!Jt(e))return;const n=Gh(e);(ke(i)?n:i)?(e.style.display=e[su]||"",Gh(e)&&(e.style.display=Rm(e.tagName))):n||(e[su]=sn(e,"display"),e.style.display="none")})},st.hide=function(){return this.toggle(!1)},st.show=function(){return this.toggle(!0)};const ru="___ce",Ea=".",Ma={focus:"focusin",blur:"focusout"},ou={mouseenter:"mouseover",mouseleave:"mouseout"},eg=/^(mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;function Pa(i){return ou[i]||Ma[i]||i}function Aa(i){const t=i.split(Ea);return[t[0],t.slice(1).sort()]}st.trigger=function(i,t){if(de(i)){const[n,s]=Aa(i),r=Pa(n);if(!r)return this;const o=eg.test(r)?"MouseEvents":"HTMLEvents";i=nn.createEvent(o),i.initEvent(r,!0,!0),i.namespace=s.join(Ea),i.___ot=n}i.___td=t;const e=i.___ot in Ma;return this.each((n,s)=>{e&&Qn(s[i.___ot])&&(s[`___i${i.type}`]=!0,s[i.___ot](),s[`___i${i.type}`]=!1),s.dispatchEvent(i)})};function au(i){return i[ru]=i[ru]||{}}function ng(i,t,e,n,s){const r=au(i);r[t]=r[t]||[],r[t].push([e,n,s]),i.addEventListener(t,s)}function lu(i,t){return!t||!wa.call(t,e=>i.indexOf(e)<0)}function mr(i,t,e,n,s){const r=au(i);if(t)r[t]&&(r[t]=r[t].filter(([o,a,l])=>{if(s&&l.guid!==s.guid||!lu(o,e)||n&&n!==a)return!0;i.removeEventListener(t,l)}));else for(t in r)mr(i,t,e,n,s)}st.off=function(i,t,e){if(ke(i))this.each((n,s)=>{!Jt(s)&&!Yn(s)&&!Ci(s)||mr(s)});else if(de(i))Qn(t)&&(e=t,t=""),re(fr(i),(n,s)=>{const[r,o]=Aa(s),a=Pa(r);this.each((l,h)=>{!Jt(h)&&!Yn(h)&&!Ci(h)||mr(h,a,o,t,e)})});else for(const n in i)this.off(n,i[n]);return this},st.remove=function(i){return yn(this,i).detach().off(),this},st.replaceWith=function(i){return this.before(i).remove()},st.replaceAll=function(i){return g(i).replaceWith(this),this};function ig(i,t,e,n,s){if(!de(i)){for(const r in i)this.on(r,t,e,i[r],s);return this}return de(t)||(ke(t)||ss(t)?t="":ke(e)?(e=t,t=""):(n=e,e=t,t="")),Qn(n)||(n=e,e=void 0),n?(re(fr(i),(r,o)=>{const[a,l]=Aa(o),h=Pa(a),f=a in ou,d=a in Ma;h&&this.each((m,y)=>{if(!Jt(y)&&!Yn(y)&&!Ci(y))return;const b=function(S){if(S.target[`___i${S.type}`])return S.stopImmediatePropagation();if(S.namespace&&!lu(l,S.namespace.split(Ea))||!t&&(d&&(S.target!==y||S.___ot===h)||f&&S.relatedTarget&&y.contains(S.relatedTarget)))return;let x=y;if(t){let T=S.target;for(;!Yh(T,t);)if(T===y||(T=T.parentNode,!T))return;x=T}Object.defineProperty(S,"currentTarget",{configurable:!0,get(){return x}}),Object.defineProperty(S,"delegateTarget",{configurable:!0,get(){return y}}),Object.defineProperty(S,"data",{configurable:!0,get(){return e}});const k=n.call(x,S,S.___td);s&&mr(y,h,l,t,b),k===!1&&(S.preventDefault(),S.stopPropagation())};b.guid=n.guid=n.guid||g.guid++,ng(y,h,l,t,b)})}),this):this}st.on=ig;function sg(i,t,e,n){return this.on(i,t,e,n,!0)}st.one=sg;const rg=/\r?\n/g;function og(i,t){return`&${encodeURIComponent(i)}=${encodeURIComponent(t.replace(rg,`\r
`))}`}const ag=/file|reset|submit|button|image/i,cu=/radio|checkbox/i;st.serialize=function(){let i="";return this.each((t,e)=>{re(e.elements||[e],(n,s)=>{if(s.disabled||!s.name||s.tagName==="FIELDSET"||ag.test(s.type)||cu.test(s.type)&&!s.checked)return;const r=Zh(s);if(!ke(r)){const o=hr(r)?r:[r];re(o,(a,l)=>{i+=og(s.name,l)})}})}),i.slice(1)},window.$=g;function hu(i,t){if(i==null)return[i,void 0];typeof t=="string"&&(t=t.split("."));const e=t.join(".");let n=i;const s=[n];for(;typeof n=="object"&&n!==null&&t.length;){let r=t.shift(),o;const a=r.indexOf("[");if(a>0&&a<r.length-1&&r.endsWith("]")&&(o=r.substring(a+1,r.length-1),r=r.substring(0,a)),n=n[r],s.push(n),o!==void 0)if(typeof n=="object"&&n!==null)n instanceof Map?n=n.get(o):n=n[o],s.push(n);else throw new Error(`Cannot access property "${r}[${o}]", the full path is "${e}".`)}if(t.length)throw new Error(`Cannot access property with rest path "${t.join(".")}", the full path is "${e}".`);return s}function Ia(i,t,e){try{const n=hu(i,t),s=n[n.length-1];return s===void 0?e:s}catch{return e}}function $t(i,...t){if(t.length===0)return i;if(t.length===1&&typeof t[0]=="object"&&t[0]){const e=t[0];return Object.keys(e).forEach(n=>{const s=e[n]??"";i=i.replace(new RegExp(`\\{${n}\\}`,"g"),`${s}`)}),i}for(let e=0;e<t.length;e++){const n=t[e]??"";i=i.replace(new RegExp(`\\{${e}\\}`,"g"),`${n}`)}return i}var Da=(i=>(i[i.B=1]="B",i[i.KB=1024]="KB",i[i.MB=1048576]="MB",i[i.GB=1073741824]="GB",i[i.TB=1099511627776]="TB",i))(Da||{});function fe(i,t=2,e){return Number.isNaN(i)?"?KB":(e||(i<1024?e="B":i<1048576?e="KB":i<1073741824?e="MB":i<1099511627776?e="GB":e="TB"),(i/Da[e]).toFixed(t)+e)}const ki=i=>{const t=/^[0-9]*(B|KB|MB|GB|TB)$/;i=i.toUpperCase();const e=i.match(t);if(!e)return 0;const n=e[1];return i=i.replace(n,""),Number.parseInt(i,10)*Da[n]};let Ra=(document.documentElement.getAttribute("lang")||"zh_cn").toLowerCase().replace("-","_"),on;function lg(){return Ra}function cg(i){Ra=i.toLowerCase().replace("-","_")}function uu(i,t){on||(on={}),typeof i=="string"&&(i={[i]:t??{}}),g.extend(!0,on,i)}function Nt(i,t,e,n,s,r){Array.isArray(i)?on&&i.unshift(on):i=on?[on,i]:[i],typeof e=="string"&&(r=s,s=n,n=e,e=void 0);const o=s||Ra;let a;for(const l of i){if(!l)continue;const h=l[o]||l.default;if(!h)continue;const f=r&&l===on?`${r}.${t}`:t;if(a=Ia(h,f),a!==void 0)break}return a===void 0?n:e?$t(a,...Array.isArray(e)?e:[e]):a}function hg(i,t,e,n){return Nt(void 0,i,t,e,n)}Nt.addLang=uu,Nt.getLang=hg,Nt.getCode=lg,Nt.setCode=cg,Nt.map=on,uu({zh_cn:{confirm:"确定",save:"保存",cancel:"取消",delete:"删除",reset:"重置",add:"添加",copy:"复制",close:"关闭"},zh_tw:{confirm:"確定",save:"儲存",cancel:"取消",delete:"刪除",reset:"重置",add:"添加",Copy:"複製",close:"關閉"},en:{confirm:"Confirm",save:"Save",cancel:"Cancel",delete:"Delete",reset:"Reset",add:"Add",copy:"Copy",close:"Close"}});function du(i,t,e){i instanceof Headers?i.set(t,e):Array.isArray(i)?i.push([t,e]):i[t]=e}function Si(i,t,e){e!=null&&(Array.isArray(e)?e.forEach(n=>Si(i,t,n)):!(e instanceof Blob)&&g.isPlainObject(e)?Object.entries(e).forEach(([n,s])=>{Si(i,`${t}[${n}]`,s)}):i.append(t,e instanceof Blob?e:String(e)))}function ug(i,t){if(i){const e={text:"text/plain",html:"text/html",json:"application/json",...t};for(const[n,s]of Object.entries(e))if(s.split(",").map(r=>r.trim()).includes(i))return n}return"text"}function gr(i,t){const e=t||new FormData;return i&&(typeof i=="string"&&(i=new URLSearchParams(i)),i instanceof URLSearchParams?i.forEach((n,s)=>{Si(e,s,n)}):Array.isArray(i)?i.forEach(([n,s])=>{Si(e,n,s)}):i instanceof FormData?i.forEach((n,s)=>{Si(e,s,n)}):g.isPlainObject(i)&&Object.entries(i).forEach(([n,s])=>{Si(e,n,s)})),e}class rs{get completed(){return this.data!==void 0||this.error!==void 0}get[Symbol.toStringTag](){return"Ajax"}constructor(t){this.setting=t,this._controller=new AbortController,this._callbacks={success:[],error:[],complete:[]}}on(t,e){return this._callbacks[t].push(e),this}success(t){return this.on("success",t)}done(t){return this.success(t)}fail(t){return this.on("error",t)}complete(t){return this.on("complete",t)}always(t){return this.complete(t)}then(t,e){return this.completed?e&&this.error?e(this.error):t(this.data):(this.success(n=>t(n)),e&&this.fail(e)),this}catch(t){return this.error?(t(this.error),this):this.on("error",e=>t(e))}finally(t){return this.completed?(t(),this):this.complete(()=>t())}abort(t){return this.completed?!1:(this._abortError=t,this._controller.abort(),!0)}getResponseHeader(t){var e;return(e=this.response)==null?void 0:e.headers.get(t)}_init(){if(this.completed)return;const{url:t,type:e,data:n,processData:s=!0,contentType:r,crossDomain:o,accepts:a,dataType:l,timeout:h,dataFilter:f,beforeSend:d,success:m,error:y,complete:b,...S}=this.setting;e&&(S.method=e);let x=n;x&&(s&&(x=gr(x)),S.body=x),o&&(S.mode="cors");const k=S.headers||{};du(k,"X-Requested-With","XMLHttpRequest"),r&&du(k,"Content-Type",r),S.headers=k,S.signal&&S.signal.addEventListener("abort",()=>{this.abort()});const T=[...this.constructor.globalBeforeSends,d];for(const j of T){if(!j)continue;const B=j.call(this,S);if(B===!1)return;B&&Object.assign(S,B)}m&&this.success(m),y&&this.fail(y),b&&this.complete(b),S.signal=this._controller.signal,this.url=t,this.request=S}_emit(t,...e){this._callbacks[t].forEach(n=>{n.call(this,...e)})}async send(){var f;if(this.completed)return[];this._init();const{timeout:t,dataType:e,accepts:n,dataFilter:s,throws:r,jsonParser:o}=this.setting;t&&(this._timeoutID=window.setTimeout(()=>{this.abort(new Error("timeout"))},t));let a,l,h;try{a=await fetch(this.url,this.request),this.response=a;const{statusText:d}=a;if(a.ok){const m=(f=a.headers.get("Content-Disposition"))==null?void 0:f.startsWith("attachment"),y=m?"blob":e||ug(a.headers.get("Content-Type"),n);m||y==="blob"||y==="file"?h=await a.blob():y==="json"?typeof o=="function"?(h=await a.text(),h=o(h)):h=await a.json():h=await a.text(),this.data=h;const b=(s==null?void 0:s(h,y))??h;this._emit("success",b,d,a)}else throw this.data=await a.text(),new Error(d)}catch(d){this.data===void 0&&h!==void 0&&(this.data=h),l=d;let m=!1;l.name==="AbortError"&&(this._abortError?l=this._abortError:m=!0),this.error=l,m||this._emit("error",l,a==null?void 0:a.statusText,l.message)}if(this._timeoutID&&clearTimeout(this._timeoutID),this._emit("complete",a,a==null?void 0:a.statusText),l&&r)throw l;return[h,l,a]}}rs.globalBeforeSends=[],g.ajax=(i,t)=>{t=t||{},typeof i=="string"?t.url=i:g.extend(t,i);const e=new rs(t);return e.send(),e},g.getJSON=(i,t,e)=>(typeof t=="function"&&(e=t,t=void 0),g.ajax({url:i,data:t,success:e,dataType:"json"})),g.get=(i,t,e,n,s="GET")=>{let r,o;return typeof t=="function"?(r=t,o=void 0):o=t,typeof e=="function"?(r=e,n=void 0):n=e,g.ajax({method:s,url:i,data:o,success:r,dataType:n})},g.post=(i,t,e,n)=>g.get(i,t,e,n,"POST"),g.fn.load=function(i,t,e){typeof t=="function"&&(e=t,t=void 0);const[n,s]=i.split(" ");return g.get(n,t,(r,o,a)=>{s&&(r=g(r).find(s).html()),g(this).html(r).zuiInit(),e==null||e.call(this,r,o,a)},"html"),this};async function Xn(i,t=[],e,n,s){const r={throws:!0,dataType:"json"};if(typeof i=="string")r.url=$t(i,...t);else if(typeof i=="object")g.extend(r,i);else if(typeof i=="function"){const l=i.call(n,...t);return l instanceof Promise?await l:l}e&&g.extend(r,typeof e=="function"?e(r):e);const o=new rs(r);s==null||s(o);const[a]=await o.send();return a}function La(i){return!!(i&&(typeof i=="string"||typeof i=="object"&&i.url||typeof i=="function"))}g.fetch=Xn;function _e(){return g.guid++}function yr(i,t){if(i===t)return!1;if(i&&t){const e=typeof i,n=typeof t;if(e!==n)return!0;if(e==="object"&&n==="object"){const s=Array.isArray(i),r=Array.isArray(t);if(s!==r)return!0;if(s&&r){if(i.length!==t.length)return!0;for(let l=0;l<i.length;l++)if(yr(i[l],t[l]))return!0;return!1}const o=Object.keys(i),a=Object.keys(t);if(o.length!==a.length)return!0;for(const l of o)if(yr(i[l],t[l]))return!0;return!1}if(e==="function"&&n==="function")return i.toString()!==t.toString()}return i!==t}class Zn{constructor(t,e){this._compute=t,this._dependencies=e}get value(){return this.compute()}get cache(){return this._lastDependencies?this._value:this.compute()}depends(t){return this._dependencies=t,this}forceCompute(t){return this._lastDependencies=void 0,this.compute(t)}compute(t){t!==void 0&&(this._dependencies=t),t=this._dependencies,typeof t=="function"&&(t=t());const e=this._lastDependencies;return(!e||t.some((n,s)=>n instanceof Zn?n.value!==e[s]:yr(n,e[s])))&&(this._value=this._compute(),this._lastDependencies=t.map(n=>n instanceof Zn?n.cache:n)),this._value}}function Oa(...i){const t=[],e=new Map,n=(s,r)=>{if(Array.isArray(s)&&(r=s[1],s=s[0]),!s.length)return;const o=e.get(s);typeof o=="number"?t[o][1]=!!r:(e.set(s,t.length),t.push([s,!!r]))};return i.forEach(s=>{typeof s=="function"&&(s=s()),Array.isArray(s)?Oa(...s).forEach(n):s&&typeof s=="object"?Object.entries(s).forEach(n):typeof s=="string"&&s.split(" ").forEach(r=>n(r,!0))}),t.sort((s,r)=>(e.get(s[0])||0)-(e.get(r[0])||0))}const q=(...i)=>Oa(...i).reduce((t,[e,n])=>(n&&t.push(e),t),[]).join(" ");g.classes=q,g.fn.setClass=function(i,...t){return this.each((e,n)=>{const s=g(n);i===!0?s.attr("class",q(s.attr("class"),...t)):s.addClass(q(i,...t))})};const xi=new WeakMap;function _r(i,t,e){const n=xi.has(i),s=n?xi.get(i):{};typeof t=="string"?s[t]=e:t===null?Object.keys(s).forEach(r=>{delete s[r]}):Object.assign(s,t),Object.keys(s).forEach(r=>{s[r]===void 0&&delete s[r]}),Object.keys(s).length?(!n&&i instanceof Element&&Object.assign(s,g(i).dataset(),s),xi.set(i,s)):xi.delete(i)}function os(i,t,e){let n=xi.get(i)||{};return e&&i instanceof Element&&(n=Object.assign({},g(i).dataset(),n)),t===void 0?n:n[t]}function dg(i){xi.delete(i)}g.fn.dataset=g.fn.data,g.fn.data=function(...i){const[t,e]=i;return!i.length||i.length===1&&typeof t=="string"?this.length?os(this[0],t,!0):void 0:this.each((n,s)=>_r(s,t,e))},g.fn.removeData=function(i=null){return this.each((t,e)=>_r(e,i))};function Jn(i,...t){return i.includes("RAWJS")&&(i=i.split('"RAWJS<').join("").split('>RAWJS"').join("").split("<RAWJS_QUOTE>").join('"').split("<RAWJS_LINE>").join(`
`)),new Function(`return ${i}`)(...t)}function za(i,...t){return i.includes("RAWJS")?Jn(i,...t):JSON.parse(i)}function $i(i,t){const e=g(i)[0];if(!e)return;const{prefix:n,getter:s,evalValue:r,json:o=!0,evalArgs:a=[]}={prefix:"z-",...typeof t=="string"?{prefix:t}:t},l=Array.isArray(r)?new Set(r):void 0;return Array.from(e.attributes).reduce((h,f)=>{let{name:d}=f;const{value:m}=f;let y=m;if(d.startsWith(n)){if(d=d.slice(n.length).replace(/-([a-z])/g,b=>b[1].toUpperCase()),s)y=s(d,m);else try{r&&(!l||l.has(d))||r===void 0&&m.includes("RAWJS")?y=Jn(m,...a):o&&(y=JSON.parse(m))}catch{}h[d]=y}return h},{})}function Fa(i,t,e="z-"){const n=g(i);Object.keys(t).forEach(s=>{let r=t[s];typeof r=="function"&&(r=`RAWJS<${r}>RAWJS`),typeof r!="string"&&(r=JSON.stringify(r)),s=s.replace(/[A-Z]/g,o=>`-${o.toLowerCase()}`),n.attr(`${e}${s}`,r)})}function fg(...i){var e;const t=i.length;if(!t)return $i(this);if(t===1){const[n]=i;return typeof n=="string"?(e=$i(this))==null?void 0:e[n]:(g.isPlainObject(n)&&Fa(this,n),this)}return Fa(this,{[i[0]]:i[1]}),this}g.fn.z=fg,g.fn._attr=g.fn.attr,g.fn.extend({attr(...i){const[t,e]=i;return!i.length||i.length===1&&typeof t=="string"?this._attr.apply(this,i):typeof t=="object"?(t&&Object.keys(t).forEach(n=>{const s=t[n];s===null?this.removeAttr(n):this._attr(n,s)}),this):e===null?this.removeAttr(t):this._attr(t,e)}}),g.Event||(g.Event=(i,t)=>{const[e,...n]=i.split("."),s=new Event(e,{bubbles:!0,cancelable:!0});return s.namespace=n.join("."),s.___ot=e,s.___td=t,s});const as=(i,t)=>new Promise(e=>{const n=window.setTimeout(e,i);t&&t(n)}),fu={};g.share=fu;var vr,Ot,pu;E.isValidElement=void 0;var ti,mu,gu,ja,Ba,Ha,Wa,ls={},yu=[],pg=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,br=Array.isArray;function vn(i,t){for(var e in t)i[e]=t[e];return i}function _u(i){var t=i.parentNode;t&&t.removeChild(i)}function P(i,t,e){var n,s,r,o={};for(r in t)r=="key"?n=t[r]:r=="ref"?s=t[r]:o[r]=t[r];if(arguments.length>2&&(o.children=arguments.length>3?vr.call(arguments,2):e),typeof i=="function"&&i.defaultProps!=null)for(r in i.defaultProps)o[r]===void 0&&(o[r]=i.defaultProps[r]);return wr(i,o,n,s,null)}function wr(i,t,e,n,s){var r={type:i,props:t,key:e,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:s??++pu,__i:-1,__u:0};return s==null&&Ot.vnode!=null&&Ot.vnode(r),r}function kt(){return{current:null}}function bn(i){return i.children}function Tt(i,t){this.props=i,this.context=t}function ei(i,t){if(t==null)return i.__?ei(i.__,i.__i+1):null;for(var e;t<i.__k.length;t++)if((e=i.__k[t])!=null&&e.__e!=null)return e.__e;return typeof i.type=="function"?ei(i):null}function vu(i){var t,e;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,t=0;t<i.__k.length;t++)if((e=i.__k[t])!=null&&e.__e!=null){i.__e=i.__c.base=e.__e;break}return vu(i)}}function bu(i){(!i.__d&&(i.__d=!0)&&ti.push(i)&&!Cr.__r++||mu!==Ot.debounceRendering)&&((mu=Ot.debounceRendering)||gu)(Cr)}function Cr(){var i,t,e,n,s,r,o,a;for(ti.sort(ja);i=ti.shift();)i.__d&&(t=ti.length,n=void 0,r=(s=(e=i).__v).__e,o=[],a=[],e.__P&&((n=vn({},s)).__v=s.__v+1,Ot.vnode&&Ot.vnode(n),Ka(e.__P,n,s,e.__n,e.__P.namespaceURI,32&s.__u?[r]:null,o,r??ei(s),!!(32&s.__u),a),n.__v=s.__v,n.__.__k[n.__i]=n,xu(o,n,a),n.__e!=r&&vu(n)),ti.length>t&&ti.sort(ja));Cr.__r=0}function wu(i,t,e,n,s,r,o,a,l,h,f){var d,m,y,b,S,x=n&&n.__k||yu,k=t.length;for(e.__d=l,mg(e,t,x),l=e.__d,d=0;d<k;d++)(y=e.__k[d])!=null&&typeof y!="boolean"&&typeof y!="function"&&(m=y.__i===-1?ls:x[y.__i]||ls,y.__i=d,Ka(i,y,m,s,r,o,a,l,h,f),b=y.__e,y.ref&&m.ref!=y.ref&&(m.ref&&Ua(m.ref,null,y),f.push(y.ref,y.__c||b,y)),S==null&&b!=null&&(S=b),65536&y.__u||m.__k===y.__k?l=Cu(y,l,i):typeof y.type=="function"&&y.__d!==void 0?l=y.__d:b&&(l=b.nextSibling),y.__d=void 0,y.__u&=-196609);e.__d=l,e.__e=S}function mg(i,t,e){var n,s,r,o,a,l=t.length,h=e.length,f=h,d=0;for(i.__k=[],n=0;n<l;n++)o=n+d,(s=i.__k[n]=(s=t[n])==null||typeof s=="boolean"||typeof s=="function"?null:typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?wr(null,s,null,null,null):br(s)?wr(bn,{children:s},null,null,null):s.constructor===void 0&&s.__b>0?wr(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s)!=null?(s.__=i,s.__b=i.__b+1,a=gg(s,e,o,f),s.__i=a,r=null,a!==-1&&(f--,(r=e[a])&&(r.__u|=131072)),r==null||r.__v===null?(a==-1&&d--,typeof s.type!="function"&&(s.__u|=65536)):a!==o&&(a==o-1?d--:a==o+1?d++:a>o?f>l-o?d+=a-o:d--:a<o&&(a==o-d?d-=a-o:d++),a!==n+d&&(s.__u|=65536))):(r=e[o])&&r.key==null&&r.__e&&!(131072&r.__u)&&(r.__e==i.__d&&(i.__d=ei(r)),Va(r,r,!1),e[o]=null,f--);if(f)for(n=0;n<h;n++)(r=e[n])!=null&&!(131072&r.__u)&&(r.__e==i.__d&&(i.__d=ei(r)),Va(r,r))}function Cu(i,t,e){var n,s;if(typeof i.type=="function"){for(n=i.__k,s=0;n&&s<n.length;s++)n[s]&&(n[s].__=i,t=Cu(n[s],t,e));return t}i.__e!=t&&(t&&i.type&&!e.contains(t)&&(t=ei(i)),e.insertBefore(i.__e,t||null),t=i.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType===8);return t}function kr(i,t){return t=t||[],i==null||typeof i=="boolean"||(br(i)?i.some(function(e){kr(e,t)}):t.push(i)),t}function gg(i,t,e,n){var s=i.key,r=i.type,o=e-1,a=e+1,l=t[e];if(l===null||l&&s==l.key&&r===l.type&&!(131072&l.__u))return e;if(n>(l!=null&&!(131072&l.__u)?1:0))for(;o>=0||a<t.length;){if(o>=0){if((l=t[o])&&!(131072&l.__u)&&s==l.key&&r===l.type)return o;o--}if(a<t.length){if((l=t[a])&&!(131072&l.__u)&&s==l.key&&r===l.type)return a;a++}}return-1}function ku(i,t,e){t[0]==="-"?i.setProperty(t,e??""):i[t]=e==null?"":typeof e!="number"||pg.test(t)?e:e+"px"}function Sr(i,t,e,n,s){var r;t:if(t==="style")if(typeof e=="string")i.style.cssText=e;else{if(typeof n=="string"&&(i.style.cssText=n=""),n)for(t in n)e&&t in e||ku(i.style,t,"");if(e)for(t in e)n&&e[t]===n[t]||ku(i.style,t,e[t])}else if(t[0]==="o"&&t[1]==="n")r=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in i||t==="onFocusOut"||t==="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),i.l||(i.l={}),i.l[t+r]=e,e?n?e.u=n.u:(e.u=Ba,i.addEventListener(t,r?Wa:Ha,r)):i.removeEventListener(t,r?Wa:Ha,r);else{if(s=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in i)try{i[t]=e??"";break t}catch{}typeof e=="function"||(e==null||e===!1&&t[4]!=="-"?i.removeAttribute(t):i.setAttribute(t,t=="popover"&&e==1?"":e))}}function Su(i){return function(t){if(this.l){var e=this.l[t.type+i];if(t.t==null)t.t=Ba++;else if(t.t<e.u)return;return e(Ot.event?Ot.event(t):t)}}}function Ka(i,t,e,n,s,r,o,a,l,h){var f,d,m,y,b,S,x,k,T,j,B,K,G,Q,Z,tt,X=t.type;if(t.constructor!==void 0)return null;128&e.__u&&(l=!!(32&e.__u),r=[a=t.__e=e.__e]),(f=Ot.__b)&&f(t);t:if(typeof X=="function")try{if(k=t.props,T="prototype"in X&&X.prototype.render,j=(f=X.contextType)&&n[f.__c],B=f?j?j.props.value:f.__:n,e.__c?x=(d=t.__c=e.__c).__=d.__E:(T?t.__c=d=new X(k,B):(t.__c=d=new Tt(k,B),d.constructor=X,d.render=_g),j&&j.sub(d),d.props=k,d.state||(d.state={}),d.context=B,d.__n=n,m=d.__d=!0,d.__h=[],d._sb=[]),T&&d.__s==null&&(d.__s=d.state),T&&X.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=vn({},d.__s)),vn(d.__s,X.getDerivedStateFromProps(k,d.__s))),y=d.props,b=d.state,d.__v=t,m)T&&X.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),T&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(T&&X.getDerivedStateFromProps==null&&k!==y&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(k,B),!d.__e&&(d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(k,d.__s,B)===!1||t.__v===e.__v)){for(t.__v!==e.__v&&(d.props=k,d.state=d.__s,d.__d=!1),t.__e=e.__e,t.__k=e.__k,t.__k.forEach(function(et){et&&(et.__=t)}),K=0;K<d._sb.length;K++)d.__h.push(d._sb[K]);d._sb=[],d.__h.length&&o.push(d);break t}d.componentWillUpdate!=null&&d.componentWillUpdate(k,d.__s,B),T&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(y,b,S)})}if(d.context=B,d.props=k,d.__P=i,d.__e=!1,G=Ot.__r,Q=0,T){for(d.state=d.__s,d.__d=!1,G&&G(t),f=d.render(d.props,d.state,d.context),Z=0;Z<d._sb.length;Z++)d.__h.push(d._sb[Z]);d._sb=[]}else do d.__d=!1,G&&G(t),f=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++Q<25);d.state=d.__s,d.getChildContext!=null&&(n=vn(vn({},n),d.getChildContext())),T&&!m&&d.getSnapshotBeforeUpdate!=null&&(S=d.getSnapshotBeforeUpdate(y,b)),wu(i,br(tt=f!=null&&f.type===bn&&f.key==null?f.props.children:f)?tt:[tt],t,e,n,s,r,o,a,l,h),d.base=t.__e,t.__u&=-161,d.__h.length&&o.push(d),x&&(d.__E=d.__=null)}catch(et){if(t.__v=null,l||r!=null){for(t.__u|=l?160:32;a&&a.nodeType===8&&a.nextSibling;)a=a.nextSibling;r[r.indexOf(a)]=null,t.__e=a}else t.__e=e.__e,t.__k=e.__k;Ot.__e(et,t,e)}else r==null&&t.__v===e.__v?(t.__k=e.__k,t.__e=e.__e):t.__e=yg(e.__e,t,e,n,s,r,o,l,h);(f=Ot.diffed)&&f(t)}function xu(i,t,e){t.__d=void 0;for(var n=0;n<e.length;n++)Ua(e[n],e[++n],e[++n]);Ot.__c&&Ot.__c(t,i),i.some(function(s){try{i=s.__h,s.__h=[],i.some(function(r){r.call(s)})}catch(r){Ot.__e(r,s.__v)}})}function yg(i,t,e,n,s,r,o,a,l){var h,f,d,m,y,b,S,x=e.props,k=t.props,T=t.type;if(T==="svg"?s="http://www.w3.org/2000/svg":T==="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),r!=null){for(h=0;h<r.length;h++)if((y=r[h])&&"setAttribute"in y==!!T&&(T?y.localName===T:y.nodeType===3)){i=y,r[h]=null;break}}if(i==null){if(T===null)return document.createTextNode(k);i=document.createElementNS(s,T,k.is&&k),r=null,a=!1}if(T===null)x===k||a&&i.data===k||(i.data=k);else{if(r=r&&vr.call(i.childNodes),x=e.props||ls,!a&&r!=null)for(x={},h=0;h<i.attributes.length;h++)x[(y=i.attributes[h]).name]=y.value;for(h in x)if(y=x[h],h!="children"){if(h=="dangerouslySetInnerHTML")d=y;else if(h!=="key"&&!(h in k)){if(h=="value"&&"defaultValue"in k||h=="checked"&&"defaultChecked"in k)continue;Sr(i,h,null,y,s)}}for(h in k)y=k[h],h=="children"?m=y:h=="dangerouslySetInnerHTML"?f=y:h=="value"?b=y:h=="checked"?S=y:h==="key"||a&&typeof y!="function"||x[h]===y||Sr(i,h,y,x[h],s);if(f)a||d&&(f.__html===d.__html||f.__html===i.innerHTML)||(i.innerHTML=f.__html),t.__k=[];else if(d&&(i.innerHTML=""),wu(i,br(m)?m:[m],t,e,n,T==="foreignObject"?"http://www.w3.org/1999/xhtml":s,r,o,r?r[0]:e.__k&&ei(e,0),a,l),r!=null)for(h=r.length;h--;)r[h]!=null&&_u(r[h]);a||(h="value",b!==void 0&&(b!==i[h]||T==="progress"&&!b||T==="option"&&b!==x[h])&&Sr(i,h,b,x[h],s),h="checked",S!==void 0&&S!==i[h]&&Sr(i,h,S,x[h],s))}return i}function Ua(i,t,e){try{if(typeof i=="function"){var n=typeof i.__u=="function";n&&i.__u(),n&&t==null||(i.__u=i(t))}else i.current=t}catch(s){Ot.__e(s,e)}}function Va(i,t,e){var n,s;if(Ot.unmount&&Ot.unmount(i),(n=i.ref)&&(n.current&&n.current!==i.__e||Ua(n,null,t)),(n=i.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(r){Ot.__e(r,t)}n.base=n.__P=null}if(n=i.__k)for(s=0;s<n.length;s++)n[s]&&Va(n[s],t,e||typeof i.type!="function");e||i.__e==null||_u(i.__e),i.__c=i.__=i.__e=i.__d=void 0}function _g(i,t,e){return this.constructor(i,e)}function ni(i,t,e){var n,s,r,o;Ot.__&&Ot.__(i,t),s=(n=typeof e=="function")?null:e&&e.__k||t.__k,r=[],o=[],Ka(t,i=(!n&&e||t).__k=P(bn,null,[i]),s||ls,ls,t.namespaceURI,!n&&e?[e]:s?null:t.firstChild?vr.call(t.childNodes):null,r,!n&&e?e:s?s.__e:t.firstChild,n,o),xu(r,i,o)}vr=yu.slice,Ot={__e:function(i,t,e,n){for(var s,r,o;t=t.__;)if((s=t.__c)&&!s.__)try{if((r=s.constructor)&&r.getDerivedStateFromError!=null&&(s.setState(r.getDerivedStateFromError(i)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(i,n||{}),o=s.__d),o)return s.__E=s}catch(a){i=a}throw i}},pu=0,E.isValidElement=function(i){return i!=null&&i.constructor==null},Tt.prototype.setState=function(i,t){var e;e=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=vn({},this.state),typeof i=="function"&&(i=i(vn({},e),this.props)),i&&vn(e,i),i!=null&&this.__v&&(t&&this._sb.push(t),bu(this))},Tt.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),bu(this))},Tt.prototype.render=bn,ti=[],gu=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ja=function(i,t){return i.__v.__b-t.__v.__b},Cr.__r=0,Ba=0,Ha=Su(!1),Wa=Su(!0);function vt(i,...t){return t.forEach(e=>{!e||typeof e!="object"||Object.keys(e).forEach(n=>{let s=e[n];const r=i[n];s!==r&&(r!==void 0&&(n==="className"||n.endsWith("Class")?s=[r,s]:n==="children"?s=[...kr(r),...kr(s)]:typeof r=="object"&&(n==="style"||n.endsWith("Style")||n==="attrs"||n.endsWith("Attrs")||n==="props")&&(s=g.extend(r,s))),i[n]=s)})}),i}function qa(i){return Object.keys(i).forEach(t=>{i[t]===void 0&&delete i[t]}),i}function $u(i,t=!0){const e=g(i),n=e[0],s="zui-disable-scroll";if(t){if(e.data(s))return;if((e.css("scrollbar-gutter")||"").includes("stable")){e.data(s,{overflow:e.css("overflow")}).css("overflow","hidden");return}const r=n===document.body||e.is("html")?window.innerWidth-document.body.clientWidth:n.offsetWidth-n.clientWidth;if(!r)return;const o=e.css("paddingRight")||"0";e.data(s,{paddingRight:o,overflow:e.css("overflow")}).css({paddingRight:`${r+Number.parseInt(o,10)}px`,overflow:"hidden"})}else{const r=e.data(s);if(!r)return;e.css(r).removeData(s)}}g.fn.disableScroll=function(i=!0){return this.each((t,e)=>{$u(e,i)})},g.fn.enableScroll=function(i=!0){return this.disableScroll(!i)};function Ga(i,t,e){if(!(e.on||"click").split(" ").includes(t.type))return;const n=e.selector?g(t.target).closest(e.selector):i;if(!n.length)return;const s=h=>h===""?!0:h,r=h=>{if(typeof h=="string")try{h=JSON.parse(h)}catch{}return h};if(s(e.once)){if(e.onceCalled)return;i.dataset("once-called",!0)}if(s(e.prevent)&&t.preventDefault(),s(e.stop)&&t.stopPropagation(),s(e.self)&&t.currentTarget!==t.target)return;const o=[["$element",i],["event",t],["options",e],["$target",n]],a=h=>typeof h=="function"?h(...o):g.runJS(h,...o);if(e.if!==void 0&&!a(e.if))return;const l=e.call;if(l){let h;if(typeof l=="string"?h=/^[$A-Z_][0-9A-Z_$.]*$/i.test(l)?Ia(window,l):a(l):h=l,typeof h=="function"){const f=[],d=e.params;e.params=f,typeof d=="string"&&d.length?d[0]==="["?f.push(...r(d)):f.push(...d.split(", ").map(m=>(m=m.trim(),m==="$element"?i:m==="event"?t:m==="options"?e:m.startsWith("$element.")||m.startsWith("event.")||m.startsWith("options.")?a(m):r(m)))):Array.isArray(d)?f.push(...d):f.push(d),h(...f)}}e.do&&a(e.do)}function vg(i){const t=g(this),e=i.type,n=t.attr("zui-on");if(n){const[o,a]=n.split("~").map(l=>l.trim());o&&o.split(" ").includes(e)&&Ga(t,i,g.extend({on:o},a?a.startsWith("{")?Jn(a):{do:a}:$i(t,{prefix:"data-",evalValue:["call","if","do"]})))}const s=t.attr(`zui-on-${e}`);s&&Ga(t,i,g.extend({on:e},s.startsWith("{")?Jn(s):{do:s}));const r=t.attr("data-on");r&&r.split(" ").includes(e)&&Ga(t,i,$i(t,{prefix:"data-",evalValue:["call","if","do"]}))}function Tu(i){g(document).off(".zui.global").on(i.map(t=>`${t}.zui.global`).join(" "),`[zui-on],${i.map(t=>`[zui-on-${t}]`)},[data-on]`,vg)}g(()=>{Tu(["click","change","inited"])});function ii(i,t){if(typeof i=="function")return ii(i(...t||[]));if(typeof i=="number")return[i];let e=i.match(/(\d+)(%|px)?/);return e?[parseInt(e[1]),e[2]]:(e=i.match(/(\d+)\/(\d+)/),e?[100*parseInt(e[1])/parseInt(e[2]),"%"]:[NaN])}function Bt(i,t){if(i==null)return null;const[e,n="px"]=ii(i,t);return Number.isNaN(e)?typeof i=="string"?i:null:`${e}${n}`}async function xr(i,t){var n,s,r;if(i instanceof Blob){const o=document.createElement("a");return o.href=window.URL.createObjectURL(i),t&&(o.download=decodeURIComponent(t)),o.click(),o.remove(),i}if(i instanceof Response){const o=await i.blob();return t=t||((r=(s=(n=i.headers.get("Content-Disposition"))==null?void 0:n.split(";")[1])==null?void 0:s.split("=")[1])==null?void 0:r.replace(/"/g,"")),xr(o,t)}const e=await fetch(i);return xr(e)}class Nu{constructor(t){this._$target=g(t)}on(...t){return this._$target.on(...t),this}one(...t){return this._$target.one(...t),this}off(...t){return this._$target.off(...t),this}trigger(...t){return this._$target.trigger(...t),this}}const Ve=new Nu(document);g.bus=Ve,g.on=Ve.on.bind(Ve),g.one=Ve.one.bind(Ve),g.off=Ve.off.bind(Ve),g.trigger=Ve.trigger.bind(Ve);var bg=["Shift","Meta","Alt","Control"],Eu=typeof navigator=="object"?navigator.platform:"",Mu=/Mac|iPod|iPhone|iPad/.test(Eu),wg=Mu?"Meta":"Control",Cg=Eu==="Win32"?["Control","Alt"]:Mu?["Alt"]:[];function Ya(i,t){return typeof i.getModifierState=="function"&&(i.getModifierState(t)||Cg.includes(t)&&i.getModifierState("AltGraph"))}function kg(i){return i.trim().split(" ").map(function(t){var e=t.split(/\b\+/),n=e.pop();return[e=e.map(function(s){return s==="$mod"?wg:s}),n]})}function Pu(i,t){var e;t===void 0&&(t={});var n=(e=t.timeout)!=null?e:1e3,s=Object.keys(i).map(function(a){return[kg(a),i[a]]}),r=new Map,o=null;return function(a){a instanceof KeyboardEvent&&(s.forEach(function(l){var h=l[0],f=l[1],d=r.get(h)||h;(function(m,y){return!(y[1].toUpperCase()!==m.key.toUpperCase()&&y[1]!==m.code||y[0].find(function(b){return!Ya(m,b)})||bg.find(function(b){return!y[0].includes(b)&&y[1]!==b&&Ya(m,b)}))})(a,d[0])?d.length>1?r.set(h,d.slice(1)):(r.delete(h),f(a)):Ya(a,a.key)||r.delete(h)}),o&&clearTimeout(o),o=setTimeout(r.clear.bind(r),n))}}function Sg(i,t,e){var n;e===void 0&&(e={});var s=(n=e.event)!=null?n:"keydown",r=Pu(t,e);return i.addEventListener(s,r),function(){i.removeEventListener(s,r)}}function Qa(i,t={}){if(!i)return;const e=Object.keys(t).reduce((n,s)=>(t[s].optional||(n[s]={...t[s]}),n),{});return Object.keys(i).forEach(n=>{const s=i[n];s?s===!0?t[n]&&(e[n]={...t[n]}):e[n]=s:delete e[n]}),Object.keys(e).reduce((n,s)=>{const{keys:r,handler:o}=e[s];return typeof r=="string"?n[r]=o:r.forEach(a=>{n[a]=o}),n},{})}function Xa(i,t,e){const{timeout:n,event:s="keydown",scope:r,when:o}=e||{},a=Pu(t,{timeout:n}),l=`.zui.hotkeys${r?`.${r}`:""}`,h="zui-hotkeys-composing";return g(i).on(`${s}${l}`,function(f){o&&o(f)===!1||g(f.target).data(h)||a(f)}).on(`compositionstart${l}`,f=>{g(f.target).data(h,!0)}).on(`compositionend${l}`,f=>{g(f.target).removeData(h)})}function Za(i,t){return g(i).off(`.zui.hotkeys${t?`.${t}`:""}`)}const xg=Sg;g.fn.hotkeys=function(i,t){return Xa(this,i,t)},g.fn.unbindHotkeys=function(i){return Za(this,i)},g.hotkeys=function(i,t){Xa(window,i,t)},g.unbindHotkeys=function(i){Za(window,i)};function $r(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement}async function Au(i){(typeof i=="string"||i instanceof Element||i instanceof g)&&(i={target:i});const{target:t,onError:e,onSuccess:n,afterExit:s,afterEnter:r}=i,o=g(t),a=o[0];if(!a)return;const l=a.requestFullscreen||a.webkitRequestFullscreen||a.mozRequestFullScreen;if(!l){e==null||e.call(a,new Error("[ZUI] The browser does not support full screen feature."));return}try{await l.call(a),n==null||n.call(a),g(a).off(".zui.fullscreen"),s&&o.on("exitFullscreen.zui.fullscreen",s),r&&o.on("enterFullscreen.zui.fullscreen",r)}catch(h){e==null||e.call(a,h)}document.zuiBindFullscreenChange||(document.zuiBindFullscreenChange=!0,g(document).on("fullscreenchange.zui webkitfullscreenchange.zui mozfullscreenchange.zui",h=>{const f=$r();let d=f;f?g(f).addClass("is-in-fullscreen"):(d=g(document).find(".is-in-fullscreen")[0]||document,g(d).removeClass("is-in-fullscreen")),g("body").toggleClass("has-in-fullscreen",!!f);const m={event:h,target:d,fullscreenElement:f};g(d).trigger(f?"enterFullscreen":"exitFullscreen",m).trigger("toggleFullscreen",m)}))}async function Ja(i){const t=$r();return i===!1&&!!t===i?i:t?(document.exitFullscreen(),!1):(await Au(i),!0)}g.fn.fullscreen=function(i){return Ja({target:this,...i})},g.getFullscreenElement=$r,g.toggleFullscreen=Ja;function wn(i){return!i||i.parentNode===document?!1:i.parentNode?wn(i.parentNode):!0}g.isDetached=wn,g.fn.isDetached=function(){const i=this[0];return!i||wn(i)};const si=class lm{constructor(t,e){this._inited=!1,this._autoDestory=0,this._destroyed=!1;const{KEY:n,DATA_KEY:s,MULTI_INSTANCE:r,NAME:o,ATTR_KEY:a,ALL:l,TYPED_ALL:h}=this.constructor;if(!o)throw new Error('[ZUI] The component must have a "NAME" static property.');const f=g(t);if(f.data(n)&&!r)throw new Error(`[ZUI] The component "${o}" has been initialized on element.`);const d=f[0],m=_e();if(this._gid=m,this._element=d,this.resetOptions(e),this._key=this.options.key??`__${m}`,l.has(d)?l.get(d).add(this):l.set(d,new Set([this])),h.has(o)?h.get(o).add(this):h.set(o,new Set([this])),f.data(n,this).attr(a,"").attr(s,`${m}`),r){const y=`${n}:ALL`;let b=f.data(y);b||(b=new Map,f.data(y,b)),b.set(this._key,this)}this.init(),requestAnimationFrame(async()=>{this._inited=!0,await this.afterInit(),this.emit("inited",this.options)})}static get ZUI(){return this.NAME.replace(/(^[A-Z]+)/,t=>t.toLowerCase())}static get KEY(){return`zui.${this.NAME}`}static get NAMESPACE(){return`.zui.${this.ZUI}`}static get DATA_KEY(){return`data-zui-${this.NAME}`}static get ATTR_KEY(){return`z-use-${this.NAME}`}static get SELECTOR(){return`[${this.DATA_KEY}]`}get inited(){return this._inited}get destroyed(){return this._destroyed}get element(){return this._element}get key(){return this._key}get options(){return this._options}get gid(){return this._gid}get $element(){return g(this.element)}get $emitter(){return this.$element}get i18nData(){return[this.options.i18n,this.constructor.i18n]}init(){}afterInit(){}render(t,e){this.setOptions(t,e)}destroy(){const{KEY:t,DATA_KEY:e,ALL:n,TYPED_ALL:s,NAME:r,MULTI_INSTANCE:o,ATTR_KEY:a}=this.constructor,{$element:l,element:h}=this;if(this.emit("destroyed"),this._destroyed=!0,l.off(this.namespace).removeData(t).removeAttr(a).removeAttr(e),o){const m=this.$element.data(`${t}:ALL`);if(m)if(m.delete(this._key),m.size===0)this.$element.removeData(`${t}:ALL`);else{const y=m.values().next().value;l.data(t,y).attr(e,y.gid)}}const f=n.get(h);f&&(f.delete(this),f.size===0&&n.delete(h));const d=s.get(r);d&&(d.delete(this),d.size===0&&s.delete(r))}autoDestroy(t=100){this._autoDestory&&clearTimeout(this._autoDestory),this._autoDestory=window.setTimeout(()=>{this._autoDestory=0,wn(this.element)&&this.destroy()},t)}setOptions(t,e){if(e){const n={...this.constructor.DEFAULT,...(t==null?void 0:t.$optionsFromDataset)!==!1?this.$element.dataset():{},...t},{$options:s}=n;if(s){const r=typeof s=="function"?s(this.element,n):s;r&&g.extend(n,r),delete n.$options}this._options=n}else t&&g.extend(this._options,t);return this._options}resetOptions(t){return this.setOptions(t,!0)}emit(t,...e){const n=g.Event(t);return n.__src=this,this.$emitter.trigger(n,[this,...e]),n}on(t,e,n){const s=this;this.$element[n!=null&&n.once?"one":"on"](this._wrapEvent(t),function(r,o){(!r.__src||r.__src===s)&&e.call(this,r,o)})}one(t,e){this.on(t,e,{once:!0})}off(t){this.$element.off(this._wrapEvent(t))}i18n(t,e,n){const{i18nData:s}=this;return Nt(s,t,e,n,this.options.lang,this.constructor.NAME)??Nt(s,t,e,n,this.options.lang)??`{i18n:${t}}`}get namespace(){return`${this.constructor.NAMESPACE}.${this._key}`}_wrapEvent(t){return t.split(" ").map(e=>e.includes(".")?e:`${e}${this.namespace}`).join(" ")}static get(t,e){const n=g(t);if(this.MULTI_INSTANCE&&e!==void 0){const s=n.data(`${this.KEY}:ALL`);return s?s.get(e):void 0}return n.data(this.KEY)}static isValid(t){return!0}static ensure(t,e){const n=this.get(t,e==null?void 0:e.key);if(n){if(this.isValid(n))return e&&n.setOptions(e),n;n.destroy()}return new this(t,e)}static getAll(t,e){var l;const{SELECTOR:n,ALL:s,TYPED_ALL:r}=this,o=[],a=h=>{h instanceof this&&(!e||e(h)!==!1)&&o.push(h)};return t?g(t).find(n).each((h,f)=>{var d;(d=s.get(f))==null||d.forEach(a)}):this!==lm?(l=r.get(this.NAME))==null||l.forEach(a):s.forEach(h=>{h.forEach(a)}),o.sort((h,f)=>h.gid-f.gid)}static query(t,e,n){return t===void 0?this.getAll(void 0,n).pop():this.get(g(t).closest(this.SELECTOR),e)}static defineFn(t){let e=t||this.ZUI;g.fn[e]&&(e=`zui${this.NAME}`);const n=this;g.fn.extend({[e](s,...r){const o=typeof s=="object"?s:void 0,a=typeof s=="string"?s:void 0;let l;return this.each((h,f)=>{let d=n.get(f);if(d)o&&d.render(o);else{if(a)return;d=new n(f,o)}if(a){let m=d[a],y=d;m===void 0&&(y=d.$,m=y[a]),typeof m=="function"?l=m.call(y,...r):l=m}}),l!==void 0?l:this}})}static register(t,e){var s,r;t=t||this,e=(e??t.NAME).toLowerCase(),this.map.set(e,t);const n=(r=(s=t.toggle)==null?void 0:s.name)==null?void 0:r.toLowerCase();n&&n!==e&&this.toggleMap.set(n,t)}};si.DEFAULT={},si.MULTI_INSTANCE=!1,si.ALL=new Map,si.TYPED_ALL=new Map,si.map=new Map,si.toggleMap=new Map;let zt=si;function cs(i){return zt.map.get(i.toLowerCase())}function tl(i,t,e={}){let n=cs(i);if(n||(n=el(i)),!n)return null;const{$update:s,...r}=e;if(!n.MULTI_INSTANCE){const o=n.get(t);if(o)return s&&o.render(r,s==="reset"),o}return new n(t,r)}function $g(i,t,e={}){requestAnimationFrame(()=>tl(i,t,e))}function Iu(i,t){zt.register(i,t)}function el(i){const{zui:t}=window;if(t){i=i==null?void 0:i.toLowerCase();for(const e in t){const n=e.toLowerCase()===i;if(i&&!n)continue;const s=t[e];if(!(typeof s!="function"||!s.NAME||!s.ZUI)&&(zt.map.has(e.toLowerCase())||Iu(s),n))return s}}}function Tg(i){var t;i?(t=cs(i))==null||t.defineFn():window._zuiDefined||(el(),zt.map.forEach(e=>{e.defineFn()}),Object.assign(window,{_zuiDefined:!0}))}function Ng(i,t={}){const e=g(i);let n=e.attr("zui-create");const{update:s,onCreate:r}=t,o=(a,l)=>{if(l={$update:s,$optionsFromDataset:!1,...l},r){const f=r(a,l);if(f===!1)return;f&&(l=f)}const h=l.$lib;if(h){delete l.$lib,g.getLib(h).then(()=>tl(a,i,l));return}$g(a,i,l)};if(typeof n=="string"){n=n.trim();const a=n.length?n.split(",").map(f=>f.trim()):[],l=$i(i,{prefix:"zui-create-",evalValue:!0}),h=Object.keys(l);if(!h.length&&a.length===1)o(a[0],e.dataset());else{const f=new Set;[...a,...h].forEach(d=>{if(f.has(d))return;const m=l[d];o(d,m),delete l[d],f.add(d)})}}else{const a=e.dataset(),l=a==null?void 0:a.zui;if(!l)return;console.warn("[ZUI] create component instance with [data-zui] is deprecated, use [zui-create] instead.",{element:i,options:t}),delete a.zui,o(l,a)}}function Eg(){g(document).on("click.zui.toggle mouseenter.zui.toggle","[data-toggle],[zui-toggle]",function(i){const t=g(this),e=t.dataset("toggle")||t.attr("zui-toggle");if(!e)return;const n=zt.toggleMap.get(e)||cs(e),s=n==null?void 0:n.toggle;if(!s)return;const{trigger:r="click",skip:o="[disabled],.disabled",check:a}=s,l=i.type==="mouseover"?"hover":"click";if(!r.includes(l)||a&&!a.call(n,this,l,i)||o&&t.is(o))return;const{onGet:h,onCreate:f,setOptions:d=!0,getOptions:m,prevent:y=!0,handler:b,onToggle:S,convertHref:x}=s;let k=t.dataset();const T=t.attr(`zui-toggle-${e}`);if(T&&(k=g.extend(k,Jn(T))),x&&t.is("a")){const B=t.attr("href");if(B){const K=x===!0?{selector:"target",url:"url"}:x;"#.".includes(B[0])?K.selector&&k[K.selector]===void 0&&(k[K.selector]=B):K.url&&k[K.url]===void 0&&(k[K.url]=B)}}if(m&&(k=m.call(n,this,k,i)),b){b.call(n,this,k,l,i),y&&i.preventDefault();return}let j=h?h.call(n,this):n.get(this);if(j)d&&j.setOptions(k);else{const B=f?f.call(n,this,i,k):new n(this,k);if(!B)return;j=B}if(S){if(S.call(n,j,this,i)===!1)return}else{const{shown:B,show:K,hide:G,toggle:Q}=j;let Z;if(Q?Z=Q:K&&G?B?Z=G:Z=K:K&&(Z=K),Z)Z.call(j);else return}y&&i.preventDefault()})}function Mg(i,t){const e=os(i),n=[];return Object.keys(e).forEach(s=>{if(!s.startsWith("zui."))return;const r=e[s];(t==null?void 0:t(r,s))!==!1&&n.push(e[s])}),n}let Tr=0;function Du(i=100){if(Tr&&clearTimeout(Tr),i){Tr=window.setTimeout(()=>Du(0),i);return}Tr=0,zt.ALL.forEach(t=>{t.forEach(e=>e.autoDestroy())})}function Pg(){if(!document.body||os(document.body,"_autoDestoryMob"))return;const i=new MutationObserver(t=>{let e=!1;for(const n of t)if(n.removedNodes.length){e=!0;break}e&&Du()});i.observe(document.body,{childList:!0,subtree:!0}),_r(document.body,"_autoDestoryMob",i)}g.fn.zuiInit=function(i){return this.find("[zui-create],[data-zui]").each(function(){var t;((t=i==null?void 0:i.beforeCreate)==null?void 0:t.call(i,this))!==!1&&Ng(this,i)}),this.find("[zui-init]").each(function(){this.hasAttribute("z-zui-inited")||(this.setAttribute("z-zui-inited",""),g.runJS(this.getAttribute("zui-init"),["$element",g(this)]))}),this.find(".hide-before-init").removeClass("invisible hidden opacity-0"),this.find(".scroll-into-view").scrollIntoView(),this.find('[data-on="inited"],[zui-on-inited]').each((t,e)=>{const n=g(e);n.zui()||n.trigger("inited")}),this},g.fn.zui=function(i,t){const e=this[0];if(!e)return;if(typeof i!="string"){const s={};let r;return Mg(e,(o,a)=>{s[a]=o,(!r||r.gid<o.gid)&&(r=s[a])}),i===!0?s:r}const n=cs(i);return n?t===!0?n.getAll(e):n.query(e,t):g(e).data(`zui.${i}`)},g.fn.zuiCall=function(i,t=[]){return this.each(function(){const e=i.split("."),n=e.length>1?e[0]:void 0,s=e[e.length>1?1:0],r=g(this).zui(n),o=r==null?void 0:r[s];typeof o=="function"&&o.apply(r,t)}),this},g(()=>{g("body").zuiInit({update:!0}),Eg(),Pg()});class nl extends zt{init(){const{offset:t=1,side:e,zIndex:n,pinnedClass:s="is-pinned",targets:r,scrollContainer:o}=this.options,{$element:a}=this,l=r?a.find(r):a;if(l.css({position:"sticky",zIndex:n}),e&&l.css(e,-t),o){const h=a.closest(o)[0];if(h){const f=()=>{this._raf&&cancelAnimationFrame(this._raf),this._raf=requestAnimationFrame(()=>{if(this._raf=0,h.scrollTop===0&&(!e||e==="top")){l.toggleClass(s,!1);return}const d=h.getBoundingClientRect();l.each((m,y)=>{const S=y.getBoundingClientRect()[e||"top"]===d[e||"top"];y.classList.toggle(s,S)})})};this._scrollListener=f,h.addEventListener("scroll",f)}this._container=h}else this._ob=new IntersectionObserver(h=>{h.forEach(f=>{f.target.classList.toggle(s,f.intersectionRatio<t)})},{threshold:[1]}),l.each((h,f)=>this._ob.observe(f))}destroy(){var t;(t=this._ob)==null||t.disconnect(),this._container&&(this._container.removeEventListener("scroll",this._scrollListener),this._raf&&cancelAnimationFrame(this._raf))}}nl.NAME="Sticky";function Nr(i,t){i=i.replace(/^#?!?!?>?/,""),i.startsWith("/")||(i=`/${i}`);const e=new URL(window.location.origin+i),[,n="",...s]=e.pathname.split("/"),{execute:r,event:o,scope:a}=t;let{options:l}=t;return l={...Object.fromEntries([...e.searchParams.entries()].map(([h,f])=>{try{f.includes("%")&&(f=decodeURIComponent(f)),f=JSON.parse(f)}catch{}return[h,f]})),...l},r({name:n,options:l,event:o,scope:a},...s.map(h=>{try{return h.includes("%")&&(h=decodeURIComponent(h)),JSON.parse(h)}catch{return h}}))}async function Ag(i,t){if(i.includes(">")){const e=i.split(">"),n=[];for(const s of e){if(!s.length)continue;const r=await Nr(s,t);n.push(r)}return n}return i.includes("|")?Promise.all(i.split("|").map(e=>Nr(e,t))):Nr(i,t)}function il(i,t){if(/^#?!?!?>/.test(i))return Ag(i,t);if(i.includes(">")){const e=i.split(">"),n=[];for(const s of e){const r=il(s,t);n.push(r)}return n}if(i.includes("|")){const e=i.split("|"),n=[];for(const s of e){const r=il(s,t);n.push(r)}return n}return Nr(i,t)}function sl(i,t){typeof t=="string"?t={scope:t}:typeof t=="function"&&(t={execute:t});const{scope:e="",events:n="click",execute:s,commands:r}=t??{},o=g(i),a=`z-commands${e?`-${e}`:""}`;if(typeof o.attr(a)=="string")return;const l=e?`zui-command-${e}`:"zui-command";o.attr(a,"").on(n.split(" ").map(h=>`${h}.zui.command.${e}`).join(" "),`[${l}]${e?"":',a[href^="#!"]'}`,h=>{if(h.commandHandled)return;const f=g(h.currentTarget);if(f.is(".disabled,[disabled]"))return;const d=f.attr(l)||(f.is('a[href^="#!"]')?f.attr("href"):"");d&&(h.commandHandled=!0,(d.startsWith("#!!")||d.startsWith("!!"))&&h.stopPropagation(),il(d,{execute:(m,...y)=>{s==null||s(m,...y);const b=r==null?void 0:r[m.name];b==null||b(m,...y);const{name:S}=m,x=[m,y];f.trigger("command",x).trigger(`command:${e?`${S}.${e}`:S}`,x),e&&f.trigger(`command:.${e}`,x)},event:h,scope:e,options:{}}))})}function Ru(i,t){const e=`z-commands${t?`-${t}`:""}`;g(i).removeAttr(e).off(`.zui.command${t?`.${t}`:""}`)}g.fn.command=function(i,t){return this.on(`command:${i}`,t)},g.fn.offCommand=function(i,t){return this.off(`command:${i}`,t)},g.fn.commands=function(i){return this.each((t,e)=>sl(e,i)),this},g.fn.unbindCommands=function(i){return this.each((t,e)=>Ru(e,i)),this},g(()=>sl(document.body));function hs(i,t={}){const e=g(i)[0];if(!e)return!1;let{viewport:n}=t;const{left:s,top:r,width:o,height:a}=e.getBoundingClientRect();if(t.checkZeroSize&&!(o*a))return!1;if(!n)if(t.container)n=g(e).closest(t.container)[0].getBoundingClientRect();else{const{innerHeight:b,innerWidth:S}=window,{clientHeight:x,clientWidth:k}=document.documentElement;n={left:0,top:0,width:S||k,height:b||x}}const{left:l,top:h,width:f,height:d}=n;if(t.fullyCheck)return s>=l&&r>=h&&s+o<=f+l&&r+a<=d+h;const m=s<=l+f&&s+o>=l;return r<=h+d&&r+a>=h&&m}g.fn.isVisible=function(i){return hs(this,i)};function Er(i,t,e=!1){var s;const n=g(i);if(t!==void 0){if(typeof t=="string"&&t.length){const r=`zui-runjs-${_e()}`;n.append(`<script id="${r}">${t}<\/script>`),e&&n.find(`#${r}`).remove()}return}if(n.is("script")){const r=(s=n[0])==null?void 0:s.textContent;r&&Er(n.parent(),r);return}n.find("script").each((r,o)=>{Er(n,o.textContent),o.remove()})}g.runJS=(i,...t)=>(i=i.trim(),!i.startsWith("return ")&&!i.endsWith(";")&&(i=`return ${i}`),new Function(...t.map(([n])=>n),i)(...t.map(([,n])=>n))),g.fn.runJS=function(i){return this.each((t,e)=>{Er(e,i)})};function Ig(i,t="both"){return(t==="vert"||t==="both")&&i.clientHeight<i.scrollHeight||(t==="horz"||t==="both")&&i.clientWidth<i.scrollWidth}function Lu(i,t){const e=g(i),{ifNeeded:n=!0,container:s,...r}=t||{};return e.each((o,a)=>{if(s){const l=g(a).closest(s);if(!l.length||!Ig(l[0]))return}if(n){if(a.scrollIntoViewIfNeeded)return a.scrollIntoViewIfNeeded(r);if(hs(a,{viewport:a.getBoundingClientRect()}))return}a.scrollIntoView(r)}),e}g.fn.scrollIntoView=function(i){return this.each((t,e)=>{Lu(e,i)})},g.setLibRoot=function(i){g.libRoot=i},g.registerLib=function(i,t){g.libMap||(g.libMap={}),!t.name&&t.id&&(t.id=`zui-lib-${i}`),g.libMap[i]=t};function Ou(i){return new Promise((t,e)=>{typeof i=="string"&&(i={src:i});const{src:n,id:s}=i;if(g(s?`#${s}`:`link[href="${n}"]`).length){t();return}const o=document.createElement("link");o.onload=()=>{t()},o.onerror=()=>{e(new Error(`[ZUI] Failed to load CSS from: ${n}`))},o.rel="stylesheet",o.href=n,s&&(o.id=s),g("head").append(o)})}function zu(i){return new Promise((t,e)=>{typeof i=="string"&&(i={src:i});const{src:n,id:s}=i,r=g(s?`#${s}`:`script[src="${n}"]`);if(r.length){if(r.dataset("loaded"))t();else{const m=r.data("loadCalls")||[];m.push(t),r.data("loadCalls",m)}return}const{async:o=!0,defer:a=!1,noModule:l=!1,type:h,integrity:f}=i,d=document.createElement("script");d.async=o,d.defer=a,d.noModule=l,h&&(d.type=h),f&&(d.integrity=f),d.onload=()=>{t(),(g(d).dataset("loaded",!0).data("loadCalls")||[]).forEach(y=>y()),g(d).removeData("loadCalls")},d.onerror=()=>{e(new Error(`[ZUI] Failed to load JS from: ${n}`))},g("head").append(d),d.src=n})}function Fu(i){return new Promise(t=>{typeof i=="string"&&(i={type:"module",src:i});const{src:e,imports:n,srcList:s=[],id:r}=i;e&&s.unshift({src:e,imports:n});const o=s.map(k=>k.src).join(","),a=g(r?`#${r}`:`script[data-src-list="${o}"]`);if(a.length){const k=a.data("module");if(k)t(k);else{const T=a.data("resolves")||[];T.push(t),a.data("resolves",T)}return}const{async:l=!0,defer:h=!1,integrity:f,globalVar:d,resolve:m}=i,y=document.createElement("script"),b=`zui-module-resolve-${g.guid++}`,S=g(y);Object.assign(window,{[b]:k=>{(S.data("module",k).data("resolves")||[]).forEach(j=>j(k)),S.removeData("resolves"),m==null||m(k),t(k),delete window[b]}}),y.async=l,y.defer=h,y.type="module",S.attr("data-src-list",o).attr("data-resolve-id",b);const x=[];y.text=[...s.map(({src:k,imports:T})=>{if(n){if(typeof T=="string")return x.push(T),`import * as ${T} from '${k}';`;if(T)return x.push(...Object.values(T)),`import {${Object.entries(T).map(([j,B])=>`${j} as ${B}`).join(",")}} from '${k}';`}return`import '${k}';`}),`const zuiImportResult = {${x.map(k=>`${k}: ${k},`)}};`,d?`Object.assign(window, ${d===!0?"zuiImportResult":`{${d}: zuiImportResult}`});`:"",`if(window['${b}']) window['${b}'](zuiImportResult);`].join(`
`),f&&(y.integrity=f),g("head").append(y)})}g.getLib=async function(i,t,e){var b;typeof i=="string"&&(i=((b=g.libMap)==null?void 0:b[i])||{src:i});let n=Array.isArray(i)?{src:i}:g.extend({},i);typeof t=="function"?n.success=t:t&&g.extend(n,t),e&&(n.success=e);let{src:s}=n;const{name:r,success:o}=n,a=g.libMap&&r?g.libMap[r]:null;if(a&&(n=g.extend({},a,n),s=a.src||n.src),typeof s=="string"&&(s=[s]),!s||!s.length)throw new Error("[ZUI] No src provided for $.getLib.");let{check:l=!0}=n;l===!0&&r&&(l=r);const h=typeof l=="string"?l:r;let f;const d=()=>h?window[h]||f:void 0;typeof l=="string"&&(l=()=>!!d());const m=()=>(o==null||o(),d());if(typeof l=="function"&&await l())return m();const{root:y=g.libRoot}=n;for(let S of s){typeof S=="string"&&(S={src:S});let{src:x}=S;y&&!/https?:\/\//.test(x)&&(x=`${y}${y.endsWith("/")||x.startsWith("/")?"":"/"}${x}`);const k={...n,...S,src:x};if(S.type==="css"||!S.type&&x.endsWith(".css")){await Ou(k);continue}if(k.type==="module"){f=await Fu(k);continue}await zu(k)}return m()},g.getScript=g.getLib;function ju(i,t){const e=g(i),n=new ResizeObserver(t);return e.each((s,r)=>{n.observe(r)}),n}g.fn.resize=function(i){return ju(this,i)};const Dg=Object.freeze(Object.defineProperty({__proto__:null,isElementDetached:wn,isVisible:hs,listenResize:ju,loadCSS:Ou,loadJS:zu,loadModule:Fu,runJS:Er,scrollIntoView:Lu},Symbol.toStringTag,{value:"Module"}));var rl,Se,ol,Bu,Hu=0,Wu=[],Xt=Ot,Ku=Xt.__b,Uu=Xt.__r,Vu=Xt.diffed,qu=Xt.__c,Gu=Xt.unmount,Yu=Xt.__;function Rg(i,t){Xt.__h&&Xt.__h(Se,i,Hu||t),Hu=0;var e=Se.__H||(Se.__H={__:[],__h:[]});return i>=e.__.length&&e.__.push({}),e.__[i]}function Qu(i,t){var e=Rg(rl++,7);return zg(e.__H,t)&&(e.__=i(),e.__H=t,e.__h=i),e.__}function Lg(){for(var i;i=Wu.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(Mr),i.__H.__h.forEach(al),i.__H.__h=[]}catch(t){i.__H.__h=[],Xt.__e(t,i.__v)}}Xt.__b=function(i){Se=null,Ku&&Ku(i)},Xt.__=function(i,t){i&&t.__k&&t.__k.__m&&(i.__m=t.__k.__m),Yu&&Yu(i,t)},Xt.__r=function(i){Uu&&Uu(i),rl=0;var t=(Se=i.__c).__H;t&&(ol===Se?(t.__h=[],Se.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.i=e.__N=void 0})):(t.__h.forEach(Mr),t.__h.forEach(al),t.__h=[],rl=0)),ol=Se},Xt.diffed=function(i){Vu&&Vu(i);var t=i.__c;t&&t.__H&&(t.__H.__h.length&&(Wu.push(t)!==1&&Bu===Xt.requestAnimationFrame||((Bu=Xt.requestAnimationFrame)||Og)(Lg)),t.__H.__.forEach(function(e){e.i&&(e.__H=e.i),e.i=void 0})),ol=Se=null},Xt.__c=function(i,t){t.some(function(e){try{e.__h.forEach(Mr),e.__h=e.__h.filter(function(n){return!n.__||al(n)})}catch(n){t.some(function(s){s.__h&&(s.__h=[])}),t=[],Xt.__e(n,e.__v)}}),qu&&qu(i,t)},Xt.unmount=function(i){Gu&&Gu(i);var t,e=i.__c;e&&e.__H&&(e.__H.__.forEach(function(n){try{Mr(n)}catch(s){t=s}}),e.__H=void 0,t&&Xt.__e(t,e.__v))};var Xu=typeof requestAnimationFrame=="function";function Og(i){var t,e=function(){clearTimeout(n),Xu&&cancelAnimationFrame(t),setTimeout(i)},n=setTimeout(e,100);Xu&&(t=requestAnimationFrame(e))}function Mr(i){var t=Se,e=i.__c;typeof e=="function"&&(i.__c=void 0,e()),Se=t}function al(i){var t=Se;i.__c=i.__(),Se=t}function zg(i,t){return!i||i.length!==t.length||t.some(function(e,n){return e!==i[n]})}var Fg=Symbol.for("preact-signals");function Pr(){if(Cn>1)Cn--;else{for(var i,t=!1;us!==void 0;){var e=us;for(us=void 0,ll++;e!==void 0;){var n=e.o;if(e.o=void 0,e.f&=-3,!(8&e.f)&&td(e))try{e.c()}catch(s){t||(i=s,t=!0)}e=n}}if(ll=0,Cn--,t)throw i}}function Zu(i){if(Cn>0)return i();Cn++;try{return i()}finally{Pr()}}var It=void 0;function jg(i){var t=It;It=void 0;try{return i()}finally{It=t}}var us=void 0,Cn=0,ll=0,Ar=0;function Ju(i){if(It!==void 0){var t=i.n;if(t===void 0||t.t!==It)return t={i:0,S:i,p:It.s,n:void 0,t:It,e:void 0,x:void 0,r:t},It.s!==void 0&&(It.s.n=t),It.s=t,i.n=t,32&It.f&&i.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=It.s,t.n=void 0,It.s.n=t,It.s=t),t}}function te(i){this.v=i,this.i=0,this.n=void 0,this.t=void 0}te.prototype.brand=Fg,te.prototype.h=function(){return!0},te.prototype.S=function(i){this.t!==i&&i.e===void 0&&(i.x=this.t,this.t!==void 0&&(this.t.e=i),this.t=i)},te.prototype.U=function(i){if(this.t!==void 0){var t=i.e,e=i.x;t!==void 0&&(t.x=e,i.e=void 0),e!==void 0&&(e.e=t,i.x=void 0),i===this.t&&(this.t=e)}},te.prototype.subscribe=function(i){var t=this;return Dr(function(){var e=t.value,n=It;It=void 0;try{i(e)}finally{It=n}})},te.prototype.valueOf=function(){return this.value},te.prototype.toString=function(){return this.value+""},te.prototype.toJSON=function(){return this.value},te.prototype.peek=function(){var i=It;It=void 0;try{return this.value}finally{It=i}},Object.defineProperty(te.prototype,"value",{get:function(){var i=Ju(this);return i!==void 0&&(i.i=this.i),this.v},set:function(i){if(i!==this.v){if(ll>100)throw new Error("Cycle detected");this.v=i,this.i++,Ar++,Cn++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{Pr()}}}});function Ir(i){return new te(i)}function td(i){for(var t=i.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function ed(i){for(var t=i.s;t!==void 0;t=t.n){var e=t.S.n;if(e!==void 0&&(t.r=e),t.S.n=t,t.i=-1,t.n===void 0){i.s=t;break}}}function nd(i){for(var t=i.s,e=void 0;t!==void 0;){var n=t.p;t.i===-1?(t.S.U(t),n!==void 0&&(n.n=t.n),t.n!==void 0&&(t.n.p=n)):e=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=n}i.s=e}function Ti(i){te.call(this,void 0),this.x=i,this.s=void 0,this.g=Ar-1,this.f=4}(Ti.prototype=new te).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Ar))return!0;if(this.g=Ar,this.f|=1,this.i>0&&!td(this))return this.f&=-2,!0;var i=It;try{ed(this),It=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(e){this.v=e,this.f|=16,this.i++}return It=i,nd(this),this.f&=-2,!0},Ti.prototype.S=function(i){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}te.prototype.S.call(this,i)},Ti.prototype.U=function(i){if(this.t!==void 0&&(te.prototype.U.call(this,i),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}},Ti.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var i=this.t;i!==void 0;i=i.x)i.t.N()}},Object.defineProperty(Ti.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var i=Ju(this);if(this.h(),i!==void 0&&(i.i=this.i),16&this.f)throw this.v;return this.v}});function id(i){return new Ti(i)}function sd(i){var t=i.u;if(i.u=void 0,typeof t=="function"){Cn++;var e=It;It=void 0;try{t()}catch(n){throw i.f&=-2,i.f|=8,cl(i),n}finally{It=e,Pr()}}}function cl(i){for(var t=i.s;t!==void 0;t=t.n)t.S.U(t);i.x=void 0,i.s=void 0,sd(i)}function Bg(i){if(It!==this)throw new Error("Out-of-order effect");nd(this),It=i,this.f&=-2,8&this.f&&cl(this),Pr()}function ds(i){this.x=i,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}ds.prototype.c=function(){var i=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{i()}},ds.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,sd(this),ed(this),Cn++;var i=It;return It=this,Bg.bind(this,i)},ds.prototype.N=function(){2&this.f||(this.f|=2,this.o=us,us=this)},ds.prototype.d=function(){this.f|=8,1&this.f||cl(this)};function Dr(i){var t=new ds(i);try{t.c()}catch(e){throw t.d(),e}return t.d.bind(t)}var hl;function Ni(i,t){Ot[i]=t.bind(null,Ot[i]||function(){})}function Rr(i){hl&&hl(),hl=i&&i.S()}function rd(i){var t=this,e=i.data,n=Wg(e);n.value=e;var s=Qu(function(){for(var r=t.__v;r=r.__;)if(r.__c){r.__c.__$f|=4;break}return t.__$u.c=function(){var o;!E.isValidElement(s.peek())&&((o=t.base)==null?void 0:o.nodeType)===3?t.base.data=s.peek():(t.__$f|=1,t.setState({}))},id(function(){var o=n.value.value;return o===0?0:o===!0?"":o||""})},[]);return s.value}rd.displayName="_st",Object.defineProperties(te.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:rd},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}}),Ni("__b",function(i,t){if(typeof t.type=="string"){var e,n=t.props;for(var s in n)if(s!=="children"){var r=n[s];r instanceof te&&(e||(t.__np=e={}),e[s]=r,n[s]=r.peek())}}i(t)}),Ni("__r",function(i,t){Rr();var e,n=t.__c;n&&(n.__$f&=-2,(e=n.__$u)===void 0&&(n.__$u=e=function(s){var r;return Dr(function(){r=this}),r.c=function(){n.__$f|=1,n.setState({})},r}())),Rr(e),i(t)}),Ni("__e",function(i,t,e,n){Rr(),i(t,e,n)}),Ni("diffed",function(i,t){Rr();var e;if(typeof t.type=="string"&&(e=t.__e)){var n=t.__np,s=t.props;if(n){var r=e.U;if(r)for(var o in r){var a=r[o];a!==void 0&&!(o in n)&&(a.d(),r[o]=void 0)}else e.U=r={};for(var l in n){var h=r[l],f=n[l];h===void 0?(h=Hg(e,l,f,s),r[l]=h):h.o(f,s)}}}i(t)});function Hg(i,t,e,n){var s=t in i&&i.ownerSVGElement===void 0,r=Ir(e);return{o:function(o,a){r.value=o,n=a},d:Dr(function(){var o=r.value.value;n[t]!==o&&(n[t]=o,s?i[t]=o:o?i.setAttribute(t,o):i.removeAttribute(t))})}}Ni("unmount",function(i,t){if(typeof t.type=="string"){var e=t.__e;if(e){var n=e.U;if(n){e.U=void 0;for(var s in n){var r=n[s];r&&r.d()}}}}else{var o=t.__c;if(o){var a=o.__$u;a&&(o.__$u=void 0,a.d())}}i(t)}),Ni("__h",function(i,t,e,n){(n<3||n===9)&&(t.__$f|=2),i(t,e,n)}),Tt.prototype.shouldComponentUpdate=function(i,t){var e=this.__$u;if(!(e&&e.s!==void 0||4&this.__$f)||3&this.__$f)return!0;for(var n in t)return!0;for(var s in i)if(s!=="__source"&&i[s]!==this.props[s])return!0;for(var r in this.props)if(!(r in i))return!0;return!1};function Wg(i){return Qu(function(){return Ir(i)},[])}const ul={};function oe(i,t){typeof i=="object"?Object.keys(i).forEach(e=>{oe(e,i[e])}):t&&(ul[i.toLowerCase()]=t)}function od(i){return ul[i.toLowerCase()]}class Ft extends Tt{constructor(t){super(t),this._gid=_e(),this.state=this.getDefaultState(t)}get gid(){return this._gid}get element(){return document.querySelector(`[z-gid-${this._gid}]`)}get i18nData(){return[this.props.i18n,this.constructor.i18n]}getDefaultState(t){return{}}resetState(t,e){const n=this.getDefaultState(t);e?this.state=n:this.changeState(n)}i18n(t,e,n){const{i18nData:s}=this;return Nt(s,t,e,n,this.props.lang,this.constructor.NAME)??Nt(s,t,e,n,this.props.lang)??`{i18n:${t}}`}changeState(t,e){return new Promise(n=>{this.setState(t,()=>{e==null||e(),n(this.state)})})}_getClassName(t){return t.className}_getProps(t){const{className:e,attrs:n,props:s,data:r,forwardRef:o,children:a,component:l,style:h,class:f,...d}=t,m=new Set(this.constructor.customProps),y="dangerouslySetInnerHTML",b=Object.keys(d).reduce((S,x)=>{if(!m.has(x)&&(x===y||/^(on[A-Z]|data-|zui-|z-)[a-zA-Z-]+/.test(x))){const k=d[x];S[x]=x!==y&&k&&typeof k=="object"?JSON.stringify(k):k}return S},{});return{ref:o,className:q(this._getClassName(t),f)||void 0,style:h,[`z-gid-${this._gid}`]:"",...b,...n,...s}}_getComponent(t){const{component:e="div"}=t;return(typeof e=="string"?od(e):e)||e}_getChildren(t){return t.children}_beforeRender(t){return t}_onRender(t,e,n,s){return[t,e,n]}render(t){t=this._beforeRender(t)||t;let e=this._getComponent(t),n=this._getChildren(t),s=this._getProps(t);const r=this._onRender(e,s,n,t);return r&&([e,s,n]=r),P(e,s,n)}}Ft.HElement=!0,Ft.customProps=[];class ad extends Ft{constructor(t){super(t),this.signals={};const{state:e}=this;this.changeState(e),this.state={}}changeState(t,e){return Zu(()=>{typeof t=="function"&&(t=t(this.state));for(const n in t){const s=this.signals[n];s?s.value=t[n]:this.signals[n]=Ir(t[n])}e==null||e()}),Promise.resolve({})}resetState(t){this.changeState(this.getDefaultState(t))}}ad.HElementSignals=!0;var Kg=0;function w(i,t,e,n,s,r){t||(t={});var o,a,l=t;if("ref"in l)for(a in l={},t)a=="ref"?o=t[a]:l[a]=t[a];var h={type:i,props:l,key:e,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--Kg,__i:-1,__u:0,__source:s,__self:r};if(typeof i=="function"&&(o=i.defaultProps))for(a in o)l[a]===void 0&&(l[a]=o[a]);return Ot.vnode&&Ot.vnode(h),h}class kn extends Tt{constructor(){super(...arguments),this._ref=kt()}_runJS(){this.props.executeScript&&g(this._ref.current).runJS().zuiInit()}componentDidMount(){this._runJS()}componentDidUpdate(t){this.props.html!==t.html&&this._runJS()}render(t){const{executeScript:e,html:n,...s}=t;return w(Ft,{forwardRef:this._ref,dangerouslySetInnerHTML:{__html:n},...s})}}function ld(i){const{tag:t,className:e,style:n,renders:s,generateArgs:r=[],generatorThis:o,generators:a,onGenerate:l,onRenderItem:h,...f}=i,d=[e],m={...n},y=[],b=[];return s.forEach(S=>{const x=[];if(typeof S=="string"&&a&&a[S]&&(S=a[S]),typeof S=="function")if(l)x.push(...l.call(o,S,y,...r));else{const k=S.call(o,y,...r);k&&(Array.isArray(k)?x.push(...k):x.push(k))}else x.push(S);x.forEach(k=>{k!=null&&(typeof k=="object"&&!E.isValidElement(k)&&("html"in k||"__html"in k||"className"in k||"style"in k||"attrs"in k||"children"in k)?k.html?y.push(w("div",{className:q(k.className),style:k.style,dangerouslySetInnerHTML:{__html:k.html},...k.attrs??{}})):k.__html?b.push(k.__html):(k.style&&Object.assign(m,k.style),k.className&&d.push(k.className),k.children&&y.push(k.children),k.attrs&&Object.assign(f,k.attrs)):y.push(k))})}),b.length&&Object.assign(f,{dangerouslySetInnerHTML:{__html:b}}),[{className:q(d),style:m,...f},y]}function dl({tag:i="div",...t}){const[e,n]=ld(t);return P(i,e,...n)}function Lr(i){const{content:t,generatorArgs:e,generatorThis:n,...s}=i;let r=t;if(typeof r=="function"&&(r=r.call(n,...e||[])),Array.isArray(r))return r.map(o=>Lr({...s,content:o,generatorThis:n,generatorArgs:e}));if(typeof r=="string"||typeof r=="number")return Object.keys(s).length?w("div",{...s,children:r}):r;if(r&&typeof r=="object"&&(typeof r.html=="string"||r.component)){if(r.html)return w(kn,{...vt(s,r)});const{children:o,...a}=r;return o&&(r=vt({children:(Array.isArray(o)?o:[o]).map(l=>Lr({...s,content:l,generatorThis:n,generatorArgs:e}))},a)),w(Ft,{...vt(s,r)})}return E.isValidElement(r)?r:(r&&(console.groupCollapsed("[ZUI] CustomContent format error"),console.trace("content:",r),console.log("props:",i),console.groupEnd()),null)}function gt(i){const t=Lr(i);return t==null||typeof t=="boolean"?null:E.isValidElement(t)?t:w(bn,{children:t})}const cd=i=>i.startsWith("icon-")?i:`icon-${i}`;function Ht(i){const{icon:t,className:e,...n}=i;if(!t)return null;if(E.isValidElement(t))return t;const s=["icon",e];if(typeof t=="string")s.push(cd(t));else if(typeof t=="object"){const{className:r,icon:o,...a}=t;s.push(r,o?cd(o):""),Object.assign(n,a)}return w("i",{className:q(s),...n})}function Ug(i){return this.getChildContext=()=>i.context,i.children}function fl(i){const t=this,e=i._container;t.componentWillUnmount=function(){ni(null,t._temp),t._temp=null,t._container=null},t._container&&t._container!==e&&t.componentWillUnmount(),i._vnode?(t._temp||(t._container=e,t._temp={nodeType:1,parentNode:e,childNodes:[],appendChild(n){this.childNodes.push(n),t._container.appendChild(n)},insertBefore(n,s){this.childNodes.push(n),t._container.appendChild(n)},removeChild(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),t._container.removeChild(n)}}),ni(P(Ug,{context:t.context},i._vnode),t._temp)):t._temp&&t.componentWillUnmount()}function hd(i,t){const e=P(fl,{_vnode:i,_container:t});return e.containerInfo=t,e}oe({HElement:Ft,element:Ft,HtmlContent:kn,html:kn,CustomContent:gt,custom:gt,Icon:Ht,Portal:fl});class mt extends zt{constructor(){super(...arguments),this._ref=kt()}get $(){return this._ref.current}get i18nData(){const{i18n:t,i18nData:e}=this.constructor.Component;return e?[...e,this.constructor.i18n]:[t,...super.i18nData]}afterInit(){this.render()}destroy(){var t,e;(e=(t=this.$)==null?void 0:t.componentWillUnmount)==null||e.call(t),this.element&&(this.element.innerHTML=""),super.destroy()}render(t,e){var d;const{element:n,$:s}=this,{Component:r,replace:o}=this.constructor,{$replace:a=o,$optionsFromDataset:l,...h}=this.setOptions(t,e),f={ref:this._ref,...h};if(e&&((d=s==null?void 0:s.resetState)==null||d.call(s,h)),a&&r.HElement&&(n.tagName.toLowerCase()===a||a===!0)){const m=Array.from(n.attributes).reduce((y,b)=>{const{name:S,value:x}=b;return y[S==="class"?"className":S]=x,y},{});ni(P(r,vt({component:n.tagName.toLowerCase(),attrs:m},f)),n.parentElement,n)}else ni(P(r,f),n)}static renderHTML(t){const e=document.createElement("div");return ni(P(this.Component,t),e),e.innerHTML}}mt.replace=!1;class Et extends Ft{_beforeRender(t){const{text:e,loading:n,loadingText:s,caret:r,icon:o,trailingIcon:a,children:l}=t;this._isEmptyText=e==null||typeof e=="string"&&!e.length||n&&!s,this._onlyCaret=r&&this._isEmptyText&&!o&&!a&&!l&&!n}_getChildren(t){const{loading:e,loadingIcon:n,loadingText:s,icon:r,iconClass:o,text:a,textClass:l,children:h,trailingIcon:f,trailingIconClass:d,caret:m}=t;return[e?w(Ht,{icon:n||"icon-spinner-snake",className:"spin"}):w(Ht,{icon:r,className:o}),this._isEmptyText?null:w("span",{className:q("text",l),children:e?s:a}),e?null:h,e?null:w(Ht,{icon:f,className:d}),e?null:m?w("span",{className:typeof m=="string"?`caret-${m}`:"caret"}):null]}_getClassName(t){const{type:e,className:n,disabled:s,loading:r,active:o,children:a,square:l,size:h,rounded:f}=t;return["btn",e,n,{"btn-caret":this._onlyCaret,disabled:s||r,active:o,loading:r,square:l===void 0?!this._onlyCaret&&!a&&this._isEmptyText:l},h?`size-${h}`:"",typeof f=="string"?`rounded-${f}`:{rounded:f}]}_getComponent(t){return t.component||(t.url?"a":"button")}_getProps(t){const e=this._getComponent(t),{url:n,target:s,disabled:r,btnType:o="button",hint:a}=t,l=e==="a",h={...super._getProps(t),type:l?void 0:"button",disabled:!l&&r?"":void 0,title:a};return o&&(["button","reset","submit"].includes(o)?e==="button"&&(h.type=o):h.className=q([h.className,o])),r||(n!==void 0&&(h[l?"href":"data-url"]=n),s!==void 0&&(h[l?"target":"data-target"]=s)),h}}oe(Object.freeze(Object.defineProperty({__proto__:null,Button:Et},Symbol.toStringTag,{value:"Module"})));const Kb="",Ub="",Vb="",qb="",Gb="";let pe=class extends Ft{constructor(t){super(t),this._handleClick=this._handleClick.bind(this)}get name(){return this.props.name||this.constructor.NAME}get itemName(){return this.props.itemName||this.constructor.ITEM_NAME}getItems(){return this._items}getRenderedItem(t){return this._renderedItems.find(e=>e.key===t)}getItem(t){return this._items[this.getItemIndex(t)]}getItemIndex(t){return this._renderedItems.findIndex(e=>e.key===t)}getItemByIndex(t){return this._items[t]}getKey(t){var e,n;return(n=(e=this._renderedItems)==null?void 0:e[t])==null?void 0:n.key}_getItemFromEvent(t,e){var l;const n=(e||t.target).closest("[z-item]");if(!n||!((l=n.parentElement)!=null&&l.hasAttribute(`z-gid-${this._gid}`)))return;const s=+n.getAttribute("z-item"),r=this._items[s];if(!r)return;const o=this.getKey(s);if(o===void 0)return;const a=this._renderedItems[s];return{index:s,item:r,element:n,event:t,key:o,renderedItem:a,relativeTarget:this.props.relativeTarget}}_handleClick(t){var n,s;const e=this._getItemFromEvent(t);if(e)return(n=this.props.onClickItem)==null||n.call(this,e),(s=e.item.onClick)==null||s.call(this,t,e),e}_renderItem(t,e,n){const{beforeRenderItem:s}=t;if(s){const h=s.call(this,e,n);h!==void 0&&(e=h)}const{type:r}=e;let{itemRender:o}=t;if(o&&typeof o=="object"&&(o=o[r]),o){const h=o.call(this,e,n);if(h!==void 0)return w(gt,{"z-key":e.key,"z-item":n,"z-type":r,content:h})}const{ItemComponents:a}=this.constructor;let l=a[r];if(!l&&e.component)return w(gt,{"z-key":e.key,"z-item":n,"z-type":r,content:{...e}});if(l=l||a.default||Ft,Array.isArray(l)){let h=l[1];typeof h=="function"&&(h=h.call(this,e,t)),e=vt({},h,e),l=l[0]}return w(l,{"z-key":e.key,"z-item":n,"z-type":r,...e})}_getItem(t,e,n){if(!e)return!1;const{itemProps:s,itemPropsMap:r={},getItem:o,itemKey:a}=t,{type:l=this.constructor.defaultItemType}=e,{name:h,itemName:f}=this,{defaultItemProps:d={},defaultItemPropsMap:m={}}=this.constructor;if(e=vt({type:l},d,m[l],s,r[l],{className:[h?`${h}-${l}`:"",f]},e,{_item:e,_index:n,key:String((a?e[a]:e.key)??e.key??n),onClick:void 0}),o){const y=o.call(this,e,n);if(y!==void 0)return y}return e}_getProps(t){const e=super._getProps(t);return{onClick:this._handleClick,...e}}_getClassName(t){return[this.name,t.className]}_getItems(t){let{items:e=[]}=t;typeof e=="function"?e=e.call(this):Array.isArray(e)||(e=[]);const{getItems:n}=t;if(n){const s=n.call(this,e);if(s!==void 0)return s}return e}_renderItems(t,e){return this._renderedItems=e.map((n,s)=>{const r=this._getItem(t,n,s);return r||void 0}),this._renderedItems.reduce((n,s,r)=>(s&&n.push(this._renderItem(t,s,r)),n),[])}_getChildren(t){const e=this._getItems(t);this._items=e;const n=this._renderItems(t,e);return t.children&&n.push(t.children),n}_getComponent(t){return t.component||this.constructor.TAG}};pe.NAME="",pe.ITEM_NAME="item",pe.TAG="ul",pe.ItemComponents={default:Ft,divider:[Ft,{className:"divider"}],space:[Ft,i=>{const{space:t,flex:e,style:n}=i;return{style:{width:t,height:t,flex:e,...n}}}]},pe.defaultItemProps={component:"li"},pe.defaultItemPropsMap={},pe.defaultItemType="item",pe.defaultProps={itemKey:"id"};const Vg=Object.freeze(Object.defineProperty({__proto__:null,CommonList:pe},Symbol.toStringTag,{value:"Module"}));class fs extends mt{}fs.NAME="CommonList",fs.Component=pe,fs.replace=pe.TAG,fs.register(),oe(Vg);const Yb="",Qb="",Xb="",Zb="",Jb="",tw="";function qg(i){if(i.indexOf("#")===0&&(i=i.slice(1)),i.length===3&&(i=i[0]+i[0]+i[1]+i[1]+i[2]+i[2]),i.length!==6)throw new Error(`Invalid HEX color "${i}".`);return[parseInt(i.slice(0,2),16),parseInt(i.slice(2,4),16),parseInt(i.slice(4,6),16)]}function Gg(i){const[t,e,n]=typeof i=="string"?qg(i):i;return t*.299+e*.587+n*.114>186}function ud(i,t){return Gg(i)?(t==null?void 0:t.dark)??"#333333":(t==null?void 0:t.light)??"#ffffff"}function dd(i,t=255){return Math.min(Math.max(i,0),t)}function Yg(i,t,e){i=i%360/360,t=dd(t),e=dd(e);const n=e<=.5?e*(t+1):e+t-e*t,s=e*2-n,r=o=>(o=o<0?o+1:o>1?o-1:o,o*6<1?s+(n-s)*o*6:o*2<1?n:o*3<2?s+(n-s)*(2/3-o)*6:s);return[r(i+1/3)*255,r(i)*255,r(i-1/3)*255]}function pl(i){let t=0;if(typeof i!="string"&&(i=String(i)),i&&i.length)for(let e=0;e<i.length;++e)t+=(e+1)*i.charCodeAt(e);return t}function Qg(i,t){return/^[\u4e00-\u9fa5\s]+$/.test(i)?i.length<=t?i:i.substring(i.length-t):/^[A-Za-z\d\s]+$/.test(i)?i[0].toUpperCase():i.length<=t?i:i.substring(0,t)}let Ei=class extends Tt{render(){const{className:t,style:e,size:n="",circle:s,rounded:r,background:o,foreColor:a,icon:l,text:h,code:f,maxTextLength:d=2,src:m,hueDistance:y=43,saturation:b=.4,lightness:S=.6,children:x,...k}=this.props,T=["avatar",t],j={...e,background:o,color:a};let B=32;n&&(typeof n=="number"?(j.width=`${n}px`,j.height=`${n}px`,j.fontSize=`${Math.max(12,Math.round(n/2))}px`,B=n):(T.push(`size-${n}`),B={xs:20,sm:24,lg:48,xl:80}[n])),s?T.push("circle"):r&&(typeof r=="number"?j.borderRadius=`${r}px`:T.push(`rounded-${r}`));let K;if(m)T.push("has-img"),K=w("img",{className:"avatar-img",src:m,alt:h});else if(l)T.push("has-icon"),K=w(Ht,{icon:l});else if(h!=null&&h.length){const G=Qg(h,d),Q=G.length;if(T.push("has-text",`has-text-${Q}`),o===void 0){const tt=f??h,X=(typeof tt=="number"?tt:pl(tt))*y%360;if(j.background=`hsl(${X},${b*100}%,${S*100}%)`,!a){const et=Yg(X,b,S);j.color=ud(et)}}else!a&&o&&(j.color=ud(o));let Z;B&&B<16*Q&&(Z={transform:`scale(${B/(16*Q)})`,whiteSpace:"nowrap"}),K=w("div",{"data-actualSize":B,className:"avatar-text",style:Z,children:G})}return w("div",{className:q(T),style:j,...k,children:[K,x]})}};const Xg=Object.freeze(Object.defineProperty({__proto__:null,Avatar:Ei},Symbol.toStringTag,{value:"Module"}));let Fe=class extends pe{_isBtnType({type:t}){return t==="item"||t==="dropdown"}_getItem(t,e,n){if(!e)return!1;e.type||(e=g.extend({type:e.dropdown||e.items?"dropdown":"item"},e));let s=super._getItem(t,e,n);return s&&(this._isBtnType(s)&&(s=vt({},this._shareBtnProps,s)),s)}_beforeRender(t){const{btnProps:e,btnType:n,size:s}=t;this._shareBtnProps=vt({},e,qa({btnType:n,size:s}))}};Fe.NAME="btn-group",Fe.TAG="nav",Fe.ItemComponents={...pe.ItemComponents,default:Et},Fe.defaultItemProps={component:void 0};const Or=class cm extends Fe{_getProps(t){const{gap:e}=t,n=super._getProps(t);return e&&(typeof e=="number"?n.className=q(n.className,`gap-${e}`):n.style=g.extend(n.style||{},{gap:e})),n}_getItem(t,e,n){const s=super._getItem(t,e,n);if(!s)return s;const{type:r}=s,o=r==="btn-group"||r==="btnGroup";return o&&(s.btnProps=vt({},this._shareBtnProps,s.btnProps)),(o||r==="dropdown")&&!s.relativeTarget&&(s.relativeTarget=t.relativeTarget),s}static render(t,e,n,s){let r=typeof t=="function"?t.call(s??this,...e):t;if(r)return Array.isArray(r)&&(r={items:r}),n&&(r=vt(n,r)),w(cm,{...r})}};Or.NAME="toolbar",Or.defaultProps={btnProps:{btnType:"ghost"}},Or.ItemComponents={...Fe.ItemComponents,btnGroup:Fe,"btn-group":Fe};let Zt=Or;const Zg=Object.freeze(Object.defineProperty({__proto__:null,Toolbar:Zt},Symbol.toStringTag,{value:"Module"}));class zr extends Ft{constructor(t){super(t),this._handleChange=e=>{const{onChange:n}=this.props,s=e.target.indeterminate?"indeterminate":e.target.checked;n&&n.call(this,e,s),this._controlled||this.setState({checked:s})},this.state={checked:t.checked??t.defaultChecked??!1},this._controlled=t.checked!==void 0}get checked(){return this._controlled?this.props.checked:this.state.checked}_getClassName(t){const{disabled:e,type:n="checkbox"}=t,{checked:s}=this;return[t.className,n==="switch"?n:`${n}-primary`,{disabled:e,checked:s===!0,indeterminate:s==="indeterminate"}]}_getChildren(t){const{name:e,type:n,value:s,id:r,label:o}=t,{checked:a}=this;return[e?w("input",{type:n==="radio"?n:"checkbox",name:e,id:r,value:s,onChange:this._handleChange,indeterminate:a==="indeterminate",checked:typeof a=="boolean"?a:void 0},"input"):null,w("label",{htmlFor:r,children:w(gt,{content:o})},"label")]}}class Jg extends zr{}Jg.defaultProps={type:"radio"};class ty extends zr{}ty.defaultProps={type:"switch"};class qe extends Ft{_renderLeading(t){const{icon:e,iconClass:n,avatar:s,toggleIcon:r,leading:o,leadingClass:a,checked:l,checkbox:h,multiline:f}=t,d=[];if(r&&d.push(w(gt,{content:r},"toggleIcon")),l!==void 0&&d.push(w(zr,{className:"item-checkbox",checked:l,...h},"checkbox")),e&&d.push(w(Ht,{className:q("item-icon",n),icon:e},"icon")),s){const y=typeof s=="function"?s.call(this,t):s;y&&(y.className=q("item-avatar",y.className),d.push(w(Ei,{...y},"avatar")))}const m=o?w(gt,{content:o},"leading"):null;return m&&d.push(m),f?d.length?[w("div",{className:q("item-leading",a),children:d},"leading")]:[]:d}_renderContent(t,e){const{textClass:n,titleClass:s,titleAttrs:r,subtitle:o,subtitleClass:a,url:l,target:h,content:f,contentClass:d,contentAttrs:m}=t,y=l&&!e,b=y?"a":"div";let{title:S,text:x}=t;return S===void 0&&(S=x,x=null),[w("div",{className:q("item-content",d),...m,children:[S?w(b,{className:q("item-title",s),href:y?l:void 0,target:y?h:void 0,...r,children:w(gt,{content:S})},"title"):null,o?w("div",{className:q("item-subtitle",a),children:w(gt,{content:o})},"subtitle"):null,x?w("div",{className:q("item-text text",n),children:x},"text"):null,f?w(gt,{content:f},"extraContent"):null]},"content")]}_renderTrailing(t){const{multiline:e,trailing:n,trailingClass:s,trailingIcon:r,trailingIconClass:o,actions:a}=t,l=[];r&&l.push(w(Ht,{className:q("item-trailing-icon",o),icon:r},"trailing-icon")),a&&l.push(Zt.render(a,[t],{key:"actions",className:"item-actions",relativeTarget:t,size:"sm"},this));const h=n?w(gt,{content:n},"trailing"):null;return h&&l.push(h),e?l.length?[w("div",{className:q("item-trailing",s),children:[l,h]},"trailing")]:[]:l}_render(t,e){const{innerComponent:n,innerClass:s,innerAttrs:r,url:o,actions:a,target:l,active:h,disabled:f,divider:d,checked:m,multiline:y,title:b,subtitle:S,hint:x,selected:k}=t,T=n||(o&&!a?"a":"div"),j=T==="a",B=vt({key:"item",title:x,className:q("listitem",s,{active:h,disabled:f,"has-divider":d,selected:k,checked:m,multiline:y??!!(b&&S),state:j&&!f})},j?{href:o||"javascript:;",target:l}:null,e,r);return w(T,{...B,children:[this._renderLeading(t),this._renderContent(t,j),this._renderTrailing(t)]})}_onRender(t,e,n,s){const r=Object.keys(e).reduce((o,a)=>(a.startsWith("data-")&&(o[a]=e[a],delete e[a]),o),{});return[t,e,[this._render(s,r),...kr(n)]]}}let me=class extends pe{constructor(t){super(t),this._activeSet=new Zn(()=>{const e=new Set,{active:n}=this.props;Array.isArray(n)?n.forEach(r=>e.add(r)):typeof n=="string"?e.add(n):n&&Object.keys(n).forEach(r=>n[r]&&e.add(r));const{activeMap:s}=this.state;return Object.keys(s).forEach(r=>s[r]?e.add(r):e.delete(r)),e},()=>[this.state.activeMap,this.props.active]),this.state={checked:{},activeMap:{}}}get namespace(){return`.zui.${this.constructor.NAME}.list_${this.gid}`}get isLazyItems(){const{items:t}=this.props;return t&&!Array.isArray(t)}componentDidMount(){this._afterRender(!0),this.tryLoad(),this.props.activeOnHover&&!this.props.multipleActive&&g(this.element).on(`mouseenter${this.namespace}`,"[z-item]",t=>{const e=this._getItemFromEvent(t);e&&e.renderedItem.type==="item"&&!e.renderedItem.disabled&&!this.isActive(e.key)&&this.toggleActive(e.key,!0)})}componentDidUpdate(){this._afterRender(!1),this.tryLoad()}componentWillUnmount(){var t;g(this.element).off(this.namespace),(t=this.props.beforeDestroy)==null||t.call(this)}setItems(t,e){const{onLoadFail:n}=this.props;return this.changeState({loading:!1,items:t||[],loadFailed:e?(typeof n=="function"?n.call(this,e):n)||String(e):void 0})}load(){const{items:t,onLoad:e}=this.props;this._loadedSetting=t,this.setState({loading:!0,items:[]},async()=>{try{const n=await Xn(t,[this],{throws:!0});this.setItems((e==null?void 0:e.call(this,n))||n)}catch(n){this.setItems(void 0,n)}})}tryLoad(){const{loading:t}=this.state,{items:e}=this.props;return t||!e||Array.isArray(e)||e===this._loadedSetting?!1:(this.load(),!0)}isChecked(t,e,n=!1){const s=(typeof e=="number"?this._items[e]:this.getItem(t))||{};return this.state.checked[t]??s.checked??n}isAllChecked(){return this._renderedItems.every(({key:t},e)=>this.isChecked(t,e)===!0)}toggleAllChecked(t){return t===void 0&&(t=!this.isAllChecked()),this.toggleChecked(this._renderedItems.map(e=>e.key),t)}async toggleChecked(t,e){let n;if(Array.isArray(t)){if(!t.length)return;e===void 0&&(e=!this.isChecked(t[0])),n=t.reduce((s,r)=>(s[r]=e,s),{})}else if(typeof t=="object")n=t;else{const s=this.isChecked(t);e===void 0&&(e=!s),n={[t]:e}}Object.keys(n).length&&await this.changeState(s=>({checked:{...s.checked,...n}}),()=>{var r;const s=this.state.checked;(r=this.props.onCheck)==null||r.call(this,n,Object.keys(s).filter(o=>s[o]===!0))})}getChecks(){return this._renderedItems.reduce((t,{key:e},n)=>(e!==void 0&&this.isChecked(e,n)===!0&&t.push(e),t),[])}isActive(t){return typeof t=="object"&&(t=t.key),this._activeSet.cache.has(t)}getActiveKeys(){return[...this._activeSet.value]}getActiveKey(){return this.getActiveKeys()[0]}async toggleActive(t,e){typeof t=="string"&&(t=[t]),t.length&&(e=e??!this.isActive(t[0]),await this.changeState(n=>({activeMap:this.props.multipleActive?t.reduce((r,o)=>(r[o]=e,r),{...n.activeMap}):{[t[0]]:e}}),()=>{var n;(n=this.props.onActive)==null||n.call(this,t,e)}))}getNextItem(t,e,n=1,s=void 0){s=s||this._renderedItems;const r=s.length;if(t===void 0)return s[n?0:r-1];let o=s.findIndex(l=>l.key===t);if(o<0||r<2)return s[n?0:r-1];let a=0;for(e=e||(l=>l.type==="item"&&!l.disabled);a<r;){o=(o+n+r)%r;const l=s[o];if(l&&!l.disabled&&!l.hidden&&e.call(this,l,o))return l;a++}}getPrevItem(t,e){return this.getNextItem(t,e,-1)}activeNext(t,e=1){const n=this.getNextItem(this.getActiveKey(),t,e);n&&this.toggleActive(n.key)}activePrev(t){this.activeNext(t,-1)}_afterRender(t){var e;(e=this.props.afterRender)==null||e.call(this,t)}_beforeRender(t){var e;return(e=this.props.beforeRender)==null?void 0:e.call(this,t)}_getItems(t){const{items:e}=t,{items:n}=this.state;return n||(Array.isArray(e)?e:[])}_getRenderedItem(t,e,n){const{divider:s,multiline:r}=t;e=vt({},qa({divider:s,multiline:r}),e);const{itemName:o,name:a}=this;if(e.innerClass=[o?`${o}-inner${a?` ${a}-${e.type}-inner`:""}`:"",e.innerClass],e.type==="item"){const{checkbox:l}=t;e.checkbox===!1?e.checked=void 0:(l||e.checkbox)&&(e.checked=this.isChecked(e.key,n,e.checked),typeof l=="object"&&e.checkbox!==!1&&(e.checkbox=e.checkbox?g.extend({},l,e.checkbox):l),t.selectOnChecked&&e.checked===!0&&(e.selected=!0)),e.active===void 0&&this.isActive(e)&&(e.active=!0)}return e.icon&&(this._hasIcons=!0),e.checked!==void 0&&(this._hasCheckbox=!0),e}_getItem(t,e,n){const s=super._getItem(t,e,n);return s&&this._getRenderedItem(t,s,n)}_renderItem(t,e,n){return e.type==="item"&&this._hasIcons&&e.icon===void 0&&(e.icon="EMPTY"),super._renderItem(t,e,n)}_handleClick(t){const e=super._handleClick(t);let{checkOnClick:n}=this.props;if(n==="any"?n=".item-checkbox,.item-content,.item-icon":n===!0&&(n=".item-checkbox"),!n||!e||!e.renderedItem)return e;const s=e.renderedItem,r=s.checkbox;if(r!==!1&&(this.props.checkbox||r||s.checked!==void 0)&&!s.disabled&&e&&t.target.closest(n)){this.toggleChecked(e.key),t.stopPropagation();return}return e}_getClassName(t){const{loading:e,loadFailed:n}=this.state;return[super._getClassName(t),e?"loading":n?"is-load-failed":"",t.hoverItemActions?"with-hover-actions":""]}_getProps(t){const{className:e,...n}=super._getProps(t);return{...n,className:q(e,this._hasIcons?"has-icons":"",this._hasCheckbox?"has-checkbox":"")}}_getChildren(t){this._hasIcons=!1,this._hasCheckbox=!1,this._activeSet.compute();const e=super._getChildren(t),{loadFailed:n}=this.state;return n&&e.push(n),e}};me.ItemComponents={...pe.ItemComponents,default:Ft,item:qe,heading:qe},me.NAME="list";const ml="```ZUI_STR\n";class ps{constructor(t="",e="local"){this._type=e,this._id=t,this._name=`ZUI_STORE:${this._id}`,this._storage=e==="local"?localStorage:sessionStorage}get type(){return this._type}get session(){return this.type==="session"?this:(this._altStorage||(this._altStorage=new ps(this._id,"session")),this._altStorage)}_getKey(t){return`${this._name}:${t}`}switch(t){this._id=t,this._name=`ZUI_STORE:${this._id}`}get(t,e){const n=this._storage.getItem(this._getKey(t));if(typeof n=="string"){if(n.startsWith(ml))return n.substring(ml.length);try{return JSON.parse(n)}catch{}}return n??e}set(t,e){if(e==null)return this.remove(t);this._storage.setItem(this._getKey(t),typeof e=="string"?`${ml}${e}`:JSON.stringify(e))}remove(t){this._storage.removeItem(this._getKey(t))}each(t){for(let e=0;e<this._storage.length;e++){const n=this._storage.key(e);if(n!=null&&n.startsWith(this._name)){const s=this._storage.getItem(n);typeof s=="string"&&t(n.substring(this._name.length+1),JSON.parse(s))}}}getAll(){const t={};return this.each((e,n)=>{t[e]=n}),t}}const ae=new ps("DEFAULT");function ey(i,t="local"){return new ps(i,t)}Object.assign(ae,{create:ey});const ew="";function fd(i,t){const{children:e}=i;e.length&&e.forEach(n=>{t(n),fd(n,t)})}function ny(i,t){let e=i.parent;for(;e;)t(e),e=e.parent}function pd(i){return i.split(":").reduce((t,e,n)=>(t.push(n?t[n-1]+":"+e:e),t),[])}function gl(i,t,e,n,s=0,r){return i.reduce((o,a,l)=>{if(!a)return o;const h=String((t?a[t]:a.key)??a.key??l),f=r?`${r.keyPath}:${h}`:h,d={key:h,level:s,keyPath:f,parentKey:r==null?void 0:r.keyPath,parent:r,data:a,children:[]};return r&&r.children.push(d),o=e(o,d),Array.isArray(a.items)?gl(a.items,t,e,o,s+1,d):o},n)}let an=class extends me{constructor(t){super(t);const{defaultNestedShow:e,preserve:n,nestedShow:s}=t;if(g.extend(this.state,typeof e=="boolean"?{defaultShow:e,nestedShow:{}}:{nestedShow:e||{}},s!==void 0?{nestedShow:s}:null),n&&s===void 0){this._storeID=`${this.constructor.NAME}:${n}:state`;const r=ae.get(this._storeID);r&&(this.state.nestedShow=r.nestedShow)}if(!t.level){const r=this.state.nestedShow;r&&Object.keys(r).forEach(o=>{r[o]&&pd(o).forEach(a=>{r[a]=!0})}),this._needInitChecks=!0}this._renderedItemMap=new Map,this._handleClick=this._handleClick.bind(this),this._beforeRenderNestedItem=this._beforeRenderNestedItem.bind(this),this._handleNestedToggle=this._handleNestedToggle.bind(this),this._handleNestedCheck=this._handleNestedCheck.bind(this),this._preserveState=this._preserveState.bind(this)}get isRoot(){return!this.props.level}get nestedShow(){return this.props.nestedShow??this.state.nestedShow??!1}async setItems(t,e){var s;this.isRoot&&(this._needInitChecks=!0);const n=await super.setItems(t,e);return t&&((s=this.props.parent)==null?void 0:s.checked)===!0?this.toggleChecked(this._renderedItems.map(r=>r.key),!0):t!=null&&t.some(r=>r.checked)&&(this._needInitChecks=!0,this.forceUpdate()),n}getItemMap(t){if(t&&(this._itemMap||this._itemMapCache))return this._itemMap||this._itemMapCache;if(!this._itemMap){let e=!1;const n=gl(this._items,this.props.itemKey,(s,r)=>(s.set(r.keyPath,r),r.data.items&&!Array.isArray(r.data.items)&&(e=!0),s),new Map);if(e)return this._renderedItemMap.forEach((s,r)=>{n.has(r)||n.set(r,{key:s.key,level:s._level,keyPath:r,parentKey:`${r.split(":").slice(0,-1).join(":")}`,children:[],data:s})}),n.forEach(s=>{const{parentKey:r}=s;if(!r)return;const o=n.get(r);o&&(o.children.push(s),s.parent=o)}),this._itemMapCache=n,n;this._itemMap=n}return this._itemMap}getRenderedItem(t){return this._renderedItemMap.get(t)}getItem(t){var s;const e=this._itemMap||this._itemMapCache;if(e)return(s=e.get(t))==null?void 0:s.data;const n=this.getRenderedItem(t);return n?n._item:super.getItem(t)}isExpanded(t){const{nestedShow:e}=this;return typeof e=="boolean"?e:!!(e[t]??this.state.defaultShow)}async toggle(t,e,n){const s=this.isExpanded(t);if(!n&&e===s)return;e===void 0&&(e=!s);const{nestedShow:r,onToggle:o,accordion:a}=this.props;o&&o.call(this,t,e,n)===!1||r===void 0&&await this.changeState(l=>{let h={...n?{}:l.nestedShow,[t]:e};if(e&&a){let f=`${t.split(":").slice(0,-1).join(":")}`;f.length&&(f+=":"),Object.keys(h).forEach(d=>{d!==t&&d.startsWith(f)&&(h[d]=!1)})}return h=e?pd(t).reduce((f,d)=>(f[d]=e,f),h):h,{nestedShow:h}},this._preserveState)}toggleAll(t){if(this.props.nestedShow===void 0)return this.setState({nestedShow:{},defaultShow:t},this._preserveState)}getChecks(){return Array.from(this.getItemMap(!0).values()).reduce((t,{keyPath:e,data:n})=>{const s=this.state.checked[e];return(s===!0||n.checked&&s!==!1)===!0&&t.push(e),t},[])}isChecked(t,e,n=!1){const s=(typeof e=="number"?this._items[e]:this.getItem(t))||{};return this.isRoot?this.state.checked[t]??s.checked??n:this.props.checkedState[`${this.props.parentKey}:${t}`]??s.checked??n}async toggleChecked(t,e){let n;if(Array.isArray(t)){if(!t.length)return;e===void 0&&(e=!this.isChecked(t[0])),n=t.reduce((a,l)=>(a[l]=e,a),{})}else typeof t=="object"?n=t:(e===void 0&&(e=!this.isChecked(t)),n={[t]:e});if(!Object.keys(n).length)return;if(this.isRoot){await this.changeState(({checked:a,nestedShow:l})=>{const h=y=>n[y.keyPath]??a[y.keyPath]??y.data.checked??!1,f=this.getItemMap(),d={},{expandChildrenOnCheck:m}=this.props;return Object.keys(n).forEach(y=>{e=n[y];const b=f.get(y);b&&(fd(b,S=>{h(S)!==e&&(n[S.keyPath]=e)}),ny(b,S=>{const{children:x}=S,k=x.reduce((T,j)=>(h(j)&&T++,T),0);n[S.keyPath]=k===x.length?!0:k?"indeterminate":!1}),m&&e&&b.data.items&&(d[y]=!0))}),{checked:{...a,...n},nestedShow:{...l,...d}}},()=>{var l;const a=this.state.checked;(l=this.props.onCheck)==null||l.call(this,n,Object.keys(a).filter(h=>a[h]===!0))});return}const{parentKey:s,onCheck:r}=this.props,o=Object.keys(n).reduce((a,l)=>(a[`${s!==void 0?`${s}:`:""}${l}`]=n[l],a),{});r.call(this,o,[])}getKeyPath(t){if(this.isRoot)return t;const e=this.props.parentKey;return t.startsWith(e+":")?t:`${e}:${t}`}isActive(t){if(typeof t=="object"){const e=t._keyPath??t.key;if(e===void 0)return!1;t=e}return this._activeSet.cache.has(this.getKeyPath(t))}async toggleActive(t,e){if(typeof t=="string"&&(t=[t]),t=t.map(n=>this.getKeyPath(n)),this.isRoot){await super.toggleActive(t,e),this.props.toggleOnActive&&t.forEach(n=>{this.isActive(n)&&!this.isExpanded(n)&&this.toggle(n,!0)});return}this.props.onActive.call(this,t,e??!this.isActive(t[0]))}activeNext(t,e=1){const n=this.getNextItem(this.getActiveKey(),t,e);n&&this.toggleActive(n._keyPath)}getNextItem(t,e,n=1,s=void 0){return s=s||gl(this._items,this.props.itemKey,(r,o)=>(o.data.disabled||r.push({_keyPath:o.keyPath,type:"item",...o.data,...this._renderedItemMap.get(o.keyPath),key:o.keyPath}),r),[]),super.getNextItem(t,e,n,s)}_afterRender(t){if(super._afterRender(t),this._needInitChecks){const e={};this.getItemMap().forEach(s=>{s.data.checked!==void 0&&(e[s.keyPath]=s.data.checked)}),this.toggleChecked(e),this._needInitChecks=!1}}_preserveState(){this._storeID&&ae.set(this._storeID,{nestedShow:this.state.nestedShow})}_getClassName(t){return[super._getClassName(t),"is-nested",t.level?"is-nested-sub":"is-nested-root"]}_getNestedProps(t,e,n,s){const{parentKey:r,level:o=0}=t,{isRoot:a}=this;return vt(this.constructor.inheritNestedProps.reduce((l,h)=>(l[h]=t[h],l),{}),{key:n.key,level:o+1,className:`is-nested-${s?"expanded":"collapsed"}`,items:e,parent:n,parentKey:r?`${r}:${n.key}`:n.key,nestedShow:this.nestedShow,defaultNestedShow:this.state.defaultShow,checkedState:t.checkedState||this.state.checked,onCheck:a?this._handleNestedCheck:t.onCheck,onToggle:a?this._handleNestedToggle:t.onToggle,beforeRenderItem:a?this._beforeRenderNestedItem:t.beforeRenderItem,active:a?this.getActiveKeys():t.active,onActive:a?this.toggleActive.bind(this):t.onActive},n.listProps)}_renderNestedList(t,e,n,s){if(!s&&!t.renderCollapsedList)return;const r=this._getNestedProps(t,e,n,s),o=this.constructor;return w(o,{...r},`nested:${n.key}`)}_renderNestedToggle(t,e){let n,s="";const{toggleIcons:r={}}=t;return typeof e=="boolean"?(n=e?r.expanded||w("span",{className:"caret-down"}):r.collapsed||w("span",{className:"caret-right"}),s=`state is-${e?"expanded":"collapsed"}`,E.isValidElement(n)||(n=w(Ht,{icon:n}))):(n=w(Ht,{icon:r.normal}),s="is-empty"),w("span",{className:q(`${this.name}-toggle nested-toggle-icon`,s),children:n})}_getItems(t){const e=super._getItems(t);return this.isRoot&&e!==this._items&&(this._itemMap=void 0),e}_getItem(t,e,n){const s=super._getItem(t,e,n)??e;if(!s)return s;const{parentKey:r}=t,o=s.key,a=`${r!==void 0?`${r}:`:""}${o}`;if(s.items){const l=s.expanded??this.isExpanded(a);vt(s,{expanded:l,className:["is-nested",`is-nested-${l?"show":"hide"}`]}),this._hasNestedItems=!0}return vt(s,{_level:t.level,_keyPath:a,parentKey:r})}_beforeRenderNestedItem(t,e){const{beforeRenderItem:n}=this.props;if(n){const s=n.call(this,t,e);s!==void 0&&(t=s)}return this._renderedItemMap.set(t._keyPath,t),t}_renderItem(t,e,n){(this._hasNestedItems||!this.isRoot)&&e.type==="item"&&e.toggleIcon===void 0&&(e.toggleIcon=this._renderNestedToggle(t,e.expanded));const s=e.items?this._renderNestedList(t,e.items,e,e.expanded):null;return e=vt(e,{"z-parent":e.parentKey,"z-key-path":e._keyPath},s?{children:s}:null),this._renderedItemMap.set(e._keyPath,e),super._renderItem(t,e,n)}_getItemFromEvent(t,e){e=e||t.target;let n=super._getItemFromEvent(t,e);if(!n){const r=e.closest("[z-list]");if(r){const o=r.getAttribute("z-list"),a=this.getItem(o),l=this.getRenderedItem(o);if(!a||!l)return;n={target:e,index:l._index,item:a,element:r,event:t,key:o,keyPath:o,renderedItem:l}}return}(t.type==="mouseenter"||t.type==="mouseleave"||t.type==="mouseover")&&(n.hover=t.type!=="mouseleave");const{parentKey:s}=this.props;return{...n,parentKey:s,keyPath:`${s!==void 0?`${s}:`:""}${n.key}`,target:e}}_handleNestedToggle(t,e,n){this.toggle(t,e,n)}_handleClick(t){const e=super._handleClick(t);if(e){const{renderedItem:n,keyPath:s,target:r}=e,{nestedToggle:o}=this.props;if(!n.items||t.defaultPrevented||r.closest(".not-nested-toggle")||o&&!n.disabled&&!r.closest(o)||!o&&!n.disabled&&r.closest("a,.btn,.item-checkbox,.open-url,input,select,textarea")&&!r.closest(".nested-toggle-icon,.item-icon"))return e;this.toggle(s),t.preventDefault()}return e}_handleNestedCheck(t){this.toggleChecked(t)}_getProps(t){const{level:e=0,indent:n=20,parentKey:s}=t,r=vt(super._getProps(t),{"z-level":e,"z-list":s,style:{"--list-nested-indent":`${e*n}px`,"--list-indent":`${n}px`},className:this._hasNestedItems?"has-nested-items":"no-nested-items"});return r.className=q(r.className),r}_beforeRender(t){return this._renderedItemMap.clear(),this._hasIcons=!1,this._hasNestedItems=!1,super._beforeRender(t)}};an.defaultProps={...me.defaultProps,defaultNestedShow:!1,level:0,indent:20},an.inheritNestedProps=["component","name","itemName","itemKey","indent","hover","divider","multiline","toggleIcons","nestedToggle","accordion","itemRender","itemProps","onToggle","checkbox","getItem","getItems","checkOnClick","selectOnChecked","checkedState","onClickItem","activeOnHover","multipleActive","onActive","hoverItemActions"];const iy=Object.freeze(Object.defineProperty({__proto__:null,List:me,Listitem:qe,NestedList:an},Symbol.toStringTag,{value:"Module"}));class ms extends mt{}ms.NAME="List",ms.Component=me,ms.replace=me.TAG,ms.register();class gs extends mt{}gs.NAME="NestedList",gs.Component=an,gs.replace=an.TAG,gs.register(),oe(iy);const nw="",iw="",sw="",Mi=class hm extends an{constructor(t){super(t),this._handleHover=this._handleHover.bind(this)}get isHoverTrigger(){return this.props.nestedTrigger==="hover"}_getClassName(t){return[super._getClassName(t),this._hasNestedItems?"menu-nested":"",t.className,t.wrap?{"scrollbar-thin":t.scrollbarThin,"scrollbar-hover":t.scrollbarHover}:{popup:t.popup,compact:t.compact}]}_getWrapClass(t){return["menu-wrapper",t.wrapClass,{popup:t.popup,compact:t.compact}]}_getWrapperProps(t){const{wrapAttrs:e,height:n,maxHeight:s,parentKey:r}=t,o=vt({"z-list-wrapper":r},e,n||s?{style:{height:n,maxHeight:s}}:null,this.isRoot&&this.isHoverTrigger?{onMouseEnter:this._handleHover,onMouseLeave:this._handleHover,onMouseOver:this._handleHover}:null);return o.className=q(this._getWrapClass(t),o.className),o}_renderWrapperHeader(t){return w(gt,{content:t.header,generatorThis:this},"header")}_renderWrapperFooter(t){return w(gt,{content:t.footer,generatorThis:this},"footer")}_handleHover(t){const e=t.target;if(!(e instanceof HTMLElement)||!this.isHoverTrigger)return;let n;if(t.type!=="mouseleave"){const h=e.closest("[z-item]");if(h)n=h.getAttribute("z-key-path"),h.classList.contains("is-nested")||(n=h.getAttribute("z-parent"));else{const f=e.closest("[z-list-wrapper]");n=f==null?void 0:f.getAttribute("z-list-wrapper")}}const s=this._hoverInfo,r=s==null?void 0:s.keyPath;if(r===n)return;s!=null&&s.timer&&clearTimeout(s.timer);const o=typeof n=="string",l=o?typeof r=="string"&&(s!=null&&s.shown)?50:200:s!=null&&s.shown?100:200;this._hoverInfo={keyPath:n,timer:window.setTimeout(()=>{o?(this.toggle(n,!0,!0),this._hoverInfo.shown=!0):(this.toggleAll(!1),this._hoverInfo=void 0)},l)}}componentWillUnmount(){var e;super.componentWillUnmount();const t=(e=this._hoverInfo)==null?void 0:e.timer;t&&clearTimeout(t)}render(t){const e=super.render(t);return t.wrap?w("menu",{...this._getWrapperProps(t),children:[this._renderWrapperHeader(t),e,this._renderWrapperFooter(t)]}):e}static render(t,e,n,s){let r=typeof t=="function"?t.call(s??this,...e):t;if(r)return Array.isArray(r)&&(r={items:r}),n&&(r=vt(n,r)),w(hm,{...r})}};Mi.NAME="menu",Mi.TAG="menu",Mi.inheritNestedProps=[...an.inheritNestedProps,"compact"],Mi.ItemComponents={...an.ItemComponents,item:[qe,{innerComponent:"a"}]},Mi.defaultProps={...an.defaultProps,scrollbarHover:!0};let ve=Mi;const Pi=24*60*60*1e3,Wt=i=>i===void 0?new Date:(i instanceof Date||(typeof i=="string"&&(i=i.trim(),/^\d+$/.test(i)&&(i=Number.parseInt(i,10))),typeof i=="number"&&i<1e10&&(i*=1e3),i=new Date(i)),i),md=(i,t,e="day")=>{if(typeof t=="string"){const n=Number.parseInt(t,10);e=t.replace(n.toString(),""),t=n}return i=new Date(Wt(i).getTime()),e==="month"?i.setMonth(i.getMonth()+t):e==="year"?i.setFullYear(i.getFullYear()+t):e==="week"?i.setDate(i.getDate()+t*7):e==="hour"?i.setHours(i.getHours()+t):e==="minute"?i.setMinutes(i.getMinutes()+t):e==="second"?i.setSeconds(i.getSeconds()+t):i.setDate(i.getDate()+t),i},Sn=(i,t=new Date)=>Wt(i).toDateString()===Wt(t).toDateString(),Fr=(i,t=new Date)=>Wt(i).getFullYear()===Wt(t).getFullYear(),yl=(i,t=new Date)=>(i=Wt(i),t=Wt(t),i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()),sy=(i,t=new Date)=>{i=Wt(i),t=Wt(t);const e=1e3*60*60*24,n=Math.floor(i.getTime()/e),s=Math.floor(t.getTime()/e);return Math.floor((n+4)/7)===Math.floor((s+4)/7)},ry=(i,t)=>Sn(Wt(t),i),oy=(i,t)=>Sn(Wt(t).getTime()-Pi,i),ay=(i,t)=>Sn(Wt(t).getTime()+Pi,i),_l=i=>i!=null&&!isNaN(Wt(i).getTime()),Ae=(i,t="yyyy-MM-dd hh:mm",e="")=>{if(i=Wt(i),!_l(i))return e;if(typeof t=="function")return t(i);const n={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"H+":i.getHours()%12,"m+":i.getMinutes(),"s+":i.getSeconds(),"S+":i.getMilliseconds()};return/(y+)/i.test(t)&&(t.includes("[yyyy-]")&&(t=t.replace("[yyyy-]",Fr(i)?"":"yyyy-")),t=t.replace(RegExp.$1,`${i.getFullYear()}`.substring(4-RegExp.$1.length))),Object.keys(n).forEach(s=>{if(new RegExp(`(${s})`).test(t)){const r=`${n[s]}`;t=t.replace(RegExp.$1,RegExp.$1.length===1?r:`00${r}`.substring(r.length))}}),t},ly=(i,t,e)=>{const n={full:"yyyy-M-d",month:"M-d",day:"d",str:"{0} ~ {1}",...e},s=Ae(i,Fr(i)?n.month:n.full);if(Sn(i,t))return s;const r=Ae(t,Fr(i,t)?yl(i,t)?n.day:n.month:n.full);return n.str.replace("{0}",s).replace("{1}",r)},rw="",ow="",aw="";let Ai=class extends Tt{constructor(t){super(t),this._input=kt(),this._timer=0,this._handleClearBtnClick=e=>{e.stopPropagation(),this.clear(e)},this._handleChange=e=>{const n=this.state.value,s=e.target.value,{onChange:r,delay:o}=this.props;this.setState({value:s},()=>{!r||n===s||(o?(this._clearTimer(),this._timer=window.setTimeout(()=>{r(s,e),this._timer=0},o)):r(s,e))})},this._handleFocus=e=>{const n=e.type==="focus";this.setState({focus:n},()=>{const s=n?this.props.onFocus:this.props.onBlur;s==null||s(e)})},this.state={focus:!1,value:t.defaultValue||""},this._gid=t.id||`search-box-${_e()}`}componentDidMount(){const{hotkeys:t}=this.props;if(t){const e=Qa(t,{clear:{keys:"Escape",handler:n=>{this.clear(n)}},enter:{keys:"Enter",handler:n=>{var s,r;(r=(s=this.props).onEnter)==null||r.call(s,this.state.value,n)}}});e&&(this._hotkeysScope=`SearchBox_${this._gid}`,g(this.input).hotkeys(e,{scope:this._hotkeysScope,event:"keydown"}))}}componentWillUnmount(){this._hotkeysScope&&g(this.input).unbindHotkeys(this._hotkeysScope)}get id(){return this._gid}get input(){return this._input.current}focus(){var t;(t=this.input)==null||t.focus()}blur(){var t;(t=this.input)==null||t.blur()}clear(t){const e=this.state.value;this.setState({value:""},()=>{const{onChange:n,onClear:s}=this.props;s==null||s(t),this.focus(),e.trim()!==""&&(n==null||n("",t))})}_clearTimer(){this._timer&&clearTimeout(this._timer),this._timer=0}render(t,e){const{style:n,className:s,rootClass:r,rootStyle:o,readonly:a,disabled:l,circle:h,placeholder:f,mergeIcon:d,searchIcon:m,clearIcon:y,value:b,compact:S,prefixClass:x,suffixClass:k}=t,{focus:T,value:j}=e,{id:B}=this,K=b??j,G=typeof K!="string"||!K.trim().length;let Q,Z,tt;return m&&(tt=m===!0?w("span",{class:"magnifier"}):w(Ht,{icon:m})),!d&&m&&(Q=w("label",{for:B,class:q("input-control-prefix",x),children:tt},"prefix")),y&&!G?Z=w("button",{type:"button",class:"btn ghost size-sm square rounded-full",onClick:this._handleClearBtnClick,children:y===!0?w("span",{class:"close"}):w(Ht,{icon:y})}):d&&m&&(Z=tt),Z&&(Z=w("label",{for:B,class:q("input-control-suffix",k),children:Z},"suffix")),w("div",{class:q("search-box input-control",r,{focus:T,empty:G,compact:S,"has-prefix-icon":Q,"has-suffix-icon":Z}),style:o,children:[Q,w("input",{ref:this._input,id:B,type:"text",class:q("form-control",{"rounded-full":h,"size-sm":S},s),style:n,placeholder:f,disabled:l,readonly:a,value:K,onInput:this._handleChange,onChange:this._handleChange,onFocus:this._handleFocus,onBlur:this._handleFocus},"input"),Z]})}};Ai.defaultProps={clearIcon:!0,searchIcon:!0,delay:500,hotkeys:!0};const cy=Object.freeze(Object.defineProperty({__proto__:null,SearchBox:Ai},Symbol.toStringTag,{value:"Module"}));let Ie=class extends ve{constructor(t){super(t),this._handleSearchChange=e=>{const n=this.constructor.getSearchKeys(e);this._searchKeys=n,this.setState({search:n.join(" ")})},this.state.search=t.search??t.defaultSearch,this._searchKeys=this.constructor.getSearchKeys(this.state.search),this._isNestedItemMatch=this._isNestedItemMatch.bind(this)}componentWillUpdate(t){this.isRoot&&t.search!==void 0&&t.search!==this.props.search&&(this._searchKeys=this.constructor.getSearchKeys(t.search))}componentDidMount(){super.componentDidMount(),this._updateMatchedParents()}componentDidUpdate(){super.componentDidUpdate(),this._updateMatchedParents()}isExpanded(t){return this.props.expandOnSearch&&this._searchKeys.length?!0:super.isExpanded(t)}_updateMatchedParents(){var n;if(!this.isRoot)return;const t=g(this.element),e=t.find(".item.is-nested.is-not-match").filter((s,r)=>this._matchedParents.has(r.getAttribute("z-key-path")||"")).addClass("has-match-child");t.parent().toggleClass("no-match-child",!!((n=this._searchKeys)!=null&&n.length)&&!e.length&&!t.children(".item").not(".is-not-match").length)}_isItemMatch(t,e,n,s){const{isItemMatch:r,nestedSearch:o}=t,a=r?r.call(this,e,this._searchKeys,n,s):this.constructor.isItemMatch(e,this._searchKeys,t.searchProps);if(o&&this.isRoot&&a&&s!==void 0){let l="";String(s).split(":").forEach(h=>{l+=`${l.length?":":""}${h}`,this._matchedParents.add(l)})}return a}_isNestedItemMatch(t,e,n,s){return this._isItemMatch(this.props,t,n,s)}_getNestedProps(t,e,n,s){const r=super._getNestedProps(t,e,n,s);return this.isRoot&&t.nestedSearch?(r.isItemMatch=this._isNestedItemMatch,r.search=this._searchKeys.join(" ")):t.nestedSearch||vt(r,{search:void 0,defaultSearch:void 0},n.listProps),r}_getItem(t,e,n){const s=super._getItem(t,e,n);return s&&(this.isRoot&&this.props.limit&&this._showCount>=this.props.limit?!1:(s.hidden=!this._isItemMatch(t,e,n,t.parentKey),s.hidden||this._showCount++,s))}_renderItem(t,e,n){return e.className=[e.className,e.hidden?"is-not-match":""],t.underlineKeys&&this._searchKeys.length&&["text","title","subtitle","content"].forEach(s=>{typeof e[s]=="string"&&(e[s]=this.constructor.underlineKeys(this._searchKeys,[e[s]]))}),super._renderItem(t,e,n)}_getWrapClass(t){const e=this.isRoot&&this._searchKeys.length;return q(super._getWrapClass(t),"search-menu",t.searchBox?`search-menu-on-${t.searchPlacement||"top"}`:"",e?"is-search-mode":"",e&&t.expandOnSearch?"no-toggle-on-search":"")}_getSearchBoxProps(t){const{searchBox:e}=t,n={compact:!0,className:"not-nested-toggle",onChange:this._handleSearchChange};return typeof e=="object"&&vt(n,e),t.search!==void 0&&(n.value=this._searchKeys.join(" "),n.disabled=!0),n}_renderSearchBox(t){const e=this._getSearchBoxProps(t);return w(Ai,{...e},"search")}_renderWrapperHeader(t){const e=t.header,{noMatchHint:n,searchBox:s,searchPlacement:r,nestedSearch:o,headerClass:a}=t,l=(!o||this.isRoot)&&s&&r!=="bottom";return!e&&!l&&!n?null:[n?w("div",{className:"search-menu-no-match-hint",children:n},"noMatchHint"):null,e||l?w("header",{className:q("search-menu-header",a),children:[e?super._renderWrapperHeader(t):null,l?this._renderSearchBox(t):null]},"header"):null]}_renderWrapperFooter(t){const e=t.footer,{searchBox:n,searchPlacement:s,nestedSearch:r,footerClass:o,exceedLimitHint:a,limit:l}=t,h=(!r||this.isRoot)&&n&&s==="bottom",f=a&&l&&this._items.length>l;return!e&&!h&&!f?null:w("footer",{className:q("search-menu-footer",o),children:[f?w("div",{className:"search-menu-exceed-limit-hint",children:$t(a,this._items.length-l)}):null,e?super._renderWrapperFooter(t):null,h?this._renderSearchBox(t):null]},"footer")}_beforeRender(t){return this.isRoot&&(this._matchedParents=new Set,this._showCount=0),super._beforeRender(t)}static isItemMatch(t,e,n=["keys","text","title","subtitle"]){return e.length?e.every(s=>n.some(r=>{const o=typeof r=="function"?r(t):t[r];return typeof o=="string"&&o.length&&o.toLowerCase().includes(s)})):!0}static getSearchKeys(t=""){return g.unique(t.toLowerCase().split(" ").filter(e=>e.length))}static underlineKeys(t,e,n="is-match-keys"){return t.reduce((s,r)=>[...s].reduce((o,a)=>{if(typeof a!="string")return o.push(a),o;const l=a.toLowerCase().split(r);if(l.length===1)return o.push(a),o;let h=0;return l.forEach((f,d)=>{d&&(o.push(w("span",{class:n,children:a.substring(h,h+r.length)})),h+=r.length),o.push(a.substring(h,h+f.length)),h+=f.length}),o},[]),e)}};Ie.inheritNestedProps=[...ve.inheritNestedProps,"isItemMatch","search","underlineKeys","nestedSearch"],Ie.defaultProps={...ve.defaultProps,defaultNestedShow:!0,wrap:!0,nestedSearch:!0,underlineKeys:!0};const hy=Object.freeze(Object.defineProperty({__proto__:null,Menu:ve,SearchMenu:Ie},Symbol.toStringTag,{value:"Module"}));class jr extends mt{}jr.NAME="Menu",jr.Component=ve,jr.replace=ve.TAG;class Br extends mt{}Br.NAME="SearchMenu",Br.Component=Ie,Br.replace=Ie.TAG,oe(hy);const lw="",cw="",hw="",uw="",dw="",fw="",pw="",mw="",gw="",yw="",_w="";function uy({className:i,style:t,actions:e,heading:n,content:s,contentClass:r,children:o,close:a,onClose:l,icon:h,iconClass:f,...d}){let m;a===!0?m=w(Et,{className:"alert-close btn ghost square text-inherit",square:!0,onClick:l,children:w("span",{class:"close"})}):E.isValidElement(a)?m=a:typeof a=="object"&&(m=w(Et,{...a,onClick:l}));const y=Zt.render(e,[]);return w("div",{className:q("alert",i),style:t,...d,children:[w(Ht,{icon:h,className:q("alert-icon",f)}),typeof s!="string"?w(gt,{content:s}):w("div",{className:q("alert-content",r),children:[typeof n!="string"?w(gt,{content:n}):n&&w("div",{className:"alert-heading",children:n}),w("div",{className:"alert-text",children:s}),n?y:null]}),n?null:y,m,o]})}function dy(i){if(i==="center")return"fade-from-center";if(i){if(i.includes("top"))return"fade-from-top";if(i.includes("bottom"))return"fade-from-bottom"}return"fade"}let fy=class extends Tt{render(t){const{margin:e,type:n,placement:s,animation:r,show:o,className:a,time:l,...h}=t;return typeof h.html=="string"&&(h.content={html:h.html},delete h.html),w(uy,{className:q("messager",a,n,r===!0?dy(s):r,o?"in":""),...h})}};class vl extends mt{constructor(){super(...arguments),this._show=!1,this._showTimer=0,this._afterRender=({firstRender:t})=>{t&&this.show();const{margin:e}=this.options;e&&this.$element.css("margin",`${e}px`)}}get isShown(){return this._show}afterInit(){this.on("click",t=>{g(t.target).closest('.alert-close,[data-dismiss="messager"]').length&&(t.preventDefault(),t.stopPropagation(),this.hide())})}setOptions(t,e){return t=super.setOptions(t,e),{...t,show:this._show,afterRender:this._afterRender}}show(){this.render(),this.emit("show"),this._resetTimer(()=>{this._show=!0,this.render(),this._resetTimer(()=>{this.emit("shown");const{time:t}=this.options;t&&this._resetTimer(()=>this.hide(),t)})},100)}hide(){this._show&&this._resetTimer(()=>{this.emit("hide"),this._show=!1,this.render(),this._resetTimer(()=>{this.emit("hidden")})},50)}_resetTimer(t,e=200){this._showTimer&&clearTimeout(this._showTimer),this._showTimer=window.setTimeout(()=>{t(),this._showTimer=0},e)}}vl.NAME="MessagerItem",vl.Component=fy;const ys=class um extends zt{get isShown(){var t;return!!((t=this._item)!=null&&t.isShown)}show(t){this.setOptions(t),this._getItem().show()}hide(){var t;(t=this._item)==null||t.hide()}_getItem(){const t={...this.options};if(this._item)this._item.setOptions(t);else{const e=this._getHolder(),n=new vl(e,t);n.on("hidden",()=>{n.destroy(),e==null||e.remove(),this._holder=void 0,this._item=void 0}),this._item=n}return this._item}_getHolder(){if(this._holder)return this._holder;const{placement:t="top"}=this.options;let e=this.$element.find(`.messagers-${t}`);e.length||(e=g(`<div class="messagers messagers-${t}"></div>`).appendTo(this.$element));let n=e.find(`#messager-${this.gid}`);return n.length||(n=g(`<div class="messager-holder" id="messager-${this.gid}"></div>`).appendTo(e),this._holder=n[0]),n[0]}static show(t,e){typeof t=="string"&&(t={content:t});const{container:n,...s}=t,r={type:e,key:`messager_${_e()}`,...s};r.type&&g.extend(r,this.TypeOptions[r.type]);const o=um.ensure(n||"body",r);return o.hide(),o.show(),o}};ys.NAME="messager",ys.DEFAULT={placement:"top",animation:!0,close:!0,margin:6,time:5e3},ys.MULTI_INSTANCE=!0,ys.TypeOptions={};let xn=ys,Hr=class extends Tt{render(t){const{percent:e=50,color:n,background:s=null,height:r,width:o,children:a,className:l,style:h}=t;return w("div",{class:q("progress",l),style:{width:o,height:r,"--progress-bg":s,"--progress-bar-color":n,...h},children:[w("div",{class:"progress-bar",style:{width:`${e}%`}}),a]})}};Hr.defaultProps={percent:50,height:20,width:"auto"},oe(Object.freeze(Object.defineProperty({__proto__:null,ProgressBar:Hr},Symbol.toStringTag,{value:"Module"})));class bl extends mt{}bl.NAME="ProgressBar",bl.Component=Hr,bl.register();const bw="",ww="";let Wr=class extends Tt{render(t){const{percent:e=50,size:n=24,circleBg:s,circleColor:r,text:o,className:a,textStyle:l,textX:h,textY:f,children:d}=t,m=n/2;let{circleWidth:y=.1}=t;y<1&&(y=n*y);const b=(n-y)/2;return w("svg",{className:a,width:n,height:n,children:[w("circle",{cx:m,cy:m,r:b,"stroke-width":y,stroke:s,fill:"transparent"}),w("circle",{cx:m,cy:m,r:b,"stroke-width":y,stroke:r,fill:"transparent","stroke-linecap":"round","stroke-dasharray":Math.PI*b*2,"stroke-dashoffset":Math.PI*b*2*(100-e)/100,style:{transformOrigin:"center",transform:"rotate(-90deg)"}}),o?w("text",{x:h??m,y:f??m+y/2,"dominant-baseline":"middle","text-anchor":"middle",style:l||{fontSize:`${b}px`,stroke:"currentColor"},children:o===!0?Math.round(e):o}):null,d]})}};Wr.defaultProps={circleBg:"var(--color-surface)",circleColor:"var(--color-primary-500)",text:!0};class Kr extends mt{}Kr.NAME="ProgressCircle",Kr.Component=Wr,Kr.register(),oe(Object.freeze(Object.defineProperty({__proto__:null,ProgressCircle:Wr},Symbol.toStringTag,{value:"Module"})));const kw="",Sw="",xw="",$w="",Tw="",Nw="",Ew="",Mw="",Pw="",_s='[droppable="true"]';class vs extends zt{constructor(){super(...arguments),this._state={dragging:null,dropping:null},this._handleMouseDown=t=>{const{selector:e,handle:n,beforeDrag:s}=this.options,r=g(t.target),o=r.closest(e),a=o[0];!a||n&&!r.closest(n).length||s&&s.call(this,t,a)===!1||(o.attr("draggable","true"),this._setState({dragging:a}))},this._handleDragStart=t=>{const{dragElement:e}=this;if(!e){t.preventDefault();return}const{options:n}=this,{onDragStart:s}=n;if(s&&s.call(this,t,e)===!1){this._clean();return}const{$element:r}=this,{target:o,selector:a,draggingClass:l,droppableClass:h,hasDraggingClass:f,canDrop:d}=n;l&&(this.$element.find(l).removeClass(l),g(e).addClass(l));let m=typeof o=="function"?g(o.call(this,e)):r.find(o||a||_s);if(d&&(m=m.filter((y,b)=>d.call(this,t,e,b)!==!1)),!m.length){this._clean();return}h&&(r.find(h).removeClass(h),m.addClass(h)),f&&r.addClass(f),r.find(_s).removeAttr("droppable"),m.attr("droppable","true"),this._$targets=m},this._handleDrag=t=>{var n;const{dragElement:e}=this;e&&(this._setDragEffect(t),(n=this.options.onDrag)==null||n.call(this,t,e))},this._handleDragEnd=t=>{var n;const{dragElement:e}=this;e&&((n=this.options.onDragEnd)==null||n.call(this,t,e)),this._clean()},this._handleDragEnter=t=>{this._handleDragOver(t)},this._handleDragOver=t=>{var o,a;const{dragElement:e}=this,s=g(t.target).closest(_s)[0];if(!e||!s)return;const r=this.state.dropping;if(t.preventDefault(),this._setDragEffect(t),r!==s){const{droppingClass:l}=this.options;l&&(r&&this._leaveDropElement(t,r),g(s).addClass(l)),this._setState({dropping:s}),(o=this.options.onDragEnter)==null||o.call(this,t,e,s)}(a=this.options.onDragOver)==null||a.call(this,t,e,s)},this._handleDragLeave=t=>{const{dragElement:e}=this,n=g(t.target).filter(_s)[0];!e||!n||(t.preventDefault(),this._leaveDropElement(t,n),this._setState({dropping:null}))},this._handleDrop=t=>{var n;const e=g(t.target).closest(_s)[0];e&&(t.preventDefault(),(n=this.options.onDrop)==null||n.call(this,t,this.dragElement,e)),this._needClean=!0,setTimeout(()=>{this._needClean&&this._clean()},50)}}get state(){return this._state}get dragElement(){return this._state.dragging}get dropElement(){return this._state.dropping}async afterInit(){const{namespace:t}=this,{dragContainer:e,dropContainer:n,onDrag:s}=this.options;this._$dragContainer=e?g(e):this.$element,this._$dropContainer=n?g(n):this._$dragContainer,this._$dragContainer.on("mousedown"+t,this._handleMouseDown).on("dragstart"+t,this._handleDragStart).on("dragend"+t,this._handleDragEnd),s&&this._$dragContainer.on("drag"+t,this._handleDrag),this._$dropContainer.on("dragover"+t,this._handleDragOver).on("dragenter"+t,this._handleDragEnter).on("dragleave"+t,this._handleDragLeave).on("drop"+t,this._handleDrop),g(document).on(`mouseup${this.namespace}`,this._clean.bind(this))}destroy(){this._clean(),g(document).off(this.namespace),this._$dragContainer.off(this.namespace),this._$dropContainer.off(this.namespace),super.destroy()}_setState(t){var r;const e=this._state,{dragging:n=e.dragging,dropping:s=e.dropping}=t;n===e.dragging&&s===e.dropping||(this._state={dragging:n,dropping:s},(r=this.options.onChange)==null||r.call(this,this._state,e))}_setDragEffect(t){const{dropEffect:e}=this.options;e&&(t.dataTransfer.dropEffect=e)}_leaveDropElement(t,e){var s;const{droppingClass:n}=this.options;n&&g(e).removeClass(n),(s=this.options.onDragLeave)==null||s.call(this,t,this.dragElement,e)}_clean(){this._needClean=!0;const{draggingClass:t,droppableClass:e,droppingClass:n,hasDraggingClass:s}=this.options;s&&this.$element.removeClass(s);const{dragElement:r}=this;if(r){const a=g(r);t&&a.removeClass(t)}this._setState({dropping:null,dragging:null});const o=this._$targets;o&&(e&&o.removeClass(e),n&&o.removeClass(n),this._$targets=void 0)}}vs.NAME="Draggable",vs.DEFAULT={selector:'[draggable="true"]',dropEffect:"move",hasDraggingClass:"has-dragging",draggingClass:"is-dragging",droppableClass:"is-droppable",droppingClass:"is-dropping"};const py='[moveable="true"]',wl=class dm extends zt{constructor(){super(...arguments),this._handleMouseDown=t=>{const{options:e}=this,{selector:n,handle:s,onMoveStart:r}=e,o=g(t.target),a=n==="self"?this.$element:o.closest(n),l=a[0];if(!l||s&&!o.closest(s).length||r&&r.call(this,t,l)===!1)return;a.attr("moveable","true");const{movingClass:h,hasMovingClass:f}=e;h&&a.addClass(h),f&&this.$element.addClass(f),t.preventDefault(),this._setState(t,l),g(document).off("mousemove mouseup").on(`mousemove${this.namespace}`,this._handleMouseMove.bind(this)).on(`mouseup${this.namespace}`,this._handleMouseUp.bind(this))},this._handleMouseMove=t=>{!this._state||!t.buttons||(t.preventDefault(),this._raf&&cancelAnimationFrame(this._raf),this._raf=requestAnimationFrame(()=>{var e;this._raf=0,this._setState(t),(e=this.options.onMove)==null||e.call(this,t,this._state)}))},this._handleMouseUp=t=>{var e,n;this._state&&(this._raf&&(cancelAnimationFrame(this._raf),this._raf=0),this._setState(t),(e=this.options.onMove)==null||e.call(this,t,this._state),(n=this.options.onMoveEnd)==null||n.call(this,t,this._state),this._clean())}}get state(){return this._state}get moveElement(){var t;return(t=this._state)==null?void 0:t.target}async afterInit(){this.on("mousedown",this._handleMouseDown)}destroy(){this._clean(),g(document).off(this.namespace),super.destroy()}_setState(t,e){var l;let n={x:t.pageX,y:t.pageY};const s=this._state;if(e){const h=g(e);let f;if(this.options.move===!0){const m=h.css("position");f=m==="fixed"||m==="absolute"||m==="relative"?"position":"transform"}else f=this.options.move||"none";const d=f==="transform"?dm.getTranslate(e):f==="scroll"?{left:e.scrollLeft,top:e.scrollTop}:h.position();n=g.extend(n,{strategy:f,target:e,startX:n.x,startY:n.y,deltaX:0,deltaY:0,startLeft:d.left,startTop:d.top,left:d.left,top:d.top,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop})}else if(s){const h=n.x-s.startX,f=n.y-s.startY;n=g.extend({},s,n,{deltaX:h,deltaY:f,left:s.startLeft+h,top:s.startTop+f})}this._state=n;const{strategy:r,target:o}=n,a=g(o);r==="position"?a.css({left:n.left,top:n.top}):r==="transform"?a.css("transform",`translate(${n.left}px, ${n.top}px)`):r==="scroll"&&(o.scrollLeft=n.scrollLeft-n.deltaX,o.scrollTop=n.scrollTop-n.deltaY),(l=this.options.onChange)==null||l.call(this,n,s,t)}_clean(){g(document).off("mousemove mouseup");const{hasMovingClass:t,movingClass:e}=this.options;t&&this.$element.removeClass(t);const{moveElement:n}=this;if(n){const s=g(n);e&&s.removeClass(e)}this._state=void 0}static getTranslate(t){const n=window.getComputedStyle(t).getPropertyValue("transform");if(n==="none")return{left:0,top:0};const s=n.match(/^matrix\((.+)\)$/);if(!s)return{left:0,top:0};const r=s[1].split(", ");return{left:parseFloat(r[4]),top:parseFloat(r[5])}}};wl.NAME="Moveable",wl.DEFAULT={selector:py,hasMovingClass:"has-moving",movingClass:"is-moving",move:!0};let bs=wl;const Cl=class fm extends zt{async afterInit(){const t=await fm.loadModule(),{options:e}=this;if(e.dragShadow!==void 0&&e.dragShadow!==!0){const{dragShadow:n,onEnd:s,setData:r}=e;e.setData=(o,a)=>{n===!1&&!this._emptyShadow&&(this._emptyShadow=a.cloneNode(!0),this._emptyShadow.classList.add("sortable-empty-shadow"),document.body.appendChild(this._emptyShadow)),o.setDragImage(n===!1?this._emptyShadow:n,0,0),r==null||r(o,a)},e.onEnd=o=>{var a;s==null||s(o),(a=this._emptyShadow)==null||a.remove(),this._emptyShadow=void 0},delete e.dragShadow}this.module=new t(this.element,e)}option(t,e){if(e===void 0)return this.module.option(t);this.module.option(t,e)}closest(t,e){return this.module.closest(t,e)}sort(t,e){this.module.sort(t,e)}save(){this.module.save()}destroy(){super.destroy(),this.module.destroy()}toArray(){return this.module.toArray()}static async loadModule(){return this.Module||(this.Module=await g.getLib("sortablejs")),this.Module}};Cl.NAME="Sortable",Cl.DEFAULT={animation:150};let Ur=Cl;g.registerLib("sortablejs",{src:"sortable/sortable.min.js",check:"Sortable"});let Vr=class extends me{componentDidMount(){super.componentDidMount();const t=this._getSortableOptions();t&&(this._sortable=new Ur(this.element,t))}getOrders(){var t;return((t=this._sortable)==null?void 0:t.toArray())||[]}_getClassName(t){return[super._getClassName(t),"sortable-list"]}_getSortableOptions(){const{sortable:t,canSortTo:e}=this.props;if(!t)return;const n=typeof t=="object"?t:{};return{group:`SortableList.${this.gid}`,dataIdAttr:"z-key",draggable:".list-item",...n,onSort:s=>{var o,a;const r=this.getOrders();(o=this.props.onSort)==null||o.call(this,s,r),(a=n.onSort)==null||a.call(this,s)},onMove:(s,r)=>{var o;if(e){const a=s.dragged.getAttribute("z-key-path"),l=s.related.getAttribute("z-key-path"),h=this.getItem(a),f=this.getItem(l),d=e.call(this,s,h,f);if(d!==void 0)return d}return(o=n.onMove)==null?void 0:o.call(this,s,r)}}}};Vr.defaultProps={...me.defaultProps,sortable:!0};let De=class extends ve{_getClassName(t){return[super._getClassName(t),t.lines?"tree-lines":""]}_getItem(t,e,n){return this.constructor.getTreeItem(t,super._getItem(t,e,n))}static getTreeItem(t,e){return e&&(e.type==="item"&&(e.icon===void 0&&(e.icon=e.items?e.expanded?t.expandedIcon:t.collapsedIcon:t.normalIcon),e.actions===void 0&&(e.actions=t.itemActions)),e)}};De.NAME="tree",De.defaultProps={...ve.defaultProps,indent:12},De.defaultItemProps={...ve.defaultItemProps,innerComponent:"div"},De.inheritNestedProps=[...ve.inheritNestedProps,"itemActions","expandedIcon","collapsedIcon","normalIcon"];let ri=class extends Ie{_getClassName(t){return[super._getClassName(t),t.lines?"tree-lines":""]}_getItem(t,e,n){return De.getTreeItem(t,super._getItem(t,e,n))}};ri.NAME="tree",ri.inheritNestedProps=[...Ie.inheritNestedProps,"itemActions","expandedIcon","collapsedIcon","normalIcon"],ri.ItemComponents={...Ie.ItemComponents,item:[qe,{innerComponent:"div"}]};const my=Object.freeze(Object.defineProperty({__proto__:null,SearchTree:ri,Tree:De},Symbol.toStringTag,{value:"Module"}));let qr=class extends De{componentDidMount(){super.componentDidMount();const t=this._getSortableOptions();t&&(this._sortable=new Ur(this.element,t))}getOrders(){var t;return((t=this._sortable)==null?void 0:t.toArray())||[]}_getClassName(t){return[super._getClassName(t),"sortable-tree"]}_getSortableOptions(){const{sortable:t}=this.props;if(!t)return;const e=typeof t=="object"?t:{},{onSort:n,canSortTo:s,parentKey:r}=this.props;return{group:`SortableTree.${this.gid}`,dataIdAttr:"z-key",draggable:".tree-item",...e,onSort:o=>{var l;const a=this.getOrders();n==null||n.call(this,o,a,r),(l=e.onSort)==null||l.call(this,o)},onMove:(o,a)=>{var l;if(s){const h=o.dragged.getAttribute("z-key-path"),f=o.related.getAttribute("z-key-path"),d=this.getItem(h),m=this.getItem(f),y=s.call(this,o,d,m,r);if(y!==void 0)return y}return(l=e.onMove)==null?void 0:l.call(this,o,a)}}}};qr.defaultProps={...De.defaultProps,sortable:!0},qr.inheritNestedProps=[...De.inheritNestedProps,"onSort","sortable"];class Gr extends mt{}Gr.NAME="SortableList",Gr.Component=Vr,Gr.replace=Vr.TAG;class Yr extends mt{}Yr.NAME="SortableTree",Yr.Component=qr,Yr.replace=qr.TAG;const Aw="";/*! js-cookie v3.0.1 | MIT */function Qr(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)i[n]=e[n]}return i}var gy={read:function(i){return i[0]==='"'&&(i=i.slice(1,-1)),i.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(i){return encodeURIComponent(i).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function kl(i,t){function e(s,r,o){if(!(typeof document>"u")){o=Qr({},t,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),s=encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var l in o)o[l]&&(a+="; "+l,o[l]!==!0&&(a+="="+o[l].split(";")[0]));return document.cookie=s+"="+i.write(r,s)+a}}function n(s){if(!(typeof document>"u"||arguments.length&&!s)){for(var r=document.cookie?document.cookie.split("; "):[],o={},a=0;a<r.length;a++){var l=r[a].split("="),h=l.slice(1).join("=");try{var f=decodeURIComponent(l[0]);if(o[f]=i.read(h,f),s===f)break}catch{}}return s?o[s]:o}}return Object.create({set:e,get:n,remove:function(s,r){e(s,"",Qr({},r,{expires:-1}))},withAttributes:function(s){return kl(this.converter,Qr({},this.attributes,s))},withConverter:function(s){return kl(Qr({},this.converter,s),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(i)}})}var gd=kl(gy,{path:"/"});window.$&&Object.assign(window.$,{cookie:gd});var yd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yy(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var _d={exports:{}};(function(i,t){(function(e,n){i.exports=n()})(yd,function(){var e=function(c,u){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,_){p.__proto__=_}||function(p,_){for(var v in _)Object.prototype.hasOwnProperty.call(_,v)&&(p[v]=_[v])})(c,u)},n=function(){return(n=Object.assign||function(c){for(var u,p=1,_=arguments.length;p<_;p++)for(var v in u=arguments[p])Object.prototype.hasOwnProperty.call(u,v)&&(c[v]=u[v]);return c}).apply(this,arguments)};function s(c,u,p){if(p||arguments.length===2)for(var _,v=0,C=u.length;v<C;v++)!_&&v in u||((_=_||Array.prototype.slice.call(u,0,v))[v]=u[v]);return c.concat(_||Array.prototype.slice.call(u))}var r=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:yd,o=Object.keys,a=Array.isArray;function l(c,u){return typeof u!="object"||o(u).forEach(function(p){c[p]=u[p]}),c}typeof Promise>"u"||r.Promise||(r.Promise=Promise);var h=Object.getPrototypeOf,f={}.hasOwnProperty;function d(c,u){return f.call(c,u)}function m(c,u){typeof u=="function"&&(u=u(h(c))),(typeof Reflect>"u"?o:Reflect.ownKeys)(u).forEach(function(p){b(c,p,u[p])})}var y=Object.defineProperty;function b(c,u,p,_){y(c,u,l(p&&d(p,"get")&&typeof p.get=="function"?{get:p.get,set:p.set,configurable:!0}:{value:p,configurable:!0,writable:!0},_))}function S(c){return{from:function(u){return c.prototype=Object.create(u.prototype),b(c.prototype,"constructor",c),{extend:m.bind(null,c.prototype)}}}}var x=Object.getOwnPropertyDescriptor,k=[].slice;function T(c,u,p){return k.call(c,u,p)}function j(c,u){return u(c)}function B(c){if(!c)throw new Error("Assertion Failed")}function K(c){r.setImmediate?setImmediate(c):setTimeout(c,0)}function G(c,u){if(typeof u=="string"&&d(c,u))return c[u];if(!u)return c;if(typeof u!="string"){for(var p=[],_=0,v=u.length;_<v;++_){var C=G(c,u[_]);p.push(C)}return p}var $=u.indexOf(".");if($!==-1){var N=c[u.substr(0,$)];return N==null?void 0:G(N,u.substr($+1))}}function Q(c,u,p){if(c&&u!==void 0&&!("isFrozen"in Object&&Object.isFrozen(c)))if(typeof u!="string"&&"length"in u){B(typeof p!="string"&&"length"in p);for(var _=0,v=u.length;_<v;++_)Q(c,u[_],p[_])}else{var C,$,N=u.indexOf(".");N!==-1?(C=u.substr(0,N),($=u.substr(N+1))===""?p===void 0?a(c)&&!isNaN(parseInt(C))?c.splice(C,1):delete c[C]:c[C]=p:Q(N=!(N=c[C])||!d(c,C)?c[C]={}:N,$,p)):p===void 0?a(c)&&!isNaN(parseInt(u))?c.splice(u,1):delete c[u]:c[u]=p}}function Z(c){var u,p={};for(u in c)d(c,u)&&(p[u]=c[u]);return p}var tt=[].concat;function X(c){return tt.apply([],c)}var mn="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(X([8,16,32,64].map(function(c){return["Int","Uint","Float"].map(function(u){return u+c+"Array"})}))).filter(function(c){return r[c]}),et=new Set(mn.map(function(c){return r[c]})),ct=null;function pt(c){return ct=new WeakMap,c=function u(p){if(!p||typeof p!="object")return p;var _=ct.get(p);if(_)return _;if(a(p)){_=[],ct.set(p,_);for(var v=0,C=p.length;v<C;++v)_.push(u(p[v]))}else if(et.has(p.constructor))_=p;else{var $,N=h(p);for($ in _=N===Object.prototype?{}:Object.create(N),ct.set(p,_),p)d(p,$)&&(_[$]=u(p[$]))}return _}(c),ct=null,c}var xt={}.toString;function Rt(c){return xt.call(c).slice(8,-1)}var Dt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ht=typeof Dt=="symbol"?function(c){var u;return c!=null&&(u=c[Dt])&&u.apply(c)}:function(){return null};function J(c,u){return u=c.indexOf(u),0<=u&&c.splice(u,1),0<=u}var _t={};function yt(c){var u,p,_,v;if(arguments.length===1){if(a(c))return c.slice();if(this===_t&&typeof c=="string")return[c];if(v=ht(c)){for(p=[];!(_=v.next()).done;)p.push(_.value);return p}if(c==null)return[c];if(typeof(u=c.length)!="number")return[c];for(p=new Array(u);u--;)p[u]=c[u];return p}for(u=arguments.length,p=new Array(u);u--;)p[u]=arguments[u];return p}var Mt=typeof Symbol<"u"?function(c){return c[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Xs=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Oe=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Xs),Fn={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function le(c,u){this.name=c,this.message=u}function dn(c,u){return c+". Errors: "+Object.keys(u).map(function(p){return u[p].toString()}).filter(function(p,_,v){return v.indexOf(p)===_}).join(`
`)}function fn(c,u,p,_){this.failures=u,this.failedKeys=_,this.successCount=p,this.message=dn(c,u)}function ge(c,u){this.name="BulkError",this.failures=Object.keys(u).map(function(p){return u[p]}),this.failuresByPos=u,this.message=dn(c,this.failures)}S(le).from(Error).extend({toString:function(){return this.name+": "+this.message}}),S(fn).from(le),S(ge).from(le);var jn=Oe.reduce(function(c,u){return c[u]=u+"Error",c},{}),Ze=le,dt=Oe.reduce(function(c,u){var p=u+"Error";function _(v,C){this.name=p,v?typeof v=="string"?(this.message="".concat(v).concat(C?`
 `+C:""),this.inner=C||null):typeof v=="object"&&(this.message="".concat(v.name," ").concat(v.message),this.inner=v):(this.message=Fn[u]||p,this.inner=null)}return S(_).from(Ze),c[u]=_,c},{});dt.Syntax=SyntaxError,dt.Type=TypeError,dt.Range=RangeError;var Gs=Xs.reduce(function(c,u){return c[u+"Error"]=dt[u],c},{}),Uo=Oe.reduce(function(c,u){return["Syntax","Type","Range"].indexOf(u)===-1&&(c[u+"Error"]=dt[u]),c},{});function Lt(){}function Ys(c){return c}function ib(c,u){return c==null||c===Ys?u:function(p){return u(c(p))}}function ui(c,u){return function(){c.apply(this,arguments),u.apply(this,arguments)}}function sb(c,u){return c===Lt?u:function(){var p=c.apply(this,arguments);p!==void 0&&(arguments[0]=p);var _=this.onsuccess,v=this.onerror;this.onsuccess=null,this.onerror=null;var C=u.apply(this,arguments);return _&&(this.onsuccess=this.onsuccess?ui(_,this.onsuccess):_),v&&(this.onerror=this.onerror?ui(v,this.onerror):v),C!==void 0?C:p}}function rb(c,u){return c===Lt?u:function(){c.apply(this,arguments);var p=this.onsuccess,_=this.onerror;this.onsuccess=this.onerror=null,u.apply(this,arguments),p&&(this.onsuccess=this.onsuccess?ui(p,this.onsuccess):p),_&&(this.onerror=this.onerror?ui(_,this.onerror):_)}}function ob(c,u){return c===Lt?u:function(p){var _=c.apply(this,arguments);l(p,_);var v=this.onsuccess,C=this.onerror;return this.onsuccess=null,this.onerror=null,p=u.apply(this,arguments),v&&(this.onsuccess=this.onsuccess?ui(v,this.onsuccess):v),C&&(this.onerror=this.onerror?ui(C,this.onerror):C),_===void 0?p===void 0?void 0:p:l(_,p)}}function ab(c,u){return c===Lt?u:function(){return u.apply(this,arguments)!==!1&&c.apply(this,arguments)}}function Jc(c,u){return c===Lt?u:function(){var p=c.apply(this,arguments);if(p&&typeof p.then=="function"){for(var _=this,v=arguments.length,C=new Array(v);v--;)C[v]=arguments[v];return p.then(function(){return u.apply(_,C)})}return u.apply(this,arguments)}}Uo.ModifyError=fn,Uo.DexieError=le,Uo.BulkError=ge;var Je=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Mp(c){Je=c}var Qs={},Pp=100,mn=typeof Promise>"u"?[]:function(){var c=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[c,h(c),c];var u=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[u,h(u),c]}(),Xs=mn[0],Oe=mn[1],mn=mn[2],Oe=Oe&&Oe.then,Zs=Xs&&Xs.constructor,th=!!mn,Js=function(c,u){tr.push([c,u]),Vo&&(queueMicrotask(cb),Vo=!1)},eh=!0,Vo=!0,di=[],qo=[],nh=Ys,Bn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Lt,pgp:!1,env:{},finalize:Lt},ut=Bn,tr=[],fi=0,Go=[];function lt(c){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var u=this._PSD=ut;if(typeof c!="function"){if(c!==Qs)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&sh(this,this._value))}this._state=null,this._value=null,++u.ref,function p(_,v){try{v(function(C){if(_._state===null){if(C===_)throw new TypeError("A promise cannot be resolved with itself.");var $=_._lib&&Xi();C&&typeof C.then=="function"?p(_,function(N,D){C instanceof lt?C._then(N,D):C.then(N,D)}):(_._state=!0,_._value=C,Ip(_)),$&&Zi()}},sh.bind(null,_))}catch(C){sh(_,C)}}(this,c)}var ih={get:function(){var c=ut,u=Zo;function p(_,v){var C=this,$=!c.global&&(c!==ut||u!==Zo),N=$&&!Wn(),D=new lt(function(A,O){rh(C,new Ap(Rp(_,c,$,N),Rp(v,c,$,N),A,O,c))});return this._consoleTask&&(D._consoleTask=this._consoleTask),D}return p.prototype=Qs,p},set:function(c){b(this,"then",c&&c.prototype===Qs?ih:{get:function(){return c},set:ih.set})}};function Ap(c,u,p,_,v){this.onFulfilled=typeof c=="function"?c:null,this.onRejected=typeof u=="function"?u:null,this.resolve=p,this.reject=_,this.psd=v}function sh(c,u){var p,_;qo.push(u),c._state===null&&(p=c._lib&&Xi(),u=nh(u),c._state=!1,c._value=u,_=c,di.some(function(v){return v._value===_._value})||di.push(_),Ip(c),p&&Zi())}function Ip(c){var u=c._listeners;c._listeners=[];for(var p=0,_=u.length;p<_;++p)rh(c,u[p]);var v=c._PSD;--v.ref||v.finalize(),fi===0&&(++fi,Js(function(){--fi==0&&oh()},[]))}function rh(c,u){if(c._state!==null){var p=c._state?u.onFulfilled:u.onRejected;if(p===null)return(c._state?u.resolve:u.reject)(c._value);++u.psd.ref,++fi,Js(lb,[p,c,u])}else c._listeners.push(u)}function lb(c,u,p){try{var _,v=u._value;!u._state&&qo.length&&(qo=[]),_=Je&&u._consoleTask?u._consoleTask.run(function(){return c(v)}):c(v),u._state||qo.indexOf(v)!==-1||function(C){for(var $=di.length;$;)if(di[--$]._value===C._value)return di.splice($,1)}(u),p.resolve(_)}catch(C){p.reject(C)}finally{--fi==0&&oh(),--p.psd.ref||p.psd.finalize()}}function cb(){pi(Bn,function(){Xi()&&Zi()})}function Xi(){var c=eh;return Vo=eh=!1,c}function Zi(){var c,u,p;do for(;0<tr.length;)for(c=tr,tr=[],p=c.length,u=0;u<p;++u){var _=c[u];_[0].apply(null,_[1])}while(0<tr.length);Vo=eh=!0}function oh(){var c=di;di=[],c.forEach(function(_){_._PSD.onunhandled.call(null,_._value,_)});for(var u=Go.slice(0),p=u.length;p;)u[--p]()}function Yo(c){return new lt(Qs,!1,c)}function Ut(c,u){var p=ut;return function(){var _=Xi(),v=ut;try{return Kn(p,!0),c.apply(this,arguments)}catch(C){u&&u(C)}finally{Kn(v,!1),_&&Zi()}}}m(lt.prototype,{then:ih,_then:function(c,u){rh(this,new Ap(null,null,c,u,ut))},catch:function(c){if(arguments.length===1)return this.then(null,c);var u=c,p=arguments[1];return typeof u=="function"?this.then(null,function(_){return(_ instanceof u?p:Yo)(_)}):this.then(null,function(_){return(_&&_.name===u?p:Yo)(_)})},finally:function(c){return this.then(function(u){return lt.resolve(c()).then(function(){return u})},function(u){return lt.resolve(c()).then(function(){return Yo(u)})})},timeout:function(c,u){var p=this;return c<1/0?new lt(function(_,v){var C=setTimeout(function(){return v(new dt.Timeout(u))},c);p.then(_,v).finally(clearTimeout.bind(null,C))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&b(lt.prototype,Symbol.toStringTag,"Dexie.Promise"),Bn.env=Dp(),m(lt,{all:function(){var c=yt.apply(null,arguments).map(Jo);return new lt(function(u,p){c.length===0&&u([]);var _=c.length;c.forEach(function(v,C){return lt.resolve(v).then(function($){c[C]=$,--_||u(c)},p)})})},resolve:function(c){return c instanceof lt?c:c&&typeof c.then=="function"?new lt(function(u,p){c.then(u,p)}):new lt(Qs,!0,c)},reject:Yo,race:function(){var c=yt.apply(null,arguments).map(Jo);return new lt(function(u,p){c.map(function(_){return lt.resolve(_).then(u,p)})})},PSD:{get:function(){return ut},set:function(c){return ut=c}},totalEchoes:{get:function(){return Zo}},newPSD:Hn,usePSD:pi,scheduler:{get:function(){return Js},set:function(c){Js=c}},rejectionMapper:{get:function(){return nh},set:function(c){nh=c}},follow:function(c,u){return new lt(function(p,_){return Hn(function(v,C){var $=ut;$.unhandleds=[],$.onunhandled=C,$.finalize=ui(function(){var N,D=this;N=function(){D.unhandleds.length===0?v():C(D.unhandleds[0])},Go.push(function A(){N(),Go.splice(Go.indexOf(A),1)}),++fi,Js(function(){--fi==0&&oh()},[])},$.finalize),c()},u,p,_)})}}),Zs&&(Zs.allSettled&&b(lt,"allSettled",function(){var c=yt.apply(null,arguments).map(Jo);return new lt(function(u){c.length===0&&u([]);var p=c.length,_=new Array(p);c.forEach(function(v,C){return lt.resolve(v).then(function($){return _[C]={status:"fulfilled",value:$}},function($){return _[C]={status:"rejected",reason:$}}).then(function(){return--p||u(_)})})})}),Zs.any&&typeof AggregateError<"u"&&b(lt,"any",function(){var c=yt.apply(null,arguments).map(Jo);return new lt(function(u,p){c.length===0&&p(new AggregateError([]));var _=c.length,v=new Array(_);c.forEach(function(C,$){return lt.resolve(C).then(function(N){return u(N)},function(N){v[$]=N,--_||p(new AggregateError(v))})})})}));var ie={awaits:0,echoes:0,id:0},hb=0,Qo=[],Xo=0,Zo=0,ub=0;function Hn(c,u,p,_){var v=ut,C=Object.create(v);return C.parent=v,C.ref=0,C.global=!1,C.id=++ub,Bn.env,C.env=th?{Promise:lt,PromiseProp:{value:lt,configurable:!0,writable:!0},all:lt.all,race:lt.race,allSettled:lt.allSettled,any:lt.any,resolve:lt.resolve,reject:lt.reject}:{},u&&l(C,u),++v.ref,C.finalize=function(){--this.parent.ref||this.parent.finalize()},_=pi(C,c,p,_),C.ref===0&&C.finalize(),_}function Ji(){return ie.id||(ie.id=++hb),++ie.awaits,ie.echoes+=Pp,ie.id}function Wn(){return!!ie.awaits&&(--ie.awaits==0&&(ie.id=0),ie.echoes=ie.awaits*Pp,!0)}function Jo(c){return ie.echoes&&c&&c.constructor===Zs?(Ji(),c.then(function(u){return Wn(),u},function(u){return Wn(),qt(u)})):c}function db(){var c=Qo[Qo.length-1];Qo.pop(),Kn(c,!1)}function Kn(c,u){var p,_=ut;(u?!ie.echoes||Xo++&&c===ut:!Xo||--Xo&&c===ut)||queueMicrotask(u?(function(v){++Zo,ie.echoes&&--ie.echoes!=0||(ie.echoes=ie.awaits=ie.id=0),Qo.push(ut),Kn(v,!0)}).bind(null,c):db),c!==ut&&(ut=c,_===Bn&&(Bn.env=Dp()),th&&(p=Bn.env.Promise,u=c.env,(_.global||c.global)&&(Object.defineProperty(r,"Promise",u.PromiseProp),p.all=u.all,p.race=u.race,p.resolve=u.resolve,p.reject=u.reject,u.allSettled&&(p.allSettled=u.allSettled),u.any&&(p.any=u.any))))}function Dp(){var c=r.Promise;return th?{Promise:c,PromiseProp:Object.getOwnPropertyDescriptor(r,"Promise"),all:c.all,race:c.race,allSettled:c.allSettled,any:c.any,resolve:c.resolve,reject:c.reject}:{}}function pi(c,u,p,_,v){var C=ut;try{return Kn(c,!0),u(p,_,v)}finally{Kn(C,!1)}}function Rp(c,u,p,_){return typeof c!="function"?c:function(){var v=ut;p&&Ji(),Kn(u,!0);try{return c.apply(this,arguments)}finally{Kn(v,!1),_&&queueMicrotask(Wn)}}}function ah(c){Promise===Zs&&ie.echoes===0?Xo===0?c():enqueueNativeMicroTask(c):setTimeout(c,0)}(""+Oe).indexOf("[native code]")===-1&&(Ji=Wn=Lt);var qt=lt.reject,mi=String.fromCharCode(65535),pn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Lp="String expected.",ts=[],ta="__dbnames",lh="readonly",ch="readwrite";function gi(c,u){return c?u?function(){return c.apply(this,arguments)&&u.apply(this,arguments)}:c:u}var Op={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ea(c){return typeof c!="string"||/\./.test(c)?function(u){return u}:function(u){return u[c]===void 0&&c in u&&delete(u=pt(u))[c],u}}function zp(){throw dt.Type()}function At(c,u){try{var p=Fp(c),_=Fp(u);if(p!==_)return p==="Array"?1:_==="Array"?-1:p==="binary"?1:_==="binary"?-1:p==="string"?1:_==="string"?-1:p==="Date"?1:_!=="Date"?NaN:-1;switch(p){case"number":case"Date":case"string":return u<c?1:c<u?-1:0;case"binary":return function(v,C){for(var $=v.length,N=C.length,D=$<N?$:N,A=0;A<D;++A)if(v[A]!==C[A])return v[A]<C[A]?-1:1;return $===N?0:$<N?-1:1}(jp(c),jp(u));case"Array":return function(v,C){for(var $=v.length,N=C.length,D=$<N?$:N,A=0;A<D;++A){var O=At(v[A],C[A]);if(O!==0)return O}return $===N?0:$<N?-1:1}(c,u)}}catch{}return NaN}function Fp(c){var u=typeof c;return u!="object"?u:ArrayBuffer.isView(c)?"binary":(c=Rt(c),c==="ArrayBuffer"?"binary":c)}function jp(c){return c instanceof Uint8Array?c:ArrayBuffer.isView(c)?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):new Uint8Array(c)}var Bp=(jt.prototype._trans=function(c,u,p){var _=this._tx||ut.trans,v=this.name,C=Je&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(c==="readonly"?"read":"write"," ").concat(this.name));function $(A,O,M){if(!M.schema[v])throw new dt.NotFound("Table "+v+" not part of transaction");return u(M.idbtrans,M)}var N=Xi();try{var D=_&&_.db._novip===this.db._novip?_===ut.trans?_._promise(c,$,p):Hn(function(){return _._promise(c,$,p)},{trans:_,transless:ut.transless||ut}):function A(O,M,z,I){if(O.idbdb&&(O._state.openComplete||ut.letThrough||O._vip)){var L=O._createTransaction(M,z,O._dbSchema);try{L.create(),O._state.PR1398_maxLoop=3}catch(F){return F.name===jn.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return A(O,M,z,I)})):qt(F)}return L._promise(M,function(F,R){return Hn(function(){return ut.trans=L,I(F,R,L)})}).then(function(F){if(M==="readwrite")try{L.idbtrans.commit()}catch{}return M==="readonly"?F:L._completion.then(function(){return F})})}if(O._state.openComplete)return qt(new dt.DatabaseClosed(O._state.dbOpenError));if(!O._state.isBeingOpened){if(!O._state.autoOpen)return qt(new dt.DatabaseClosed);O.open().catch(Lt)}return O._state.dbReadyPromise.then(function(){return A(O,M,z,I)})}(this.db,c,[this.name],$);return C&&(D._consoleTask=C,D=D.catch(function(A){return console.trace(A),qt(A)})),D}finally{N&&Zi()}},jt.prototype.get=function(c,u){var p=this;return c&&c.constructor===Object?this.where(c).first(u):c==null?qt(new dt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(_){return p.core.get({trans:_,key:c}).then(function(v){return p.hook.reading.fire(v)})}).then(u)},jt.prototype.where=function(c){if(typeof c=="string")return new this.db.WhereClause(this,c);if(a(c))return new this.db.WhereClause(this,"[".concat(c.join("+"),"]"));var u=o(c);if(u.length===1)return this.where(u[0]).equals(c[u[0]]);var p=this.schema.indexes.concat(this.schema.primKey).filter(function(D){if(D.compound&&u.every(function(O){return 0<=D.keyPath.indexOf(O)})){for(var A=0;A<u.length;++A)if(u.indexOf(D.keyPath[A])===-1)return!1;return!0}return!1}).sort(function(D,A){return D.keyPath.length-A.keyPath.length})[0];if(p&&this.db._maxKey!==mi){var $=p.keyPath.slice(0,u.length);return this.where($).equals($.map(function(A){return c[A]}))}!p&&Je&&console.warn("The query ".concat(JSON.stringify(c)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(u.join("+"),"]"));var _=this.schema.idxByName,v=this.db._deps.indexedDB;function C(D,A){return v.cmp(D,A)===0}var N=u.reduce(function(z,A){var O=z[0],M=z[1],z=_[A],I=c[A];return[O||z,O||!z?gi(M,z&&z.multi?function(L){return L=G(L,A),a(L)&&L.some(function(F){return C(I,F)})}:function(L){return C(I,G(L,A))}):M]},[null,null]),$=N[0],N=N[1];return $?this.where($.name).equals(c[$.keyPath]).filter(N):p?this.filter(N):this.where(u).equals("")},jt.prototype.filter=function(c){return this.toCollection().and(c)},jt.prototype.count=function(c){return this.toCollection().count(c)},jt.prototype.offset=function(c){return this.toCollection().offset(c)},jt.prototype.limit=function(c){return this.toCollection().limit(c)},jt.prototype.each=function(c){return this.toCollection().each(c)},jt.prototype.toArray=function(c){return this.toCollection().toArray(c)},jt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},jt.prototype.orderBy=function(c){return new this.db.Collection(new this.db.WhereClause(this,a(c)?"[".concat(c.join("+"),"]"):c))},jt.prototype.reverse=function(){return this.toCollection().reverse()},jt.prototype.mapToClass=function(c){var u,p=this.db,_=this.name;function v(){return u!==null&&u.apply(this,arguments)||this}(this.schema.mappedClass=c).prototype instanceof zp&&(function(D,A){if(typeof A!="function"&&A!==null)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");function O(){this.constructor=D}e(D,A),D.prototype=A===null?Object.create(A):(O.prototype=A.prototype,new O)}(v,u=c),Object.defineProperty(v.prototype,"db",{get:function(){return p},enumerable:!1,configurable:!0}),v.prototype.table=function(){return _},c=v);for(var C=new Set,$=c.prototype;$;$=h($))Object.getOwnPropertyNames($).forEach(function(D){return C.add(D)});function N(D){if(!D)return D;var A,O=Object.create(c.prototype);for(A in D)if(!C.has(A))try{O[A]=D[A]}catch{}return O}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=N,this.hook("reading",N),c},jt.prototype.defineClass=function(){return this.mapToClass(function(c){l(this,c)})},jt.prototype.add=function(c,u){var p=this,_=this.schema.primKey,v=_.auto,C=_.keyPath,$=c;return C&&v&&($=ea(C)(c)),this._trans("readwrite",function(N){return p.core.mutate({trans:N,type:"add",keys:u!=null?[u]:null,values:[$]})}).then(function(N){return N.numFailures?lt.reject(N.failures[0]):N.lastResult}).then(function(N){if(C)try{Q(c,C,N)}catch{}return N})},jt.prototype.update=function(c,u){return typeof c!="object"||a(c)?this.where(":id").equals(c).modify(u):(c=G(c,this.schema.primKey.keyPath),c===void 0?qt(new dt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(c).modify(u))},jt.prototype.put=function(c,u){var p=this,_=this.schema.primKey,v=_.auto,C=_.keyPath,$=c;return C&&v&&($=ea(C)(c)),this._trans("readwrite",function(N){return p.core.mutate({trans:N,type:"put",values:[$],keys:u!=null?[u]:null})}).then(function(N){return N.numFailures?lt.reject(N.failures[0]):N.lastResult}).then(function(N){if(C)try{Q(c,C,N)}catch{}return N})},jt.prototype.delete=function(c){var u=this;return this._trans("readwrite",function(p){return u.core.mutate({trans:p,type:"delete",keys:[c]})}).then(function(p){return p.numFailures?lt.reject(p.failures[0]):void 0})},jt.prototype.clear=function(){var c=this;return this._trans("readwrite",function(u){return c.core.mutate({trans:u,type:"deleteRange",range:Op})}).then(function(u){return u.numFailures?lt.reject(u.failures[0]):void 0})},jt.prototype.bulkGet=function(c){var u=this;return this._trans("readonly",function(p){return u.core.getMany({keys:c,trans:p}).then(function(_){return _.map(function(v){return u.hook.reading.fire(v)})})})},jt.prototype.bulkAdd=function(c,u,p){var _=this,v=Array.isArray(u)?u:void 0,C=(p=p||(v?void 0:u))?p.allKeys:void 0;return this._trans("readwrite",function($){var A=_.schema.primKey,N=A.auto,A=A.keyPath;if(A&&v)throw new dt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(v&&v.length!==c.length)throw new dt.InvalidArgument("Arguments objects and keys must have the same length");var D=c.length,A=A&&N?c.map(ea(A)):c;return _.core.mutate({trans:$,type:"add",keys:v,values:A,wantResults:C}).then(function(L){var M=L.numFailures,z=L.results,I=L.lastResult,L=L.failures;if(M===0)return C?z:I;throw new ge("".concat(_.name,".bulkAdd(): ").concat(M," of ").concat(D," operations failed"),L)})})},jt.prototype.bulkPut=function(c,u,p){var _=this,v=Array.isArray(u)?u:void 0,C=(p=p||(v?void 0:u))?p.allKeys:void 0;return this._trans("readwrite",function($){var A=_.schema.primKey,N=A.auto,A=A.keyPath;if(A&&v)throw new dt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(v&&v.length!==c.length)throw new dt.InvalidArgument("Arguments objects and keys must have the same length");var D=c.length,A=A&&N?c.map(ea(A)):c;return _.core.mutate({trans:$,type:"put",keys:v,values:A,wantResults:C}).then(function(L){var M=L.numFailures,z=L.results,I=L.lastResult,L=L.failures;if(M===0)return C?z:I;throw new ge("".concat(_.name,".bulkPut(): ").concat(M," of ").concat(D," operations failed"),L)})})},jt.prototype.bulkUpdate=function(c){var u=this,p=this.core,_=c.map(function($){return $.key}),v=c.map(function($){return $.changes}),C=[];return this._trans("readwrite",function($){return p.getMany({trans:$,keys:_,cache:"clone"}).then(function(N){var D=[],A=[];c.forEach(function(M,z){var I=M.key,L=M.changes,F=N[z];if(F){for(var R=0,H=Object.keys(L);R<H.length;R++){var W=H[R],U=L[W];if(W===u.schema.primKey.keyPath){if(At(U,I)!==0)throw new dt.Constraint("Cannot update primary key in bulkUpdate()")}else Q(F,W,U)}C.push(z),D.push(I),A.push(F)}});var O=D.length;return p.mutate({trans:$,type:"put",keys:D,values:A,updates:{keys:_,changeSpecs:v}}).then(function(M){var z=M.numFailures,I=M.failures;if(z===0)return O;for(var L=0,F=Object.keys(I);L<F.length;L++){var R,H=F[L],W=C[Number(H)];W!=null&&(R=I[H],delete I[H],I[W]=R)}throw new ge("".concat(u.name,".bulkUpdate(): ").concat(z," of ").concat(O," operations failed"),I)})})})},jt.prototype.bulkDelete=function(c){var u=this,p=c.length;return this._trans("readwrite",function(_){return u.core.mutate({trans:_,type:"delete",keys:c})}).then(function($){var v=$.numFailures,C=$.lastResult,$=$.failures;if(v===0)return C;throw new ge("".concat(u.name,".bulkDelete(): ").concat(v," of ").concat(p," operations failed"),$)})},jt);function jt(){}function er(c){function u($,N){if(N){for(var D=arguments.length,A=new Array(D-1);--D;)A[D-1]=arguments[D];return p[$].subscribe.apply(null,A),c}if(typeof $=="string")return p[$]}var p={};u.addEventType=C;for(var _=1,v=arguments.length;_<v;++_)C(arguments[_]);return u;function C($,N,D){if(typeof $!="object"){var A;N=N||ab;var O={subscribers:[],fire:D=D||Lt,subscribe:function(M){O.subscribers.indexOf(M)===-1&&(O.subscribers.push(M),O.fire=N(O.fire,M))},unsubscribe:function(M){O.subscribers=O.subscribers.filter(function(z){return z!==M}),O.fire=O.subscribers.reduce(N,D)}};return p[$]=u[$]=O}o(A=$).forEach(function(M){var z=A[M];if(a(z))C(M,A[M][0],A[M][1]);else{if(z!=="asap")throw new dt.InvalidArgument("Invalid event config");var I=C(M,Ys,function(){for(var L=arguments.length,F=new Array(L);L--;)F[L]=arguments[L];I.subscribers.forEach(function(R){K(function(){R.apply(null,F)})})})}})}}function nr(c,u){return S(u).from({prototype:c}),u}function es(c,u){return!(c.filter||c.algorithm||c.or)&&(u?c.justLimit:!c.replayFilter)}function hh(c,u){c.filter=gi(c.filter,u)}function uh(c,u,p){var _=c.replayFilter;c.replayFilter=_?function(){return gi(_(),u())}:u,c.justLimit=p&&!_}function na(c,u){if(c.isPrimKey)return u.primaryKey;var p=u.getIndexByKeyPath(c.index);if(!p)throw new dt.Schema("KeyPath "+c.index+" on object store "+u.name+" is not indexed");return p}function Hp(c,u,p){var _=na(c,u.schema);return u.openCursor({trans:p,values:!c.keysOnly,reverse:c.dir==="prev",unique:!!c.unique,query:{index:_,range:c.range}})}function ia(c,u,p,_){var v=c.replayFilter?gi(c.filter,c.replayFilter()):c.filter;if(c.or){var C={},$=function(N,D,A){var O,M;v&&!v(D,A,function(z){return D.stop(z)},function(z){return D.fail(z)})||((M=""+(O=D.primaryKey))=="[object ArrayBuffer]"&&(M=""+new Uint8Array(O)),d(C,M)||(C[M]=!0,u(N,D,A)))};return Promise.all([c.or._iterate($,p),Wp(Hp(c,_,p),c.algorithm,$,!c.keysOnly&&c.valueMapper)])}return Wp(Hp(c,_,p),gi(c.algorithm,v),u,!c.keysOnly&&c.valueMapper)}function Wp(c,u,p,_){var v=Ut(_?function(C,$,N){return p(_(C),$,N)}:p);return c.then(function(C){if(C)return C.start(function(){var $=function(){return C.continue()};u&&!u(C,function(N){return $=N},function(N){C.stop(N),$=Lt},function(N){C.fail(N),$=Lt})||v(C.value,C,function(N){return $=N}),$()})})}var mn=Symbol(),dh=(Kp.prototype.execute=function(c){var u=(u=this.replacePrefix)===null||u===void 0?void 0:u[0];return u&&typeof c=="string"&&c.startsWith(u)?this.replacePrefix[1]+c.substring(u.length):c},Kp);function Kp(c){Object.assign(this,c)}var fb=(Pt.prototype._read=function(c,u){var p=this._ctx;return p.error?p.table._trans(null,qt.bind(null,p.error)):p.table._trans("readonly",c).then(u)},Pt.prototype._write=function(c){var u=this._ctx;return u.error?u.table._trans(null,qt.bind(null,u.error)):u.table._trans("readwrite",c,"locked")},Pt.prototype._addAlgorithm=function(c){var u=this._ctx;u.algorithm=gi(u.algorithm,c)},Pt.prototype._iterate=function(c,u){return ia(this._ctx,c,u,this._ctx.table.core)},Pt.prototype.clone=function(c){var u=Object.create(this.constructor.prototype),p=Object.create(this._ctx);return c&&l(p,c),u._ctx=p,u},Pt.prototype.raw=function(){return this._ctx.valueMapper=null,this},Pt.prototype.each=function(c){var u=this._ctx;return this._read(function(p){return ia(u,c,p,u.table.core)})},Pt.prototype.count=function(c){var u=this;return this._read(function(p){var _=u._ctx,v=_.table.core;if(es(_,!0))return v.count({trans:p,query:{index:na(_,v.schema),range:_.range}}).then(function($){return Math.min($,_.limit)});var C=0;return ia(_,function(){return++C,!1},p,v).then(function(){return C})}).then(c)},Pt.prototype.sortBy=function(c,u){var p=c.split(".").reverse(),_=p[0],v=p.length-1;function C(D,A){return A?C(D[p[A]],A-1):D[_]}var $=this._ctx.dir==="next"?1:-1;function N(D,A){return D=C(D,v),A=C(A,v),D<A?-$:A<D?$:0}return this.toArray(function(D){return D.sort(N)}).then(u)},Pt.prototype.toArray=function(c){var u=this;return this._read(function(p){var _=u._ctx;if(_.dir==="next"&&es(_,!0)&&0<_.limit){var v=_.valueMapper,C=na(_,_.table.core.schema);return _.table.core.query({trans:p,limit:_.limit,values:!0,query:{index:C,range:_.range}}).then(function(N){return N=N.result,v?N.map(v):N})}var $=[];return ia(_,function(N){return $.push(N)},p,_.table.core).then(function(){return $})},c)},Pt.prototype.offset=function(c){var u=this._ctx;return c<=0||(u.offset+=c,es(u)?uh(u,function(){var p=c;return function(_,v){return p===0||(p===1?--p:v(function(){_.advance(p),p=0}),!1)}}):uh(u,function(){var p=c;return function(){return--p<0}})),this},Pt.prototype.limit=function(c){return this._ctx.limit=Math.min(this._ctx.limit,c),uh(this._ctx,function(){var u=c;return function(p,_,v){return--u<=0&&_(v),0<=u}},!0),this},Pt.prototype.until=function(c,u){return hh(this._ctx,function(p,_,v){return!c(p.value)||(_(v),u)}),this},Pt.prototype.first=function(c){return this.limit(1).toArray(function(u){return u[0]}).then(c)},Pt.prototype.last=function(c){return this.reverse().first(c)},Pt.prototype.filter=function(c){var u;return hh(this._ctx,function(p){return c(p.value)}),(u=this._ctx).isMatch=gi(u.isMatch,c),this},Pt.prototype.and=function(c){return this.filter(c)},Pt.prototype.or=function(c){return new this.db.WhereClause(this._ctx.table,c,this)},Pt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Pt.prototype.desc=function(){return this.reverse()},Pt.prototype.eachKey=function(c){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(p,_){c(_.key,_)})},Pt.prototype.eachUniqueKey=function(c){return this._ctx.unique="unique",this.eachKey(c)},Pt.prototype.eachPrimaryKey=function(c){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(p,_){c(_.primaryKey,_)})},Pt.prototype.keys=function(c){var u=this._ctx;u.keysOnly=!u.isMatch;var p=[];return this.each(function(_,v){p.push(v.key)}).then(function(){return p}).then(c)},Pt.prototype.primaryKeys=function(c){var u=this._ctx;if(u.dir==="next"&&es(u,!0)&&0<u.limit)return this._read(function(_){var v=na(u,u.table.core.schema);return u.table.core.query({trans:_,values:!1,limit:u.limit,query:{index:v,range:u.range}})}).then(function(_){return _.result}).then(c);u.keysOnly=!u.isMatch;var p=[];return this.each(function(_,v){p.push(v.primaryKey)}).then(function(){return p}).then(c)},Pt.prototype.uniqueKeys=function(c){return this._ctx.unique="unique",this.keys(c)},Pt.prototype.firstKey=function(c){return this.limit(1).keys(function(u){return u[0]}).then(c)},Pt.prototype.lastKey=function(c){return this.reverse().firstKey(c)},Pt.prototype.distinct=function(){var c=this._ctx,c=c.index&&c.table.schema.idxByName[c.index];if(!c||!c.multi)return this;var u={};return hh(this._ctx,function(v){var _=v.primaryKey.toString(),v=d(u,_);return u[_]=!0,!v}),this},Pt.prototype.modify=function(c){var u=this,p=this._ctx;return this._write(function(_){var v,C,$;$=typeof c=="function"?c:(v=o(c),C=v.length,function(R){for(var H=!1,W=0;W<C;++W){var U=v[W],V=c[U],Y=G(R,U);V instanceof dh?(Q(R,U,V.execute(Y)),H=!0):Y!==V&&(Q(R,U,V),H=!0)}return H});function N(R,U){var W=U.failures,U=U.numFailures;L+=R-U;for(var V=0,Y=o(W);V<Y.length;V++){var rt=Y[V];I.push(W[rt])}}var D=p.table.core,A=D.schema.primaryKey,O=A.outbound,M=A.extractKey,z=u.db._options.modifyChunkSize||200,I=[],L=0,F=[];return u.clone().primaryKeys().then(function(R){function H(W){var U=Math.min(z,R.length-W);return D.getMany({trans:_,keys:R.slice(W,W+U),cache:"immutable"}).then(function(V){for(var Y=[],rt=[],nt=O?[]:null,it=[],ot=0;ot<U;++ot){var at=V[ot],ft={value:pt(at),primKey:R[W+ot]};$.call(ft,ft.value,ft)!==!1&&(ft.value==null?it.push(R[W+ot]):O||At(M(at),M(ft.value))===0?(rt.push(ft.value),O&&nt.push(R[W+ot])):(it.push(R[W+ot]),Y.push(ft.value)))}var bt=es(p)&&p.limit===1/0&&(typeof c!="function"||c===fh)&&{index:p.index,range:p.range};return Promise.resolve(0<Y.length&&D.mutate({trans:_,type:"add",values:Y}).then(function(St){for(var wt in St.failures)it.splice(parseInt(wt),1);N(Y.length,St)})).then(function(){return(0<rt.length||bt&&typeof c=="object")&&D.mutate({trans:_,type:"put",keys:nt,values:rt,criteria:bt,changeSpec:typeof c!="function"&&c}).then(function(St){return N(rt.length,St)})}).then(function(){return(0<it.length||bt&&c===fh)&&D.mutate({trans:_,type:"delete",keys:it,criteria:bt}).then(function(St){return N(it.length,St)})}).then(function(){return R.length>W+U&&H(W+z)})})}return H(0).then(function(){if(0<I.length)throw new fn("Error modifying one or more objects",I,L,F);return R.length})})})},Pt.prototype.delete=function(){var c=this._ctx,u=c.range;return es(c)&&(c.isPrimKey||u.type===3)?this._write(function(p){var _=c.table.core.schema.primaryKey,v=u;return c.table.core.count({trans:p,query:{index:_,range:v}}).then(function(C){return c.table.core.mutate({trans:p,type:"deleteRange",range:v}).then(function($){var N=$.failures;if($.lastResult,$.results,$=$.numFailures,$)throw new fn("Could not delete some values",Object.keys(N).map(function(D){return N[D]}),C-$);return C-$})})}):this.modify(fh)},Pt);function Pt(){}var fh=function(c,u){return u.value=null};function pb(c,u){return c<u?-1:c===u?0:1}function mb(c,u){return u<c?-1:c===u?0:1}function Me(c,u,p){return c=c instanceof Vp?new c.Collection(c):c,c._ctx.error=new(p||TypeError)(u),c}function ns(c){return new c.Collection(c,function(){return Up("")}).limit(0)}function sa(c,u,p,_){var v,C,$,N,D,A,O,M=p.length;if(!p.every(function(L){return typeof L=="string"}))return Me(c,Lp);function z(L){v=L==="next"?function(R){return R.toUpperCase()}:function(R){return R.toLowerCase()},C=L==="next"?function(R){return R.toLowerCase()}:function(R){return R.toUpperCase()},$=L==="next"?pb:mb;var F=p.map(function(R){return{lower:C(R),upper:v(R)}}).sort(function(R,H){return $(R.lower,H.lower)});N=F.map(function(R){return R.upper}),D=F.map(function(R){return R.lower}),O=(A=L)==="next"?"":_}z("next"),c=new c.Collection(c,function(){return Un(N[0],D[M-1]+_)}),c._ondirectionchange=function(L){z(L)};var I=0;return c._addAlgorithm(function(L,F,R){var H=L.key;if(typeof H!="string")return!1;var W=C(H);if(u(W,D,I))return!0;for(var U=null,V=I;V<M;++V){var Y=function(rt,nt,it,ot,at,ft){for(var bt=Math.min(rt.length,ot.length),St=-1,wt=0;wt<bt;++wt){var We=nt[wt];if(We!==ot[wt])return at(rt[wt],it[wt])<0?rt.substr(0,wt)+it[wt]+it.substr(wt+1):at(rt[wt],ot[wt])<0?rt.substr(0,wt)+ot[wt]+it.substr(wt+1):0<=St?rt.substr(0,St)+nt[St]+it.substr(St+1):null;at(rt[wt],We)<0&&(St=wt)}return bt<ot.length&&ft==="next"?rt+it.substr(rt.length):bt<rt.length&&ft==="prev"?rt.substr(0,it.length):St<0?null:rt.substr(0,St)+ot[St]+it.substr(St+1)}(H,W,N[V],D[V],$,A);Y===null&&U===null?I=V+1:(U===null||0<$(U,Y))&&(U=Y)}return F(U!==null?function(){L.continue(U+O)}:R),!1}),c}function Un(c,u,p,_){return{type:2,lower:c,upper:u,lowerOpen:p,upperOpen:_}}function Up(c){return{type:1,lower:c,upper:c}}var Vp=(Object.defineProperty(se.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),se.prototype.between=function(c,u,p,_){p=p!==!1,_=_===!0;try{return 0<this._cmp(c,u)||this._cmp(c,u)===0&&(p||_)&&(!p||!_)?ns(this):new this.Collection(this,function(){return Un(c,u,!p,!_)})}catch{return Me(this,pn)}},se.prototype.equals=function(c){return c==null?Me(this,pn):new this.Collection(this,function(){return Up(c)})},se.prototype.above=function(c){return c==null?Me(this,pn):new this.Collection(this,function(){return Un(c,void 0,!0)})},se.prototype.aboveOrEqual=function(c){return c==null?Me(this,pn):new this.Collection(this,function(){return Un(c,void 0,!1)})},se.prototype.below=function(c){return c==null?Me(this,pn):new this.Collection(this,function(){return Un(void 0,c,!1,!0)})},se.prototype.belowOrEqual=function(c){return c==null?Me(this,pn):new this.Collection(this,function(){return Un(void 0,c)})},se.prototype.startsWith=function(c){return typeof c!="string"?Me(this,Lp):this.between(c,c+mi,!0,!0)},se.prototype.startsWithIgnoreCase=function(c){return c===""?this.startsWith(c):sa(this,function(u,p){return u.indexOf(p[0])===0},[c],mi)},se.prototype.equalsIgnoreCase=function(c){return sa(this,function(u,p){return u===p[0]},[c],"")},se.prototype.anyOfIgnoreCase=function(){var c=yt.apply(_t,arguments);return c.length===0?ns(this):sa(this,function(u,p){return p.indexOf(u)!==-1},c,"")},se.prototype.startsWithAnyOfIgnoreCase=function(){var c=yt.apply(_t,arguments);return c.length===0?ns(this):sa(this,function(u,p){return p.some(function(_){return u.indexOf(_)===0})},c,mi)},se.prototype.anyOf=function(){var c=this,u=yt.apply(_t,arguments),p=this._cmp;try{u.sort(p)}catch{return Me(this,pn)}if(u.length===0)return ns(this);var _=new this.Collection(this,function(){return Un(u[0],u[u.length-1])});_._ondirectionchange=function(C){p=C==="next"?c._ascending:c._descending,u.sort(p)};var v=0;return _._addAlgorithm(function(C,$,N){for(var D=C.key;0<p(D,u[v]);)if(++v===u.length)return $(N),!1;return p(D,u[v])===0||($(function(){C.continue(u[v])}),!1)}),_},se.prototype.notEqual=function(c){return this.inAnyRange([[-1/0,c],[c,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},se.prototype.noneOf=function(){var c=yt.apply(_t,arguments);if(c.length===0)return new this.Collection(this);try{c.sort(this._ascending)}catch{return Me(this,pn)}var u=c.reduce(function(p,_){return p?p.concat([[p[p.length-1][1],_]]):[[-1/0,_]]},null);return u.push([c[c.length-1],this.db._maxKey]),this.inAnyRange(u,{includeLowers:!1,includeUppers:!1})},se.prototype.inAnyRange=function(H,u){var p=this,_=this._cmp,v=this._ascending,C=this._descending,$=this._min,N=this._max;if(H.length===0)return ns(this);if(!H.every(function(W){return W[0]!==void 0&&W[1]!==void 0&&v(W[0],W[1])<=0}))return Me(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",dt.InvalidArgument);var D=!u||u.includeLowers!==!1,A=u&&u.includeUppers===!0,O,M=v;function z(W,U){return M(W[0],U[0])}try{(O=H.reduce(function(W,U){for(var V=0,Y=W.length;V<Y;++V){var rt=W[V];if(_(U[0],rt[1])<0&&0<_(U[1],rt[0])){rt[0]=$(rt[0],U[0]),rt[1]=N(rt[1],U[1]);break}}return V===Y&&W.push(U),W},[])).sort(z)}catch{return Me(this,pn)}var I=0,L=A?function(W){return 0<v(W,O[I][1])}:function(W){return 0<=v(W,O[I][1])},F=D?function(W){return 0<C(W,O[I][0])}:function(W){return 0<=C(W,O[I][0])},R=L,H=new this.Collection(this,function(){return Un(O[0][0],O[O.length-1][1],!D,!A)});return H._ondirectionchange=function(W){M=W==="next"?(R=L,v):(R=F,C),O.sort(z)},H._addAlgorithm(function(W,U,V){for(var Y,rt=W.key;R(rt);)if(++I===O.length)return U(V),!1;return!L(Y=rt)&&!F(Y)||(p._cmp(rt,O[I][1])===0||p._cmp(rt,O[I][0])===0||U(function(){M===v?W.continue(O[I][0]):W.continue(O[I][1])}),!1)}),H},se.prototype.startsWithAnyOf=function(){var c=yt.apply(_t,arguments);return c.every(function(u){return typeof u=="string"})?c.length===0?ns(this):this.inAnyRange(c.map(function(u){return[u,u+mi]})):Me(this,"startsWithAnyOf() only works with strings")},se);function se(){}function tn(c){return Ut(function(u){return ir(u),c(u.target.error),!1})}function ir(c){c.stopPropagation&&c.stopPropagation(),c.preventDefault&&c.preventDefault()}var sr="storagemutated",ph="x-storagemutated-1",Vn=er(null,sr),gb=(en.prototype._lock=function(){return B(!ut.global),++this._reculock,this._reculock!==1||ut.global||(ut.lockOwnerFor=this),this},en.prototype._unlock=function(){if(B(!ut.global),--this._reculock==0)for(ut.global||(ut.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var c=this._blockedFuncs.shift();try{pi(c[1],c[0])}catch{}}return this},en.prototype._locked=function(){return this._reculock&&ut.lockOwnerFor!==this},en.prototype.create=function(c){var u=this;if(!this.mode)return this;var p=this.db.idbdb,_=this.db._state.dbOpenError;if(B(!this.idbtrans),!c&&!p)switch(_&&_.name){case"DatabaseClosedError":throw new dt.DatabaseClosed(_);case"MissingAPIError":throw new dt.MissingAPI(_.message,_);default:throw new dt.OpenFailed(_)}if(!this.active)throw new dt.TransactionInactive;return B(this._completion._state===null),(c=this.idbtrans=c||(this.db.core||p).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ut(function(v){ir(v),u._reject(c.error)}),c.onabort=Ut(function(v){ir(v),u.active&&u._reject(new dt.Abort(c.error)),u.active=!1,u.on("abort").fire(v)}),c.oncomplete=Ut(function(){u.active=!1,u._resolve(),"mutatedParts"in c&&Vn.storagemutated.fire(c.mutatedParts)}),this},en.prototype._promise=function(c,u,p){var _=this;if(c==="readwrite"&&this.mode!=="readwrite")return qt(new dt.ReadOnly("Transaction is readonly"));if(!this.active)return qt(new dt.TransactionInactive);if(this._locked())return new lt(function(C,$){_._blockedFuncs.push([function(){_._promise(c,u,p).then(C,$)},ut])});if(p)return Hn(function(){var C=new lt(function($,N){_._lock();var D=u($,N,_);D&&D.then&&D.then($,N)});return C.finally(function(){return _._unlock()}),C._lib=!0,C});var v=new lt(function(C,$){var N=u(C,$,_);N&&N.then&&N.then(C,$)});return v._lib=!0,v},en.prototype._root=function(){return this.parent?this.parent._root():this},en.prototype.waitFor=function(c){var u,p=this._root(),_=lt.resolve(c);p._waitingFor?p._waitingFor=p._waitingFor.then(function(){return _}):(p._waitingFor=_,p._waitingQueue=[],u=p.idbtrans.objectStore(p.storeNames[0]),function C(){for(++p._spinCount;p._waitingQueue.length;)p._waitingQueue.shift()();p._waitingFor&&(u.get(-1/0).onsuccess=C)}());var v=p._waitingFor;return new lt(function(C,$){_.then(function(N){return p._waitingQueue.push(Ut(C.bind(null,N)))},function(N){return p._waitingQueue.push(Ut($.bind(null,N)))}).finally(function(){p._waitingFor===v&&(p._waitingFor=null)})})},en.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new dt.Abort))},en.prototype.table=function(c){var u=this._memoizedTables||(this._memoizedTables={});if(d(u,c))return u[c];var p=this.schema[c];if(!p)throw new dt.NotFound("Table "+c+" not part of transaction");return p=new this.db.Table(c,p,this),p.core=this.db.core.table(c),u[c]=p},en);function en(){}function mh(c,u,p,_,v,C,$){return{name:c,keyPath:u,unique:p,multi:_,auto:v,compound:C,src:(p&&!$?"&":"")+(_?"*":"")+(v?"++":"")+qp(u)}}function qp(c){return typeof c=="string"?c:c?"["+[].join.call(c,"+")+"]":""}function gh(c,u,p){return{name:c,primKey:u,indexes:p,mappedClass:null,idxByName:(_=function(v){return[v.name,v]},p.reduce(function(v,C,$){return $=_(C,$),$&&(v[$[0]]=$[1]),v},{}))};var _}var rr=function(c){try{return c.only([[]]),rr=function(){return[[]]},[[]]}catch{return rr=function(){return mi},mi}};function yh(c){return c==null?function(){}:typeof c=="string"?(u=c).split(".").length===1?function(p){return p[u]}:function(p){return G(p,u)}:function(p){return G(p,c)};var u}function Gp(c){return[].slice.call(c)}var yb=0;function or(c){return c==null?":id":typeof c=="string"?c:"[".concat(c.join("+"),"]")}function _b(c,u,D){function _(R){if(R.type===3)return null;if(R.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var I=R.lower,L=R.upper,F=R.lowerOpen,R=R.upperOpen;return I===void 0?L===void 0?null:u.upperBound(L,!!R):L===void 0?u.lowerBound(I,!!F):u.bound(I,L,!!F,!!R)}function v(z){var I,L=z.name;return{name:L,schema:z,mutate:function(F){var R=F.trans,H=F.type,W=F.keys,U=F.values,V=F.range;return new Promise(function(Y,rt){Y=Ut(Y);var nt=R.objectStore(L),it=nt.keyPath==null,ot=H==="put"||H==="add";if(!ot&&H!=="delete"&&H!=="deleteRange")throw new Error("Invalid operation type: "+H);var at,ft=(W||U||{length:1}).length;if(W&&U&&W.length!==U.length)throw new Error("Given keys array must have same length as given values array.");if(ft===0)return Y({numFailures:0,failures:{},results:[],lastResult:void 0});function bt(ye){++We,ir(ye)}var St=[],wt=[],We=0;if(H==="deleteRange"){if(V.type===4)return Y({numFailures:We,failures:wt,results:[],lastResult:void 0});V.type===3?St.push(at=nt.clear()):St.push(at=nt.delete(_(V)))}else{var it=ot?it?[U,W]:[U,null]:[W,null],Ct=it[0],he=it[1];if(ot)for(var ue=0;ue<ft;++ue)St.push(at=he&&he[ue]!==void 0?nt[H](Ct[ue],he[ue]):nt[H](Ct[ue])),at.onerror=bt;else for(ue=0;ue<ft;++ue)St.push(at=nt[H](Ct[ue])),at.onerror=bt}function ya(ye){ye=ye.target.result,St.forEach(function(vi,Lh){return vi.error!=null&&(wt[Lh]=vi.error)}),Y({numFailures:We,failures:wt,results:H==="delete"?W:St.map(function(vi){return vi.result}),lastResult:ye})}at.onerror=function(ye){bt(ye),ya(ye)},at.onsuccess=ya})},getMany:function(F){var R=F.trans,H=F.keys;return new Promise(function(W,U){W=Ut(W);for(var V,Y=R.objectStore(L),rt=H.length,nt=new Array(rt),it=0,ot=0,at=function(St){St=St.target,nt[St._pos]=St.result,++ot===it&&W(nt)},ft=tn(U),bt=0;bt<rt;++bt)H[bt]!=null&&((V=Y.get(H[bt]))._pos=bt,V.onsuccess=at,V.onerror=ft,++it);it===0&&W(nt)})},get:function(F){var R=F.trans,H=F.key;return new Promise(function(W,U){W=Ut(W);var V=R.objectStore(L).get(H);V.onsuccess=function(Y){return W(Y.target.result)},V.onerror=tn(U)})},query:(I=A,function(F){return new Promise(function(R,H){R=Ut(R);var W,U,V,it=F.trans,Y=F.values,rt=F.limit,at=F.query,nt=rt===1/0?void 0:rt,ot=at.index,at=at.range,it=it.objectStore(L),ot=ot.isPrimaryKey?it:it.index(ot.name),at=_(at);if(rt===0)return R({result:[]});I?((nt=Y?ot.getAll(at,nt):ot.getAllKeys(at,nt)).onsuccess=function(ft){return R({result:ft.target.result})},nt.onerror=tn(H)):(W=0,U=!Y&&"openKeyCursor"in ot?ot.openKeyCursor(at):ot.openCursor(at),V=[],U.onsuccess=function(ft){var bt=U.result;return bt?(V.push(Y?bt.value:bt.primaryKey),++W===rt?R({result:V}):void bt.continue()):R({result:V})},U.onerror=tn(H))})}),openCursor:function(F){var R=F.trans,H=F.values,W=F.query,U=F.reverse,V=F.unique;return new Promise(function(Y,rt){Y=Ut(Y);var ot=W.index,nt=W.range,it=R.objectStore(L),it=ot.isPrimaryKey?it:it.index(ot.name),ot=U?V?"prevunique":"prev":V?"nextunique":"next",at=!H&&"openKeyCursor"in it?it.openKeyCursor(_(nt),ot):it.openCursor(_(nt),ot);at.onerror=tn(rt),at.onsuccess=Ut(function(ft){var bt,St,wt,We,Ct=at.result;Ct?(Ct.___id=++yb,Ct.done=!1,bt=Ct.continue.bind(Ct),St=(St=Ct.continuePrimaryKey)&&St.bind(Ct),wt=Ct.advance.bind(Ct),We=function(){throw new Error("Cursor not stopped")},Ct.trans=R,Ct.stop=Ct.continue=Ct.continuePrimaryKey=Ct.advance=function(){throw new Error("Cursor not started")},Ct.fail=Ut(rt),Ct.next=function(){var he=this,ue=1;return this.start(function(){return ue--?he.continue():he.stop()}).then(function(){return he})},Ct.start=function(he){function ue(){if(at.result)try{he()}catch(ye){Ct.fail(ye)}else Ct.done=!0,Ct.start=function(){throw new Error("Cursor behind last entry")},Ct.stop()}var ya=new Promise(function(ye,vi){ye=Ut(ye),at.onerror=tn(vi),Ct.fail=vi,Ct.stop=function(Lh){Ct.stop=Ct.continue=Ct.continuePrimaryKey=Ct.advance=We,ye(Lh)}});return at.onsuccess=Ut(function(ye){at.onsuccess=ue,ue()}),Ct.continue=bt,Ct.continuePrimaryKey=St,Ct.advance=wt,ue(),ya},Y(Ct)):Y(null)},rt)})},count:function(F){var R=F.query,H=F.trans,W=R.index,U=R.range;return new Promise(function(V,Y){var rt=H.objectStore(L),nt=W.isPrimaryKey?rt:rt.index(W.name),rt=_(U),nt=rt?nt.count(rt):nt.count();nt.onsuccess=Ut(function(it){return V(it.target.result)}),nt.onerror=tn(Y)})}}}var C,$,N,O=($=D,N=Gp((C=c).objectStoreNames),{schema:{name:C.name,tables:N.map(function(z){return $.objectStore(z)}).map(function(z){var I=z.keyPath,R=z.autoIncrement,L=a(I),F={},R={name:z.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:I==null,compound:L,keyPath:I,autoIncrement:R,unique:!0,extractKey:yh(I)},indexes:Gp(z.indexNames).map(function(H){return z.index(H)}).map(function(V){var W=V.name,U=V.unique,Y=V.multiEntry,V=V.keyPath,Y={name:W,compound:a(V),keyPath:V,unique:U,multiEntry:Y,extractKey:yh(V)};return F[or(V)]=Y}),getIndexByKeyPath:function(H){return F[or(H)]}};return F[":id"]=R.primaryKey,I!=null&&(F[or(I)]=R.primaryKey),R})},hasGetAll:0<N.length&&"getAll"in $.objectStore(N[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),D=O.schema,A=O.hasGetAll,O=D.tables.map(v),M={};return O.forEach(function(z){return M[z.name]=z}),{stack:"dbcore",transaction:c.transaction.bind(c),table:function(z){if(!M[z])throw new Error("Table '".concat(z,"' not found"));return M[z]},MIN_KEY:-1/0,MAX_KEY:rr(u),schema:D}}function vb(c,u,p,_){var v=p.IDBKeyRange;return p.indexedDB,{dbcore:(_=_b(u,v,_),c.dbcore.reduce(function(C,$){return $=$.create,n(n({},C),$(C))},_))}}function ra(c,_){var p=_.db,_=vb(c._middlewares,p,c._deps,_);c.core=_.dbcore,c.tables.forEach(function(v){var C=v.name;c.core.schema.tables.some(function($){return $.name===C})&&(v.core=c.core.table(C),c[C]instanceof c.Table&&(c[C].core=v.core))})}function oa(c,u,p,_){p.forEach(function(v){var C=_[v];u.forEach(function($){var N=function D(A,O){return x(A,O)||(A=h(A))&&D(A,O)}($,v);(!N||"value"in N&&N.value===void 0)&&($===c.Transaction.prototype||$ instanceof c.Transaction?b($,v,{get:function(){return this.table(v)},set:function(D){y(this,v,{value:D,writable:!0,configurable:!0,enumerable:!0})}}):$[v]=new c.Table(v,C))})})}function _h(c,u){u.forEach(function(p){for(var _ in p)p[_]instanceof c.Table&&delete p[_]})}function bb(c,u){return c._cfg.version-u._cfg.version}function wb(c,u,p,_){var v=c._dbSchema;p.objectStoreNames.contains("$meta")&&!v.$meta&&(v.$meta=gh("$meta",Qp("")[0],[]),c._storeNames.push("$meta"));var C=c._createTransaction("readwrite",c._storeNames,v);C.create(p),C._completion.catch(_);var $=C._reject.bind(C),N=ut.transless||ut;Hn(function(){return ut.trans=C,ut.transless=N,u!==0?(ra(c,p),A=u,((D=C).storeNames.includes("$meta")?D.table("$meta").get("version").then(function(O){return O??A}):lt.resolve(A)).then(function(O){return z=O,I=C,L=p,F=[],O=(M=c)._versions,R=M._dbSchema=la(0,M.idbdb,L),(O=O.filter(function(H){return H._cfg.version>=z})).length!==0?(O.forEach(function(H){F.push(function(){var W=R,U=H._cfg.dbschema;ca(M,W,L),ca(M,U,L),R=M._dbSchema=U;var V=vh(W,U);V.add.forEach(function(ot){bh(L,ot[0],ot[1].primKey,ot[1].indexes)}),V.change.forEach(function(ot){if(ot.recreate)throw new dt.Upgrade("Not yet support for changing primary key");var at=L.objectStore(ot.name);ot.add.forEach(function(ft){return aa(at,ft)}),ot.change.forEach(function(ft){at.deleteIndex(ft.name),aa(at,ft)}),ot.del.forEach(function(ft){return at.deleteIndex(ft)})});var Y=H._cfg.contentUpgrade;if(Y&&H._cfg.version>z){ra(M,L),I._memoizedTables={};var rt=Z(U);V.del.forEach(function(ot){rt[ot]=W[ot]}),_h(M,[M.Transaction.prototype]),oa(M,[M.Transaction.prototype],o(rt),rt),I.schema=rt;var nt,it=Mt(Y);return it&&Ji(),V=lt.follow(function(){var ot;(nt=Y(I))&&it&&(ot=Wn.bind(null,null),nt.then(ot,ot))}),nt&&typeof nt.then=="function"?lt.resolve(nt):V.then(function(){return nt})}}),F.push(function(W){var U,V,Y=H._cfg.dbschema;U=Y,V=W,[].slice.call(V.db.objectStoreNames).forEach(function(rt){return U[rt]==null&&V.db.deleteObjectStore(rt)}),_h(M,[M.Transaction.prototype]),oa(M,[M.Transaction.prototype],M._storeNames,M._dbSchema),I.schema=M._dbSchema}),F.push(function(W){M.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(M.idbdb.version/10)===H._cfg.version?(M.idbdb.deleteObjectStore("$meta"),delete M._dbSchema.$meta,M._storeNames=M._storeNames.filter(function(U){return U!=="$meta"})):W.objectStore("$meta").put(H._cfg.version,"version"))})}),function H(){return F.length?lt.resolve(F.shift()(I.idbtrans)).then(H):lt.resolve()}().then(function(){Yp(R,L)})):lt.resolve();var M,z,I,L,F,R}).catch($)):(o(v).forEach(function(O){bh(p,O,v[O].primKey,v[O].indexes)}),ra(c,p),void lt.follow(function(){return c.on.populate.fire(C)}).catch($));var D,A})}function Cb(c,u){Yp(c._dbSchema,u),u.db.version%10!=0||u.objectStoreNames.contains("$meta")||u.db.createObjectStore("$meta").add(Math.ceil(u.db.version/10-1),"version");var p=la(0,c.idbdb,u);ca(c,c._dbSchema,u);for(var _=0,v=vh(p,c._dbSchema).change;_<v.length;_++){var C=function($){if($.change.length||$.recreate)return console.warn("Unable to patch indexes of table ".concat($.name," because it has changes on the type of index or primary key.")),{value:void 0};var N=u.objectStore($.name);$.add.forEach(function(D){Je&&console.debug("Dexie upgrade patch: Creating missing index ".concat($.name,".").concat(D.src)),aa(N,D)})}(v[_]);if(typeof C=="object")return C.value}}function vh(c,u){var p,_={del:[],add:[],change:[]};for(p in c)u[p]||_.del.push(p);for(p in u){var v=c[p],C=u[p];if(v){var $={name:p,def:C,recreate:!1,del:[],add:[],change:[]};if(""+(v.primKey.keyPath||"")!=""+(C.primKey.keyPath||"")||v.primKey.auto!==C.primKey.auto)$.recreate=!0,_.change.push($);else{var N=v.idxByName,D=C.idxByName,A=void 0;for(A in N)D[A]||$.del.push(A);for(A in D){var O=N[A],M=D[A];O?O.src!==M.src&&$.change.push(M):$.add.push(M)}(0<$.del.length||0<$.add.length||0<$.change.length)&&_.change.push($)}}else _.add.push([p,C])}return _}function bh(c,u,p,_){var v=c.db.createObjectStore(u,p.keyPath?{keyPath:p.keyPath,autoIncrement:p.auto}:{autoIncrement:p.auto});return _.forEach(function(C){return aa(v,C)}),v}function Yp(c,u){o(c).forEach(function(p){u.db.objectStoreNames.contains(p)||(Je&&console.debug("Dexie: Creating missing table",p),bh(u,p,c[p].primKey,c[p].indexes))})}function aa(c,u){c.createIndex(u.name,u.keyPath,{unique:u.unique,multiEntry:u.multi})}function la(c,u,p){var _={};return T(u.objectStoreNames,0).forEach(function(v){for(var C=p.objectStore(v),$=mh(qp(A=C.keyPath),A||"",!0,!1,!!C.autoIncrement,A&&typeof A!="string",!0),N=[],D=0;D<C.indexNames.length;++D){var O=C.index(C.indexNames[D]),A=O.keyPath,O=mh(O.name,A,!!O.unique,!!O.multiEntry,!1,A&&typeof A!="string",!1);N.push(O)}_[v]=gh(v,$,N)}),_}function ca(c,u,p){for(var _=p.db.objectStoreNames,v=0;v<_.length;++v){var C=_[v],$=p.objectStore(C);c._hasGetAll="getAll"in $;for(var N=0;N<$.indexNames.length;++N){var D=$.indexNames[N],A=$.index(D).keyPath,O=typeof A=="string"?A:"["+T(A).join("+")+"]";!u[C]||(A=u[C].idxByName[O])&&(A.name=D,delete u[C].idxByName[O],u[C].idxByName[D]=A)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&r.WorkerGlobalScope&&r instanceof r.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(c._hasGetAll=!1)}function Qp(c){return c.split(",").map(function(u,p){var _=(u=u.trim()).replace(/([&*]|\+\+)/g,""),v=/^\[/.test(_)?_.match(/^\[(.*)\]$/)[1].split("+"):_;return mh(_,v||null,/\&/.test(u),/\*/.test(u),/\+\+/.test(u),a(v),p===0)})}var kb=(ha.prototype._parseStoresSpec=function(c,u){o(c).forEach(function(p){if(c[p]!==null){var _=Qp(c[p]),v=_.shift();if(v.unique=!0,v.multi)throw new dt.Schema("Primary key cannot be multi-valued");_.forEach(function(C){if(C.auto)throw new dt.Schema("Only primary key can be marked as autoIncrement (++)");if(!C.keyPath)throw new dt.Schema("Index must have a name and cannot be an empty string")}),u[p]=gh(p,v,_)}})},ha.prototype.stores=function(p){var u=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,p):p;var p=u._versions,_={},v={};return p.forEach(function(C){l(_,C._cfg.storesSource),v=C._cfg.dbschema={},C._parseStoresSpec(_,v)}),u._dbSchema=v,_h(u,[u._allTables,u,u.Transaction.prototype]),oa(u,[u._allTables,u,u.Transaction.prototype,this._cfg.tables],o(v),v),u._storeNames=o(v),this},ha.prototype.upgrade=function(c){return this._cfg.contentUpgrade=Jc(this._cfg.contentUpgrade||Lt,c),this},ha);function ha(){}function wh(c,u){var p=c._dbNamesDB;return p||(p=c._dbNamesDB=new gn(ta,{addons:[],indexedDB:c,IDBKeyRange:u})).version(1).stores({dbnames:"name"}),p.table("dbnames")}function Ch(c){return c&&typeof c.databases=="function"}function kh(c){return Hn(function(){return ut.letThrough=!0,c()})}function Sh(c){return!("from"in c)}var ce=function(c,u){if(!this){var p=new ce;return c&&"d"in c&&l(p,c),p}l(this,arguments.length?{d:1,from:c,to:1<arguments.length?u:c}:{d:0})};function ar(c,u,p){var _=At(u,p);if(!isNaN(_)){if(0<_)throw RangeError();if(Sh(c))return l(c,{from:u,to:p,d:1});var v=c.l,_=c.r;if(At(p,c.from)<0)return v?ar(v,u,p):c.l={from:u,to:p,d:1,l:null,r:null},Xp(c);if(0<At(u,c.to))return _?ar(_,u,p):c.r={from:u,to:p,d:1,l:null,r:null},Xp(c);At(u,c.from)<0&&(c.from=u,c.l=null,c.d=_?_.d+1:1),0<At(p,c.to)&&(c.to=p,c.r=null,c.d=c.l?c.l.d+1:1),p=!c.r,v&&!c.l&&lr(c,v),_&&p&&lr(c,_)}}function lr(c,u){Sh(u)||function p(_,D){var C=D.from,$=D.to,N=D.l,D=D.r;ar(_,C,$),N&&p(_,N),D&&p(_,D)}(c,u)}function ua(c,u){var p=xh(u),_=p.next();if(_.done)return!1;for(var v=_.value,C=xh(c),$=C.next(v.from),N=$.value;!_.done&&!$.done;){if(At(N.from,v.to)<=0&&0<=At(N.to,v.from))return!0;At(v.from,N.from)<0?v=(_=p.next(N.from)).value:N=($=C.next(v.from)).value}return!1}function xh(c){var u=Sh(c)?null:{s:0,n:c};return{next:function(p){for(var _=0<arguments.length;u;)switch(u.s){case 0:if(u.s=1,_)for(;u.n.l&&At(p,u.n.from)<0;)u={up:u,n:u.n.l,s:1};else for(;u.n.l;)u={up:u,n:u.n.l,s:1};case 1:if(u.s=2,!_||At(p,u.n.to)<=0)return{value:u.n,done:!1};case 2:if(u.n.r){u.s=3,u={up:u,n:u.n.r,s:0};continue}case 3:u=u.up}return{done:!0}}}}function Xp(c){var u,p,_=(((u=c.r)===null||u===void 0?void 0:u.d)||0)-(((p=c.l)===null||p===void 0?void 0:p.d)||0),v=1<_?"r":_<-1?"l":"";v&&(u=v=="r"?"l":"r",p=n({},c),_=c[v],c.from=_.from,c.to=_.to,c[v]=_[v],p[v]=_[u],(c[u]=p).d=Zp(p)),c.d=Zp(c)}function Zp(p){var u=p.r,p=p.l;return(u?p?Math.max(u.d,p.d):u.d:p?p.d:0)+1}function da(c,u){return o(u).forEach(function(p){c[p]?lr(c[p],u[p]):c[p]=function _(v){var C,$,N={};for(C in v)d(v,C)&&($=v[C],N[C]=!$||typeof $!="object"||et.has($.constructor)?$:_($));return N}(u[p])}),c}function $h(c,u){return c.all||u.all||Object.keys(c).some(function(p){return u[p]&&ua(u[p],c[p])})}m(ce.prototype,((Oe={add:function(c){return lr(this,c),this},addKey:function(c){return ar(this,c,c),this},addKeys:function(c){var u=this;return c.forEach(function(p){return ar(u,p,p)}),this}})[Dt]=function(){return xh(this)},Oe));var yi={},Th={},Nh=!1;function fa(c){da(Th,c),Nh||(Nh=!0,setTimeout(function(){Nh=!1,Eh(Th,!(Th={}))},0))}function Eh(c,u){u===void 0&&(u=!1);var p=new Set;if(c.all)for(var _=0,v=Object.values(yi);_<v.length;_++)Jp($=v[_],c,p,u);else for(var C in c){var $,N=/^idb\:\/\/(.*)\/(.*)\//.exec(C);N&&(C=N[1],N=N[2],($=yi["idb://".concat(C,"/").concat(N)])&&Jp($,c,p,u))}p.forEach(function(D){return D()})}function Jp(c,u,p,_){for(var v=[],C=0,$=Object.entries(c.queries.query);C<$.length;C++){for(var N=$[C],D=N[0],A=[],O=0,M=N[1];O<M.length;O++){var z=M[O];$h(u,z.obsSet)?z.subscribers.forEach(function(R){return p.add(R)}):_&&A.push(z)}_&&v.push([D,A])}if(_)for(var I=0,L=v;I<L.length;I++){var F=L[I],D=F[0],A=F[1];c.queries.query[D]=A}}function Sb(c){var u=c._state,p=c._deps.indexedDB;if(u.isBeingOpened||c.idbdb)return u.dbReadyPromise.then(function(){return u.dbOpenError?qt(u.dbOpenError):c});u.isBeingOpened=!0,u.dbOpenError=null,u.openComplete=!1;var _=u.openCanceller,v=Math.round(10*c.verno),C=!1;function $(){if(u.openCanceller!==_)throw new dt.DatabaseClosed("db.open() was cancelled")}function N(){return new lt(function(z,I){if($(),!p)throw new dt.MissingAPI;var L=c.name,F=u.autoSchema||!v?p.open(L):p.open(L,v);if(!F)throw new dt.MissingAPI;F.onerror=tn(I),F.onblocked=Ut(c._fireOnBlocked),F.onupgradeneeded=Ut(function(R){var H;O=F.transaction,u.autoSchema&&!c._options.allowEmptyDB?(F.onerror=ir,O.abort(),F.result.close(),(H=p.deleteDatabase(L)).onsuccess=H.onerror=Ut(function(){I(new dt.NoSuchDatabase("Database ".concat(L," doesnt exist")))})):(O.onerror=tn(I),R=R.oldVersion>Math.pow(2,62)?0:R.oldVersion,M=R<1,c.idbdb=F.result,C&&Cb(c,O),wb(c,R/10,O,I))},I),F.onsuccess=Ut(function(){O=null;var R,H,W,U,V,Y=c.idbdb=F.result,rt=T(Y.objectStoreNames);if(0<rt.length)try{var nt=Y.transaction((U=rt).length===1?U[0]:U,"readonly");if(u.autoSchema)H=Y,W=nt,(R=c).verno=H.version/10,W=R._dbSchema=la(0,H,W),R._storeNames=T(H.objectStoreNames,0),oa(R,[R._allTables],o(W),W);else if(ca(c,c._dbSchema,nt),((V=vh(la(0,(V=c).idbdb,nt),V._dbSchema)).add.length||V.change.some(function(it){return it.add.length||it.change.length}))&&!C)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Y.close(),v=Y.version+1,C=!0,z(N());ra(c,nt)}catch{}ts.push(c),Y.onversionchange=Ut(function(it){u.vcFired=!0,c.on("versionchange").fire(it)}),Y.onclose=Ut(function(it){c.on("close").fire(it)}),M&&(V=c._deps,nt=L,Y=V.indexedDB,V=V.IDBKeyRange,Ch(Y)||nt===ta||wh(Y,V).put({name:nt}).catch(Lt)),z()},I)}).catch(function(z){switch(z==null?void 0:z.name){case"UnknownError":if(0<u.PR1398_maxLoop)return u.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),N();break;case"VersionError":if(0<v)return v=0,N()}return lt.reject(z)})}var D,A=u.dbReadyResolve,O=null,M=!1;return lt.race([_,(typeof navigator>"u"?lt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(z){function I(){return indexedDB.databases().finally(z)}D=setInterval(I,100),I()}).finally(function(){return clearInterval(D)}):Promise.resolve()).then(N)]).then(function(){return $(),u.onReadyBeingFired=[],lt.resolve(kh(function(){return c.on.ready.fire(c.vip)})).then(function z(){if(0<u.onReadyBeingFired.length){var I=u.onReadyBeingFired.reduce(Jc,Lt);return u.onReadyBeingFired=[],lt.resolve(kh(function(){return I(c.vip)})).then(z)}})}).finally(function(){u.openCanceller===_&&(u.onReadyBeingFired=null,u.isBeingOpened=!1)}).catch(function(z){u.dbOpenError=z;try{O&&O.abort()}catch{}return _===u.openCanceller&&c._close(),qt(z)}).finally(function(){u.openComplete=!0,A()}).then(function(){var z;return M&&(z={},c.tables.forEach(function(I){I.schema.indexes.forEach(function(L){L.name&&(z["idb://".concat(c.name,"/").concat(I.name,"/").concat(L.name)]=new ce(-1/0,[[[]]]))}),z["idb://".concat(c.name,"/").concat(I.name,"/")]=z["idb://".concat(c.name,"/").concat(I.name,"/:dels")]=new ce(-1/0,[[[]]])}),Vn(sr).fire(z),Eh(z,!0)),c})}function Mh(c){function u(C){return c.next(C)}var p=v(u),_=v(function(C){return c.throw(C)});function v(C){return function(D){var N=C(D),D=N.value;return N.done?D:D&&typeof D.then=="function"?D.then(p,_):a(D)?Promise.all(D).then(p,_):p(D)}}return v(u)()}function pa(c,u,p){for(var _=a(c)?c.slice():[c],v=0;v<p;++v)_.push(u);return _}var xb={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(c){return n(n({},c),{table:function(u){var p=c.table(u),_=p.schema,v={},C=[];function $(M,z,I){var L=or(M),F=v[L]=v[L]||[],R=M==null?0:typeof M=="string"?1:M.length,H=0<z,H=n(n({},I),{name:H?"".concat(L,"(virtual-from:").concat(I.name,")"):I.name,lowLevelIndex:I,isVirtual:H,keyTail:z,keyLength:R,extractKey:yh(M),unique:!H&&I.unique});return F.push(H),H.isPrimaryKey||C.push(H),1<R&&$(R===2?M[0]:M.slice(0,R-1),z+1,I),F.sort(function(W,U){return W.keyTail-U.keyTail}),H}u=$(_.primaryKey.keyPath,0,_.primaryKey),v[":id"]=[u];for(var N=0,D=_.indexes;N<D.length;N++){var A=D[N];$(A.keyPath,0,A)}function O(M){var z,I=M.query.index;return I.isVirtual?n(n({},M),{query:{index:I.lowLevelIndex,range:(z=M.query.range,I=I.keyTail,{type:z.type===1?2:z.type,lower:pa(z.lower,z.lowerOpen?c.MAX_KEY:c.MIN_KEY,I),lowerOpen:!0,upper:pa(z.upper,z.upperOpen?c.MIN_KEY:c.MAX_KEY,I),upperOpen:!0})}}):M}return n(n({},p),{schema:n(n({},_),{primaryKey:u,indexes:C,getIndexByKeyPath:function(M){return(M=v[or(M)])&&M[0]}}),count:function(M){return p.count(O(M))},query:function(M){return p.query(O(M))},openCursor:function(M){var z=M.query.index,I=z.keyTail,L=z.isVirtual,F=z.keyLength;return L?p.openCursor(O(M)).then(function(H){return H&&R(H)}):p.openCursor(M);function R(H){return Object.create(H,{continue:{value:function(W){W!=null?H.continue(pa(W,M.reverse?c.MAX_KEY:c.MIN_KEY,I)):M.unique?H.continue(H.key.slice(0,F).concat(M.reverse?c.MIN_KEY:c.MAX_KEY,I)):H.continue()}},continuePrimaryKey:{value:function(W,U){H.continuePrimaryKey(pa(W,c.MAX_KEY,I),U)}},primaryKey:{get:function(){return H.primaryKey}},key:{get:function(){var W=H.key;return F===1?W[0]:W.slice(0,F)}},value:{get:function(){return H.value}}})}}})}})}};function Ph(c,u,p,_){return p=p||{},_=_||"",o(c).forEach(function(v){var C,$,N;d(u,v)?(C=c[v],$=u[v],typeof C=="object"&&typeof $=="object"&&C&&$?(N=Rt(C))!==Rt($)?p[_+v]=u[v]:N==="Object"?Ph(C,$,p,_+v+"."):C!==$&&(p[_+v]=u[v]):C!==$&&(p[_+v]=u[v])):p[_+v]=void 0}),o(u).forEach(function(v){d(c,v)||(p[_+v]=u[v])}),p}function Ah(c,u){return u.type==="delete"?u.keys:u.keys||u.values.map(c.extractKey)}var $b={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(c){return n(n({},c),{table:function(u){var p=c.table(u),_=p.schema.primaryKey;return n(n({},p),{mutate:function(v){var C=ut.trans,$=C.table(u).hook,N=$.deleting,D=$.creating,A=$.updating;switch(v.type){case"add":if(D.fire===Lt)break;return C._promise("readwrite",function(){return O(v)},!0);case"put":if(D.fire===Lt&&A.fire===Lt)break;return C._promise("readwrite",function(){return O(v)},!0);case"delete":if(N.fire===Lt)break;return C._promise("readwrite",function(){return O(v)},!0);case"deleteRange":if(N.fire===Lt)break;return C._promise("readwrite",function(){return function M(z,I,L){return p.query({trans:z,values:!1,query:{index:_,range:I},limit:L}).then(function(F){var R=F.result;return O({type:"delete",keys:R,trans:z}).then(function(H){return 0<H.numFailures?Promise.reject(H.failures[0]):R.length<L?{failures:[],numFailures:0,lastResult:void 0}:M(z,n(n({},I),{lower:R[R.length-1],lowerOpen:!0}),L)})})}(v.trans,v.range,1e4)},!0)}return p.mutate(v);function O(M){var z,I,L,F=ut.trans,R=M.keys||Ah(_,M);if(!R)throw new Error("Keys missing");return(M=M.type==="add"||M.type==="put"?n(n({},M),{keys:R}):n({},M)).type!=="delete"&&(M.values=s([],M.values,!0)),M.keys&&(M.keys=s([],M.keys,!0)),z=p,L=R,((I=M).type==="add"?Promise.resolve([]):z.getMany({trans:I.trans,keys:L,cache:"immutable"})).then(function(H){var W=R.map(function(U,V){var Y,rt,nt,it=H[V],ot={onerror:null,onsuccess:null};return M.type==="delete"?N.fire.call(ot,U,it,F):M.type==="add"||it===void 0?(Y=D.fire.call(ot,U,M.values[V],F),U==null&&Y!=null&&(M.keys[V]=U=Y,_.outbound||Q(M.values[V],_.keyPath,U))):(Y=Ph(it,M.values[V]),(rt=A.fire.call(ot,Y,U,it,F))&&(nt=M.values[V],Object.keys(rt).forEach(function(at){d(nt,at)?nt[at]=rt[at]:Q(nt,at,rt[at])}))),ot});return p.mutate(M).then(function(U){for(var V=U.failures,Y=U.results,rt=U.numFailures,U=U.lastResult,nt=0;nt<R.length;++nt){var it=(Y||R)[nt],ot=W[nt];it==null?ot.onerror&&ot.onerror(V[nt]):ot.onsuccess&&ot.onsuccess(M.type==="put"&&H[nt]?M.values[nt]:it)}return{failures:V,results:Y,numFailures:rt,lastResult:U}}).catch(function(U){return W.forEach(function(V){return V.onerror&&V.onerror(U)}),Promise.reject(U)})})}}})}})}};function tm(c,u,p){try{if(!u||u.keys.length<c.length)return null;for(var _=[],v=0,C=0;v<u.keys.length&&C<c.length;++v)At(u.keys[v],c[C])===0&&(_.push(p?pt(u.values[v]):u.values[v]),++C);return _.length===c.length?_:null}catch{return null}}var Tb={stack:"dbcore",level:-1,create:function(c){return{table:function(u){var p=c.table(u);return n(n({},p),{getMany:function(_){if(!_.cache)return p.getMany(_);var v=tm(_.keys,_.trans._cache,_.cache==="clone");return v?lt.resolve(v):p.getMany(_).then(function(C){return _.trans._cache={keys:_.keys,values:_.cache==="clone"?pt(C):C},C})},mutate:function(_){return _.type!=="add"&&(_.trans._cache=null),p.mutate(_)}})}}}};function em(c,u){return c.trans.mode==="readonly"&&!!c.subscr&&!c.trans.explicit&&c.trans.db._options.cache!=="disabled"&&!u.schema.primaryKey.outbound}function nm(c,u){switch(c){case"query":return u.values&&!u.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Nb={stack:"dbcore",level:0,name:"Observability",create:function(c){var u=c.schema.name,p=new ce(c.MIN_KEY,c.MAX_KEY);return n(n({},c),{transaction:function(_,v,C){if(ut.subscr&&v!=="readonly")throw new dt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ut.querier));return c.transaction(_,v,C)},table:function(_){var v=c.table(_),C=v.schema,$=C.primaryKey,M=C.indexes,N=$.extractKey,D=$.outbound,A=$.autoIncrement&&M.filter(function(I){return I.compound&&I.keyPath.includes($.keyPath)}),O=n(n({},v),{mutate:function(I){function L(at){return at="idb://".concat(u,"/").concat(_,"/").concat(at),U[at]||(U[at]=new ce)}var F,R,H,W=I.trans,U=I.mutatedParts||(I.mutatedParts={}),V=L(""),Y=L(":dels"),rt=I.type,ot=I.type==="deleteRange"?[I.range]:I.type==="delete"?[I.keys]:I.values.length<50?[Ah($,I).filter(function(at){return at}),I.values]:[],nt=ot[0],it=ot[1],ot=I.trans._cache;return a(nt)?(V.addKeys(nt),(ot=rt==="delete"||nt.length===it.length?tm(nt,ot):null)||Y.addKeys(nt),(ot||it)&&(F=L,R=ot,H=it,C.indexes.forEach(function(at){var ft=F(at.name||"");function bt(wt){return wt!=null?at.extractKey(wt):null}function St(wt){return at.multiEntry&&a(wt)?wt.forEach(function(We){return ft.addKey(We)}):ft.addKey(wt)}(R||H).forEach(function(wt,he){var Ct=R&&bt(R[he]),he=H&&bt(H[he]);At(Ct,he)!==0&&(Ct!=null&&St(Ct),he!=null&&St(he))})}))):nt?(it={from:nt.lower,to:nt.upper},Y.add(it),V.add(it)):(V.add(p),Y.add(p),C.indexes.forEach(function(at){return L(at.name).add(p)})),v.mutate(I).then(function(at){return!nt||I.type!=="add"&&I.type!=="put"||(V.addKeys(at.results),A&&A.forEach(function(ft){var bt=I.values.map(function(wt){return ft.extractKey(wt)}),St=ft.keyPath.findIndex(function(wt){return wt===$.keyPath});at.results.forEach(function(wt){return bt[St]=wt}),L(ft.name).addKeys(bt)})),W.mutatedParts=da(W.mutatedParts||{},U),at})}}),M=function(L){var F=L.query,L=F.index,F=F.range;return[L,new ce((L=F.lower)!==null&&L!==void 0?L:c.MIN_KEY,(F=F.upper)!==null&&F!==void 0?F:c.MAX_KEY)]},z={get:function(I){return[$,new ce(I.key)]},getMany:function(I){return[$,new ce().addKeys(I.keys)]},count:M,query:M,openCursor:M};return o(z).forEach(function(I){O[I]=function(L){var F=ut.subscr,R=!!F,H=em(ut,v)&&nm(I,L)?L.obsSet={}:F;if(R){var W=function(it){return it="idb://".concat(u,"/").concat(_,"/").concat(it),H[it]||(H[it]=new ce)},U=W(""),V=W(":dels"),F=z[I](L),R=F[0],F=F[1];if((I==="query"&&R.isPrimaryKey&&!L.values?V:W(R.name||"")).add(F),!R.isPrimaryKey){if(I!=="count"){var Y=I==="query"&&D&&L.values&&v.query(n(n({},L),{values:!1}));return v[I].apply(this,arguments).then(function(it){if(I==="query"){if(D&&L.values)return Y.then(function(bt){return bt=bt.result,U.addKeys(bt),it});var ot=L.values?it.result.map(N):it.result;(L.values?U:V).addKeys(ot)}else if(I==="openCursor"){var at=it,ft=L.values;return at&&Object.create(at,{key:{get:function(){return V.addKey(at.primaryKey),at.key}},primaryKey:{get:function(){var bt=at.primaryKey;return V.addKey(bt),bt}},value:{get:function(){return ft&&U.addKey(at.primaryKey),at.value}}})}return it})}V.add(p)}}return v[I].apply(this,arguments)}}),O}})}};function im(c,u,p){if(p.numFailures===0)return u;if(u.type==="deleteRange")return null;var _=u.keys?u.keys.length:"values"in u&&u.values?u.values.length:1;return p.numFailures===_?null:(u=n({},u),a(u.keys)&&(u.keys=u.keys.filter(function(v,C){return!(C in p.failures)})),"values"in u&&a(u.values)&&(u.values=u.values.filter(function(v,C){return!(C in p.failures)})),u)}function Ih(c,u){return p=c,((_=u).lower===void 0||(_.lowerOpen?0<At(p,_.lower):0<=At(p,_.lower)))&&(c=c,(u=u).upper===void 0||(u.upperOpen?At(c,u.upper)<0:At(c,u.upper)<=0));var p,_}function sm(c,u,z,_,v,C){if(!z||z.length===0)return c;var $=u.query.index,N=$.multiEntry,D=u.query.range,A=_.schema.primaryKey.extractKey,O=$.extractKey,M=($.lowLevelIndex||$).extractKey,z=z.reduce(function(I,L){var F=I,R=L.type==="add"||L.type==="put"?L.values.filter(function(V){return V=O(V),N&&a(V)?V.some(function(Y){return Ih(Y,D)}):Ih(V,D)}).map(function(V){return V=pt(V),C&&Object.freeze(V),V}):[];switch(L.type){case"add":F=I.concat(u.values?R:R.map(function(Y){return A(Y)}));break;case"put":var H=new ce().addKeys(L.values.map(function(Y){return A(Y)})),F=I.filter(function(Y){return Y=u.values?A(Y):Y,!ua(new ce(Y),H)}).concat(u.values?R:R.map(function(Y){return A(Y)}));break;case"delete":var W=new ce().addKeys(L.keys);F=I.filter(function(Y){return Y=u.values?A(Y):Y,!ua(new ce(Y),W)});break;case"deleteRange":var U=L.range;F=I.filter(function(Y){return!Ih(A(Y),U)})}return F},c);return z===c?c:(z.sort(function(I,L){return At(M(I),M(L))||At(A(I),A(L))}),u.limit&&u.limit<1/0&&(z.length>u.limit?z.length=u.limit:c.length===u.limit&&z.length<u.limit&&(v.dirty=!0)),C?Object.freeze(z):z)}function rm(c,u){return At(c.lower,u.lower)===0&&At(c.upper,u.upper)===0&&!!c.lowerOpen==!!u.lowerOpen&&!!c.upperOpen==!!u.upperOpen}function Eb(c,u){return function(p,_,v,C){if(p===void 0)return _!==void 0?-1:0;if(_===void 0)return 1;if((_=At(p,_))===0){if(v&&C)return 0;if(v)return 1;if(C)return-1}return _}(c.lower,u.lower,c.lowerOpen,u.lowerOpen)<=0&&0<=function(p,_,v,C){if(p===void 0)return _!==void 0?1:0;if(_===void 0)return-1;if((_=At(p,_))===0){if(v&&C)return 0;if(v)return-1;if(C)return 1}return _}(c.upper,u.upper,c.upperOpen,u.upperOpen)}function Mb(c,u,p,_){c.subscribers.add(p),_.addEventListener("abort",function(){var v,C;c.subscribers.delete(p),c.subscribers.size===0&&(v=c,C=u,setTimeout(function(){v.subscribers.size===0&&J(C,v)},3e3))})}var Pb={stack:"dbcore",level:0,name:"Cache",create:function(c){var u=c.schema.name;return n(n({},c),{transaction:function(p,_,v){var C,$,N=c.transaction(p,_,v);return _==="readwrite"&&($=(C=new AbortController).signal,v=function(D){return function(){if(C.abort(),_==="readwrite"){for(var A=new Set,O=0,M=p;O<M.length;O++){var z=M[O],I=yi["idb://".concat(u,"/").concat(z)];if(I){var L=c.table(z),F=I.optimisticOps.filter(function(ft){return ft.trans===N});if(N._explicit&&D&&N.mutatedParts)for(var R=0,H=Object.values(I.queries.query);R<H.length;R++)for(var W=0,U=(rt=H[R]).slice();W<U.length;W++)$h((nt=U[W]).obsSet,N.mutatedParts)&&(J(rt,nt),nt.subscribers.forEach(function(ft){return A.add(ft)}));else if(0<F.length){I.optimisticOps=I.optimisticOps.filter(function(ft){return ft.trans!==N});for(var V=0,Y=Object.values(I.queries.query);V<Y.length;V++)for(var rt,nt,it,ot=0,at=(rt=Y[V]).slice();ot<at.length;ot++)(nt=at[ot]).res!=null&&N.mutatedParts&&(D&&!nt.dirty?(it=Object.isFrozen(nt.res),it=sm(nt.res,nt.req,F,L,nt,it),nt.dirty?(J(rt,nt),nt.subscribers.forEach(function(ft){return A.add(ft)})):it!==nt.res&&(nt.res=it,nt.promise=lt.resolve({result:it}))):(nt.dirty&&J(rt,nt),nt.subscribers.forEach(function(ft){return A.add(ft)})))}}}A.forEach(function(ft){return ft()})}}},N.addEventListener("abort",v(!1),{signal:$}),N.addEventListener("error",v(!1),{signal:$}),N.addEventListener("complete",v(!0),{signal:$})),N},table:function(p){var _=c.table(p),v=_.schema.primaryKey;return n(n({},_),{mutate:function(C){var $=ut.trans;if(v.outbound||$.db._options.cache==="disabled"||$.explicit)return _.mutate(C);var N=yi["idb://".concat(u,"/").concat(p)];return N?($=_.mutate(C),C.type!=="add"&&C.type!=="put"||!(50<=C.values.length||Ah(v,C).some(function(D){return D==null}))?(N.optimisticOps.push(C),C.mutatedParts&&fa(C.mutatedParts),$.then(function(D){0<D.numFailures&&(J(N.optimisticOps,C),(D=im(0,C,D))&&N.optimisticOps.push(D),C.mutatedParts&&fa(C.mutatedParts))}),$.catch(function(){J(N.optimisticOps,C),C.mutatedParts&&fa(C.mutatedParts)})):$.then(function(D){var A=im(0,n(n({},C),{values:C.values.map(function(I,M){var z,I=(z=v.keyPath)!==null&&z!==void 0&&z.includes(".")?pt(I):n({},I);return Q(I,v.keyPath,D.results[M]),I})}),D);N.optimisticOps.push(A),queueMicrotask(function(){return C.mutatedParts&&fa(C.mutatedParts)})}),$):_.mutate(C)},query:function(C){if(!em(ut,_)||!nm("query",C))return _.query(C);var $=((A=ut.trans)===null||A===void 0?void 0:A.db._options.cache)==="immutable",M=ut,N=M.requery,D=M.signal,A=function(L,F,R,H){var W=yi["idb://".concat(L,"/").concat(F)];if(!W)return[];if(!(F=W.queries[R]))return[null,!1,W,null];var U=F[(H.query?H.query.index.name:null)||""];if(!U)return[null,!1,W,null];switch(R){case"query":var V=U.find(function(Y){return Y.req.limit===H.limit&&Y.req.values===H.values&&rm(Y.req.query.range,H.query.range)});return V?[V,!0,W,U]:[U.find(function(Y){return("limit"in Y.req?Y.req.limit:1/0)>=H.limit&&(!H.values||Y.req.values)&&Eb(Y.req.query.range,H.query.range)}),!1,W,U];case"count":return V=U.find(function(Y){return rm(Y.req.query.range,H.query.range)}),[V,!!V,W,U]}}(u,p,"query",C),O=A[0],M=A[1],z=A[2],I=A[3];return O&&M?O.obsSet=C.obsSet:(M=_.query(C).then(function(L){var F=L.result;if(O&&(O.res=F),$){for(var R=0,H=F.length;R<H;++R)Object.freeze(F[R]);Object.freeze(F)}else L.result=pt(F);return L}).catch(function(L){return I&&O&&J(I,O),Promise.reject(L)}),O={obsSet:C.obsSet,promise:M,subscribers:new Set,type:"query",req:C,dirty:!1},I?I.push(O):(I=[O],(z=z||(yi["idb://".concat(u,"/").concat(p)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[C.query.index.name||""]=I)),Mb(O,I,N,D),O.promise.then(function(L){return{result:sm(L.result,C,z==null?void 0:z.optimisticOps,_,O,$)}})}})}})}};function ma(c,u){return new Proxy(c,{get:function(p,_,v){return _==="db"?u:Reflect.get(p,_,v)}})}var gn=(Gt.prototype.version=function(c){if(isNaN(c)||c<.1)throw new dt.Type("Given version is not a positive number");if(c=Math.round(10*c)/10,this.idbdb||this._state.isBeingOpened)throw new dt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,c);var u=this._versions,p=u.filter(function(_){return _._cfg.version===c})[0];return p||(p=new this.Version(c),u.push(p),u.sort(bb),p.stores({}),this._state.autoSchema=!1,p)},Gt.prototype._whenReady=function(c){var u=this;return this.idbdb&&(this._state.openComplete||ut.letThrough||this._vip)?c():new lt(function(p,_){if(u._state.openComplete)return _(new dt.DatabaseClosed(u._state.dbOpenError));if(!u._state.isBeingOpened){if(!u._state.autoOpen)return void _(new dt.DatabaseClosed);u.open().catch(Lt)}u._state.dbReadyPromise.then(p,_)}).then(c)},Gt.prototype.use=function(c){var u=c.stack,p=c.create,_=c.level,v=c.name;return v&&this.unuse({stack:u,name:v}),c=this._middlewares[u]||(this._middlewares[u]=[]),c.push({stack:u,create:p,level:_??10,name:v}),c.sort(function(C,$){return C.level-$.level}),this},Gt.prototype.unuse=function(c){var u=c.stack,p=c.name,_=c.create;return u&&this._middlewares[u]&&(this._middlewares[u]=this._middlewares[u].filter(function(v){return _?v.create!==_:!!p&&v.name!==p})),this},Gt.prototype.open=function(){var c=this;return pi(Bn,function(){return Sb(c)})},Gt.prototype._close=function(){var c=this._state,u=ts.indexOf(this);if(0<=u&&ts.splice(u,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}c.isBeingOpened||(c.dbReadyPromise=new lt(function(p){c.dbReadyResolve=p}),c.openCanceller=new lt(function(p,_){c.cancelOpen=_}))},Gt.prototype.close=function(p){var u=(p===void 0?{disableAutoOpen:!0}:p).disableAutoOpen,p=this._state;u?(p.isBeingOpened&&p.cancelOpen(new dt.DatabaseClosed),this._close(),p.autoOpen=!1,p.dbOpenError=new dt.DatabaseClosed):(this._close(),p.autoOpen=this._options.autoOpen||p.isBeingOpened,p.openComplete=!1,p.dbOpenError=null)},Gt.prototype.delete=function(c){var u=this;c===void 0&&(c={disableAutoOpen:!0});var p=0<arguments.length&&typeof arguments[0]!="object",_=this._state;return new lt(function(v,C){function $(){u.close(c);var N=u._deps.indexedDB.deleteDatabase(u.name);N.onsuccess=Ut(function(){var D,A,O;D=u._deps,A=u.name,O=D.indexedDB,D=D.IDBKeyRange,Ch(O)||A===ta||wh(O,D).delete(A).catch(Lt),v()}),N.onerror=tn(C),N.onblocked=u._fireOnBlocked}if(p)throw new dt.InvalidArgument("Invalid closeOptions argument to db.delete()");_.isBeingOpened?_.dbReadyPromise.then($):$()})},Gt.prototype.backendDB=function(){return this.idbdb},Gt.prototype.isOpen=function(){return this.idbdb!==null},Gt.prototype.hasBeenClosed=function(){var c=this._state.dbOpenError;return c&&c.name==="DatabaseClosed"},Gt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Gt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Gt.prototype,"tables",{get:function(){var c=this;return o(this._allTables).map(function(u){return c._allTables[u]})},enumerable:!1,configurable:!0}),Gt.prototype.transaction=function(){var c=(function(u,p,_){var v=arguments.length;if(v<2)throw new dt.InvalidArgument("Too few arguments");for(var C=new Array(v-1);--v;)C[v-1]=arguments[v];return _=C.pop(),[u,X(C),_]}).apply(this,arguments);return this._transaction.apply(this,c)},Gt.prototype._transaction=function(c,u,p){var _=this,v=ut.trans;v&&v.db===this&&c.indexOf("!")===-1||(v=null);var C,$,N=c.indexOf("?")!==-1;c=c.replace("!","").replace("?","");try{if($=u.map(function(A){if(A=A instanceof _.Table?A.name:A,typeof A!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return A}),c=="r"||c===lh)C=lh;else{if(c!="rw"&&c!=ch)throw new dt.InvalidArgument("Invalid transaction mode: "+c);C=ch}if(v){if(v.mode===lh&&C===ch){if(!N)throw new dt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");v=null}v&&$.forEach(function(A){if(v&&v.storeNames.indexOf(A)===-1){if(!N)throw new dt.SubTransaction("Table "+A+" not included in parent transaction.");v=null}}),N&&v&&!v.active&&(v=null)}}catch(A){return v?v._promise(null,function(O,M){M(A)}):qt(A)}var D=(function A(O,M,z,I,L){return lt.resolve().then(function(){var F=ut.transless||ut,R=O._createTransaction(M,z,O._dbSchema,I);if(R.explicit=!0,F={trans:R,transless:F},I)R.idbtrans=I.idbtrans;else try{R.create(),R.idbtrans._explicit=!0,O._state.PR1398_maxLoop=3}catch(U){return U.name===jn.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return A(O,M,z,null,L)})):qt(U)}var H,W=Mt(L);return W&&Ji(),F=lt.follow(function(){var U;(H=L.call(R,R))&&(W?(U=Wn.bind(null,null),H.then(U,U)):typeof H.next=="function"&&typeof H.throw=="function"&&(H=Mh(H)))},F),(H&&typeof H.then=="function"?lt.resolve(H).then(function(U){return R.active?U:qt(new dt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):F.then(function(){return H})).then(function(U){return I&&R._resolve(),R._completion.then(function(){return U})}).catch(function(U){return R._reject(U),qt(U)})})}).bind(null,this,C,$,v,p);return v?v._promise(C,D,"lock"):ut.trans?pi(ut.transless,function(){return _._whenReady(D)}):this._whenReady(D)},Gt.prototype.table=function(c){if(!d(this._allTables,c))throw new dt.InvalidTable("Table ".concat(c," does not exist"));return this._allTables[c]},Gt);function Gt(c,u){var p=this;this._middlewares={},this.verno=0;var _=Gt.dependencies;this._options=u=n({addons:Gt.addons,autoOpen:!0,indexedDB:_.indexedDB,IDBKeyRange:_.IDBKeyRange,cache:"cloned"},u),this._deps={indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange},_=u.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var v,C,$,N,D,A={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Lt,dbReadyPromise:null,cancelOpen:Lt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:u.autoOpen};A.dbReadyPromise=new lt(function(M){A.dbReadyResolve=M}),A.openCanceller=new lt(function(M,z){A.cancelOpen=z}),this._state=A,this.name=c,this.on=er(this,"populate","blocked","versionchange","close",{ready:[Jc,Lt]}),this.on.ready.subscribe=j(this.on.ready.subscribe,function(M){return function(z,I){Gt.vip(function(){var L,F=p._state;F.openComplete?(F.dbOpenError||lt.resolve().then(z),I&&M(z)):F.onReadyBeingFired?(F.onReadyBeingFired.push(z),I&&M(z)):(M(z),L=p,I||M(function R(){L.on.ready.unsubscribe(z),L.on.ready.unsubscribe(R)}))})}}),this.Collection=(v=this,nr(fb.prototype,function(H,R){this.db=v;var I=Op,L=null;if(R)try{I=R()}catch(W){L=W}var F=H._ctx,R=F.table,H=R.hook.reading.fire;this._ctx={table:R,index:F.index,isPrimKey:!F.index||R.schema.primKey.keyPath&&F.index===R.schema.primKey.name,range:I,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:L,or:F.or,valueMapper:H!==Ys?H:null}})),this.Table=(C=this,nr(Bp.prototype,function(M,z,I){this.db=C,this._tx=I,this.name=M,this.schema=z,this.hook=C._allTables[M]?C._allTables[M].hook:er(null,{creating:[sb,Lt],reading:[ib,Ys],updating:[ob,Lt],deleting:[rb,Lt]})})),this.Transaction=($=this,nr(gb.prototype,function(M,z,I,L,F){var R=this;this.db=$,this.mode=M,this.storeNames=z,this.schema=I,this.chromeTransactionDurability=L,this.idbtrans=null,this.on=er(this,"complete","error","abort"),this.parent=F||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new lt(function(H,W){R._resolve=H,R._reject=W}),this._completion.then(function(){R.active=!1,R.on.complete.fire()},function(H){var W=R.active;return R.active=!1,R.on.error.fire(H),R.parent?R.parent._reject(H):W&&R.idbtrans&&R.idbtrans.abort(),qt(H)})})),this.Version=(N=this,nr(kb.prototype,function(M){this.db=N,this._cfg={version:M,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(D=this,nr(Vp.prototype,function(M,z,I){if(this.db=D,this._ctx={table:M,index:z===":id"?null:z,or:I},this._cmp=this._ascending=At,this._descending=function(L,F){return At(F,L)},this._max=function(L,F){return 0<At(L,F)?L:F},this._min=function(L,F){return At(L,F)<0?L:F},this._IDBKeyRange=D._deps.IDBKeyRange,!this._IDBKeyRange)throw new dt.MissingAPI})),this.on("versionchange",function(M){0<M.newVersion?console.warn("Another connection wants to upgrade database '".concat(p.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(p.name,"'. Closing db now to resume the delete request.")),p.close({disableAutoOpen:!1})}),this.on("blocked",function(M){!M.newVersion||M.newVersion<M.oldVersion?console.warn("Dexie.delete('".concat(p.name,"') was blocked")):console.warn("Upgrade '".concat(p.name,"' blocked by other connection holding version ").concat(M.oldVersion/10))}),this._maxKey=rr(u.IDBKeyRange),this._createTransaction=function(M,z,I,L){return new p.Transaction(M,z,I,p._options.chromeTransactionDurability,L)},this._fireOnBlocked=function(M){p.on("blocked").fire(M),ts.filter(function(z){return z.name===p.name&&z!==p&&!z._state.vcFired}).map(function(z){return z.on("versionchange").fire(M)})},this.use(Tb),this.use(Pb),this.use(Nb),this.use(xb),this.use($b);var O=new Proxy(this,{get:function(M,z,I){if(z==="_vip")return!0;if(z==="table")return function(F){return ma(p.table(F),O)};var L=Reflect.get(M,z,I);return L instanceof Bp?ma(L,O):z==="tables"?L.map(function(F){return ma(F,O)}):z==="_createTransaction"?function(){return ma(L.apply(this,arguments),O)}:L}});this.vip=O,_.forEach(function(M){return M(p)})}var ga,Oe=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ab=(Dh.prototype.subscribe=function(c,u,p){return this._subscribe(c&&typeof c!="function"?c:{next:c,error:u,complete:p})},Dh.prototype[Oe]=function(){return this},Dh);function Dh(c){this._subscribe=c}try{ga={indexedDB:r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB,IDBKeyRange:r.IDBKeyRange||r.webkitIDBKeyRange}}catch{ga={indexedDB:null,IDBKeyRange:null}}function om(c){var u,p=!1,_=new Ab(function(v){var C=Mt(c),$,N=!1,D={},A={},O={get closed(){return N},unsubscribe:function(){N||(N=!0,$&&$.abort(),M&&Vn.storagemutated.unsubscribe(I))}};v.start&&v.start(O);var M=!1,z=function(){return ah(L)},I=function(F){da(D,F),$h(A,D)&&z()},L=function(){var F,R,H;!N&&ga.indexedDB&&(D={},F={},$&&$.abort(),$=new AbortController,H=function(W){var U=Xi();try{C&&Ji();var V=Hn(c,W);return V=C?V.finally(Wn):V}finally{U&&Zi()}}(R={subscr:F,signal:$.signal,requery:z,querier:c,trans:null}),Promise.resolve(H).then(function(W){p=!0,u=W,N||R.signal.aborted||(D={},function(U){for(var V in U)if(d(U,V))return;return 1}(A=F)||M||(Vn(sr,I),M=!0),ah(function(){return!N&&v.next&&v.next(W)}))},function(W){p=!1,["DatabaseClosedError","AbortError"].includes(W==null?void 0:W.name)||N||ah(function(){N||v.error&&v.error(W)})}))};return setTimeout(z,0),O});return _.hasValue=function(){return p},_.getValue=function(){return u},_}var _i=gn;function Rh(c){var u=qn;try{qn=!0,Vn.storagemutated.fire(c),Eh(c,!0)}finally{qn=u}}m(_i,n(n({},Uo),{delete:function(c){return new _i(c,{addons:[]}).delete()},exists:function(c){return new _i(c,{addons:[]}).open().then(function(u){return u.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(c){try{return u=_i.dependencies,p=u.indexedDB,u=u.IDBKeyRange,(Ch(p)?Promise.resolve(p.databases()).then(function(_){return _.map(function(v){return v.name}).filter(function(v){return v!==ta})}):wh(p,u).toCollection().primaryKeys()).then(c)}catch{return qt(new dt.MissingAPI)}var u,p},defineClass:function(){return function(c){l(this,c)}},ignoreTransaction:function(c){return ut.trans?pi(ut.transless,c):c()},vip:kh,async:function(c){return function(){try{var u=Mh(c.apply(this,arguments));return u&&typeof u.then=="function"?u:lt.resolve(u)}catch(p){return qt(p)}}},spawn:function(c,u,p){try{var _=Mh(c.apply(p,u||[]));return _&&typeof _.then=="function"?_:lt.resolve(_)}catch(v){return qt(v)}},currentTransaction:{get:function(){return ut.trans||null}},waitFor:function(c,u){return u=lt.resolve(typeof c=="function"?_i.ignoreTransaction(c):c).timeout(u||6e4),ut.trans?ut.trans.waitFor(u):u},Promise:lt,debug:{get:function(){return Je},set:function(c){Mp(c)}},derive:S,extend:l,props:m,override:j,Events:er,on:Vn,liveQuery:om,extendObservabilitySet:da,getByKeyPath:G,setByKeyPath:Q,delByKeyPath:function(c,u){typeof u=="string"?Q(c,u,void 0):"length"in u&&[].map.call(u,function(p){Q(c,p,void 0)})},shallowClone:Z,deepClone:pt,getObjectDiff:Ph,cmp:At,asap:K,minKey:-1/0,addons:[],connections:ts,errnames:jn,dependencies:ga,cache:yi,semVer:"4.0.4",version:"4.0.4".split(".").map(function(c){return parseInt(c)}).reduce(function(c,u,p){return c+u/Math.pow(10,2*p)})})),_i.maxKey=rr(_i.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Vn(sr,function(c){qn||(c=new CustomEvent(ph,{detail:c}),qn=!0,dispatchEvent(c),qn=!1)}),addEventListener(ph,function(c){c=c.detail,qn||Rh(c)}));var is,qn=!1,am=function(){};return typeof BroadcastChannel<"u"&&((am=function(){(is=new BroadcastChannel(ph)).onmessage=function(c){return c.data&&Rh(c.data)}})(),typeof is.unref=="function"&&is.unref(),Vn(sr,function(c){qn||is.postMessage(c)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(c){if(!gn.disableBfCache&&c.persisted){Je&&console.debug("Dexie: handling persisted pagehide"),is!=null&&is.close();for(var u=0,p=ts;u<p.length;u++)p[u].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(c){!gn.disableBfCache&&c.persisted&&(Je&&console.debug("Dexie: handling persisted pageshow"),am(),Rh({all:new ce(-1/0,[[]])}))})),lt.rejectionMapper=function(c,u){return!c||c instanceof le||c instanceof TypeError||c instanceof SyntaxError||!c.name||!Gs[c.name]?c:(u=new Gs[c.name](u||c.message,c),"stack"in c&&b(u,"stack",{get:function(){return this.inner.stack}}),u)},Mp(Je),n(gn,Object.freeze({__proto__:null,Dexie:gn,liveQuery:om,Entity:zp,cmp:At,PropModSymbol:mn,PropModification:dh,replacePrefix:function(c,u){return new dh({replacePrefix:[c,u]})},default:gn,RangeSet:ce,mergeRanges:lr,rangesOverlap:ua}),{default:gn}),gn})})(_d);var _y=_d.exports;const Sl=yy(_y),vd=Symbol.for("Dexie"),ws=globalThis[vd]||(globalThis[vd]=Sl);if(Sl.semVer!==ws.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Sl.semVer} and ${ws.semVer}`);const{liveQuery:vy,mergeRanges:by,rangesOverlap:wy,RangeSet:Cy,cmp:ky,Entity:Sy,PropModSymbol:xy,PropModification:$y,replacePrefix:Ty}=ws;class $n{}$n.TABLE={name:"cache",schema:"++id, type, key, data, createTime, updateTime, [type+key]",version:1},$n.DEFAULT_TYPE="cache";const bd=Object.freeze(Object.defineProperty({__proto__:null,CacheData:$n},Symbol.toStringTag,{value:"Module"})),Ny=Object.values(bd).reduce((i,t)=>Math.max(t.TABLE.version,i),1),Ey=Object.values(bd).reduce((i,{TABLE:t})=>(i[t.name]=t.schema,i),{});class wd extends ws{constructor(t="DataHub"){super(t),this.version(Ny).stores(Ey),this.cache.mapToClass($n)}async getCache(t,e=$n.DEFAULT_TYPE){return this.cache.where("[type+key]").equals([e,t]).first()}async getCacheData(t,e=$n.DEFAULT_TYPE){const n=await this.getCache(t,e);return n==null?void 0:n.data}async setCacheData(t,e,n,s=$n.DEFAULT_TYPE){if(e===null)return this.deleteCacheData(t,s);const r=await this.getCache(t,s);return n=n||Date.now(),r?(await this.cache.update(r.id,{data:e,updateTime:n}),r.id):await this.cache.add({key:t,data:e,type:s,createTime:n,updateTime:n})}async deleteCacheData(t,e=$n.DEFAULT_TYPE){return typeof t=="number"?this.cache.delete(t):this.cache.where("[type+key]").equals([e,t]).delete()}async getPageData(t,e,n){const{currentModule:s,currentMethod:r}=window.config;return this.getCacheData(t,`PAGE_${e||s}_${n||r}`)}setPageData(t,e,n,s){const{currentModule:r,currentMethod:o}=window.config;return this.setCacheData(t,e,void 0,`PAGE_${n||r}_${s||o}`)}}Object.defineProperty(window.$,"db",{get(){var i;return this._db||(window.parent!==window?this._db=window.parent.$.db:this._db=new wd(`zentao_${((i=window.config)==null?void 0:i.account)||""}`)),this._db}});class xl extends mt{}xl.NAME="Avatar",xl.Component=Ei,oe(Xg);const Iw="",Dw="",Rw="",Lw="";class $l extends mt{}$l.NAME="BtnGroup",$l.Component=Fe,oe(Object.freeze(Object.defineProperty({__proto__:null,BtnGroup:Fe},Symbol.toStringTag,{value:"Module"})));const zw="",Fw="",Cd=Symbol("EVENT_PICK");class Xr extends Tt{constructor(t){super(t),this._handleClick=this._handleClick.bind(this),this._hasInput=!!g(`#${t.id}`).length}get hasInput(){return this._hasInput}_handleClick(t){const{togglePop:e,clickType:n,onClick:s}=this.props;let r=n==="open"?!0:void 0;const o=g(t.target),a=s==null?void 0:s(t);if(!t.defaultPrevented){if(typeof a=="boolean")r=a;else{if(o.closest('[data-dismiss="pick"]').length){e(!1);return}if(o.closest("a,input").length)return}requestAnimationFrame(()=>e(r))}}_getClass(t){const{state:e,className:n,disabled:s,readonly:r,pickerName:o,empty:a}=t,{open:l}=e;return q("pick",n,o?`${o}-pick`:"",l&&"is-open focus",s&&"disabled",r&&"readonly",a?"is-empty-value":"")}_getProps(t){const{id:e,style:n,attrs:s}=t;return{id:`pick-${e}`,className:this._getClass(t),style:n,tabIndex:-1,onClick:this._handleClick,...s}}_renderTrigger(t){const{children:e,state:n}=t;return e??n.value}_renderValue(t){const{name:e,state:{value:n=""},disabled:s,readonly:r,id:o}=t;if(e)if(this._hasInput)g(`#${o}`).val(n);else return w("input",{id:o,type:"hidden",className:"pick-value",name:e,value:n,readonly:r,disabled:s});return null}componentDidMount(){const{id:t}=this.props;g(`#${t}`).on(`change.zui.pick.${t} syncValue.zui.pick.${t}`,(e,n)=>{if(typeof n=="symbol")return;const s=e.target.value;this._skipTriggerChange=s,this.props.changeState({value:s})})}componentWillUnmount(){const{id:t}=this.props;g(`#${t}`).off(`change.zui.pick.${t}`)}componentDidUpdate(t){const{id:e,state:n,name:s}=this.props;s&&t.state.value!==n.value&&(this._skipTriggerChange!==n.value&&g(`#${e}`).trigger("change",Cd),this._skipTriggerChange=!1)}render(t){return P(t.tagName||"div",this._getProps(t),this._renderTrigger(t),this._renderValue(t))}}const Ge=Math.min,xe=Math.max,Zr=Math.round,Jr=Math.floor,Tn=i=>({x:i,y:i}),My={left:"right",right:"left",bottom:"top",top:"bottom"},Py={start:"end",end:"start"};function Tl(i,t,e){return xe(i,Ge(t,e))}function Ii(i,t){return typeof i=="function"?i(t):i}function Nn(i){return i.split("-")[0]}function Di(i){return i.split("-")[1]}function kd(i){return i==="x"?"y":"x"}function Nl(i){return i==="y"?"height":"width"}function oi(i){return["top","bottom"].includes(Nn(i))?"y":"x"}function El(i){return kd(oi(i))}function Ay(i,t,e){e===void 0&&(e=!1);const n=Di(i),s=El(i),r=Nl(s);let o=s==="x"?n===(e?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[r]>t.floating[r]&&(o=to(o)),[o,to(o)]}function Iy(i){const t=to(i);return[Ml(i),t,Ml(t)]}function Ml(i){return i.replace(/start|end/g,t=>Py[t])}function Dy(i,t,e){const n=["left","right"],s=["right","left"],r=["top","bottom"],o=["bottom","top"];switch(i){case"top":case"bottom":return e?t?s:n:t?n:s;case"left":case"right":return t?r:o;default:return[]}}function Ry(i,t,e,n){const s=Di(i);let r=Dy(Nn(i),e==="start",n);return s&&(r=r.map(o=>o+"-"+s),t&&(r=r.concat(r.map(Ml)))),r}function to(i){return i.replace(/left|right|bottom|top/g,t=>My[t])}function Ly(i){return{top:0,right:0,bottom:0,left:0,...i}}function Sd(i){return typeof i!="number"?Ly(i):{top:i,right:i,bottom:i,left:i}}function eo(i){const{x:t,y:e,width:n,height:s}=i;return{width:n,height:s,top:e,left:t,right:t+n,bottom:e+s,x:t,y:e}}function xd(i,t,e){let{reference:n,floating:s}=i;const r=oi(t),o=El(t),a=Nl(o),l=Nn(t),h=r==="y",f=n.x+n.width/2-s.width/2,d=n.y+n.height/2-s.height/2,m=n[a]/2-s[a]/2;let y;switch(l){case"top":y={x:f,y:n.y-s.height};break;case"bottom":y={x:f,y:n.y+n.height};break;case"right":y={x:n.x+n.width,y:d};break;case"left":y={x:n.x-s.width,y:d};break;default:y={x:n.x,y:n.y}}switch(Di(t)){case"start":y[o]-=m*(e&&h?-1:1);break;case"end":y[o]+=m*(e&&h?-1:1);break}return y}const Oy=async(i,t,e)=>{const{placement:n="bottom",strategy:s="absolute",middleware:r=[],platform:o}=e,a=r.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(t));let h=await o.getElementRects({reference:i,floating:t,strategy:s}),{x:f,y:d}=xd(h,n,l),m=n,y={},b=0;for(let S=0;S<a.length;S++){const{name:x,fn:k}=a[S],{x:T,y:j,data:B,reset:K}=await k({x:f,y:d,initialPlacement:n,placement:m,strategy:s,middlewareData:y,rects:h,platform:o,elements:{reference:i,floating:t}});f=T??f,d=j??d,y={...y,[x]:{...y[x],...B}},K&&b<=50&&(b++,typeof K=="object"&&(K.placement&&(m=K.placement),K.rects&&(h=K.rects===!0?await o.getElementRects({reference:i,floating:t,strategy:s}):K.rects),{x:f,y:d}=xd(h,m,l)),S=-1)}return{x:f,y:d,placement:m,strategy:s,middlewareData:y}};async function Pl(i,t){var e;t===void 0&&(t={});const{x:n,y:s,platform:r,rects:o,elements:a,strategy:l}=i,{boundary:h="clippingAncestors",rootBoundary:f="viewport",elementContext:d="floating",altBoundary:m=!1,padding:y=0}=Ii(t,i),b=Sd(y),x=a[m?d==="floating"?"reference":"floating":d],k=eo(await r.getClippingRect({element:(e=await(r.isElement==null?void 0:r.isElement(x)))==null||e?x:x.contextElement||await(r.getDocumentElement==null?void 0:r.getDocumentElement(a.floating)),boundary:h,rootBoundary:f,strategy:l})),T=d==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,j=await(r.getOffsetParent==null?void 0:r.getOffsetParent(a.floating)),B=await(r.isElement==null?void 0:r.isElement(j))?await(r.getScale==null?void 0:r.getScale(j))||{x:1,y:1}:{x:1,y:1},K=eo(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:T,offsetParent:j,strategy:l}):T);return{top:(k.top-K.top+b.top)/B.y,bottom:(K.bottom-k.bottom+b.bottom)/B.y,left:(k.left-K.left+b.left)/B.x,right:(K.right-k.right+b.right)/B.x}}const zy=i=>({name:"arrow",options:i,async fn(t){const{x:e,y:n,placement:s,rects:r,platform:o,elements:a,middlewareData:l}=t,{element:h,padding:f=0}=Ii(i,t)||{};if(h==null)return{};const d=Sd(f),m={x:e,y:n},y=El(s),b=Nl(y),S=await o.getDimensions(h),x=y==="y",k=x?"top":"left",T=x?"bottom":"right",j=x?"clientHeight":"clientWidth",B=r.reference[b]+r.reference[y]-m[y]-r.floating[b],K=m[y]-r.reference[y],G=await(o.getOffsetParent==null?void 0:o.getOffsetParent(h));let Q=G?G[j]:0;(!Q||!await(o.isElement==null?void 0:o.isElement(G)))&&(Q=a.floating[j]||r.floating[b]);const Z=B/2-K/2,tt=Q/2-S[b]/2-1,X=Ge(d[k],tt),et=Ge(d[T],tt),ct=X,pt=Q-S[b]-et,xt=Q/2-S[b]/2+Z,Rt=Tl(ct,xt,pt),Dt=!l.arrow&&Di(s)!=null&&xt!==Rt&&r.reference[b]/2-(xt<ct?X:et)-S[b]/2<0,ht=Dt?xt<ct?xt-ct:xt-pt:0;return{[y]:m[y]+ht,data:{[y]:Rt,centerOffset:xt-Rt-ht,...Dt&&{alignmentOffset:ht}},reset:Dt}}}),Fy=function(i){return i===void 0&&(i={}),{name:"flip",options:i,async fn(t){var e,n;const{placement:s,middlewareData:r,rects:o,initialPlacement:a,platform:l,elements:h}=t,{mainAxis:f=!0,crossAxis:d=!0,fallbackPlacements:m,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:S=!0,...x}=Ii(i,t);if((e=r.arrow)!=null&&e.alignmentOffset)return{};const k=Nn(s),T=oi(a),j=Nn(a)===a,B=await(l.isRTL==null?void 0:l.isRTL(h.floating)),K=m||(j||!S?[to(a)]:Iy(a)),G=b!=="none";!m&&G&&K.push(...Ry(a,S,b,B));const Q=[a,...K],Z=await Pl(t,x),tt=[];let X=((n=r.flip)==null?void 0:n.overflows)||[];if(f&&tt.push(Z[k]),d){const xt=Ay(s,o,B);tt.push(Z[xt[0]],Z[xt[1]])}if(X=[...X,{placement:s,overflows:tt}],!tt.every(xt=>xt<=0)){var et,ct;const xt=(((et=r.flip)==null?void 0:et.index)||0)+1,Rt=Q[xt];if(Rt)return{data:{index:xt,overflows:X},reset:{placement:Rt}};let Dt=(ct=X.filter(ht=>ht.overflows[0]<=0).sort((ht,J)=>ht.overflows[1]-J.overflows[1])[0])==null?void 0:ct.placement;if(!Dt)switch(y){case"bestFit":{var pt;const ht=(pt=X.filter(J=>{if(G){const _t=oi(J.placement);return _t===T||_t==="y"}return!0}).map(J=>[J.placement,J.overflows.filter(_t=>_t>0).reduce((_t,yt)=>_t+yt,0)]).sort((J,_t)=>J[1]-_t[1])[0])==null?void 0:pt[0];ht&&(Dt=ht);break}case"initialPlacement":Dt=a;break}if(s!==Dt)return{reset:{placement:Dt}}}return{}}}};async function jy(i,t){const{placement:e,platform:n,elements:s}=i,r=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=Nn(e),a=Di(e),l=oi(e)==="y",h=["left","top"].includes(o)?-1:1,f=r&&l?-1:1,d=Ii(t,i);let{mainAxis:m,crossAxis:y,alignmentAxis:b}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof b=="number"&&(y=a==="end"?b*-1:b),l?{x:y*f,y:m*h}:{x:m*h,y:y*f}}const By=function(i){return i===void 0&&(i=0),{name:"offset",options:i,async fn(t){var e,n;const{x:s,y:r,placement:o,middlewareData:a}=t,l=await jy(t,i);return o===((e=a.offset)==null?void 0:e.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:s+l.x,y:r+l.y,data:{...l,placement:o}}}}},Hy=function(i){return i===void 0&&(i={}),{name:"shift",options:i,async fn(t){const{x:e,y:n,placement:s}=t,{mainAxis:r=!0,crossAxis:o=!1,limiter:a={fn:x=>{let{x:k,y:T}=x;return{x:k,y:T}}},...l}=Ii(i,t),h={x:e,y:n},f=await Pl(t,l),d=oi(Nn(s)),m=kd(d);let y=h[m],b=h[d];if(r){const x=m==="y"?"top":"left",k=m==="y"?"bottom":"right",T=y+f[x],j=y-f[k];y=Tl(T,y,j)}if(o){const x=d==="y"?"top":"left",k=d==="y"?"bottom":"right",T=b+f[x],j=b-f[k];b=Tl(T,b,j)}const S=a.fn({...t,[m]:y,[d]:b});return{...S,data:{x:S.x-e,y:S.y-n}}}}},Wy=function(i){return i===void 0&&(i={}),{name:"size",options:i,async fn(t){const{placement:e,rects:n,platform:s,elements:r}=t,{apply:o=()=>{},...a}=Ii(i,t),l=await Pl(t,a),h=Nn(e),f=Di(e),d=oi(e)==="y",{width:m,height:y}=n.floating;let b,S;h==="top"||h==="bottom"?(b=h,S=f===(await(s.isRTL==null?void 0:s.isRTL(r.floating))?"start":"end")?"left":"right"):(S=h,b=f==="end"?"top":"bottom");const x=y-l.top-l.bottom,k=m-l.left-l.right,T=Ge(y-l[b],x),j=Ge(m-l[S],k),B=!t.middlewareData.shift;let K=T,G=j;if(d?G=f||B?Ge(j,k):k:K=f||B?Ge(T,x):x,B&&!f){const Z=xe(l.left,0),tt=xe(l.right,0),X=xe(l.top,0),et=xe(l.bottom,0);d?G=m-2*(Z!==0||tt!==0?Z+tt:xe(l.left,l.right)):K=y-2*(X!==0||et!==0?X+et:xe(l.top,l.bottom))}await o({...t,availableWidth:G,availableHeight:K});const Q=await s.getDimensions(r.floating);return m!==Q.width||y!==Q.height?{reset:{rects:!0}}:{}}}};function Ri(i){return $d(i)?(i.nodeName||"").toLowerCase():"#document"}function $e(i){var t;return(i==null||(t=i.ownerDocument)==null?void 0:t.defaultView)||window}function ln(i){var t;return(t=($d(i)?i.ownerDocument:i.document)||window.document)==null?void 0:t.documentElement}function $d(i){return i instanceof Node||i instanceof $e(i).Node}function Ye(i){return i instanceof Element||i instanceof $e(i).Element}function Qe(i){return i instanceof HTMLElement||i instanceof $e(i).HTMLElement}function Td(i){return typeof ShadowRoot>"u"?!1:i instanceof ShadowRoot||i instanceof $e(i).ShadowRoot}function Cs(i){const{overflow:t,overflowX:e,overflowY:n,display:s}=je(i);return/auto|scroll|overlay|hidden|clip/.test(t+n+e)&&!["inline","contents"].includes(s)}function Ky(i){return["table","td","th"].includes(Ri(i))}function no(i){return[":popover-open",":modal"].some(t=>{try{return i.matches(t)}catch{return!1}})}function Al(i){const t=Il(),e=je(i);return e.transform!=="none"||e.perspective!=="none"||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(e.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(e.contain||"").includes(n))}function Uy(i){let t=En(i);for(;Qe(t)&&!Li(t);){if(no(t))return null;if(Al(t))return t;t=En(t)}return null}function Il(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Li(i){return["html","body","#document"].includes(Ri(i))}function je(i){return $e(i).getComputedStyle(i)}function io(i){return Ye(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.scrollX,scrollTop:i.scrollY}}function En(i){if(Ri(i)==="html")return i;const t=i.assignedSlot||i.parentNode||Td(i)&&i.host||ln(i);return Td(t)?t.host:t}function Nd(i){const t=En(i);return Li(t)?i.ownerDocument?i.ownerDocument.body:i.body:Qe(t)&&Cs(t)?t:Nd(t)}function ks(i,t,e){var n;t===void 0&&(t=[]),e===void 0&&(e=!0);const s=Nd(i),r=s===((n=i.ownerDocument)==null?void 0:n.body),o=$e(s);return r?t.concat(o,o.visualViewport||[],Cs(s)?s:[],o.frameElement&&e?ks(o.frameElement):[]):t.concat(s,ks(s,[],e))}function Ed(i){const t=je(i);let e=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=Qe(i),r=s?i.offsetWidth:e,o=s?i.offsetHeight:n,a=Zr(e)!==r||Zr(n)!==o;return a&&(e=r,n=o),{width:e,height:n,$:a}}function Dl(i){return Ye(i)?i:i.contextElement}function Oi(i){const t=Dl(i);if(!Qe(t))return Tn(1);const e=t.getBoundingClientRect(),{width:n,height:s,$:r}=Ed(t);let o=(r?Zr(e.width):e.width)/n,a=(r?Zr(e.height):e.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Vy=Tn(0);function Md(i){const t=$e(i);return!Il()||!t.visualViewport?Vy:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function qy(i,t,e){return t===void 0&&(t=!1),!e||t&&e!==$e(i)?!1:t}function ai(i,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=!1);const s=i.getBoundingClientRect(),r=Dl(i);let o=Tn(1);t&&(n?Ye(n)&&(o=Oi(n)):o=Oi(i));const a=qy(r,e,n)?Md(r):Tn(0);let l=(s.left+a.x)/o.x,h=(s.top+a.y)/o.y,f=s.width/o.x,d=s.height/o.y;if(r){const m=$e(r),y=n&&Ye(n)?$e(n):n;let b=m,S=b.frameElement;for(;S&&n&&y!==b;){const x=Oi(S),k=S.getBoundingClientRect(),T=je(S),j=k.left+(S.clientLeft+parseFloat(T.paddingLeft))*x.x,B=k.top+(S.clientTop+parseFloat(T.paddingTop))*x.y;l*=x.x,h*=x.y,f*=x.x,d*=x.y,l+=j,h+=B,b=$e(S),S=b.frameElement}}return eo({width:f,height:d,x:l,y:h})}function Gy(i){let{elements:t,rect:e,offsetParent:n,strategy:s}=i;const r=s==="fixed",o=ln(n),a=t?no(t.floating):!1;if(n===o||a&&r)return e;let l={scrollLeft:0,scrollTop:0},h=Tn(1);const f=Tn(0),d=Qe(n);if((d||!d&&!r)&&((Ri(n)!=="body"||Cs(o))&&(l=io(n)),Qe(n))){const m=ai(n);h=Oi(n),f.x=m.x+n.clientLeft,f.y=m.y+n.clientTop}return{width:e.width*h.x,height:e.height*h.y,x:e.x*h.x-l.scrollLeft*h.x+f.x,y:e.y*h.y-l.scrollTop*h.y+f.y}}function Yy(i){return Array.from(i.getClientRects())}function Pd(i){return ai(ln(i)).left+io(i).scrollLeft}function Qy(i){const t=ln(i),e=io(i),n=i.ownerDocument.body,s=xe(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),r=xe(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-e.scrollLeft+Pd(i);const a=-e.scrollTop;return je(n).direction==="rtl"&&(o+=xe(t.clientWidth,n.clientWidth)-s),{width:s,height:r,x:o,y:a}}function Xy(i,t){const e=$e(i),n=ln(i),s=e.visualViewport;let r=n.clientWidth,o=n.clientHeight,a=0,l=0;if(s){r=s.width,o=s.height;const h=Il();(!h||h&&t==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:r,height:o,x:a,y:l}}function Zy(i,t){const e=ai(i,!0,t==="fixed"),n=e.top+i.clientTop,s=e.left+i.clientLeft,r=Qe(i)?Oi(i):Tn(1),o=i.clientWidth*r.x,a=i.clientHeight*r.y,l=s*r.x,h=n*r.y;return{width:o,height:a,x:l,y:h}}function Ad(i,t,e){let n;if(t==="viewport")n=Xy(i,e);else if(t==="document")n=Qy(ln(i));else if(Ye(t))n=Zy(t,e);else{const s=Md(i);n={...t,x:t.x-s.x,y:t.y-s.y}}return eo(n)}function Id(i,t){const e=En(i);return e===t||!Ye(e)||Li(e)?!1:je(e).position==="fixed"||Id(e,t)}function Jy(i,t){const e=t.get(i);if(e)return e;let n=ks(i,[],!1).filter(a=>Ye(a)&&Ri(a)!=="body"),s=null;const r=je(i).position==="fixed";let o=r?En(i):i;for(;Ye(o)&&!Li(o);){const a=je(o),l=Al(o);!l&&a.position==="fixed"&&(s=null),(r?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Cs(o)&&!l&&Id(i,o))?n=n.filter(f=>f!==o):s=a,o=En(o)}return t.set(i,n),n}function t_(i){let{element:t,boundary:e,rootBoundary:n,strategy:s}=i;const o=[...e==="clippingAncestors"?no(t)?[]:Jy(t,this._c):[].concat(e),n],a=o[0],l=o.reduce((h,f)=>{const d=Ad(t,f,s);return h.top=xe(d.top,h.top),h.right=Ge(d.right,h.right),h.bottom=Ge(d.bottom,h.bottom),h.left=xe(d.left,h.left),h},Ad(t,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function e_(i){const{width:t,height:e}=Ed(i);return{width:t,height:e}}function n_(i,t,e){const n=Qe(t),s=ln(t),r=e==="fixed",o=ai(i,!0,r,t);let a={scrollLeft:0,scrollTop:0};const l=Tn(0);if(n||!n&&!r)if((Ri(t)!=="body"||Cs(s))&&(a=io(t)),n){const d=ai(t,!0,r,t);l.x=d.x+t.clientLeft,l.y=d.y+t.clientTop}else s&&(l.x=Pd(s));const h=o.left+a.scrollLeft-l.x,f=o.top+a.scrollTop-l.y;return{x:h,y:f,width:o.width,height:o.height}}function Rl(i){return je(i).position==="static"}function Dd(i,t){return!Qe(i)||je(i).position==="fixed"?null:t?t(i):i.offsetParent}function Rd(i,t){const e=$e(i);if(no(i))return e;if(!Qe(i)){let s=En(i);for(;s&&!Li(s);){if(Ye(s)&&!Rl(s))return s;s=En(s)}return e}let n=Dd(i,t);for(;n&&Ky(n)&&Rl(n);)n=Dd(n,t);return n&&Li(n)&&Rl(n)&&!Al(n)?e:n||Uy(i)||e}const i_=async function(i){const t=this.getOffsetParent||Rd,e=this.getDimensions,n=await e(i.floating);return{reference:n_(i.reference,await t(i.floating),i.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function s_(i){return je(i).direction==="rtl"}const r_={convertOffsetParentRelativeRectToViewportRelativeRect:Gy,getDocumentElement:ln,getClippingRect:t_,getOffsetParent:Rd,getElementRects:i_,getClientRects:Yy,getDimensions:e_,getScale:Oi,isElement:Ye,isRTL:s_};function o_(i,t){let e=null,n;const s=ln(i);function r(){var a;clearTimeout(n),(a=e)==null||a.disconnect(),e=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),r();const{left:h,top:f,width:d,height:m}=i.getBoundingClientRect();if(a||t(),!d||!m)return;const y=Jr(f),b=Jr(s.clientWidth-(h+d)),S=Jr(s.clientHeight-(f+m)),x=Jr(h),T={rootMargin:-y+"px "+-b+"px "+-S+"px "+-x+"px",threshold:xe(0,Ge(1,l))||1};let j=!0;function B(K){const G=K[0].intersectionRatio;if(G!==l){if(!j)return o();G?o(!1,G):n=setTimeout(()=>{o(!1,1e-7)},1e3)}j=!1}try{e=new IntersectionObserver(B,{...T,root:s.ownerDocument})}catch{e=new IntersectionObserver(B,T)}e.observe(i)}return o(!0),r}function Ld(i,t,e,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:r=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,h=Dl(i),f=s||r?[...h?ks(h):[],...ks(t)]:[];f.forEach(k=>{s&&k.addEventListener("scroll",e,{passive:!0}),r&&k.addEventListener("resize",e)});const d=h&&a?o_(h,e):null;let m=-1,y=null;o&&(y=new ResizeObserver(k=>{let[T]=k;T&&T.target===h&&y&&(y.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var j;(j=y)==null||j.observe(t)})),e()}),h&&!l&&y.observe(h),y.observe(t));let b,S=l?ai(i):null;l&&x();function x(){const k=ai(i);S&&(k.x!==S.x||k.y!==S.y||k.width!==S.width||k.height!==S.height)&&e(),S=k,b=requestAnimationFrame(x)}return e(),()=>{var k;f.forEach(T=>{s&&T.removeEventListener("scroll",e),r&&T.removeEventListener("resize",e)}),d==null||d(),(k=y)==null||k.disconnect(),y=null,l&&cancelAnimationFrame(b)}}const Ll=By,Ol=Hy,zl=Fy,Od=Wy,a_=zy,Fl=(i,t,e)=>{const n=new Map,s={platform:r_,...e},r={...s.platform,_c:n};return Oy(i,t,{...s,platform:r})};class jl extends Tt{constructor(t){super(t),this._ref=kt(),this._handleDocClick=e=>{const{state:{open:n},id:s,togglePop:r}=this.props,o=g(e.target);n!=="closing"&&!o.closest(`#pick-${s},#pick-pop-${s}`).length&&o.parent().length&&r(!1)},this._handleClick=this._handleClick.bind(this)}get trigger(){return g(`#pick-${this.props.id}`)[0]}get element(){var t;return(t=this._ref)==null?void 0:t.current}get container(){return this._container}_handleClick(t){const{togglePop:e}=this.props,n=g(t.target),s=n.closest("[data-pick-value]");if(s.length)return t.stopPropagation(),e(!1,{value:`${s.dataset("pickValue")}`});if(n.closest('[data-dismiss="pick"]').length)return e(!1)}_getClass(t){const{className:e,state:n,pickerName:s,empty:r}=t,{open:o}=n;return q("pick-pop",s?`${s}-pick-pop`:"",e,o===!0&&"in",r?"is-empty-value":"")}_getProps(t){const{id:e,style:n,maxHeight:s,maxWidth:r,minHeight:o,minWidth:a}=t,l=g.extend({maxHeight:s,maxWidth:r,minHeight:o,minWidth:a},n);return{id:`pick-pop-${e}`,className:this._getClass(t),style:l,ref:this._ref,onClick:this._handleClick}}_getContainer(t){if(!this._container){const e=g(t.container||"body");let n=e.find(".pick-container");n.length||(n=g("<div>").addClass("pick-container").appendTo(e)),this._container=n[0]}return this._container}_render(t){return w("div",{...this._getProps(t),children:this._renderPop(t)})}_renderPop(t){return t.children}_getStyle(t={},e){var h;const n=(h=this.trigger)==null?void 0:h.getBoundingClientRect();if(!n)return{};const{width:s,minWidth:r,maxWidth:o,maxHeight:a}=this.props,l=n.width;if(typeof s=="function"?t.width=s():s==="100%"?t.width=l:s&&(t.width=Bt(s)),r==="100%"&&(t.minWidth=l),o==="100%"&&(t.maxWidth=l),this.props.limitInScreen&&e&&(!a||a==="auto"||typeof a=="number")){let f;if(e.includes("bottom"))f=window.innerHeight-n.bottom-2;else{const d=this.element.getBoundingClientRect().height;f=n.top,d>f&&typeof t.top=="number"&&(t.top+=d-f)}f&&(t.maxHeight=typeof a=="number"?Math.min(f,a):f)}else a&&(t.maxHeight=a);return t}layout(){const{element:t,trigger:e,props:n}=this,{state:s}=n;if(!t||!e||!s.open){this._layoutWatcher&&(this._layoutWatcher(),this._layoutWatcher=void 0);return}this._layoutWatcher||(this._layoutWatcher=Ld(e,t,()=>{const{placement:r,width:o}=n;Fl(e,t,{placement:!r||r==="auto"?"bottom-start":r,middleware:[r==="auto"?zl():null,Ol(),Ll(1)].filter(Boolean)}).then(({x:a,y:l,placement:h})=>{var f,d;if(wn(e)||!hs(e)){g(t).css({display:"none"});return}g(t).css(this._getStyle({left:a,top:l},h)),(d=(f=this.props).onLayout)==null||d.call(f,t)}),o==="100%"&&g(t).css(this._getStyle())}))}componentDidMount(){var t,e;this.layout(),g(document).on("click",this._handleDocClick),(e=(t=this.props).afterRender)==null||e.call(t,{firstRender:!0})}componentDidUpdate(){var t,e;(e=(t=this.props).afterRender)==null||e.call(t,{firstRender:!1})}componentWillUnmount(){var e,n;g(document).off("click",this._handleDocClick);const t=this._layoutWatcher;t&&(t(),this._layoutWatcher=void 0),this._container=void 0,this._ref=void 0,g(`#pick-pop-${this.props.id}`).remove(),(n=(e=this.props).beforeDestroy)==null||n.call(e)}render(t){return hd(this._render(t),this._getContainer(t))}}const jw="";let ee=class extends Tt{constructor(t){super(t),this._toggleTimer=0,this._pop=kt(),this._trigger=kt(),this.toggle=async(e,n)=>{(this.props.disabled||this.props.readonly)&&(e=!1);const{state:s}=this;if(typeof e=="boolean"&&e===(!!s.open&&s.open!=="closing"))return n&&await this.changeState(n),this.state;this._toggleTimer&&(clearTimeout(this._toggleTimer),this._toggleTimer=0);let r=await this.changeState(a=>(e=e??!a.open,{open:e?"opening":"closing",...n}));const{open:o}=r;return o==="closing"?(await as(200,a=>{this._toggleTimer=a}),this._toggleTimer=0,r=await this.changeState({open:!1})):o==="opening"&&(await as(50,a=>{this._toggleTimer=a}),this._toggleTimer=0,r=await this.changeState({open:!0})),r},this._id=t.id??`_pick${_e()}`,this.changeState=this.changeState.bind(this),this.state=this.getDefaultState(t)}get id(){return this._id}get pop(){return this._pop.current}get trigger(){return this._trigger.current}get value(){return this.state.value}getDefaultState(t){return{value:String((t||this.props).defaultValue??""),open:!1}}resetState(t,e){const n=this.getDefaultState(t);e?this.state=n:this.changeState(n)}changeState(t,e){return new Promise(n=>{this.setState(t,()=>{e==null||e(),n(this.state)})})}open(t){return this.toggle(!0,t)}close(t){return this.toggle(!1,t)}_getTriggerProps(t,e){return{id:this.id,ref:this._trigger,state:e,className:t.className,pickerName:t.pickerName,style:t.style,name:t.name,tagName:t.tagName,attrs:t.attrs,disabled:t.disabled,readonly:t.readonly,clickType:t.clickType,onClick:t.onClick,changeState:this.changeState,togglePop:this.toggle}}_getPopProps(t,e){return{id:this.id,state:e,className:t.popClass,pickerName:t.pickerName,style:t.popStyle,disabled:t.disabled,readonly:t.readonly,changeState:this.changeState,togglePop:this.toggle,placement:t.popPlacement,container:t.popContainer,width:t.popWidth,height:t.popHeight,minHeight:t.popMinHeight,maxHeight:t.popMaxHeight,maxWidth:t.popMaxWidth,minWidth:t.popMinWidth,limitInScreen:t.limitPopInScreen}}_renderTrigger(t,e){return null}_renderPop(t,e){return null}_afterRender(t=!1){var e;(e=this.props.afterRender)==null||e.call(this,{firstRender:t})}_getPop(t){return t.Pop||this.constructor.Pop}_getTrigger(t){return t.Trigger||this.constructor.Trigger}_isEmptyValue(){const{value:t}=this.state;return t==null||t===""}_handleChange(t,e){const{onChange:n}=this.props;n&&n.call(this,t,e)}_handlePopToggle(t){const{onPopShown:e,onPopHidden:n}=this.props;t===!0&&e?e.call(this):!t&&n&&n.call(this)}setValue(t,e){if(e){const n=this._trigger.current;n&&(n._skipTriggerChange=t)}return this.changeState({value:t})}componentDidMount(){this._afterRender(!0)}componentWillUpdate(t,e){const{open:n}=this.state,{open:s}=e;if(!n==!s)return;const{onPopShow:r,onPopHide:o}=this.props;s&&r?r.call(this):!s&&o&&o.call(this)}componentDidUpdate(t,e){const{open:n,value:s}=this.state,{open:r,value:o}=e;!!n!=!!r&&this._handlePopToggle(!!n),s!==o&&this._handleChange(s,o),this._afterRender()}componentWillUnmount(){var e;(e=this.props.beforeDestroy)==null||e.call(this),this._toggleTimer&&clearTimeout(this._toggleTimer);const t=this._pop.current;t&&t.componentWillUnmount&&t.componentWillUnmount()}render(t,e){const{open:n}=e,s=this._getTrigger(t);let r;if(n&&(!t.hidePopWhenEmpty||!this._isEmptyValue())){const o=this._getPop(t);r=w(o,{ref:this._pop,...this._getPopProps(t,e),children:this._renderPop(t,e)},"pop")}return w(bn,{children:[w(s,{...this._getTriggerProps(t,e),children:this._renderTrigger(t,e)},"pick"),r]})}};ee.Trigger=Xr,ee.Pop=jl,ee.defaultProps={popContainer:"body",popClass:"popup",popWidth:"100%",popPlacement:"auto",popMinWidth:50,popMinHeight:32,popMaxHeight:300,limitPopInScreen:!0,clickType:"open"};let zd=class extends ee{getDefaultState(t){const e=super.getDefaultState(t);return e.value===void 0&&(t||this.props).required&&(e.value=this.getColors()[0]),e}getColors(){const{colors:t}=this.props;return typeof t=="string"?t.split(","):t||[]}componentDidMount(){this.syncColor()}syncColor(){const{syncBackground:t,syncBorder:e,syncColor:n,syncValue:s}=this.props,r=this.state.value||"";if(t&&g(t).css("backgroundColor",r),e&&g(e).css("borderColor",r),n&&g(n).css("color",r),s){const o=g(s);o.is("input,textarea,select")?o.val(r):o.text(r)}}_handleChange(t,e){this.props.disabled||(super._handleChange(t,e),this.syncColor())}_renderTrigger(t,e){const{icon:n}=t,{value:s}=e;return[n?w(Ht,{icon:n},"icon"):w("span",{class:"color-picker-item bg-current ring ring-gray ring-inset",style:{background:s}})]}_getTriggerProps(t,e){const n=super._getTriggerProps(t,e);return n.style=g.extend({color:e.value},n.style),n.className=q("color-picker",n.className,{disabled:t.disabled}),n}_renderPop(t,e){const{closeBtn:n,heading:s}=t,r=this.getColors(),{value:o}=e;let a;return s&&(a=w("div",{className:"color-picker-heading",children:[s,n?w("button",{className:"btn ghost square rounded size-sm","data-dismiss":"pick",children:w("span",{class:"close"})}):null]},"heading")),[a,w("div",{className:"color-picker-row",children:[r.map(l=>w("button",{className:"btn color-picker-item",style:{backgroundColor:l},"data-pick-value":l,children:o===l?w(Ht,{icon:"check"}):null},l)),w("button",{className:"btn color-picker-item","data-pick-value":"",children:w(Ht,{className:"text-fore",icon:"trash"})})]},"row")]}};zd.defaultProps={...ee.defaultProps,className:"rounded btn square size-sm ghost",popClass:"color-picker-pop popup",colors:["#ef4444","#f97316","#eab308","#84cc16","#22c55e","#14b8a6","#0ea5e9","#6366f1","#a855f7","#d946ef","#ec4899"],closeBtn:!0,popWidth:"auto",popMinWidth:184};class Bl extends mt{}Bl.NAME="ColorPicker",Bl.Component=zd;const Bw="";class Fd extends Tt{constructor(){super(...arguments),this._ref=kt(),this._handleClickItem=(t,e)=>{var n,s;(s=(n=this.props).onChange)==null||s.call(n,t,+e.item.key)}}componentDidMount(){setTimeout(()=>{g(this._ref.current).find(".menu-item>.active").scrollIntoView({container:".menu"})},100)}render(t){const{minuteStep:e=5,hour:n,minute:s}=t,r=[],o=[];for(let l=0;l<24;++l)r.push({key:String(l),text:l<10?`0${l}`:l,active:n===l});for(let l=0;l<60;l+=e)o.push({key:String(l),text:l<10?`0${l}`:l,active:s===l});const a="col w-10 max-h-full overflow-y-auto scrollbar-thin scrollbar-hover";return w("div",{className:"time-picker-menu row",ref:this._ref,children:[w(ve,{className:a,items:r,onClickItem:this._handleClickItem.bind(this,"hour")}),w(ve,{className:a,items:o,onClickItem:this._handleClickItem.bind(this,"minute")})]})}}const Hw="",jd=i=>{if(!i)return;const t=Wt(`1999-01-01 ${i}`);if(!Number.isNaN(t.getDay()))return t};let so=class extends ee{constructor(){super(...arguments),this._handleInputFocus=()=>{this.toggle(!0)},this._handleInputChange=t=>{this.setTime(t.target.value)},this._handleSetTime=(t,e)=>{this.setTime({[t]:String(e)})},this._handleClearBtnClick=()=>{this.setTime("")}}getDefaultState(t){const e=super.getDefaultState(t);return e.value==="now"&&(e.value=Ae(new Date,(t||this.props).format)),e}setTime(t,e){if(!e&&(this.props.disabled||this.props.readonly))return;let n="";if(typeof t=="string")n=t;else{const[h,f]=(this.state.value||"00:00").split(":"),{hour:d=+h,minute:m=+f}=t;n=`${d}:${m}`}const s=jd(n),{onInvalid:r,required:o,defaultValue:a,format:l}=this.props;return this.changeState({value:s?Ae(s,l):o?a:""},()=>{!s&&r&&r(n)})}setValue(t,e){if(e){const n=this._trigger.current;n&&(n._skipTriggerChange=t)}return this.setTime(t,!0)}getTime(){const t=jd(this.state.value);return t?[t.getHours(),t.getMinutes()]:null}_renderTrigger(t,e){const{placeholder:n,icon:s,required:r,disabled:o,readonly:a}=t,{value:l="",open:h}=e,f=`time-picker-${this.id}`;let d;return h&&!r&&l.length?d=w("button",{type:"button",className:"btn size-sm square ghost",onClick:this._handleClearBtnClick,children:w("span",{className:"close"})}):s&&(s===!0?d=w("i",{class:"i-time"}):d=w(Ht,{icon:s})),[w("input",{id:f,type:"text",className:"form-control",placeholder:n,value:l,disabled:o,readOnly:a,autoComplete:"off",onFocus:this._handleInputFocus,onChange:this._handleInputChange},"input"),d?w("label",{for:f,className:"input-control-suffix",children:d},"icon"):null]}_getTriggerProps(t,e){const n=super._getTriggerProps(t,e);return{...n,className:q(n.className,"time-picker input-control has-suffix-icon")}}_renderPop(t){const[e,n]=this.getTime()||[];return w(Fd,{hour:e,minute:n,minuteStep:t.minuteStep,onChange:this._handleSetTime})}};so.defaultProps={...ee.defaultProps,popWidth:"auto",popMaxHeight:320,minuteStep:5,format:"hh:mm",icon:!0};function l_(i,t,e){return t&&i<t?t:e&&i>e?e:i}function Ss(i){if(i==null)return null;if(typeof i=="function"&&(i=i()),typeof i=="string"&&i.startsWith("today")){const t=new Date;i.length>6?i=md(t,i.substring(5).replace("+","")):i=t}else i=Wt(i);return _l(i)?i:null}const Ww="";Nt.addLang({zh_cn:{today:"今天",yearFormat:"{0}年",weekNames:["日","一","二","三","四","五","六"],monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},zh_tw:{today:"今天",yearFormat:"{0}年",weekNames:["日","一","二","三","四","五","六"],monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},en:{today:"Today",yearFormat:"{0}",weekNames:["SUN","MON","TUE","WED","THU","FRI","SAT"],monthNames:["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sept.","Oct.","Nov.","Dec."]}});const c_=(i,t,e=0)=>{const n=new Date(i,t-1,1),s=n.getDay(),r=n.getTime()-(7+s-e)%7*Pi;return{days:7*5,startTime:r,firstDay:n.getTime()}},Bd=(i,t)=>new Set((Array.isArray(i)?i:[i]).map(e=>Ae(e,t)));class h_ extends Tt{constructor(){super(...arguments),this._handleClickDate=t=>{const{onClickDate:e}=this.props;if(!e)return;const n=g(t.target).closest(".mini-calendar-day").dataset("date");n&&e(n)}}render(t){var tt,X;const e=new Date,{weekStart:n=1,weekNames:s=Nt.getLang("weekNames"),monthNames:r=Nt.getLang("monthNames"),year:o=e.getFullYear(),month:a=e.getMonth()+1,highlights:l=[],selections:h=[],maxDate:f,minDate:d}=t,m=[],y="btn ghost square rounded-full";for(let et=0;et<7;et++){const ct=(n+et)%7;m.push(w("div",{className:q("col mini-calendar-day",{"is-weekend":ct===0||ct===6}),children:w("div",{children:s?s[ct]:ct})},et))}const{startTime:b,days:S,firstDay:x}=c_(o,a,n),k=x+S*Pi;let T=b;const j=[],B="yyyy-MM-dd",K=Bd(l,B),G=Bd(h,B),Q=((tt=f?Wt(f):null)==null?void 0:tt.getTime())??Number.MAX_SAFE_INTEGER,Z=((X=d?Wt(d):null)==null?void 0:X.getTime())??0;for(;T<=k;){const et=[];for(let ct=0;ct<7;ct++){const pt=new Date(T),xt=pt.getDate(),Rt=Ae(pt,B),Dt=pt.getDay(),ht=yl(pt,x),J=q("col mini-calendar-day",{active:K.has(Rt),selected:G.has(Rt),"is-first":xt===1,"is-in-month":ht,"is-out-month":!ht,"is-today":Sn(pt,e),"is-weekend":Dt===0||Dt===6,disabled:!Sn(pt,Q)&&!Sn(pt,Z)&&(T>Q||T<Z)});et.push(w("div",{className:J,"data-date":Rt,children:w("button",{type:"button",className:y,onClick:this._handleClickDate,children:xt===1&&r?r[pt.getMonth()]:pt.getDate()})},Rt)),T+=Pi}j.push(w("div",{className:"row",children:et},T))}return w("div",{className:"mini-calendar",children:[w("div",{className:"row",children:m}),j]})}}class Hd extends Tt{constructor(){super(...arguments);Pe(this,Bo,kt());Pe(this,Ho,e=>{const{onChange:n}=this.props;if(!n)return;const r=g(e.target).closest("[data-value]").dataset("value");r&&(n(+r),e.stopPropagation())})}render(e){const{className:n,max:s,min:r,value:o}=e,a=[],l=new Date().getFullYear();for(let h=r;h<=s;++h)a.push(w(Et,{type:"ghost","data-value":h,active:h===o,className:q(l===h?"is-current":""),onClick:we(this,Ho),children:h},h));return w("div",{className:n,ref:we(this,Bo),children:a})}}Bo=new WeakMap,Ho=new WeakMap;class u_ extends Tt{constructor(e){super(e);Pe(this,Wo);Pe(this,Ko);Pe(this,Hs,void 0);Pe(this,Ws,void 0);Pe(this,Ks,void 0);Pe(this,Us,void 0);Pe(this,Vs,void 0);Pe(this,qs,void 0);ze(this,Hs,kt()),ze(this,Ws,r=>{const o=g(r.target).closest("[data-set-date]");o.length&&this.changeDate(o.dataset("set-date"))}),ze(this,Ks,()=>{const{year:r,month:o}=this.state;o===1?this.setState({year:r-1,month:12}):this.setState({month:o-1})}),ze(this,Us,()=>{const{year:r,month:o}=this.state;o===12?this.setState({year:r+1,month:1}):this.setState({month:o+1})}),ze(this,Vs,r=>{this.setState({year:r,select:"day"})}),ze(this,qs,r=>{this.setState({month:r,select:"day"})}),this.changeDate=r=>{var o,a;(a=(o=this.props).onChange)==null||a.call(o,r)};const{date:n}=e,s=Ss(n)||new Date;this.state={select:"day",year:s.getFullYear(),month:s.getMonth()+1}}_showSelect(e){this.setState(n=>n.select===e?{select:"day"}:{select:e})}render(e,n){const{date:s,yearText:r=Nt.getLang("yearFormat")||"{0}",weekNames:o=Nt.getLang("weekNames"),monthNames:a=Nt.getLang("monthNames"),minDate:l,maxDate:h,weekStart:f}=e,d=Ss(s),{year:m,month:y,select:b}=n,S=b==="day",x=l||Wt("1970-1-1"),k=h||Wt("2099-12-31");return w("div",{className:"date-picker-menu row",ref:we(this,Hs),onClick:we(this,Ws),children:[zh(this,Wo,pm).call(this,e),w("div",{className:"cell",style:"width: 312px",children:[w("div",{className:"row p-2",children:[w(Et,{type:b==="year"?"primary-pale":"ghost",size:"sm",caret:!0,onClick:this._showSelect.bind(this,"year"),children:$t(r,m)}),w(Et,{type:b==="month"?"primary-pale":"ghost",size:"sm",caret:!0,onClick:this._showSelect.bind(this,"month"),children:a?a[y-1]:y}),w("div",{className:"flex-auto"}),S?w("div",{children:[w(Et,{type:"ghost",size:"sm",square:!0,onClick:we(this,Ks),children:w("i",{className:"chevron-left"})}),w(Et,{type:"ghost",size:"sm",square:!0,onClick:we(this,Us),children:w("i",{className:"chevron-right"})})]}):null]}),S?w(h_,{weekStart:f,weekNames:o,monthNames:a,maxDate:k,minDate:x,year:m,month:y,selections:d||[],onClickDate:this.changeDate}):null,b==="year"?w(Hd,{className:"date-pick-menu-years overflow-y-auto scrollbar-hover scrollbar-thin",value:m,min:x.getFullYear(),max:k.getFullYear(),onChange:we(this,Vs)}):b==="month"?w(Hd,{className:"date-pick-menu-month overflow-y-auto scrollbar-hover scrollbar-thin",value:y,min:1,max:12,onChange:we(this,qs)}):null,S?zh(this,Ko,mm).call(this,e):null]})]})}}Hs=new WeakMap,Ws=new WeakMap,Ks=new WeakMap,Us=new WeakMap,Vs=new WeakMap,qs=new WeakMap,Wo=new WeakSet,pm=function(e){return ve.render(e.menu,[],{onClickItem:n=>{const s=n.item.value;typeof s=="string"&&this.changeDate(s)}},this)},Ko=new WeakSet,mm=function(e){let{actions:n}=e;const{todayText:s=Nt.getLang("today"),clearText:r}=e;return n===void 0&&(n=[{text:s,"data-set-date":Ae(new Date,"yyyy-MM-dd")}]),Array.isArray(n)&&(n={items:n}),w("div",{className:"date-picker-menu-footer",children:[w(Zt,{btnProps:{className:"ghost text-primary"},...n}),r?w(Et,{type:"ghost text-link","data-set-date":"",children:r}):null]})};const Kw="";let zi=class extends ee{constructor(){super(...arguments),this.setDate=(t,e)=>{const{disabled:n,readonly:s}=this.props;if(!e&&(n||s))return;const r=this._calcValue(t);return this.changeState({value:r},()=>{this._afterSetDate()})},this._handleInputFocus=()=>{this.toggle(!0)},this._handleInputChange=t=>{this.setDate(t.target.value)},this._handleClearBtnClick=()=>{this.setDate("")},this._handleSetDate=t=>{this.setDate(t)}}getDefaultState(t){const e=super.getDefaultState(t);return{...e,value:this._calcValue(e.value)}}getDate(){return this._date}setValue(t,e){if(e){const n=this._trigger.current;n&&(n._skipTriggerChange=t)}return this.setDate(t,!0)}_calcValue(t){const{onInvalid:e,defaultValue:n="",required:s,allowInvalid:r,format:o}=this.props;let a=this._parseDate(t);if(!a&&e){const l=e(t);l&&(a=this._parseDate(l))}return this._date=a,a?Ae(a,o):r?t:s?n:""}_getDateRange(t){const{minDate:e,maxDate:n}=this.props;return[Ss(typeof e=="function"?e(t):e),Ss(typeof n=="function"?n(t):n)]}_parseDate(t){const e=Ss(t);return e?l_(e,...this._getDateRange(t)):null}_afterSetDate(){this.toggle(!1)}_renderTrigger(t,e){const{placeholder:n,icon:s,required:r,disabled:o,readonly:a,display:l}=t,{value:h="",open:f}=e,d=`date-picker-${this.id}`;let m;f&&!r&&h.length?m=w("button",{type:"button",className:"btn size-sm square ghost",onClick:this._handleClearBtnClick,children:w("span",{className:"close"})}):s&&(s===!0?m=w("i",{class:"i-calendar"}):m=w(Ht,{icon:s}));const y=f?h:l?l(h,this._date):h;return[w("input",{id:d,type:"text",className:"form-control",placeholder:n,value:y,disabled:o,readOnly:a,autoComplete:"off",onFocus:this._handleInputFocus,onChange:this._handleInputChange},"input"),m?w("label",{for:d,className:"input-control-suffix",children:m},"icon"):null]}_getTriggerProps(t,e){const n=super._getTriggerProps(t,e);return{...n,className:q(n.className,"date-picker input-control has-suffix-icon")}}_getPopProps(t,e){const n=super._getPopProps(t,e);return{...n,className:q(n.className,"popup")}}_renderPop(t,e){const{weekNames:n,monthNames:s,weekStart:r,yearText:o,todayText:a,clearText:l,menu:h,actions:f,required:d}=t,[m,y]=this._getDateRange(e.value);return w(u_,{onChange:this._handleSetDate,date:this._date,weekNames:n,monthNames:s,weekStart:r,yearText:o,todayText:a,clearText:d?"":l,menu:h,actions:f,minDate:m,maxDate:y})}};zi.defaultProps={...ee.defaultProps,popWidth:"auto",popMaxHeight:320,format:"yyyy-MM-dd",icon:!0,limitPopInScreen:!1};let Hl=class extends zi{constructor(){super(...arguments),this._handleSetDate=t=>{const e=Wt(t),n=this.getDate()||new Date;e.setHours(n.getHours()),e.setMinutes(n.getMinutes()),this.setDate(Ae(e,this.props.format))},this._handleSetTime=(t,e)=>{const n=this.getDate()||new Date;t==="hour"?n.setHours(e):n.setMinutes(e),this.setDate(Ae(n,this.props.format))}}getTime(){const t=this.getDate();return t?[t.getHours(),t.getMinutes()]:null}_afterSetDate(){}_renderPop(t,e){const[n,s]=this.getTime()||[];return w("div",{className:"datetime-picker-menu row",children:[super._renderPop(t,e),w("div",{className:"divider"}),w(Fd,{hour:n,minute:s,minuteStep:t.minuteStep,onChange:this._handleSetTime})]})}};Hl.defaultProps={...zi.defaultProps,popMaxHeight:310,format:"yyyy-MM-dd hh:mm",minuteStep:5};class ro extends mt{}ro.NAME="TimePicker",ro.Component=so,ro.register();class oo extends mt{}oo.NAME="DatePicker",oo.Component=zi,oo.register();class ao extends mt{}ao.NAME="DatetimePicker",ao.Component=Hl,ao.register();const Uw="",Wd="show",Wl="in",d_='[data-dismiss="modal"]',lo="modal-hide",Fi=class bi extends zt{constructor(){super(...arguments),this._timer=0,this._handleClick=t=>{const e=t.target,n=e.closest(".modal");!n||n!==this.modalElement||(e.closest(d_)||this.options.backdrop===!0&&e===n)&&(t.preventDefault(),this.hide())}}static get SELECTOR(){return".modal"}get modalElement(){return this.element}get shown(){return this._shown}get dialog(){return this.modalElement.querySelector(".modal-dialog")}get rob(){return this._rob}_observeResize(){var t;if(this.options.responsive&&typeof ResizeObserver<"u"){(t=this._rob)==null||t.disconnect();const{dialog:e}=this;if(e){const n=new ResizeObserver(()=>{if(!this._shown)return;const s=e.clientWidth,r=e.clientHeight,[o,a]=this._lastDialogSize||[];(o!==s||a!==r)&&(this._lastDialogSize=[s,r],this.layout())});n.observe(e),this._rob=n}}}afterInit(){this.on("click",this._handleClick),this.options.show&&this.show(),this._observeResize(),this.on("hidden",t=>{const{modalElement:e}=this;if(!e.parentNode)return this.destroy();t.target.closest(".modal")===e&&!bi.getAll().some(n=>n.shown)&&g("html").enableScroll()}),this.on("show",t=>{const{modalElement:e}=this;if(!e.parentNode)return this.destroy();t.target.closest(".modal")===e&&g("html").disableScroll()}),this.shown&&g("html").disableScroll()}destroy(){super.destroy(),this._rob&&(this._rob.disconnect(),this._rob=void 0)}show(t){var h;const{modalElement:e}=this,n=g(e);if(this._shown&&n.hasClass(Wl))return n.removeClass(lo).css("z-index",`${bi.zIndex++}`),!1;this._shown=!0,this.setOptions(t);const{animation:s,backdrop:r,className:o,style:a}=this.options;n.setClass({"modal-trans":s,"modal-no-backdrop":!r,[lo]:!1},Wd,o).css({zIndex:`${bi.zIndex++}`,...a});const l=this.constructor;return l.hideOthers&&this.options.hideOthers!==!1&&l.getAll().forEach(f=>{f!==this&&f.shown&&!n.closest(f.modalElement).length&&f.hideForOther()}),this.options.closeOthers&&l.getAll().forEach(f=>{f!==this&&!n.closest(f.modalElement).length&&f.hide()}),this.layout(),(h=this.options.onShow)==null||h.call(this),this.emit("show"),this._setTimer(()=>{n.addClass(Wl),this._setTimer(()=>{var f,d;(f=n.find("[autofocus]")[0])==null||f.focus(),(d=this.options.onShown)==null||d.call(this),this.emit("shown")})},50),!0}hideForOther(){g(this.modalElement).addClass(lo)}hide(){var e;if(!this._shown)return!1;this._shown=!1,g(this.modalElement).removeClass(Wl),(e=this.options.onHide)==null||e.call(this),this.emit("hide"),this._setTimer(()=>{var n;g(this.modalElement).removeClass(Wd),(n=this.options.onHidden)==null||n.call(this),this.emit("hidden")});const t=this.constructor;return t.hideOthers&&this.options.hideOthers!==!1&&t.getAll().forEach(n=>{n.shown&&n!==this&&g(n.modalElement).removeClass(lo)}),!0}layout(t,e){if(!this._shown)return;const{dialog:n}=this;if(!n)return;const s=g(n);if(e=e??this.options.size,e){s.removeAttr("data-size");const f={width:"",height:""};typeof e=="object"?(f.width=e.width,f.height=e.height):typeof e=="string"&&["md","sm","lg","full"].includes(e)?s.attr("data-size",e):e&&(f.width=e),s.css(f)}t=t??this.options.position??"fit";const r=n.clientWidth,o=n.clientHeight;this._lastDialogSize=[r,o],typeof t=="function"&&(t=t({width:r,height:o}));const a={left:null,bottom:null,right:null};let l=null,h="center";typeof t=="number"?(h="flex-start",l=t):typeof t=="object"&&t?(Object.assign(a,t),l=a.top??l,h=a.alignSelf??"flex-start"):t==="fit"?(h="flex-start",l=`${Math.max(0,Math.floor((window.innerHeight-o)/3))}px`):t==="bottom"?h="flex-end":t==="top"?h="flex-start":t!=="center"&&typeof t=="string"&&(h="flex-start",l=t),a.top=l,a.alignSelf=h,s.css(a),g(this.modalElement).css("justifyContent",a.left?"flex-start":"center")}_setTimer(t,e){this._timer&&(clearTimeout(this._timer),this._timer=0),t&&(this.options.animation?this._timer=window.setTimeout(t,e??this.options.transTime):t())}static last(t){return bi.query(t,void 0,e=>e.shown)}static hide(t){var e;(e=bi.last(t))==null||e.hide()}static show(t){var e;(e=bi.query(t,void 0,n=>!n.shown))==null||e.show()}};Fi.NAME="Modal",Fi.MULTI_INSTANCE=!0,Fi.DEFAULT={position:"fit",show:!0,keyboard:!0,animation:!0,backdrop:!0,responsive:!0,transTime:300},Fi.hideOthers=!0,Fi.zIndex=1500;let ji=Fi;g(window).on(`resize.${ji.NAMESPACE}`,()=>{ji.getAll().forEach(i=>{const t=i;t.shown&&t.options.responsive&&t.layout()})});class Kd extends Tt{constructor(t){super(t),this._ref=kt(),this.state={showed:!t.waitShowEvent}}componentDidMount(){const{waitShowEvent:t,afterRender:e}=this.props;e==null||e.call(this,{firstRender:!0}),t&&g(this._ref.current).on(t,()=>{this.setState({showed:!0})})}componentDidUpdate(){var t;(t=this.props.afterRender)==null||t.call(this,{firstRender:!1})}componentWillUnmount(){var t;(t=this.props.beforeDestroy)==null||t.call(this)}renderHeader(){const{header:t,headerClass:e,title:n}=this.props;return E.isValidElement(t)?t:t===!1||!n?null:t?w(gt,{className:q("modal-header",e),content:t}):w("div",{className:q("modal-header",e),children:w("div",{className:"modal-title",children:n})})}renderActions(){const{actions:t,closeBtn:e}=this.props;return!e&&!t?null:E.isValidElement(t)?t:w("div",{className:"modal-actions",children:[t?w(Zt,{...t}):null,e?w("button",{type:"button",class:"btn square ghost","data-dismiss":"modal",children:w("span",{class:"close"})}):null]})}renderBody(){const{body:t,bodyClass:e}=this.props;return t?E.isValidElement(t)?t:w(gt,{className:q("modal-body",e),content:t}):null}renderFooter(){const{footer:t,footerClass:e,footerActions:n}=this.props;return E.isValidElement(t)?t:t===!1||!n?null:t?w(gt,{className:q("modal-footer",e),content:t}):w("div",{className:q("modal-footer",e),children:n?w(Zt,{...n}):null})}render(){const{className:t,style:e,contentClass:n,children:s,waitShowEvent:r}=this.props,o=r&&!this.state.showed;return w("div",{ref:r?this._ref:void 0,className:q("modal-dialog",t,o?"loading":""),style:e,children:[w("div",{className:q("modal-content",n),children:[this.renderHeader(),this.renderActions(),this.renderBody(),s,this.renderFooter()]}),o?w("div",{class:"load-indicator loading"}):null]})}}Kd.defaultProps={closeBtn:!0};class Kl extends Tt{constructor(){super(...arguments),this._ref=kt(),this.state={},this._handleIframeLoad=()=>{const t=this.iframeDoc;if(!t)return;const{iframeBodyClass:e,watchHeight:n}=this.props;n&&this._watchIframeHeight(),e&&t.body.classList.add(e),g(this._ref.current).trigger("modal-iframe-loaded")}}get iframeDoc(){var t,e;return(e=(t=this._ref.current)==null?void 0:t.contentWindow)==null?void 0:e.document}componentDidMount(){this.props.watchHeight&&this._watchIframeHeight()}componentWillUnmount(){var t;(t=this._rob)==null||t.disconnect()}_watchIframeHeight(){const t=this.iframeDoc;if(!t)return;let e=this._rob;e==null||e.disconnect(),e=new ResizeObserver(()=>{const n=t.body,s=t.documentElement,r=Math.ceil(Math.max(n.scrollHeight,n.offsetHeight,s.offsetHeight));this.setState({height:r})}),e.observe(t.body),e.observe(t.documentElement),this._rob=e}render(){return w("iframe",{className:"modal-iframe",style:this.state,src:this.props.url,ref:this._ref,onLoad:this._handleIframeLoad})}}Kl.defaultProps={watchHeight:!0};var Ul=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)},Be=(i,t,e)=>(Ul(i,t,"read from private field"),e?e.call(i):t.get(i)),xs=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},Bi=(i,t,e,n)=>(Ul(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),co=(i,t,e)=>(Ul(i,t,"access private method"),e),cn,$s,hn,ho,Vl,uo,ql;function f_(i,t){const{custom:e,title:n,content:s}=t;return{body:s,title:n,...typeof e=="function"?e():e}}async function p_(i,t){const{dataType:e="html",url:n,request:s,custom:r,title:o,replace:a=!0,executeScript:l=!0}=t,h=await g.ajax({url:n,headers:{"X-ZUI-Modal":"true"},...s});if(e!=="html")try{const f=JSON.parse(h);return{title:o,...r,...f}}catch{}return a!==!1&&e==="html"?[h]:{title:o,...r,body:e==="html"?w(kn,{className:"modal-body",html:h,executeScript:l}):h}}async function m_(i,t){const{url:e,custom:n,title:s,size:r}=t,o=typeof r=="object"&&typeof r.height=="number";return{title:s,...n,waitShowEvent:"modal-iframe-loaded",body:w(Kl,{url:e,watchHeight:!o})}}const g_={custom:f_,ajax:p_,iframe:m_},Ud="loading",Vd=class wi extends ji{constructor(){super(...arguments),xs(this,ho),xs(this,uo),xs(this,cn,void 0),xs(this,$s,void 0),xs(this,hn,void 0)}get id(){return Be(this,$s)}get loading(){var t;return(t=Be(this,cn))==null?void 0:t.classList.contains(Ud)}get shown(){var t;return!!((t=Be(this,cn))!=null&&t.classList.contains("show"))}get modalElement(){let t=Be(this,cn);if(!t){const{options:e}=this;let n=Be(this,$s);n||(n=e.id||`modal-${_e()}`,Bi(this,$s,n));const{$element:s}=this;if(t=s.find(`#${n}`)[0],t)g(t).data(this.constructor.KEY,this);else{const r=this.key;t=g("<div>").attr({id:n,"data-key":r}).data(this.constructor.KEY,this).css(e.style||{}).setClass("modal modal-async load-indicator",e.className).appendTo(s)[0]}Bi(this,cn,t)}return t}get $emitter(){const t=Be(this,cn);return t?g(t):this.$element}afterInit(){super.afterInit(),this.options.destroyOnHide&&this.options.type!=="static"&&this.on("hidden",t=>{g(t.target).data("key")===this.key&&this.destroy()})}show(t){return super.show(t)?(this.buildDialog(),!0):!1}destroy(){super.destroy();const t=Be(this,cn);t&&(g(t).removeData(this.constructor.KEY).remove(),Bi(this,cn,void 0))}render(t){return super.render(t),this.buildDialog()}async buildDialog(){if(this.loading)return!1;Be(this,hn)&&clearTimeout(Be(this,hn));const{modalElement:t,options:e}=this,n=g(t),{type:s,loadTimeout:r,loadingClass:o=Ud,loadingText:a=null}=e;if(!s||s==="static")return!0;const l=g_[s];if(!l)return console.warn(`Modal: Cannot build modal with type "${s}"`),!1;n.attr("data-loading",a).addClass(o),r&&Bi(this,hn,window.setTimeout(()=>{Bi(this,hn,0),co(this,uo,ql).call(this,this.options.timeoutTip)},r));const h=await l.call(this,t,e);return this._destroyed?!1:(h===!1?await co(this,uo,ql).call(this,this.options.failedTip):h&&typeof h=="object"&&await co(this,ho,Vl).call(this,h),Be(this,hn)&&(clearTimeout(Be(this,hn)),Bi(this,hn,0)),this.layout(),await as(100),n.removeClass(o),!0)}static isValid(t){return!g.isDetached(t.modalElement)}static open(t){return new Promise(e=>{const{container:n=document.body,ref:s,...r}=t,o={show:!0,...r};!o.type&&o.url&&(o.type="ajax"),!o.type&&t.id&&(o.type="static"),o.key===void 0&&(o.key=o.id);const a=wi.ensure(n,o);s&&(s.current=a);const l=`${wi.NAMESPACE}.open${_e()}`;a.on(`hidden${l}`,()=>{a.off(l),e(a)}),a.show()})}static async alert(t){typeof t=="string"&&(t={message:t});const{type:e,message:n,icon:s,iconClass:r="icon-lg muted",actions:o="confirm",onClickAction:a,custom:l,key:h="__alert",...f}=t,d=(typeof l=="function"?l():l)||{};let m=typeof n=="object"&&n.html?w("div",{dangerouslySetInnerHTML:{__html:n.html}}):w("div",{children:n});s?m=w("div",{className:q("modal-body row gap-4 items-center",d.bodyClass),children:[w("div",{className:`icon ${s} ${r}`}),m]}):m=w("div",{className:q("modal-body",d.bodyClass),children:m});const y=[];(Array.isArray(o)?o:[o]).forEach(x=>{x={...typeof x=="string"?{key:x}:x},typeof x.key=="string"&&(x.text||(x.text=Nt.getLang(x.key,x.key)),x.btnType||(x.btnType=`btn-wide ${x.key==="confirm"?"primary":"btn-default"}`)),x&&y.push(x)},[]);let b;const S=y.length?{gap:4,items:y,onClickItem:({item:x,event:k})=>{const T=wi.query(k.target);if(!T||T.key!==h)return;b=x.key,(a==null?void 0:a(x,T))!==!1&&T&&T.hide()}}:void 0;return await wi.open({key:h,type:"custom",size:400,className:"modal-alert",content:m,modal:!0,backdrop:"static",hideOthers:!1,custom:{footerActions:S,...d},...f}),b}static async confirm(t){typeof t=="string"&&(t={message:t});const{onClickAction:e,onResult:n,...s}=t;return await wi.alert({actions:["confirm","cancel"],onClickAction:(o,a)=>{n==null||n(o.key==="confirm",a),e==null||e(o,a)},...s})==="confirm"}static async prompt(t){typeof t=="string"&&(t={message:t});const{defaultValue:e="",placeholder:n,onResult:s,onShown:r,message:o,content:a,bodyClass:l,custom:h,...f}=t;let d=e,m=!1;const y=kt();return await wi.confirm({...f,custom:{closeBtn:!1,...h},message:o,ref:y,content:w("div",{className:q("modal-body",l),children:[w(gt,{content:o}),w("input",{type:"text",className:"modal-prompt-input form-control mt-3",autoFocus:!0,placeholder:n,defaultValue:e,onChange:S=>{d=S.target.value},onKeyDown:S=>{var x,k;S.key==="Enter"?(m=!0,S.preventDefault(),(x=y.current)==null||x.hide()):S.key==="Escape"&&((k=y.current)==null||k.hide())}}),a]})})||m?d:null}};cn=new WeakMap,$s=new WeakMap,hn=new WeakMap,ho=new WeakSet,Vl=function(i){return new Promise(t=>{if(Array.isArray(i))return g(this.modalElement).html(i[0]).zuiInit(),this.layout(),this._observeResize(),t();const{afterRender:e,...n}=i;i={afterRender:s=>{this.layout(),e==null||e(s),this._observeResize(),t()},...n},ni(w(Kd,{...i}),this.modalElement)})},uo=new WeakSet,ql=function(i){if(i)return co(this,ho,Vl).call(this,{body:w("div",{className:"modal-load-failed",children:i})})},Vd.DEFAULT={...ji.DEFAULT,loadTimeout:1e4,destroyOnHide:!0};let Vt=Vd;Vt.register();class Hi extends zt{get modal(){return this._modal}get container(){const{container:t}=this.options;return typeof t=="string"?document.querySelector(t):t instanceof HTMLElement?t:document.body}show(){var t;return(t=this._initModal())==null?void 0:t.show()}hide(){var t;return(t=this._modal)==null?void 0:t.hide()}_getBuilderOptions(){const{container:t,...e}=this.options,n=e,s=this.$element.attr("href")||"";return n.type||(n.target||s[0]==="#"?n.type="static":n.type=n.type||(n.url||s?"ajax":"custom")),!n.url&&(n.type==="iframe"||n.type==="ajax")&&s[0]!=="#"&&(n.url=s),n.key===void 0&&(n.key=`${this._key}`),n}_initModal(){const t=this._getBuilderOptions();let e=this._modal;if(e)return e.setOptions(t),e;if(t.type==="static"){const n=this._getStaticModalElement();if(!n)return;e=ji.ensure(n,t)}else e=Vt.ensure(this.container,t);return this._modal=e,e.on("destroyed",()=>{this._modal=void 0}),e}_getStaticModalElement(){let t=this.options.target;if(!t){const{$element:e}=this;if(e.is("a")){const n=e.attr("href");n!=null&&n.startsWith("#")&&(t=n)}}return this.container.querySelector(t||".modal")}}Hi.NAME="ModalTrigger",Hi.toggle={name:"modal",skip:"[disabled],.disabled,.open-in-parent",convertHref:!0,onGet(i){return Hi.get(i)},onCreate(i,t,e){return new Hi(i,e)}},Hi.register();const y_={zh_cn:{selectFile:"选择文件",fileSelectTip:"（不超过 {maxFileSize}）",removeFile:"移除文件",renameFile:"重命名",duplicatedTip:"文件 “{name}”（{size}） 已存在。",exceededSizeTip:"文件 “{name}”（{size}） 超过了 {maxSize} 的限制。",exceededTotalSizeTip:"文件 “{name}”（{size}） 超过了总大小 {totalFileSize} 的限制。",exceededCountTip:"文件 “{name}”（{size}） 超过了数量 {maxFileCount} 的限制。"},zh_tw:{selectFile:"選擇文件",fileSelectTip:"（不超過 {maxFileSize}）",removeFile:"移除文件",renameFile:"重命名",duplicatedTip:"文件 “{name}”（{size}） 已存在。",exceededSizeTip:"文件 “{name}”（{size}） 超過了 {maxFileSize} 的限制。",exceededTotalSizeTip:"文件 “{name}”（{size}） 超過了總大小 {totalFileSize} 的限制。",exceededCountTip:"文件 “{name}”（{size}） 超過了數量 {maxFileCount} 的限制。"},en:{selectFile:"Select File",fileSelectTip:"(Not exceeding {maxFileSize})",removeFile:"Remove File",renameFile:"Rename",duplicatedTip:"File “{name}” ({size}) already exists.",exceededSizeTip:"File “{name}” ({size}) exceeds the limit of {maxFileSize}.",exceededTotalSizeTip:"File “{name}” ({size}) exceeds the total size limit of {totalFileSize}.",exceededCountTip:"File “{name}” ({size}) exceeds the limit of {maxFileCount}."}};let Mn=class extends Ft{constructor(t){super(t),this._input=kt(),this._file=kt(),this._id=`file-selector-input-${_e()}`,this._data=new DataTransfer,this.stopRenameFile=()=>{const{renaming:e,newName:n}=this.state;this.cancelRenameFile(),!(!e||!n)&&this.renameFile(e,n)},this.cancelRenameFile=()=>{this.setState({renaming:""})},this._handleChange=e=>{const n=e.target;n.files&&(this.selectFiles(n.files),this.setState({inputKey:_e()}))},this._handleDragOver=e=>{e.preventDefault(),this.state.dragging||this.setState({dragging:!0})},this._handleDragLeave=e=>{e.preventDefault(),this.setState({dragging:!1})},this._handleDrop=e=>{var s;this._handleDragLeave(e);const n=this.constructor.filterFiles(((s=e.dataTransfer)==null?void 0:s.files)||[],this.props.accept);n.length&&(this.selectFiles(n),this.setState({inputKey:_e()}))},this._handleRenameChange=e=>{this.setState({newName:e.target.value})},this._handleClick=e=>{if(this.props.disabled)return;const s=g(e.target).closest("[data-remove-file],[data-rename-file]");if(!s.length)return;const r=s.data();r.renameFile?this.startRenameFile(r.renameFile):r.removeFile&&this.removeFile(r.removeFile)},this.state={files:(t.defaultFiles||[]).map(e=>this.constructor.getInfo(e)),inputKey:0}}get size(){return this.state.files.reduce((t,e)=>t+e.size,0)}get count(){return this.state.files.length}get multiple(){const{multiple:t,maxFileCount:e,name:n=""}=this.props;return!!(e!==1&&(t??n.endsWith("[]")))}get info(){const{maxFileSize:t=0,maxFileCount:e=Number.MAX_SAFE_INTEGER}=this.props;return{size:fe(this.size,1),maxFileSize:fe(typeof t=="string"?ki(t):t,1),maxFileCount:e,count:this.count}}get files(){return this._data.files}componentDidMount(){const t=this.state.files.reduce((e,n)=>(n.file&&e.push(n.file),e),[]);t.length&&(t.forEach(e=>this._data.items.add(e)),this._syncFiles())}getFile(t){return this.state.files.find(e=>e.id===t)}getFileByName(t){return this.state.files.find(e=>e.name===t)}select(){var t;(t=this._input.current)==null||t.click()}async selectFiles(t){var e;if(((e=this.props.onSelect)==null?void 0:e.call(this,t))!==!1){this._skipAddMore=!1;for(let n=0;n<t.length&&(await this.addFile(t[n]),!this._skipAddMore);n++);}}async _checkDuplicated(t){const{allowSameName:e,onDuplicated:n,duplicatedTip:s=this.i18n("duplicatedTip")}=this.props,{name:r}=t,o=e?this.getFile(t.id):this.getFileByName(r);return o?((n==null?void 0:n.call(this,r,t,o))===!0||s&&await this._showAlert(s,{name:r,size:fe(t.size,1)}),!0):!1}async _checkExceededSize(t){const{maxFileSize:e,onExceededSize:n,exceededSizeTip:s=this.i18n("exceededSizeTip")}=this.props;if(!e)return!1;const r=typeof e=="string"?ki(e):e;return t.size<=r?!1:((n==null?void 0:n.call(this,r,t))===!0||s&&await this._showAlert(s,{name:t.name,size:fe(t.size,1)}),!0)}async _checkTotalSize(t){const{totalFileSize:e,onExceededTotalSize:n,exceededTotalSizeTip:s=this.i18n("exceededTotalSizeTip")}=this.props;if(!e)return!1;const r=typeof e=="string"?ki(e):e,o=t.size+this.size;return o<=r?!1:((n==null?void 0:n.call(this,r,t))===!0||s&&await this._showAlert(s,{name:t.name,size:fe(t.size,1),totalSize:fe(o,1)}),!0)}async _checkExceededCount(t){const{maxFileCount:e=0,onExceededCount:n,exceededCountTip:s=this.i18n("exceededCountTip")}=this.props;if(!e)return!1;const r=this.count+1;return r<=e?!1:((n==null?void 0:n.call(this,e,t))===!0||s&&await this._showAlert(s,{name:t.name,size:fe(t.size,1),exceededCount:r}),!0)}async addFile(t){const{onAdd:e,disabled:n}=this.props;if(n)return!1;const s=this.constructor.getInfo(t);return await this._checkExceededCount(s)?(this._skipAddMore=!0,!1):await this._checkDuplicated(s)?!1:await this._checkExceededSize(s)?(this._skipAddMore=!0,!1):await this._checkTotalSize(s)?(this._skipAddMore=!0,!1):e&&e.call(this,s)===!1?!1:(this._data.items.add(t),this._syncFiles(!0),await this.changeState(h=>({files:[...h.files,s]})),!0)}startRenameFile(t){this.setState({renaming:t,newName:void 0},()=>{const e=g(this._file.current).closest(".file-selector").find(".file-selector-rename-input")[0];e&&(e.select(),e.focus())})}async renameFile(t,e){const n=this.getFile(t);if(!n||n.name===e)return;const{onRename:s}=this.props;if(s&&await s.call(this,e,n.name,n)===!1)return;const r=n.file;if(r){const l=new File([r],e,{type:r.type,lastModified:r.lastModified}),h=Array.from(this._data.files).indexOf(r);h>=0&&this._data.items.remove(h),this._data.items.add(l),this._syncFiles(!0),n.file=l}n.name=e,n.ext=this.constructor.getExt(e);const{files:o}=this.state,a=o.indexOf(n);a>=0?o.splice(a,1,n):o.push(n),this.setState({files:[...o]})}async removeFile(t){const e=this.getFile(t);if(!e)return;const{onRemove:n,removeConfirm:s}=this.props;if(s){let o=s;if(typeof o=="string"&&(o={message:o}),typeof o.message=="string"&&(o.message=$t(o.message,{name:e.name,size:fe(e.size,1)})),!await Vt.confirm(o))return}if(n&&await n.call(this,e)===!1)return;if(e.file){const o=Array.from(this._data.files).indexOf(e.file);o>=0&&this._data.items.remove(o)}const r=this.state.files.indexOf(e);r>=0&&(this.state.files.splice(r,1),this.setState({files:this.state.files}),this._syncFiles(!0))}_syncFiles(t=!1){const e=this._data.files,n=this._file.current;n.files=e,t&&g(n).trigger("change",{files:e})}_showAlert(t,e){return typeof t=="string"&&(t={message:t}),typeof t.message=="string"&&(t.message=$t(t.message,{...this.info,...e})),Vt.alert(t)}_getTip(t){return typeof t=="string"?$t(t,this.info):t}_renderInput(t){return w("input",{id:this._id,multiple:this.multiple,accept:t.accept,style:"display:none",type:"file",ref:this._input,onChange:this._handleChange},`input${this.state.inputKey}`)}_getDraggableProps(){const t={};return this.props.draggable&&!this.props.disabled&&(t.onDragOver=this._handleDragOver,t.onDragLeave=this._handleDragLeave,t.onDrop=this._handleDrop),t}_renderUpload(t){const{mode:e,disabled:n,tip:s=this.i18n("fileSelectTip"),uploadBtn:r}=t,o=vt({component:"label",attrs:{for:n?void 0:this._id},disabled:n,text:this.i18n("selectFile")},typeof r=="object"?r:typeof r=="string"?{text:r}:{}),a=w("div",{className:"file-selector-tip",children:w(gt,{content:this._getTip(s),generatorThis:this,generatorArgs:[this.state]})}),l=e==="grid",h=l?{}:this._getDraggableProps();return l||e==="box"?w(Et,{...o,...h,className:q(l?"file-selector-grid-btn":"file-selector-box",o.className),children:a},"upload"):w("div",{className:"file-selector-btn",...h,children:[w(Et,{rounded:"full",size:"sm",...o}),a]},"upload")}_renderForForm(t){const{name:e,accept:n,onChange:s}=t;return w("input",{ref:this._file,type:"file",name:e,multiple:this.multiple,accept:n,style:"display:none",onChange:s},"form")}_getIcon(t){let{fileIcons:e}=this.props;if(e)return typeof e=="string"&&(e={default:e}),e[t.ext]??e.default}_getThumbnail(t){if((t.file||t.url)&&this.props.thumbnail&&this.constructor.isImage(t))return t.url||URL.createObjectURL(t.file)}_getAvatar(t){const e=this._getThumbnail(t);let n;if(e)n={src:e};else{const s=this._getIcon(t);s&&(n={icon:s})}return n&&{size:this.props.mode==="grid"?void 0:"sm",...n}}_getFileActions(t){if(this.props.disabled)return;let{removeBtn:e,renameBtn:n}=this.props;typeof e=="function"&&(e=e.call(this,t)),typeof e=="string"?e={text:e}:e===!0&&(e={hint:this.i18n("removeFile"),icon:"trash"}),typeof n=="function"&&(n=n.call(this,t)),typeof n=="string"?n={text:n}:n===!0&&(n={hint:this.i18n("renameFile"),icon:"edit"});const s=[];return n&&s.push({"data-rename-file":t.id,...n}),e&&s.push({"data-remove-file":t.id,...e}),s}_renderFile(t){let{itemProps:e}=this.props;return e=vt({className:this.props.mode==="grid"?"file-selector-grid-item":"file-selector-item",multiline:!1,title:t.name,subtitle:fe(t.size,1),avatar:this._getAvatar(t),actions:this._getFileActions(t),"z-id":t.id},typeof e=="function"?e.call(this,t):e),w(qe,{...e},t.id)}_renderFileRename(t){let{itemProps:e}=this.props;if(typeof e=="function")e=e.call(this,t);else{const{newName:n=t.name}=this.state,s=this.props.mode==="grid",r=w("div",{className:"file-selector-rename-text",children:[w("div",{className:"form-control size-sm",children:n}),w("input",{type:"text",defaultValue:t.name,className:"form-control size-sm select-all file-selector-rename-input",autofocus:!0,onBlur:s?this.stopRenameFile:void 0,onChange:this._handleRenameChange,onInput:this._handleRenameChange})]});e=vt({className:`${s?"file-selector-grid-item":"file-selector-item"} is-renaming`,multiline:!1,avatar:this._getAvatar(t),"z-id":t.id,contentClass:"file-selector-rename",content:s?r:[r,w(Et,{icon:"check",text:this.i18n("confirm"),type:"primary-pale",size:"sm",onClick:this.stopRenameFile}),w(Et,{icon:"close",text:this.i18n("cancel"),type:"gray-pale",size:"sm",onClick:this.cancelRenameFile})]},e)}return w(qe,{...e},t.id)}_renderList(t){const{files:e,renaming:n}=this.state;return w("div",{className:`file-selector-list${e.length?"":" is-empty"}`,onClick:this._handleClick,children:e.map(s=>s.id===n?this._renderFileRename(s):this._renderFile(s))},"list")}_renderGrid(t){const e=this._getDraggableProps(),{gridWidth:n=120,gridHeight:s=148,gridGap:r=12}=t,o={"--file-selector-grid-width":Bt(n),"--file-selector-grid-height":Bt(s),"--file-selector-grid-gap":Bt(r)},{files:a,renaming:l}=this.state;return w("div",{className:"file-selector-grid",style:o,onClick:this._handleClick,...e,children:[a.map(h=>h.id===l?this._renderFileRename(h):this._renderFile(h)),this._renderUpload(t)]},"grid")}_getClassName(t){return["file-selector",`is-mode-${t.mode}`,t.className,this.state.dragging?"is-dragging":""]}_getChildren(t){const e=t.mode==="grid";return[e?null:this._renderUpload(t),e?this._renderGrid(t):this._renderList(t),this._renderInput(t),this._renderForForm(t)]}static getExt(t){return(t.split(".").pop()||"").toLowerCase()}static getInfo(t){const{name:e,size:n,type:s}=t;if(t instanceof File)return{name:e,size:n,type:s,file:t,id:[e,n].join(":"),ext:this.getExt(e)};const r=typeof n=="string"?ki(n):n;return{name:e,size:r,id:t.id??[e,r].join(":"),type:s??"",ext:this.getExt(e),file:t.file,url:t.url}}static isAccept(t,e){return!e||!e.length?!0:(Array.isArray(e)?e:e.split(",")).some(s=>t.type&&s===t.type?!0:s.startsWith(".")?t.name.endsWith(s):s.endsWith("/*")?t.type.startsWith(s.slice(0,-1)):!1)}static isImage(t){return this.isAccept(t,this.imageAccepts)}static filterFiles(t,e){if(!e||!e.length)return t;t instanceof FileList&&(t=Array.from(t));const n=e.split(",");return t.filter(s=>this.isAccept(s,n))}};Mn.defaultProps={mode:"button",maxFileSize:"100MB",fileIcons:"file",renameBtn:!0,removeBtn:!0,draggable:!0,thumbnail:!0,maxFileCount:0},Mn.i18n=y_,Mn.imageAccepts="image/*,.png,.jpg,.jpeg,.gif";let Gl=class extends Mn{};Gl.defaultProps={...Mn.defaultProps,mode:"grid",accept:Mn.imageAccepts};const __=Object.freeze(Object.defineProperty({__proto__:null,FileSelector:Mn,ImageSelector:Gl},Symbol.toStringTag,{value:"Module"}));class fo extends mt{}fo.NAME="FileSelector",fo.Component=Mn,fo.replace=!0;class po extends mt{}po.NAME="ImageSelector",po.Component=Gl,po.replace=!0,oe(__);const Vw="",Yl=class gm extends me{_getClassName(t){const{type:e,stacked:n}=t;return[super._getClassName(t),e?`nav-${e}`:"",n?"nav-stacked":""]}static render(t,e,n,s){let r=typeof t=="function"?t.call(s??this,...e):t;if(r)return Array.isArray(r)&&(r={items:r}),n&&(r=vt(n,r)),P(gm,{...r})}};Yl.NAME="nav",Yl.defaultItemProps={component:"li",innerComponent:"a"};let qd=Yl;const v_=Object.freeze(Object.defineProperty({__proto__:null,Nav:qd},Symbol.toStringTag,{value:"Module"}));class Ql extends mt{}Ql.NAME="Nav",Ql.Component=qd,oe(v_);const qw="",Gw="",Yw="",Qw="",Xw="",Zw="",Jw="",t0="",e0="",n0="",i0="",s0="",r0="";function Ts(i,t){const e=i.pageTotal||Math.ceil(i.recTotal/i.recPerPage);return typeof t=="string"&&(t==="first"?t=1:t==="last"?t=e:t==="prev"?t=i.page-1:t==="next"?t=i.page+1:t==="current"?t=i.page:t=Number.parseInt(t,10)),t=t!==void 0?Math.max(1,Math.min(t<0?e+t:t,e)):i.page,{...i,pageTotal:e,page:t}}function Gd({key:i,type:t,btnType:e,page:n,format:s,pagerInfo:r,linkCreator:o,...a}){const l=Ts(r,n);return a.text===void 0&&!a.icon&&s&&(a.text=typeof s=="function"?s(l):$t(s,l)),a.url===void 0&&o&&(a.url=typeof o=="function"?o(l):$t(o,l)),a.disabled===void 0&&(a.disabled=n!==void 0&&l.page===r.page),w(Et,{type:e,...a})}function Yd({key:i,type:t,page:e,text:n="",pagerInfo:s,children:r,...o}){const a=Ts(s,e);return n=typeof n=="function"?n(a):$t(n,a),w(Ft,{...o,children:[r,n]})}function b_({type:i,btnType:t,count:e=12,pagerInfo:n,linkCreator:s,...r}){if(!n.pageTotal)return;const o={...r,square:!0},a=()=>(o.text="",o.icon="icon-ellipsis-h",o.disabled=!0,w(Et,{type:t,...o})),l=(f,d)=>{const m=[];for(let y=f;y<=d;y++){o.text=y,delete o.icon,o.disabled=!1;const b=Ts(n,y);s&&(o.url=typeof s=="function"?s(b):$t(s,b)),m.push(w(Et,{type:t,...o}))}return m};let h=[];return h=[...l(1,1)],n.pageTotal<=1||(n.pageTotal<=e?h=[...h,...l(2,n.pageTotal)]:n.page<e-2?h=[...h,...l(2,e-2),a(),...l(n.pageTotal,n.pageTotal)]:n.page>n.pageTotal-e+3?h=[...h,a(),...l(n.pageTotal-e+3,n.pageTotal)]:h=[...h,a(),...l(n.page-Math.ceil((e-4)/2),n.page+Math.floor((e-4)/2)),a(),...l(n.pageTotal,n.pageTotal)]),h}const o0="";let w_=class extends Tt{render(t){const{id:e,popup:n,title:s,content:r,style:o,className:a,closeBtn:l,arrow:h,headingClass:f,titleClass:d,contentClass:m,arrowStyle:y,onlyInner:b,footer:S,footerClass:x}=t;let k=w(gt,{content:r},"content");(m||s)&&(k=w("div",{className:m,children:k},"content"));let T=w(gt,{content:S},"footer");(x||s)&&(T=w("div",{className:x,children:T},"footer"));const j=[],B=l?w("button",{className:"btn ghost square size-sm btn-close","data-dismiss":"popover",children:w("span",{className:"close"})}):null;return s?j.push(w("div",{className:f,children:[s?w(gt,{className:d,content:s}):null,B]},"heading")):j.push(B),j.push(k,T),h&&j.push(w("div",{className:typeof h=="string"?h:"arrow",style:y},"arrow")),b?j:w("div",{id:e,className:q("popover",a,{popup:n,"has-heading":s}),style:o,children:j})}};class mo extends mt{}mo.NAME="PopoverPanel",mo.Component=w_;const Qd="show",Xd="in",Wi=class ym extends zt{constructor(){super(...arguments),this._getClickBounding=()=>{const t=this._triggerEvent;return{x:t.clientX,y:t.clientY,left:t.clientX,top:t.clientY,width:0,height:0,bottom:t.clientY,right:t.clientX}}}get shown(){return this._shown}get id(){return this._id}get zIndex(){return this._zIndex}get trigger(){return this._triggerElement}get target(){return this._targetElement}afterInit(){const{trigger:t,id:e,triggerEvent:n}=this.options;this._triggerEvent=n,this._id=e||`popover_${this.gid}`;const s=this.getTriggerElement();if(s instanceof HTMLElement){const o=g(s),{namespace:a}=this;if(t){const l=()=>{let h=o.dataset();const f=o.attr(`zui-toggle-${this.constructor.ZUI}`);f&&(h=g.extend(h,Jn(f))),this.setOptions(h)};t==="hover"?o.on(`pointerenter${a}`,h=>{o.is("[disabled],.disabled")||(l(),this.show({delay:!0,event:h}))}).on(`pointerleave${a} pointercancel${a}`,()=>{this.delayHide()}):o.on(`${t}${a}`,h=>{o.is("[disabled],.disabled")||(this.shown||l(),this.toggle({event:h,delay:!0}),h.preventDefault())})}}const{show:r}=this.options;r&&this.show({delay:typeof r=="number"?r:!1})}getTriggerElement(){if(!this._triggerElement){let{element:t=this.element}=this.options;t===document.body&&(t={getBoundingClientRect:this._getClickBounding}),this._triggerElement=t,this._virtual=!(t instanceof HTMLElement)}return this._triggerElement}initTarget(){let t=this.options.target;return this._dynamic=!t,t?(typeof t=="function"&&(t=t()),typeof t=="string"&&(t==="$next"?t=g(this._triggerElement).next():t.startsWith("$target:")&&(t=g(this._triggerElement).closest(t.slice(8)))),g(t)[0]):this._createTarget()}show(t){const{delay:e,event:n,hideOthers:s=this.options.hideOthers}=t||{};if(n&&(this._triggerEvent=n),e)return this._resetTimer(()=>{this.show()},e===!0?this.options.delay:e);if(!this.inited){this.setOptions({show:!0});return}if(this._shown)return;const r=this.initTarget();if(!r)return;this._targetElement=r;const o=g(r),{animation:a,onShow:l,onShown:h,trigger:f,elementShowClass:d}=this.options,{SHOWN_POPOVERS:m}=this.constructor;o.addClass(Qd),a&&o.addClass(a===!0?"fade":a),this._zIndex=ym.Z_INDEX++,this._shown=!0,this.render(),m.set(this.gid,this),l==null||l.call(this),this.emit("show"),s&&m.forEach(b=>{b!==this&&b.hide()});const{namespace:y}=this;f==="hover"&&(this._clearDelayHide(),o.off(y).on(`pointerenter${y}`,()=>{this._clearDelayHide()}).on(`pointerleave${y}`,()=>{this.delayHide()})),!this._virtual&&d&&g(this._triggerElement).addClass(d),this._resetTimer(()=>{o.addClass(Xd),this._resetTimer(()=>{h==null||h.call(this),this.emit("shown")},200)},50)}hide(t){(!this._shown||!this._targetElement)&&this._resetTimer();const{destroyOnHide:e,animation:n,onHide:s,onHidden:r,trigger:o,hideNewOnHide:a,elementShowClass:l}=this.options,h=g(this._targetElement),{SHOWN_POPOVERS:f}=this.constructor;this._shown=!1,f.delete(this.gid),s==null||s.call(this),this.emit("hide"),h.removeClass(Xd),o==="hover"&&(this._clearDelayHide(),h.off(this.namespace)),!this._virtual&&l&&g(this._triggerElement).removeClass(l).removeAttr("data-pop-placement"),a&&f.forEach(d=>{d!==this&&d.zIndex>this.zIndex&&d.hide()}),this._resetTimer(()=>{r==null||r.call(this),this.emit("hidden"),h.removeClass(Qd),(e||t)&&this._resetTimer(()=>{this.destroy()},!t&&typeof e=="number"?e:0),this._destoryTarget()},n&&!t?200:0)}toggle(t){this._shown?this.hide():this.show(t)}destroy(){if(super.destroy(),!this._virtual){const{namespace:t}=this;g(this._triggerElement).off(t)}this._resetTimer(),this._destoryTarget(),this._clearDelayHide()}layout(){const t=this._triggerElement,e=this._targetElement,n=this._layoutWatcher;if(!e||!t||!this._shown){n&&(n(),this._layoutWatcher=void 0);return}n||(this._layoutWatcher=Ld(t,e,()=>{if(this.destroyed||!this._shown)return;const{animation:s,name:r="popover",minWidth:o,minHeight:a,maxWidth:l,maxHeight:h,limitInScreen:f,onLayout:d}=this.options;if(!this._virtual){const m={minWidth:Bt(o),minHeight:Bt(a),maxWidth:Bt(l),maxHeight:Bt(h)},{width:y,height:b}=this.options;y&&(m.width=typeof y=="function"?y():y==="100%"?g(t).outerWidth():y),b&&(m.height=typeof b=="function"?b():b),Object.keys(m).length&&g(e).css(m)}Fl(...this._getLayoutOptions()).then(({x:m,y,middlewareData:b,placement:S,strategy:x})=>{if(t instanceof HTMLElement&&wn(t)){this.hide(!0);return}const k={position:x,left:m,top:y},T=g(e).css(k);f&&T.css({top:Math.max(0,Math.min(window.innerHeight-T.outerHeight(),y)),left:Math.max(0,Math.min(window.innerWidth-T.outerWidth(),m))});const j=S.split("-")[0],B={top:"bottom",right:"left",bottom:"top",left:"right"}[j],K=b.arrow;K&&T.attr("data-pop-placement",j).find(".arrow").css({left:K.x,top:K.y}).attr("class",`arrow ${r}-arrow arrow-${B}`),s===!0&&T.attr("class",`${T.attr("class").split(" ").filter(G=>G!=="fade"&&!G.startsWith("fade-from")).join(" ")} fade-from-${B}`),this._virtual||g(this._triggerElement).attr("data-pop-placement",j),d&&d.call(this,{target:e,trigger:t,popSide:j,arrowSide:B,x:m,y,placement:S,strategy:x})})}))}render(t){super.render(t);const e=this._targetElement;if(!e)return;const n=this._getRenderOptions(),s=g(e);if(s.z("popover",this.gid).toggleClass("popup",n.popup).css(n.style),n.className&&s.setClass(n.className),this._dynamic){let r=this._panel;r&&r.element!==e&&(r.destroy(),r=void 0),r?r.render(n):(r=new mo(e,n),r.on("inited",()=>this.layout())),this._panel=r}else n.arrow&&(s.find(".arrow").length||s.append(g('<div class="arrow"></div>').css(n.arrowStyle))),this.layout()}handleClickOutside(t){if(this.options.mask){const e=this._triggerElement;e instanceof HTMLElement&&g(t.target).closest(e).length||this.hide()}}handleClickTarget(t){}delayHide(t=100){this._resetTimer(),this._clearDelayHide(),this._hideTimer=window.setTimeout(()=>{this._hideTimer=0,this.hide()},t)}_clearDelayHide(){this._hideTimer&&(clearTimeout(this._hideTimer),this._hideTimer=0)}_getLayoutOptions(){const t=this._triggerElement,e=this._targetElement,{placement:n,flip:s,limitSize:r,shift:o,offset:a,arrow:l,strategy:h}=this.options,f=l?e.querySelector(".arrow"):null,d=f?typeof l=="number"?l:5:0,m=()=>typeof a=="function"?a:typeof a=="object"?{mainAxis:(a.mainAxis||0)+d,...a}:(a||0)+d;return[t,e,{placement:n,strategy:h,middleware:[s?zl():null,o?Ol(typeof o=="object"?o:void 0):null,a||d?Ll(m()):null,l?a_({element:f}):null,r?Od({apply({availableWidth:y,availableHeight:b,placement:S}){g(e).css({maxHeight:b-(["top","bottom"].includes(S.split("-")[0])?d:0)-2,maxWidth:y-2})}}):null].filter(Boolean)}]}_getRenderOptions(){const{name:t="popover"}=this.options,{popup:e,title:n,content:s,headingClass:r=`${t}-heading`,titleClass:o=`${t}-title`,contentClass:a=`${t}-content`,style:l,className:h=t,closeBtn:f,arrow:d,footer:m,footerClass:y=`${t}-footer`}=this.options;return{popup:e,title:n,titleClass:o,headingClass:r,contentClass:a,content:s,style:{zIndex:this._zIndex,...l},className:h,closeBtn:f,arrow:d?`arrow ${t}-arrow`:!1,arrowStyle:{"--arrow-size":`${typeof d=="number"?d:5}px`},onlyInner:!0,footer:m,footerClass:y}}_destoryTarget(){var t,e,n;(t=this._layoutWatcher)==null||t.call(this),this._layoutWatcher=void 0,this._dynamic&&((e=this._panel)==null||e.destroy(),(n=this._targetElement)==null||n.remove(),this._panel=void 0,this._targetElement=void 0)}_resetTimer(t,e=0){this._timer&&clearTimeout(this._timer),t&&(this._timer=window.setTimeout(()=>{this._timer=0,t()},e))}_createTarget(){const{container:t="body"}=this.options,e=g(t);let n=e.find(`#${this._id}`);return n.length||(n=g("<div />").attr({id:this._id,class:"popover"}).appendTo(e)),n[0]}static show(t){const{element:e,event:n,...s}=t,r=e||(n==null?void 0:n.currentTarget);return this.ensure(r instanceof HTMLElement?r:document.body,{element:r,show:!0,destroyOnHide:!0,triggerEvent:n,...s})}};Wi.NAME="Popover",Wi.Z_INDEX=1700,Wi.MULTI_INSTANCE=!0,Wi.DEFAULT={placement:"top",strategy:"absolute",flip:!0,arrow:!0,offset:1,trigger:"click",mask:!0,delay:0,animation:!0,closeBtn:!0,popup:!0,elementShowClass:"with-popover-show",hideNewOnHide:!0},Wi.SHOWN_POPOVERS=new Map;let Te=Wi;Te.toggle={trigger:["click","hover"],convertHref:{selector:"target"},check(i,t){const e=g(i);return e.data(this.KEY)?!1:t==="hover"?(e.dataset("trigger")||this.DEFAULT.trigger)==="hover":!0},getOptions(i,t,e){return{triggerEvent:e,...t}},onToggle(i,t,e){i.toggle({event:e})}},Te.register(),g(()=>{g(document).on(`click.${Te.NAMESPACE}`,i=>{const{SHOWN_POPOVERS:t}=Te;if(!t.size)return;const e=g(i.target),n=e.closest("[z-popover]"),s=n.length?n.z("popover"):0,r=s?t.get(s):null;if(r){const a=r.options.name??r.constructor.ZUI;if(e.closest(`[data-dismiss="popover"],[data-dismiss="${a}"]`).length){r.hide();return}if(r.handleClickTarget(i))return}const o=[...t.values()].sort((a,l)=>l.zIndex-a.zIndex);for(const a of o)if(a!==r&&a.handleClickOutside(i))return})}),Object.assign(window,{Popover:Te});const a0="";class Xe extends Te{handleClickTarget(t){const e=g(t.target),{notHideOnClick:n}=this.options;return(!n||!e.closest(n).length)&&this.hide(),!0}_getMenuOptions(){const{items:t,placement:e,menu:n,tree:s,onClickItem:r,relativeTarget:o=this._triggerElement}=this.options;return{items:t,placement:e,tree:s,onClickItem:r,nestedToggle:".item",accordion:!0,relativeTarget:{target:o,event:this.options.triggerEvent,dropdown:this},dropdown:this,popup:!0,...n}}_getRenderOptions(){const t=super._getRenderOptions();return this._dynamic?{...t,contentClass:"",popup:!1,content:P(Xl,this._getMenuOptions())}:t}}Xe.NAME="Dropdown",Xe.DEFAULT={...Te.DEFAULT,name:"dropdown",placement:"bottom-start",arrow:!1,closeBtn:!1,animation:"fade",limitSize:!0,notHideOnClick:".not-hide-menu,.form-control,input,label,.nested-toggle-icon"},Xe.toggle={...Te.toggle,getOptions(i,t,e){return t=Te.toggle.getOptions.call(this,i,t,e),!t.target&&!t.items&&!t.menu&&(t.target=g(i).next(".dropdown-menu")),t}},Xe.register();class go extends Et{constructor(){super(...arguments),this._ref=kt()}get triggerElement(){return this._ref.current}_updateData(){const{dropdown:t,menu:e,items:n,onClickItem:s,relativeTarget:r=this.triggerElement}=this.props,o=Xe.get(this.triggerElement),a={items:n,onClickItem:s,menu:e,relativeTarget:r,...g(this.triggerElement).dataset(),...t};o?o.setOptions(a):new Xe(this.triggerElement,a)}componentDidMount(){this._updateData()}componentDidUpdate(){this._updateData()}componentWillUnmount(){var t;(t=Xe.get(this.triggerElement))==null||t.destroy()}_getProps(t){const{trigger:e,placement:n}=t;return{...super._getProps(t),"data-toggle":"dropdown","data-trigger":e,"data-placement":n,ref:this._ref}}}go.defaultProps={caret:!0},Object.assign(Fe.ItemComponents,{dropdown:go}),Object.assign(Zt.ItemComponents,{dropdown:go});class Xl extends Ie{constructor(){super(...arguments),this._handleSearchFocus=()=>{this._searchFocused=!0},this._handleSearchBlur=()=>{this._searchFocused=!1}}get isHoverTrigger(){const{nestedTrigger:t,tree:e}=this.props;return t?t==="hover":!e}get dropdown(){return this.props.dropdown}layout(){var a;if(this.props.tree||this.isRoot)return;const t=(a=this.element)==null?void 0:a.parentElement,e=g(t);t&&this._searchFocused&&this._position&&e.css(this._position);const r=e.parent().children(".dropdown-menu").children(`[z-key-path="${this.props.parentKey}"]`)[0];if(!t||!r)return;let{maxHeight:o}=this.props;Fl(r,t,{placement:this.props.placement,middleware:[zl(),Ol(),Ll(1),Od({apply({availableWidth:l,availableHeight:h}){if(o){const[f,d]=ii(o);o=Math.min(d==="%"?f*window.innerHeight:f,h-2)}else o=h;e.css({maxHeight:o,maxWidth:l-2})}})]}).then(({x:l,y:h})=>{e.css({left:l,top:h}),this._position={left:l,top:h,width:t.offsetWidth,height:t.offsetHeight}})}_getClassName(t){return["dropdown-menu scrollbar-hover scrollbar-thin",super._getClassName(t)]}_afterRender(t){super._afterRender(t),this.layout()}_getNestedProps(t,e,n,s){return vt(this.isHoverTrigger?{"z-key":n.key,"z-hover":this.props.parentKey??"root",onMouseEnter:this._handleHover,onMouseLeave:this._handleHover}:{},super._getNestedProps(t,e,n,s))}_getItemFromEvent(t){const e=super._getItemFromEvent(t);if(e)return e;const n=g(t.target).closest(".dropdown-menu[z-key]");if(n.length){const s=n.attr("z-key"),r=n.parent().parent().children(".dropdown-menu").children(`[z-key="${s}"]`);if(r.length)return super._getItemFromEvent(t,r[0])}}_renderNestedList(t,e,n,s){const r=super._renderNestedList(t,e,n,s);if(this.props.tree)return r;this._nestedContextMenu.push(r)}_getWrapClass(t){return[super._getWrapClass(t),t.tree?"is-tree":this.isRoot?"is-contextmenu":"is-contextmenu popup"]}_renderWrapperFooter(t){const e=super._renderWrapperFooter(t),n=this._nestedContextMenu;return this.props.tree||!n.length?e:[e,...n]}_renderNestedToggle(t,e){if(this.props.tree)return super._renderNestedToggle(t,e);if(typeof e=="boolean")return w("span",{className:`${this.name}-toggle nested-toggle-icon`,children:w("span",{className:"caret-right"})})}_getSearchBoxProps(t){return{...super._getSearchBoxProps(t),onFocus:this._handleSearchFocus,onBlur:this._handleSearchBlur}}_beforeRender(t){return this._nestedContextMenu=[],super._beforeRender(t)}}Xl.defaultProps={...Ie.defaultProps,searchBox:!1,placement:"right-start",defaultNestedShow:!1,expandOnSearch:!1,nestedSearch:!1},Xl.inheritNestedProps=[...Ie.inheritNestedProps,"container","tree"];function C_({type:i,pagerInfo:t,linkCreator:e,items:n=[5,10,15,20,25,30,35,40,45,50,100,200,500,1e3,2e3],dropdown:s={},itemProps:r,...o}){var l;s.items=s.items||n.map(h=>{const f={...t,recPerPage:h};return{...r,key:h,text:`${h}`,active:h===t.recPerPage,url:typeof e=="function"?e(f):$t(e,f)}});const{text:a=""}=o;return o.text=typeof a=="function"?a(t):$t(a,t),s.menu={...s.menu,className:q((l=s.menu)==null?void 0:l.className,"pager-size-menu")},w(go,{dropdown:s,...o})}function Zd({key:i,page:t,type:e,btnType:n,pagerInfo:s,size:r,onClick:o,onChange:a,linkCreator:l,...h}){const f={...h};let d;const m=S=>{var x;d=Number((x=S.target)==null?void 0:x.value)||1,d=d>s.pageTotal?s.pageTotal:d},y=S=>{if(!(S!=null&&S.target))return;d=d<=s.pageTotal?d:s.pageTotal;const x=Ts(s,d);a&&!a({info:x,event:S})||(S.target.href=f.url=typeof l=="function"?l(x):$t(l,x))},b=Ts(s,t||0);return f.url=typeof l=="function"?l(b):$t(l,b),w("div",{className:q("input-group","pager-goto-group",r?`size-${r}`:""),children:[w("input",{type:"number",class:"form-control",max:s.pageTotal,min:"1",onInput:m}),w(Et,{type:n,...f,onClick:y})]})}let Ki=class extends Zt{get pagerInfo(){return this._pagerInfo}_isBtnType(t){const{type:e}=t;return super._isBtnType(t)||["link","nav","size-menu","goto"].includes(e)}_beforeRender(t){const{page:e=1,recTotal:n=0,recPerPage:s=10}=this.props;return this._pagerInfo={page:+e,recTotal:+n,recPerPage:+s,pageTotal:s?Math.ceil(n/s):0},super._beforeRender(t)}_getItem(t,e,n){const s=super._getItem(t,e,n);if(!s)return!1;const{type:r="item"}=e,o=this._pagerInfo;return r==="info"?g.extend(s,{pagerInfo:o}):(r==="link"||r==="size-menu"||r==="nav"||r==="goto")&&g.extend(s,{pagerInfo:o,linkCreator:t.linkCreator}),s}};Ki.NAME="pager",Ki.ItemComponents={...Zt.ItemComponents,info:Yd,link:Gd,nav:b_,"size-menu":C_,goto:Zd},Ki.defaultItemProps={btnType:"ghost",size:"sm"};class Zl extends mt{}Zl.NAME="Pager",Zl.Component=Ki,oe(Object.freeze(Object.defineProperty({__proto__:null,Pager:Ki,PagerGoto:Zd,PagerInfoItem:Yd,PagerLink:Gd},Symbol.toStringTag,{value:"Module"})));const c0="",h0="";class yo extends mt{}yo.NAME="Pick",yo.Component=ee,yo.replace=!0;const u0="",d0="",f0="",p0="";class Jd extends Tt{constructor(t){super(t),this._searchInput=kt(),this._measure=kt(),this._changeTimer=0,this._handleChange=e=>{const n=e.target.value;this.setState({search:n},()=>{const{onSearch:s}=this.props;s&&(this._changeTimer&&clearTimeout(this._changeTimer),this._changeTimer=window.setTimeout(()=>{this._changeTimer=0,s(n)},this.props.debounce||300))}),e.stopPropagation()},this._handleClear=e=>{e.stopPropagation(),this.clear()},this.state={search:t.defaultSearch??""}}get $pop(){return g(`#pick-pop-${this.props.id}`)}focus(){var t;(t=this._searchInput.current)==null||t.focus()}clear(){var t,e;(e=(t=this.props).onClear)==null||e.call(t),this.setState({search:""},()=>this.focus())}componentDidMount(){this.focus();const{hotkeys:t}=this.props;if(t){const e=Qa(t,{clear:{keys:"Escape",handler:()=>{this.state.search.trim().length?this.clear():this.$pop.trigger("hidePop")}},enter:{keys:"Enter",handler:n=>{n.preventDefault(),this.$pop.trigger("selectActive"),this.clear()}},activeNext:{keys:"ArrowDown",handler:()=>{this.$pop.trigger("activeNext")}},activePrev:{keys:"ArrowUp",handler:()=>{this.$pop.trigger("activePrev")}}});e&&(this._hotkeysScope=`PickerSearch_${_e()}`,g(this._searchInput.current).hotkeys(e,{scope:this._hotkeysScope,event:"keydown"}))}}componentDidUpdate(){const{inline:t}=this.props;if(t){const{current:e}=this._measure,{current:n}=this._searchInput;if(e&&n){const s=g(n).parent();s.width(Math.ceil(Math.min(e.clientWidth,s.closest(".picker").outerWidth()-32)))}}}componentWillUnmount(){clearTimeout(this._changeTimer),this._hotkeysScope&&g(this._searchInput.current).unbindHotkeys(this._hotkeysScope)}render(t,e){const{placeholder:n,inline:s}=t,{search:r}=e,o=r.trim().length>0;let a;return s?a=w("div",{className:"picker-search-measure",ref:this._measure,children:r}):o?a=w("button",{type:"button",className:"btn picker-search-clear square size-sm ghost",onClick:this._handleClear,children:w("span",{className:"close"})}):a=w("span",{className:"magnifier"}),w("div",{className:`picker-search${s?" is-inline":""}`,children:[w("input",{className:"form-control picker-search-input",type:"text",placeholder:n,value:r,autoComplete:"off",onChange:this._handleChange,onInput:this._handleChange,ref:this._searchInput}),a]})}}class k_ extends Xr{constructor(){super(...arguments),this._search=kt(),this._handleDeselectClick=t=>{const{onDeselect:e,state:{selections:n}}=this.props,s=g(t.target).closest(".picker-deselect-btn").attr("data-value");e&&n.length&&typeof s=="string"&&e(s),t.stopPropagation()},this._handleSearch=t=>{this.props.changeState({search:t})},this._handleSearchClear=()=>{this.props.togglePop(!0,{search:""})},this._renderSelection=t=>{const{text:e}=t;return w("div",{className:"picker-multi-selection",title:typeof e=="string"?e:void 0,children:[w("span",{className:"text",children:w(gt,{content:e})}),this.props.disabled||this.props.readonly?null:w("div",{className:"picker-deselect-btn btn size-xs ghost",onClick:this._handleDeselectClick,"data-value":t.value,children:w("span",{className:"close"})})]},t.value)}}_handleClick(t){var e;super._handleClick(t),(e=this._search.current)==null||e.focus()}_getClass(t){return q(super._getClass(t),t.search?"":"picker-no-search","picker-select picker-select-multi form-control")}_renderSearch(t){const{state:{search:e},searchHint:n,hotkeys:s}=t;return w(Jd,{inline:!0,id:t.id,ref:this._search,defaultSearch:e,onSearch:this._handleSearch,onClear:this._handleSearchClear,placeholder:n,hotkeys:s})}_renderTrigger(t){const{state:{selections:e=[],open:n,value:s},search:r,placeholder:o,display:a,valueList:l,children:h,caretClass:f}=this.props,d=n&&r;let m;const y=!d&&!e.length;return a&&(!y||o===void 0)?(typeof a=="function"?m=a.call(this,l,e):typeof a=="string"&&(m=$t(a,{value:s,values:l,count:l.length})),m=w("div",{className:"picker-multi-selections",children:m},"selections")):y?m=w("span",{className:"picker-select-placeholder",children:o},"selections"):m=w("div",{className:"picker-multi-selections",children:[e.map(this._renderSelection),d?this._renderSearch(t):null]},"selections"),[m,h,w("span",{class:q("caret",f)},"caret")]}_renderValue(t){const{name:e,state:{value:n=""},disabled:s,readonly:r,id:o,valueList:a,emptyValue:l}=t;if(e)if(this.hasInput)g(`#${o}`).val(n);else{const h=a.length?a:[l];return w("select",{id:o,multiple:!0,className:"pick-value",name:e.endsWith("[]")?e:`${e}[]`,disabled:s,readonly:r,style:{display:"none"},children:h.map(f=>w("option",{value:f,children:f},f))})}return null}componentDidMount(){super.componentDidMount();const{id:t,valueList:e,emptyValue:n}=this.props;g(`#${t}`).val(e.length?e:[n])}componentDidUpdate(t){const{id:e,state:n,name:s,valueList:r,emptyValue:o}=this.props;if(s&&t.state.value!==n.value){const a=g(`#${e}`).val(r.length?r:[o]);this._skipTriggerChange!==n.value&&a.trigger("change",Cd),this._skipTriggerChange=!1}}}class S_ extends Xr{constructor(){super(...arguments),this._search=kt(),this._handleDeselectClick=t=>{this.props.disabled||(this.props.onClear(),t.stopPropagation())},this._handleSearch=t=>{this.props.changeState({search:t})},this._handleSearchClear=()=>{this.props.togglePop(!0,{search:""})}}_getSearchPlaceholder(){const{searchHint:t,state:{value:e,selections:n}}=this.props;let s=t;if(s===void 0){const r=n.find(o=>o.value===e);r&&typeof r.text=="string"&&(s=r.text)}return s}_handleClick(t){var e;super._handleClick(t),(e=this._search.current)==null||e.focus()}_getClass(t){return q(super._getClass(t),t.search?"":"picker-no-search","picker-select picker-select-single form-control")}_renderSearch(t){const{state:{search:e},hotkeys:n}=t;return w(Jd,{ref:this._search,id:t.id,defaultSearch:e,onSearch:this._handleSearch,onClear:this._handleSearchClear,placeholder:this._getSearchPlaceholder(),hotkeys:n})}_renderTrigger(t){const{children:e,state:{selections:n=[],value:s,open:r},placeholder:o,search:a,disabled:l,readonly:h,clearable:f,display:d,caretClass:m}=t,[y]=n,b=r&&a;let S;if(b)S=this._renderSearch(t);else if(y||o===void 0&&d){const{text:T}=y||{text:"",value:""};typeof d=="function"?S=d.call(this,s,n):typeof d=="string"?S=$t(d,y):S=w(gt,{content:T}),S=w("span",{className:"picker-single-selection",title:typeof T=="string"?T:void 0,children:S},"main")}else S=w("span",{className:"picker-select-placeholder",children:o},"main");const x=f&&!b?w("button",{type:"button",className:"btn picker-deselect-btn size-xs square ghost",disabled:l,readonly:h,onClick:this._handleDeselectClick,children:w("span",{className:"close"})},"deselect"):null,k=b?null:w("span",{className:q("caret flex-none",m)},"caret");return[S,e,x,k]}}function tf(i,t){return i.reduce((e,n)=>(Array.isArray(n.items)&&tf(n.items,e),typeof n.value=="string"&&e.set(n.value,n),e),t||new Map)}class x_ extends jl{constructor(){super(...arguments),this._menu=kt(),this._disabledSet=new Set,this._getItem=(t,e)=>{var h;if(t.parentKey!==void 0)return t;const n=new Set(this.props.valueList);let s=t.items,r=!1,o=!1;Array.isArray(s)&&(r=!0,s=s.reduce((f,d,m)=>{const y=this._getItem(d,m);return y&&(y.selected?o=!0:r=!1,f.push(y)),f},[]));const a=r||n.has(t.value);t={selected:a,hint:typeof t.text=="string"?t.text:void 0,...t,checked:this._hasCheckbox||typeof t.checked=="boolean"?r?!0:o?"indeterminate":a:void 0,className:q(t.className,{hover:t.value!==void 0&&t.value===this.props.state.hoverItem}),items:s},a&&!t.disabled&&this._firstSelected===void 0&&(this._firstSelected=t.key),t.content&&t.text&&delete t.text;const l=((h=this._getItemCallback)==null?void 0:h.call(this,t,e))??t;return l&&(l.disabled&&this._disabledSet.add(l.value),l)},this._beforeRenderItem=(t,e)=>{var n;return(n=this._renderItemCallback)==null?void 0:n.call(this,t,e)},this._handleItemClick=({item:t,event:e})=>{const n=t.value,s=e.target;if(t.disabled||n===void 0||s.closest(".item-icon,.nested-toggle-icon,.disabled")||Array.isArray(t.items)&&t.items.every(f=>this._disabledSet.has(f.value)))return;const{multiple:r,onToggleValue:o,onSelect:a,togglePop:l,onDeselect:h}=this.props;if(r)if(t.items){const d=[...tf(t.items).values()].filter(m=>!m.items&&!this._disabledSet.has(m.value)).map(m=>m.value);g(s).closest(".item").children(".item-inner.selected").length?h(d):a(d)}else o(n);else a(n),l(!1,{search:""})}}get menu(){return this._menu.current}get picker(){return this.props.picker}componentDidMount(){var t,e;super.componentDidMount(),this._firstSelected===void 0?(t=this.menu)==null||t.activeNext():(e=this.menu)==null||e.toggleActive(this._firstSelected,!0),g(this.element).on("activeNext.zui.Picker",()=>{var n;(n=this.menu)==null||n.activeNext()}).on("activePrev.zui.Picker",()=>{var n;(n=this.menu)==null||n.activePrev()}).on("selectActive.zui.Picker",()=>{const n=this.menu;if(!n)return;const s=n.getActiveKey();if(s!==void 0){const r=n.getRenderedItem(s);r&&g(this.element).find(`.item[z-key-path="${r._keyPath}"]`).trigger("click")}}).on("hidePop.zui.Picker",()=>{this.props.togglePop(!1)})}componentWillUnmount(){super.componentWillUnmount(),g(this.element).off(".zui.Picker")}_getClass(t){return q(super._getClass(t),"picker-menu")}_getMenuProps(t){const{menu:e,tree:n,state:s,checkbox:r,header:o,footer:a,noMatchHint:l,maxItemsCount:h,exceedLimitHint:f}=t,{items:d,search:m}=s;return vt({ref:this._menu,className:"picker-menu-list",underlineKeys:!0,limit:h,items:d,defaultNestedShow:!0,activeOnHover:!0,search:m,exceedLimitHint:f,onClickItem:this._handleItemClick,nestedToggle:".nested-toggle-icon,.item-icon",checkbox:r,searchProps:["keys","text","title","subtitle","value"],header:o,footer:a,noMatchHint:l,relativeTarget:this},e,n)}_renderPop(t){const{tree:e}=t;this._firstSelected=void 0,this._disabledSet.clear();const n=this._getMenuProps(t);return this._hasCheckbox=!!n.checkbox,this._getItemCallback=n.getItem,this._renderItemCallback=n.beforeRenderItem,n.getItem=this._getItem,n.beforeRenderItem=this._beforeRenderItem,e?w(ri,{...n}):w(Ie,{...n})}}function li(i,t){return i.reduce((e,n)=>(Array.isArray(n.items)&&li(n.items,e),e.set(n.value===void 0?"":String(n.value),n),e),t||new Map)}let Pn=class extends ee{constructor(t){super(t),this._updateTimer=0,this.toggleValue=(e,n)=>{if(!this.props.multiple)return n||e!==this.value?this.setValue(e):this.setValue();const{valueList:s}=this,r=s.indexOf(e);if(n!==r>=0)return r>-1?s.splice(r,1):s.push(e),this.setValue(s)},this.deselect=(e=[])=>{const{valueList:n}=this,s=new Set(this.formatValueList(e)),r=n.filter(o=>!s.has(o));this.setValue(r)},this.clear=()=>{this.setValue()},this.select=e=>{const n=this.formatValueList(e),s=this.props.multiple?[...this.valueList,...n]:n[0];return this.setValue(s)},this.isSelected=e=>this.valueList.includes(e),this.setValue=this.setValue.bind(this),this.isEmptyValue=this.isEmptyValue.bind(this)}get valueList(){return this.formatValueList(this.state.value)}get firstEmptyValue(){return this._emptyValueSet.values().next().value}getDefaultState(t){const{items:e,valueSplitter:n=",",emptyValue:s=""}=t||this.props,r={...super.getDefaultState(t),loading:!1,search:"",items:e,selections:[]};if(this._emptyValueSet=new Set(typeof s=="string"?s.split(n):[]),Array.isArray(e)&&e.length){const{limitValueInList:o,required:a,multiple:l}=this.props;if(e.forEach(h=>{typeof h.value=="number"&&(h.value=String(h.value))}),o){const h=li(e);r.value=this.formatValueList(r.value,n).filter(f=>h.has(f)).join(n)}!this.formatValueList(r.value,n).length&&a&&!l&&(r.value=e[0].value??"")}return r}isEmptyValue(t){return this._emptyValueSet.has(t)}deselectAll(){this.setValue([])}selectAll(){const{items:t}=this.state;if(!Array.isArray(t))return;const n=[...li(t).values()].reduce((s,r)=>(r.disabled||s.push(r.value),s),[]);return this.select(n)}isSelectedAll(){const{items:t}=this.state;if(!Array.isArray(t))return!1;const e=li(t),n=new Set(this.valueList);return[...e.values()].every(s=>s.disabled||n.has(s.value))}async load(){let t=this._abort;t&&t.abort(),t=new AbortController,this._abort=t;const{items:e=[],searchDelay:n}=this.props,{search:s=""}=this.state;let r=[];if(Array.isArray(e))r=e;else{if(await as(n||500),this._abort!==t)return r;let o=e;if(typeof o=="string"&&(o=$t(o,{search:encodeURIComponent(s)})),r=await Xn(o,[this,s],{signal:t.signal}),this._abort!==t)return r}return this._abort=void 0,r}changeState(t,e){return super.changeState(n=>{const s=typeof t=="function"?t(n):t;if(s.value!==void 0&&s.value!==n.value||s.items&&s.items!==n.items){const r=s.items||n.items,o=new Map;Array.isArray(n.items)&&n.items!==s.items&&li(n.items,o),li(r,o),s.selections=this.formatValueList(s.value??n.value).reduce((a,l)=>(this.isEmptyValue(l)||a.push(o.get(l)||{value:l,text:l}),a),[])}return s},e)}async update(t){const{state:e,props:n}=this,s=this._itemsCacheInfo||{},r={};if(this._itemsCacheInfo=s,!e.loading&&(t||s.search!==e.search||n.items!==s.items)){await this.changeState({loading:!0});let a=await this.load();a=a.filter(l=>(l.key=l.key??l.value,typeof l.value=="number"&&(l.value=String(l.value)),!this.isEmptyValue(l.value))),r.loading=!1,r.items=a,s.items=n.items,s.search=e.search}else s.items&&!e.open&&n.cache===!1&&!Array.isArray(n.items)&&(s.items=void 0);(t||s.value!==e.value)&&(s.value=e.value);const o=r.items;n.required&&!n.multiple&&this.isEmptyValue(this.state.value)&&Array.isArray(o)&&o.length&&(r.value=o[0].value),Object.keys(r).length&&await this.changeState(r)}async tryUpdate(){this._updateTimer&&clearTimeout(this._updateTimer),this._updateTimer=window.setTimeout(()=>{this._updateTimer=0,this.update()},50)}componentDidUpdate(t,e){super.componentDidUpdate(t,e),this.tryUpdate()}componentDidMount(){super.componentDidMount(),this.tryUpdate()}componentWillUnmount(){var t;(t=this._abort)==null||t.abort(),this._abort=void 0,this._itemsCacheInfo=void 0,clearTimeout(this._updateTimer),super.componentWillUnmount()}_handleChange(t,e){if(super._handleChange(t,e),t!==e){const{onDeselect:n,onSelect:s,onClear:r,multiple:o}=this.props,a=this.formatValueList(e),l=this.valueList;if(r&&!l.length&&a.length&&r.call(this),n){const h=a.filter(f=>!l.includes(f));h.length&&n.call(this,o?h:h[0])}if(s){const h=l.filter(f=>!a.includes(f));h.length&&s.call(this,o?h:h[0])}}}_getTriggerProps(t,e){return{...super._getTriggerProps(t,e),multiple:t.multiple,hotkeys:t.hotkeys,placeholder:t.placeholder,search:t.search,display:t.display,searchHint:t.searchHint,caretClass:t.caretClass,clearable:!!this.valueList.length&&!t.required,valueList:this.valueList,emptyValue:this.firstEmptyValue,onDeselect:this.deselect,onSelect:this.select,onClear:this.clear,onToggleValue:this.toggleValue,onSetValue:this.setValue}}_getPopProps(t,e){return{...super._getPopProps(t,e),picker:this,menu:t.menu,tree:t.tree,checkbox:t.checkbox,multiple:t.multiple,search:t.search,maxItemsCount:t.maxItemsCount,footer:this._renderToolbar(),valueList:this.valueList,noMatchHint:e.loading?Nt.getLang("loadingHint"):t.searchEmptyHint??Nt.getLang("searchEmptyHint"),exceedLimitHint:t.exceedLimitHint??Nt.getLang("exceedLimitHint"),onDeselect:this.deselect,onSelect:this.select,onClear:this.clear,onToggleValue:this.toggleValue,onSetValue:this.setValue}}_getTrigger(t){return t.Trigger||(t.multiple?k_:S_)}_renderToolbar(){let{toolbar:t}=this.props;return t?(t===!0&&(t=[{key:"selectAll",text:Nt.getLang("selectAll")},{key:"cancelSelect",text:Nt.getLang("cancelSelect")}]),Zt.render(t,[],{size:"sm",relativeTarget:this,getItem:e=>(e.onClick||(e.key==="selectAll"?(e.onClick=this.selectAll.bind(this),e.disabled=this.isSelectedAll()):e.key==="cancelSelect"&&(e.onClick=this.deselectAll.bind(this),e.disabled=!this.valueList.length)),e)},this)):null}formatValueList(t,e){let n;return typeof t=="string"&&t.length?n=t.split(e??this.props.valueSplitter??","):Array.isArray(t)?n=t:n=[t],g.unique(n).reduce((s,r)=>(r==null||(r=typeof r!="string"?String(r):r,this.isEmptyValue(r)||s.push(r)),s),[])}formatValue(t){const e=this.formatValueList(t);return e.length?e.join(this.props.valueSplitter??","):this.firstEmptyValue}setValue(t=[],e){let n=this.formatValueList(t);if(n.length){const{items:r,limitValueInList:o}=this.props;if(o){const a=li(Array.isArray(r)?r:this.state.items);n=n.filter(l=>a.has(l))}}const s=this.formatValue(n);return super.setValue(s,e)}};Pn.defaultProps={...ee.defaultProps,className:"picker",valueSplitter:",",limitValueInList:!0,search:!0,emptyValue:"",cache:!0,hotkeys:!0},Pn.Pop=x_;class _o extends mt{}_o.NAME="Picker",_o.Component=Pn,_o.register(),Nt.addLang({zh_cn:{selectAll:"全选",cancelSelect:"取消选择",searchEmptyHint:"无匹配选项",loadingHint:"正在加载...",exceedLimitHint:"还有 {0} 个选项没有显示，可尝试搜索来查找"},zh_tw:{selectAll:"全選",cancelSelect:"取消選擇",searchEmptyHint:"無匹配選項",loadingHint:"正在載入...",exceedLimitHint:"還有 {0} 個選項沒有顯示，可嘗試搜索來查找"},en:{selectAll:"Select All",cancelSelect:"Cancel Select",searchEmptyHint:"No matching options",loadingHint:"Loading...",exceedLimitHint:"There are {0} items not displayed, try searching to find"}});class vo extends mt{}vo.NAME="SearchBox",vo.Component=Ai,vo.register(),oe(cy);const m0="";function Jl(i,t){const[e,n]=ii(i);return n==="%"?t*e/100:e}const ef="is-sidebar-resizing",nf="has-sidebar-animation",tc="is-animating",bo=".sidebar-gutter";class ec extends zt{get side(){return this._side}get width(){return this._width}get $parent(){const{parent:t}=this.options;return t?g(t):this.$element.parent()}afterInit(){const{$element:t}=this,e=t.parent(),n=e[0],s=e.width();this._container=n;const{preserve:r,side:o=t.hasClass("sidebar-right")?"right":"left",animation:a,dragToResize:l,width:h,minWidth:f=0,maxWidth:d=Number.MAX_SAFE_INTEGER,toggleBtn:m,dbclick:y}=this.options;this._storeID=r?`SIDEBAR:${r}:width`:"",this._side=o,this._minWidth=Jl(f,s),this._maxWidth=Jl(d,s),this._defaultWidth=Math.max(this._minWidth,Math.min(this._maxWidth,Jl(h||t.width(),s))),this._width=(r?ae.get(this._storeID):null)??this._defaultWidth,this.render(),m&&t.on(`click${this.namespace}`,".gutter-toggle",()=>this.toggle()),y&&t.on(`dblclick${this.namespace}`,bo,()=>{y==="reset"?this.update(this._defaultWidth):this.toggle()}).on("mousedown",bo,b=>{b.preventDefault()}),l&&(this._moveable=new bs(t,{selector:bo,move:!1,onMoveStart:()=>{this._startWidth=this._width,this.$parent.addClass(ef).removeClass(nf)},onMove:(b,S)=>{const{deltaX:x}=S;Math.abs(x)<10||this.update(this._startWidth+x*(o==="left"?1:-1))},onMoveEnd:()=>{a&&this.$parent.addClass(nf),this.$parent.removeClass(ef)}})),a&&this.on("transitionend",b=>{b.target===t[0]&&b.propertyName==="width"&&t.removeClass(tc)})}destroy(){var t;super.destroy(),this._raf&&cancelAnimationFrame(this._raf),(t=this._moveable)==null||t.destroy()}toggle(t){t=t??!!this._width,t&&(this._widthBack=this._width),this.update(t?0:this._widthBack||this._defaultWidth)}update(t,e){if(!e){this._raf&&cancelAnimationFrame(this._raf),this._raf=requestAnimationFrame(()=>{this._raf=0,this.update(t,!0)});return}const{preserve:n,toggleBtn:s,onResize:r,onToggle:o,animation:a}=this.options;if(t=t<this._minWidth?s?0:this._minWidth:Math.min(this._maxWidth,t,this._container.clientWidth),t===this._width)return;const l=!this._width,h=!t;this._width=t,n&&ae.set(this._storeID,t),this.render(),r==null||r(t),l!==h&&(l&&a&&this.$element.addClass(tc),o==null||o(h)),this.emit("sidebarResize",t)}render(){var f;const{side:t,width:e,$element:n,$parent:s}=this,r=!e,{toggleBtn:o,gutterWidth:a=ii(n.parent().css("gap"))[0]||1,animation:l}=this.options;n.addClass(`sidebar-${t}`).toggleClass("is-collapsed",r).toggleClass("is-expanded",!r).css({"--gutter-width":`${a}px`,width:`var(--sidebar-${t}-width)`,"--sidebar-duration":typeof l=="number"?`${l}ms`:null});let h=n.find(bo);h.length||(h=g('<div class="sidebar-gutter gutter gutter-horz"></div>').appendTo(n)),o?h.children(".gutter-toggle").length||h.append(`<button class="gutter-toggle" type="button"><span class="chevron-${t}"></span></button>`):h.children(".gutter-resize-handler").length||h.append('<div class="gutter-resize-handler"></div>'),s.addClass(`has-sidebar-${t}`).css(`--sidebar-${t}-width`,`${e}px`).toggleClass(`is-sidebar-${t}-collapsed`,r),(f=this._moveable)!=null&&f.state&&n.removeClass(tc)}}ec.NAME="Sidebar",ec.DEFAULT={minWidth:40,toggleBtn:!0,animation:!0,dragToResize:!0,dbclick:"reset"};const g0="",y0="",_0="";class nc extends mt{}nc.NAME="Toolbar",nc.Component=Zt,oe(Zg);const v0="";class Ui extends Te{_getRenderOptions(){const{type:t,className:e,title:n,content:s}=this.options;let r=n,o=s;return o===void 0&&(o=r,r=void 0),{...super._getRenderOptions(),title:r,content:o,className:q("tooltip",t,e,r?"tooltip-has-title":""),contentClass:r?"tooltip-content":""}}}Ui.NAME="Tooltip",Ui.DEFAULT={...Te.DEFAULT,trigger:"hover",delay:500,closeBtn:!1,popup:!1,name:"tooltip",animation:"fade",destroyOnHide:5e3,hideOthers:!0,hideNewOnHide:!1},Ui.register();const b0="",w0="",C0="";class wo extends mt{}wo.NAME="Tree",wo.Component=De,wo.replace=De.TAG;class ic extends mt{}ic.NAME="SearchTree",ic.Component=ri,oe(my);const k0="",S0="",x0="",$0="";class Co extends zt{init(){const{multiple:t,defaultFileList:e,limitSize:n}=this.options;this.fileMap=new Map,this.renameMap=new Map,this.itemMap=new Map,this.dataTransfer=new DataTransfer,this.limitBytes=n?ki(n):Number.MAX_VALUE,this.currentBytes=0,t||(this.options.limitCount=1),this.$element.addClass("upload"),this.initFileInputCash(),this.initUploadCash(),e&&this.addFileItem(e)}initUploadCash(){const{name:t,uploadText:e,uploadIcon:n,listPosition:s,btnClass:r,tip:o,draggable:a}=this.options;this.$list=g('<ul class="file-list py-1"></ul>');const l=g(`<span class="upload-tip">${o}</span>`);if(!a){if(this.$label=g(`<label class="btn ${r}" for="${t}">${e}</label>`),n){const m=g(`<i class="icon icon-${n}"></i>`);this.$label.prepend(m)}const d=s==="bottom"?[this.$label,l,this.$list]:[this.$list,this.$label,l];this.$element.append(this.$input,...d);return}const h=g(`<span class="text-primary">${e}</span>`);if(n){const d=g(`<i class="icon icon-${n} mr-1"></i>`);h.prepend(d)}this.$label=g(`<label class="draggable-area col justify-center items-center cursor-pointer block w-full h-16" for="${t}"></label>`).append(h).append(l),this.bindDragEvent();const f=s==="bottom"?[this.$label,this.$list]:[this.$list,this.$label];this.$element.append(this.$input,...f)}bindDragEvent(){this.$label.on("dragover",t=>{t.preventDefault(),this.$label.hasClass("border-primary")||(this.$label.removeClass("border-gray"),this.$label.addClass("border-primary")),this.$label.hasClass("dragover")||this.$label.addClass("dragover")}).on("dragleave",t=>{t.preventDefault(),this.$label.removeClass("border-primary"),this.$label.addClass("border-gray"),this.$label.removeClass("dragover")}).on("drop",t=>{var n;t.preventDefault(),this.$label.removeClass("border-primary"),this.$label.addClass("border-gray"),this.$label.removeClass("dragover");const e=Array.from(((n=t.dataTransfer)==null?void 0:n.files)??[]);console.log(t.dataTransfer.files),this.addFileItem(e)})}initFileInputCash(){const{name:t,multiple:e,accept:n}=this.options;this.$input=g("<input />").addClass("hidden").prop("type","file").prop("name",t).prop("id",t).prop("multiple",e).on("change",s=>{const r=s.target.files;if(!r)return;const o=[...r];this.addFileItem(o)}),n&&this.$input.prop("accept",n)}addFile(t){const{multiple:e,onSizeChange:n}=this.options;e||(this.renameMap.clear(),this.fileMap.clear(),this.dataTransfer.items.clear(),this.currentBytes=t.size),this.renameMap.set(t.name,t.name),this.fileMap.set(t.name,t),this.dataTransfer.items.add(t),this.$input.prop("files",this.dataTransfer.files),this.currentBytes+=t.size,n==null||n(this.currentBytes)}renameDuplicatedFile(t){if(!this.fileMap.has(t.name))return t;const e=t.name.lastIndexOf(".");if(e===-1)return this.renameDuplicatedFile(new File([t],`${t.name}(1)`));const n=t.name.substring(0,e),s=t.name.substring(e);return this.renameDuplicatedFile(new File([t],`${n}(1)${s}`))}filterFiles(t){const{accept:e}=this.options;if(!e)return t;const n=e.replace(/\s/g,"").split(","),s=[],r=[],o=[];return n.forEach(a=>{a.endsWith("/*")?r.push(a.substring(0,a.length-1)):a.includes("/")?s.push(a):a.startsWith(".")&&o.push(a)}),t.filter(a=>s.includes(a.type)||r.some(l=>a.type.startsWith(l))||o.some(l=>a.name.endsWith(l)))}addFileItem(t){t=this.filterFiles(t);const{multiple:e,limitCount:n,exceededSizeHint:s,onExceededSize:r,exceededCountHint:o,onExceededCount:a,onAdd:l}=this.options;if(e){for(let m of t){if(n&&this.fileMap.size>=n){a==null||a(n),o&&alert(o);return}if(this.currentBytes+m.size>this.limitBytes){r==null||r(this.limitBytes),s&&alert(s);return}m=this.renameDuplicatedFile(m);const y=l==null?void 0:l(m);if(!y)continue;m=y;const b=this.createFileItem(m);this.itemMap.set(m.name,b),this.$list.append(b)}return}if(t.length===0||t[0].size>this.limitBytes)return;let h=this.renameDuplicatedFile(t[0]);const f=l==null?void 0:l(h);if(!f)return;h=f;const d=this.createFileItem(h);this.itemMap.clear(),this.itemMap.set(h.name,d),this.$list.empty().append(d)}deleteFileItem(t){var l,h;const e=this.renameMap.get(t)??t;this.renameMap.delete(t);const n=this.fileMap.get(e);if(!n)return;const{onDelete:s,onSizeChange:r}=this.options,o=this.itemMap.get(n.name);this.itemMap.delete(n.name),o==null||o.addClass("hidden");const a=(l=o==null?void 0:o.find(".file-delete"))==null?void 0:l.data("tooltip");a&&(a.destroy(),(h=a.tooltip)==null||h.remove()),setTimeout(()=>o==null?void 0:o.remove(),3e3),s==null||s(n),this.fileMap.delete(n.name),this.currentBytes-=n.size,r==null||r(this.currentBytes),this.dataTransfer=new DataTransfer,this.fileMap.forEach(f=>this.dataTransfer.items.add(f)),this.$input.prop("files",this.dataTransfer.files)}renameFileItem(t,e){var r,o;const n=this.renameMap.get(t.name);this.renameMap.set(t.name,e),n&&(t=this.fileMap.get(n)??t);const s=this.itemMap.get(t.name);s&&(this.itemMap.set(e,s).delete(t.name),(o=(r=this.options).onRename)==null||o.call(r,e,t.name),this.fileMap.delete(t.name),this.dataTransfer=new DataTransfer,t=new File([t],e),this.fileMap.set(e,t).forEach(a=>this.dataTransfer.items.add(a)),this.$input.prop("files",this.dataTransfer.files))}createFileItem(t){const{showIcon:e}=this.options;return this.addFile(t),g('<li class="file-item my-1 flex items-center gap-2"></li>').append(e?this.fileIcon():null).append(this.createFileInfo(t)).append(this.createRenameContainer(t))}fileIcon(){const{icon:t}=this.options;return g(`<i class="icon icon-${t}"></i>`)}fileRenameBtn(){const{useIconBtn:t,renameText:e,renameIcon:n,renameClass:s}=this.options;if(t){const r=g(`<button class="btn btn-link h-5 w-5 p-0 ${s}"><i class="icon icon-${n}"></i></button>`).prop("type","button").addClass("file-action file-rename");return new Ui(r,{title:e}),r}return g("<button />").prop("type","button").addClass(`btn size-sm rounded-sm text-primary canvas file-action file-rename ${s}`).html(e)}fileDeleteBtn(){const{useIconBtn:t,deleteText:e,deleteIcon:n,deleteClass:s}=this.options;if(t){const r=g(`<button class="btn btn-link h-5 w-5 p-0 ${s}"><i class="icon icon-${n}"></i></button>`).prop("type","button").addClass("file-action file-delete");return r.data("tooltip",new Ui(r,{title:e})),r}return g("<button />").html(e).prop("type","button").addClass(`btn size-sm rounded-sm text-primary canvas file-action file-delete ${s}`)}fileName(t){return g(`<span class="file-name">${t}</span>`)}fileSize(t){return g(`<span class="file-size text-gray">${fe(t)}</span>`)}createFileInfo(t){const{renameBtn:e,deleteBtn:n,showSize:s}=this.options,r=g('<div class="file-info flex items-center gap-2"></div>');return r.append(this.fileName(t.name)),s&&r.append(this.fileSize(t.size)),e&&r.append(this.fileRenameBtn().on("click",o=>{r.addClass("hidden").closest(".file-item").find(".input-rename-container.hidden").removeClass("hidden");const a=g(o.target).closest("li").find("input")[0];a.focus(),a.value.lastIndexOf(".")!==-1&&a.setSelectionRange(0,a.value.lastIndexOf("."))})),n&&r.append(this.fileDeleteBtn().on("click",()=>this.deleteFileItem(t.name))),r}createRenameContainer(t){const{confirmText:e,cancelText:n,duplicatedHint:s,onDuplicated:r}=this.options,o=g('<div class="input-group input-rename-container hidden"></div>'),a=g("<input />").addClass("form-control").prop("type","text").prop("autofocus",!0).prop("defaultValue",t.name).on("keydown",d=>{if(d.key==="Enter"){const m=o.closest(".file-item"),y=m.find(".file-name");if(y.html()===a.val()){o.addClass("hidden"),m.find(".file-info.hidden").removeClass("hidden");return}if(this.fileMap.has(a.val())){r==null||r(a.val()),s&&alert(s);return}this.renameFileItem(t,a.val()),o.addClass("hidden"),m.find(".file-info.hidden").removeClass("hidden"),y.html(a.val())}else d.key==="Escape"&&(a.val(t.name),o.addClass("hidden").closest(".file-item").find(".file-info.hidden").removeClass("hidden"))}),l=g("<button />").addClass("btn primary rename-confirm-btn").prop("type","button").html(e).on("click",()=>{const d=o.closest(".file-item"),m=d.find(".file-name");if(m.html()===a.val()){o.addClass("hidden"),d.find(".file-info.hidden").removeClass("hidden");return}if(this.fileMap.has(a.val())){r==null||r(a.val()),s&&alert(s);return}this.renameFileItem(t,a.val()),o.addClass("hidden"),d.find(".file-info.hidden").removeClass("hidden"),m.html(a.val())}),h=g("<button />").prop("type","button").addClass("btn rename-cancel-btn").html(n).on("click",()=>{a.val(t.name),o.addClass("hidden").closest(".file-item").find(".file-info.hidden").removeClass("hidden")}),f=g('<div class="btn-group"></div').append(l).append(h);return o.append(a).append(f)}}Co.NAME="Upload",Co.DEFAULT={uploadText:"上传文件",confirmText:"确定",cancelText:"取消",useIconBtn:!0,renameBtn:!0,renameText:"重命名",renameIcon:"edit",renameClass:"",deleteBtn:!0,deleteText:"删除",deleteIcon:"trash",deleteClass:"",showIcon:!0,multiple:!0,listPosition:"bottom",limitSize:!1,icon:"file-o",btnClass:"",tip:"",draggable:!1,showSize:!0,onAdd:i=>i};const T0="";class sc extends Co{init(){this.initUploadButtonItemCash(),this.options.onSizeChange=()=>{this.$uploadInfo.html(this.options.totalCountText.replace("%s",this.fileMap.size.toString()).replace("%s",this.fileMap.size.toString())),this.fileMap.size>0?(this.$tip.remove(),this.$list.append(this.$uploadButtonItem)):(this.$uploadButtonItem.remove(),this.$label.append(this.$tip))},super.init(),this.$list.addClass("flex")}initUploadButtonItemCash(){this.$uploadButtonItem=g(`<label class="upload-button-item order-last" for="${this.options.name}" />`).addClass("flex justify-center items-center cursor-pointer").css({width:120,height:120,background:"var(--color-slate-100)"}).append(g('<i class="icon icon-plus" />'))}initUploadCash(){const{name:t,tip:e,uploadText:n,uploadIcon:s,totalCountText:r}=this.options;this.$list=g('<ul class="file-list py-1 flex-wrap gap-x-4 gap-y-4"></ul>'),this.$label=g('<div class="draggable-area relative block w-full border border-dashed border-gray"></div>').css({minHeight:64});const o=g(`<label for="${t}" class="text-primary cursor-pointer">${n}</label>`);if(s){const a=g(`<i class="icon icon-${s} mr-1"></i>`);o.prepend(a)}this.$tip=g('<div class="absolute inset-0 col justify-center items-center"></div>').append(o),e&&this.$tip.append(g(`<span class="upload-tip">${e}</span>`)),this.$label.append(this.$tip),this.$label.append(this.$input,this.$list),this.bindDragEvent(),this.$element.append(this.$label),this.$uploadInfo=g('<div class="py-1" />').css({color:"var(--color-slate-500)"}).html(r.replace("%s",this.fileMap.size.toString()).replace("%s",this.fileMap.size.toString())),this.$element.append(this.$uploadInfo)}filterFiles(t){const{accept:e}=this.options;if(e==="image/*")return t.filter(s=>s.type.includes("image"));const n=e.replace(/\s/g,"").replace(/\./g,"image/").split(",");return t.filter(s=>n.includes(s.type))}createFileItem(t){const e=super.createFileItem(t).addClass("relative").removeClass("flex items-center gap-2 my-1");this.setImageUrl(t,e);const{deleteBtn:n,showSize:s}=this.options;return n&&e.append(this.fileDeleteBtn().addClass("absolute right-0 top-0 text-white").css({background:"var(--color-slate-500)"}).on("click",()=>this.deleteFileItem(t.name))),s&&e.append(this.fileSize(t.size).addClass("file-size label text-white circle darker absolute px-1 hidden").removeClass("text-gray").css({top:96,left:4})),e}setImageUrl(t,e){const n=new FileReader;n.onload=()=>{g('<div class="img flex-none" />').addClass("rounded").css({backgroundImage:`url(${n.result})`,backgroundSize:"cover"}).prependTo(e)},n.readAsDataURL(t)}createFileInfo(t){const e=this.fileRenameBtn().addClass("flex-none").on("click",s=>{const r=g(s.target).closest(".file-item");r.find(".file-info").addClass("hidden"),r.find(".input-rename-container").removeClass("hidden");const o=r.find("input")[0];o.focus(),o.value.lastIndexOf(".")!==-1&&o.setSelectionRange(0,o.value.lastIndexOf("."))});return g('<div class="file-info flex justify-between items-center"></div>').css({width:120}).append(g(`<div class="file-name py-1 ellipsis">${t.name}</div>`)).append(e)}createRenameContainer(t){const{duplicatedHint:e,onDuplicated:n}=this.options,s=g("<input />").addClass("input-rename-container border-primary border hidden").prop("type","text").prop("autofocus",!0).prop("defaultValue",t.name).css({width:120}).on("keydown",r=>{if(r.key==="Enter"){const o=s.closest(".file-item").find(".file-name");if(o.html()===s.val()){s.addClass("hidden"),o.closest(".file-info").removeClass("hidden");return}if(this.fileMap.has(s.val())){n==null||n(s.val()),e&&alert(e);return}this.renameFileItem(t,s.val()),s.addClass("hidden"),o.html(s.val()).closest(".file-info").removeClass("hidden")}else r.key==="Escape"&&s.val(t.name).addClass("hidden").closest(".file-item").find(".file-name").removeClass("hidden")}).on("blur",()=>{const r=s.closest(".file-item").find(".file-name");if(r.html()===s.val()){s.addClass("hidden"),r.closest(".file-info").removeClass("hidden");return}if(this.fileMap.has(s.val())){n==null||n(s.val()),e&&alert(e);return}this.renameFileItem(t,s.val()),s.addClass("hidden"),r.html(s.val()).closest(".file-info").removeClass("hidden")});return s}}sc.NAME="UploadImgs",sc.DEFAULT={uploadText:"添加文件",renameBtn:!0,renameText:"重命名",renameIcon:"edit",renameClass:"",deleteBtn:!0,deleteText:"删除",deleteIcon:"trash",deleteClass:"",showIcon:!1,multiple:!0,limitSize:!1,btnClass:"",draggable:!0,accept:"image/jpg, image/jpeg, image/gif, image/png",showSize:!0,useIconBtn:!0,totalCountText:'共 <span class="font-bold text-black">%s</span> 个文件 <span class="font-bold text-black">%s</span> 个文件等待上传。'};const rc=Symbol("batch-form");class oc extends zt{constructor(){super(...arguments),this._actions=null,this._cols=[],this._idSeed=0,this._rows=[]}afterInit(){var s;const t=g(this.element),e=t.find(".form-batch-table").addClass("borderless");let n=e.find("tbody");n.length||(n=g("<tbody/>").appendTo(e)),this.$tbody=n,this._template=(s=t.find(".form-batch-template").get(0))==null?void 0:s.innerHTML,this._cols=[],e.find("thead>tr>.form-batch-head").each((r,o)=>{const a=g(o),l=a.data();l&&(l.hidden=a.hasClass("hidden"),this._cols.push(l))}),t.on("click",r=>{const o=g(r.target).closest(".form-batch-btn");if(!o.length)return;const a=o.dataset("type"),h=o.closest("tr").dataset("index");a==="add"?this.addRow(h):a==="delete"?this.deleteRow(h):a==="ditto"&&this.toggleDitto(o)}).on("change",".form-batch-input,.pick-value",r=>{const o=g(r.target);r.___td===rc||o.hasClass("pick-value")&&!r.___td||this.syncDitto(o)}).on("change",'[type="radio"]',r=>{const o=g(r.target),a=o.closest("td"),l=o.attr("name"),h=a.find(`[name="${l}"]`),f=h.filter(":checked").val();h.attr("data-val",f)}),this.options.sortable&&(this._sortable=new Ur(n,{draggable:"tr",handle:'.form-batch-btn[data-type="sort"]',dataIdAttr:"data-gid",ghostClass:"bg-primary-50",onSort:()=>{this._rows=this._sortable.toArray().map(Number),this.render()},dragShadow:!1})),this.render()}destroy(){g(this.element).off("click change"),this.$tbody=void 0,this._template=void 0,this._cols.length=0,this._rows.length=0}render(t,e){super.render(t,e),!e&&this._rows.length?this._renderRows():(this._actions=null,this._initRows())}addRow(t){const e=this._idSeed++;typeof t=="number"&&t>=0&&t<=this._rows.length?this._rows.splice(t+1,0,e):(t=this._rows.length,this._rows.push(e)),this._renderRows(void 0,t)}deleteRow(t){var n;if(this._rows.length<=1||typeof t!="number"||t<0||t>=this._rows.length)return!1;const e=this._rows[t];this._rows.splice(t,1),(n=this.$tbody)==null||n.children(`[data-gid="${e}"]`).remove(),this._renderRows(void 0,t)}deleteRowByGid(t){return this.deleteRow(this._rows.indexOf(t))}toggleDitto(t,e){const n=t.closest("td");e=e??n.attr("data-ditto")!=="on",n.attr("data-ditto",e?"on":"off"),e&&n.closest("tr").prev("tr").find(`td[data-name="${n.data("name")}"]`).find(".form-batch-input,.pick-value").each((o,a)=>{this.syncDitto(g(a),!1)})}syncDitto(t,e=!0,n=!1){const s=t.closest("td");e&&s.attr("data-ditto","off");const r=s.data("name"),a=(t.hasClass("pick-value")?t.closest(".form-group-wrapper"):t).attr("data-name"),l=`td[data-name="${r}"][data-ditto="on"]`,h=t.val();let f=t.closest("tr").next("tr"),d=f.find(l);for(;d.length;){const m=d.find(`.form-batch-input[data-name="${a}"]`);if(m.length&&m.val()!==h)m.val(h).trigger("change",rc);else{const y=d.find(".pick").parent().zui();y&&y.$&&y.$element.attr("data-name")===a&&y.$.value!==h&&y.$.setValue(h,!0).then(()=>{y.$element.find(".pick-value").trigger("change",rc)})}if(n)break;f=f.next("tr"),d=f.find(l)}}toggleCols(t,e){const n=this.$element.find(".form-batch-table").find("th.form-batch-head,td.form-batch-control");n.length&&(typeof t=="string"&&(t=[t]),t.forEach(s=>{const r=this._cols.find(o=>o.name===s);r&&(r.hidden=!e,n.filter(`[data-name="${s}"]`).toggleClass("hidden",!e),e&&requestAnimationFrame(()=>{n.filter(".form-batch-ditto-control").each((o,a)=>{const l=g(a),h=l.find(".form-batch-ditto-btn");l.css("--form-batch-ditto-width",`${h.outerWidth()}px`)})}))}))}_initRows(){const t=this.$tbody;if(!this._template||!(t!=null&&t.length))return;const{data:e=[],minRows:n,maxRows:s,mode:r,rowsCount:o=r==="add"?Math.min(Math.max(1,s??100),Math.max(1,n??(r==="add"?10:1),e.length)):e.length}=this.options;this._rows=Array(o).fill(0).map((a,l)=>l),this._idSeed=this._rows.length,this._renderRows(e)}_renderRows(t=[],e=0){var s;const n=this._rows.length;for(let r=e;r<n;r++)this._renderRow(r,t[r]);(s=this.$tbody)==null||s.attr("data-count",`${n}`)}_renderActions(t){let e=this._actions;if(!e){const{addRowIcon:n="icon-plus",deleteRowIcon:s="icon-trash",sortRowIcon:r="icon-move",sortable:o}=this.options;e=new DocumentFragment;const a='<button type="button" data-type="{type}" class="form-batch-btn btn square ghost size-sm" title="{text}"><i class="icon {icon}"></i></button>';r!==!1&&o&&e.append(g($t(a,{type:"sort",icon:r,text:this.i18n("sort")})).addClass("cursor-move")[0]),n!==!1&&e.append(g($t(a,{type:"add",icon:n,text:this.i18n("add")}))[0]),s!==!1&&e.append(g($t(a,{type:"delete",icon:s,text:this.i18n("delete")}))[0]),this._actions=e,this.$element.find('.form-batch-head[data-name="ACTIONS"]').attr("data-action-count",e.children.length+"")}t.empty().append(e.cloneNode(!0))}_renderRow(t,e){const n=this.$tbody,s=String(this._rows[t]),{idKey:r="id",mode:o,onRenderRowCol:a,onRenderRow:l}=this.options,h=o==="add",f=String(e&&e[r]!==void 0?e[r]:t+1);let d=n.children(`[data-gid="${s}"]`),m=!1;if(d.length){if(!e&&d.dataset("index")===t)return}else{m=!0;let x=this._template;if((x.includes(" zui-create ")||x.includes(" zui-create="))&&(x=x.replace(/(id|for)="([\\$a-z_]+)"/g,`$1="$2_${s}"`)),x.includes("<script>")&&x.includes('zui.create("')){const k=[];x=x.replace(/(zui\.create\("[a-zA-Z]+","#)(\w+)(",)/g,(T,j,B,K)=>(k.push(B),`${j}${B}_${s}${K}`)),k.forEach(T=>{const j=`${T}_${s}`;x=x.replace(`id="${T}"`,`id="${j}"`)})}x=x.replaceAll("{GID}",s),d=g(x.trim()).attr("data-gid",s),d.find('[type="radio"],[type="checkbox"]').each((k,T)=>{const j=g(T),B=j.attr("id"),K=`${B}_${s}`;j.attr("id",K),d.find(`label[for="${B}"]`).attr("for",K)}),d.zuiInit({onCreate:(k,T)=>(typeof T.name=="string"&&(T.name=`${T.name}[${f}]`),T)})}const y=this._rows[t-1],b=n.children(`[data-gid="${y}"]`);d.attr("data-index",`${t}`),d.find("textarea").autoHeight(),d.on("inited",(x,[k])=>{let T=k.options.name;if(T){const j=T.split("[");j.length>1&&j.pop(),T=j.join("[");const B=k.$element.closest("td");if(k.$element.attr("data-name",T),b.length&&B.data("ditto")==="on"){const K=b.find(`td[data-name="${B.data("name")}"]`);this.syncDitto(K.find(`[data-name="${T}"] .pick-value`),!1,!0)}else e&&e[T]!==void 0&&k.$.setValue(e[T],!0)}}),e&&d.data("data",e),t?b.length?b.after(d):d.appendTo(n):d.prependTo(n),m&&d.find("script").remove();const S=e||d.data("data");this._cols.forEach(x=>{let k=d.find(`td[data-name="${x.name}"]`);if(k.length||(k=g(`<td data-name="${x.name}"></td>`).appendTo(d)),x.index){k.find(".form-control-static").text(f).attr("id",`${x.name}_${s}`),a==null||a.call(this,k,x,S,t);return}if(k.toggleClass("hidden",!!x.hidden),!k.data("init")||e){if(x.name==="ACTIONS"){if(k.addClass("form-batch-row-actions"),!h)return;this._renderActions(k);return}k.data("init",1).find("[name],.form-control-static").each((j,B)=>{const K=g(B);if(K.hasClass("form-control-static")){const G=K.attr("data-name");e&&K.text(String(e[G]??""))}else{const G=K.attr("name"),Q=`${G}[${f}]`;if(K.attr({name:Q,"data-name":G}).addClass("form-batch-input"),e&&e[G]!==void 0){const Z=String(e[G]);K.is('[type="radio"],[type="checkbox"]')?K.prop("checked",Z===K.val()):K.val(Z)}k.find('[type="radio"]').each((Z,tt)=>{if(g(tt).attr("data-val")!==void 0)return;const et=k.find(`[name="${Q}"]`),ct=et.filter(":checked").val();et.attr("data-val",ct)})}})}else k.find("[name]").each((j,B)=>{var Q;const K=g(B),G=K.attr("data-name");(Q=K.attr("name"))!=null&&Q.startsWith(`${G}[`)&&(K.attr("name",`${G}[${f}]`),K.is('[type="radio"]')&&K.prop("checked",K.val()===K.attr("data-val")))}),k.find(".pick").each((j,B)=>{var G;const K=g(B).parent();(G=K.zui())==null||G.render({name:`${K.data("name")}[${f}]`})});if(x.ditto){k.addClass("form-batch-ditto");let j=k.find(".form-batch-ditto-btn");if(t){const{defaultDitto:B="on"}=x;if(k.attr("data-ditto",B),!j.length){j=g(`<button type="button" class="btn ghost form-batch-btn form-batch-ditto-btn" data-type="ditto">${this.i18n("ditto")}</button>`);let K=k.children(".form-batch-ditto-wrapper");K.length||(K=g('<div class="form-batch-ditto-wrapper"></div>').append(k.children()).appendTo(k)),K.append(j)}requestAnimationFrame(()=>k.css("--form-batch-ditto-width",`${j.outerWidth()}px`)),B==="on"&&b.find(`td[data-name="${x.name}"]`).find(".form-batch-input").each((G,Q)=>{this.syncDitto(g(Q),!1,!0)})}else k.attr("data-ditto",""),j.remove()}const T=!!(x.ditto&&t);k.toggleClass("form-batch-ditto-control",T),k.find(".form-batch-ditto-btn").toggle(T),a==null||a.call(this,k,x,S,t)}),l==null||l.call(this,d,t,S)}}oc.NAME="BatchForm",oc.DEFAULT={mode:"add",idKey:"id",i18n:{zh_cn:{ditto:"同上",delete:"删除",add:"添加",sort:"排序"},zh_tw:{ditto:"同上",delete:"刪除",add:"添加",sort:"排序"},en:{ditto:"Ditto",delete:"Delete",add:"Add",sort:"Sort"}}};const N0="";function $_(i){return typeof i=="string"?i.split(",").map(t=>{const e=parseFloat(t);return Number.isNaN(e)?null:e}):i}let ac=class extends Tt{constructor(){super(...arguments),this._canvas=kt(),this._timer=0,this._needDraw=!1}componentDidMount(){var e;this.tryDraw=this.tryDraw.bind(this),this.tryDraw();const t=(e=this._canvas.current)==null?void 0:e.parentElement;if(this.props.responsive!==!1){if(t&&typeof ResizeObserver<"u"){const n=new ResizeObserver(this.tryDraw);n.observe(t),this._rob=n}this._rob||window.addEventListener("resize",this.tryDraw)}if(t&&typeof IntersectionObserver<"u"){const n=new IntersectionObserver(s=>{this._needDraw&&s.some(r=>r.isIntersecting)&&this.tryDraw()});n.observe(t),this._iob=n}}componentDidUpdate(){this.tryDraw()}componentWillUnmount(){var t;(t=this._rob)==null||t.disconnect(),window.removeEventListener("resize",this.tryDraw)}tryDraw(){this._timer&&cancelAnimationFrame(this._timer),this._timer=requestAnimationFrame(()=>{this.draw(),this._timer=0})}draw(){const t=this._canvas.current;if(!t)return;const e=t.parentElement,{width:n,height:s,responsive:r=!0}=this.props;let o=n||e.clientWidth,a=s||e.clientHeight;if(n&&s&&r&&(o=e.clientWidth,a=Math.floor(s*o/n)),t.style.width=`${o}px`,t.style.height=`${a}px`,o=o*(window.devicePixelRatio||1),a=a*(window.devicePixelRatio||1),t.width=o,t.height=a,!g(e).isVisible()&&this._iob){this._needDraw=!0;return}const{lineSize:l=1,scaleLine:h=!1,scaleLineSize:f,scaleLineGap:d=1,scaleLineDash:m,referenceLine:y,referenceLineSize:b,referenceLineDash:S,color:x="#2c78f1",fillColor:k=["rgba(46, 127, 255, 0.3)","rgba(46, 127, 255, 0.05)"],lineDash:T=[],bezier:j}=this.props,B=$_(this.props.data);if(!B.length)return;const K=Math.floor(o/(B.length-1)),G=Math.max(...B.filter(X=>X!==null)),Q=B.map((X,et)=>{const ct=typeof X!="number";return{x:et*K,y:ct?a:Math.round((1-X/G)*(a-l)),empty:ct}});let Z=Q[0];const tt=t.getContext("2d");if(h){const X=typeof h=="string"?h:"rgba(100,100,100,.1)";tt.strokeStyle=X,tt.lineWidth=f||l,m&&tt.setLineDash(m);for(let et=0;et<Q.length;++et){if(et%d!==0)continue;const ct=Q[et];tt.moveTo(ct.x,0),tt.lineTo(ct.x,a)}tt.stroke()}if(y&&Q.length>1){const X=typeof y=="string"?y:"rgba(100,100,100,.2)",et=Q[Q.length-1];tt.moveTo(et.x,a),tt.strokeStyle=X,tt.lineWidth=b||l,tt.lineTo(Z.x,Z.y),S&&tt.setLineDash(S),tt.stroke()}for(tt.setLineDash(T);Q.length&&Q[Q.length-1].empty;)Q.pop();if(k){const X=Q[Q.length-1];if(tt.beginPath(),tt.moveTo(0,a),tt.lineTo(Z.x,Z.y),j){const et=Math.round(K/2);for(let ct=1;ct<Q.length;++ct){const pt=Q[ct],xt=Math.round((pt.y-Z.y)/5);tt.bezierCurveTo(Z.x+et,Z.y+xt,pt.x-et,pt.y-xt,pt.x,pt.y),Z=pt}}else for(let et=1;et<Q.length;++et)Z=Q[et],tt.lineTo(Z.x,Z.y);if(tt.lineTo(X.x,a),Array.isArray(k)){const et=tt.createLinearGradient(0,0,0,a);for(let ct=0;ct<k.length;++ct)et.addColorStop(ct/(k.length-1),k[ct]);tt.fillStyle=et}else tt.fillStyle=k;tt.fill()}if(Z=Q[0],tt.beginPath(),tt.moveTo(Z.x,Z.y),j){const X=Math.round(K/2);for(let et=1;et<Q.length;++et){const ct=Q[et],pt=Math.round((ct.y-Z.y)/5);tt.bezierCurveTo(Z.x+X,Z.y+pt,ct.x-X,ct.y-pt,ct.x,ct.y),Z=ct}}else for(let X=1;X<Q.length;++X)Z=Q[X],tt.lineTo(Z.x,Z.y);tt.strokeStyle=x,tt.lineWidth=l,tt.stroke()}render(){const{style:t,className:e,canvasClass:n}=this.props;return P("div",{class:"center burn-chart",className:e,style:t},P("canvas",{className:n,ref:this._canvas}))}};ac.defaultProps={responsive:!0,lineSize:1,scaleLine:!1,scaleLineSize:1,bezier:!0};class lc extends mt{}lc.NAME="Burn",lc.Component=ac;const E0="",M0="",P0="";function T_(i){const{link:t,itemProps:e={},typeIconMap:n={},labelMap:s={},searchKeys:r,active:o,itemType:a="",checkIcon:l,hideDirIcon:h}=this,{id:f,keys:d,text:m,className:y,type:b,url:S,items:x,icon:k,label:T,...j}=i;let{type:B}=i;B=B==="item"?a:B||a;let K=x?T??(s[B]||B):null,G;typeof K=="string"&&K.length&&(G=K,K=P("span",{class:"label rounded-full gray-pale size-sm ml-1"},K));let Q=S;Q===void 0&&t&&(typeof t=="function"?Q=t(i):typeof t=="object"?(Q=t[B],Q&&(Q=$t(Q,i))):x||(Q=$t(t,i)));let Z=k;Z===void 0&&(!h||Q)&&(Z=n[B]),typeof Z=="string"&&(Z={icon:Z},G&&g.extend(Z,{"data-toggle":"tooltip","data-title":G}));let tt=m??(s[B]||B);r!=null&&r.length&&(tt=ri.underlineKeys(r,[tt]));const X=String(o)===String(f);return{type:"item",key:f,content:K,icon:Z,trailingIcon:l&&X?{icon:"check",className:"mx-1 text-primary"}:void 0,items:x,"data-url":Q,"data-type":B,title:tt,selected:X,hint:m,...e,...j,className:q("dropmenu-item tree-item",y,e.className,x?"is-dir":"is-item"),innerClass:Q?"is-link open-url":"is-toggle",active:!1}}function sf(i){const{className:t,items:e,tree:n,onClickItem:s}=i;return P(De,{items:e,getItem:T_.bind(i),className:q(t,"dropmenu-tree"),defaultNestedShow:!0,onClickItem:s,...n})}const N_=(i,t)=>{const{keys:e="",text:n}=i;return!t.length||t.every(s=>e.toLowerCase().includes(s)||typeof n=="string"&&n.toLowerCase().includes(s))},rf=(i,t,e=0)=>(i=i.reduce((n,s)=>{const{items:r}=s;if(r){if(r.length){const[o,a]=rf(r,t);o.length&&(n.push({...s,items:o}),e+=a)}}else N_(s,t)&&(n.push(s),e++);return n},[]),[i,e]);class E_ extends jl{constructor(t){super(t),this._searchbox=kt(),this._list=kt(),this._handleSearch=e=>{this.setState({search:e})},this._handleExpandBtnClick=()=>{this.expand()},this._handleItemClick=({item:e,event:n})=>{const s=g(n.target);!s.closest(".tree-toggle").length&&s.closest(".is-link").length&&(this.props.togglePop(!1,{text:e.text??`${e.type}:${e.id}`}),this.props.changeState({text:e.text??`${e.type||""}:${e.id}`,value:e.id}))},this._scrollToActive=()=>{requestAnimationFrame(()=>{const e=this._list.current;e&&g(e).find(".tree-item-inner.active").scrollIntoView()})},this.activeTab=e=>{this.setState({active:e})},this.expand=e=>{this.setState({expanded:e??!this.state.expanded})},this.state={search:"",data:t.data,expanded:!1,loading:!!t.fetcher&&!t.data}}async load(){var n,s;let{fetcher:t}=this.props;if(!t)return this._scrollToActive();if(typeof t=="string"&&(t={url:t}),typeof t=="object"){const{url:r,...o}=t;t=()=>g.ajax({url:r,dataType:"json",jsonParser:za,...o})}this.setState({loading:!0});let e=await t();e.result&&(e=e.data),e={...this.props.data,...e},this.setState({data:e,loading:!1},this._scrollToActive),(s=(n=this.props).onCacheData)==null||s.call(n,e)}componentDidMount(){var t;super.componentDidMount(),this.props.data||this.load(),(t=this._searchbox.current)==null||t.focus(),this._scrollToActive()}_getTreeProps(t){const{data:{labelMap:e,link:n,typeIconMap:s,typeLabelMap:r,itemProps:o,tree:a,itemType:l,checkIcon:h,hideDirIcon:f=!0}={},search:d}=this.state;return{items:t.items,labelMap:e,typeIconMap:{execution:"run",project:"project",product:"product",program:"cards-view",...s},hideDirIcon:f,typeLabelMap:r,itemProps:o,itemType:l,checkIcon:h,onClickItem:this._handleItemClick,tree:a,link:n,active:this.props.state.value,searchKeys:g.unique(d.toLowerCase().split(" ").filter(m=>m.length))}}_getData(){const{data:t={},search:e,active:n}=this.state,{tabs:s=[{name:"other"}],expandName:r}=t;let{data:o=[]}=t;Array.isArray(o)&&(o={other:o});const a={},l=g.unique(e.toLowerCase().split(" ").filter(m=>m.length));let h,f;Object.keys(o).forEach(m=>{const y=r===m,b=s.find(B=>B.name===m)||{name:m},S=o[m]||[],x=(n===m||b.active&&n===void 0)&&!y,[k,T]=rf(S,l),j={name:m,items:k,text:b.text,active:x,count:T};y?h=j:(a[m]=j,x&&(f=j))});const d=s.reduce((m,{name:y})=>(y!==r&&m.push(a[y]||{name:y,items:[]}),m),[]);return!f&&d.length&&(f=d[0]),{tabs:d,expandData:h,activeTab:f}}_renderList(t,e,n){const s=e.name,{expanded:r,data:o={}}=this.state;let{hideSingleTab:a=!0}=o;return a=t.length===1&&a,P(bn,null,a?null:P("div",{className:"dropmenu-nav"},P("ul",{key:"nav",className:"nav nav-secondary"},t.map(({name:l,text:h,count:f})=>P("li",{className:"nav-item"},P("a",{className:`${s===l?" active":""}`,onClick:this.activeTab.bind(this,l)},h||l,f?P("span",{className:"label gray-pale rounded-full size-sm font-normal"},f):null))))),P("div",{key:"tab",className:"flex-auto dropmenu-list scrollbar-hover"},P(sf,{...this._getTreeProps(e)})),n?P("div",{key:"foot",className:"dropmenu-foot flex-none toolbar justify-between border-t"},o.footToolbar?Zt.render(o.footToolbar,[]):P("div",{className:"flex-auto"}),P(Et,{type:"ghost text-dark rounded gap-0.5 px-1.5",trailingIcon:`angle-${this.state.expanded?"left":"right"} opacity-60`,onClick:this._handleExpandBtnClick},n.text||n.name," ",n.count&&r?P("span",{className:"ml-1 label gray-pale rounded-full size-sm font-normal"},n.count):null)):null)}_renderExpand(t){return P("div",{className:"col w-1/2 dropmenu-list scrollbar-hover"},P(sf,{...this._getTreeProps(t)}))}_renderPop(){const{expanded:t,data:e={}}=this.state,{searchHint:n,search:s=!0,title:r}=e,{expandData:o,tabs:a,activeTab:l}=this._getData(),h=t&&o;return P(bn,null,s?P("div",{key:"search",className:"p-3 flex-none"},P(Ai,{ref:this._searchbox,className:"size-md",placeholder:n,onChange:this._handleSearch})):null,r?P("div",{className:"dropmenu-title"},r):null,P("div",{class:"row flex-auto min-h-0",ref:this._list},P("div",{class:`col w-${h?"1/2":"full"}`},this._renderList(a,l,o)),h?P("div",{class:"w-px bg-gray opacity-10"}):null,t&&o&&this._renderExpand(o)))}_getClass(t){const{expanded:e,loading:n,data:s={}}=this.state;return q("dropmenu load-indicator col",super._getClass(t),e&&"is-expanded",n&&"loading",s.search!==!1&&"has-search",s.title?"has-title":"")}_getStyle(t={},e){t=super._getStyle(t,e);const{width:n=248}=this.props;return typeof n=="number"&&(t.width=n*(this.state.expanded?2:1)),t}_getProps(t){const{style:e,...n}=super._getProps(t),s=this.trigger,r=s==null?void 0:s.getBoundingClientRect();return{...n,style:{...e,...this._getStyle(),maxHeight:r?Math.max(r.top-8,window.innerHeight-r.bottom-8):e.maxHeight}}}}class M_ extends Xr{_getProps(t){const e=super._getProps(t);return{type:"button","data-value":t.state.value,...e}}_renderTrigger(t){const{text:e,state:n,children:s,caret:r,leadingAngle:o}=t,a=n.text??e??s;return[o&&P(Ht,{icon:"angle-right",className:"is-leading"}),P("span",{key:"text",className:"text",title:typeof a=="string"?a:void 0},a),r&&P("div",{key:"caret",class:"is-caret"},P("span",{className:"caret"}))]}}let ko=class extends ee{constructor(){super(...arguments),this._setCacheData=t=>{const{cache:e}=this.props;e&&(this._cacheData=t,typeof e=="number"&&(this._cacheTimer&&clearTimeout(this._cacheTimer),this._cacheTimer=window.setTimeout(()=>{this._cacheData=void 0,this._cacheTimer=0},e)))}}getDefaultState(t){return{...super.getDefaultState(t),text:void 0}}componentWillUnmount(){super.componentWillUnmount(),this._cacheTimer&&clearTimeout(this._cacheTimer)}componentWillReceiveProps(t){(this.props.data!==t.data||this.props.fetcher!==t.fetcher)&&(this._cacheData=void 0)}_getTriggerProps(t,e){const{className:n,...s}=super._getTriggerProps(t,e),{value:r=""}=e;return{...s,className:q(n,{"has-value":r.length}),text:t.text,caret:t.caret,maxWidth:t.maxWidth,leadingAngle:t.leadingAngle}}_getPopProps(t,e){return{...super._getPopProps(t,e),data:this._cacheData||t.data,fetcher:t.fetcher,cache:!!t.cache,onCacheData:this._setCacheData}}};ko.defaultProps={...ee.defaultProps,popWidth:248,popMaxHeight:800,maxWidth:160,className:"dropmenu-btn btn ghost",tagName:"button",clickType:"toggle",leadingAngle:!0,caret:!0,cache:60*1e3*4},ko.Pop=E_,ko.Trigger=M_;class cc extends mt{}cc.NAME="Dropmenu",cc.Component=ko;class of extends zt{init(){const{echarts:t}=window;if(!t){console.warn("ZUI: ECharts is not loaded.");return}const{responsive:e=!0,theme:n,...s}=this.options,r=t.init(this.element,n);r.setOption(s),e&&g(window).on(`resize.${this.gid}.ECharts.zt`,r.resize),this.chart=r}destroy(){var n;const{echarts:t}=window;if(!t){super.destroy();return}const{responsive:e=!0}=this.options;e&&g(window).off(`resize.${this.gid}.ECharts.zt`),(n=this.chart)==null||n.dispose(),super.destroy()}}of.NAME="ECharts";const Vi=class extends me{_getFileIcon(t,e){if(!e)return null;const n=typeof e;return n==="string"?e:(e=e||this.props.fileIcon,n==="function"?e.call(this,t):e[t.extension]||"file")}_getItems(t){const e=super._getItems(t),{fileIcon:n,fileSizeFormat:s,itemProps:r,heading:o,fileUrl:a,fileActions:l}=t,h=e.map(f=>{let d=null;return typeof f.size=="number"&&(d=fe(f.size),s&&(d=$t(s,{size:d}))),{key:`${f.id}`,icon:this.constructor.getFileIcon(f,n),iconClass:"text-gray",title:f.title,subtitle:d,multiline:!1,url:typeof a=="function"?a.call(this,f):a?$t(a,f):void 0,actions:l?l.call(this,f):void 0,...r}});return o&&h.unshift({key:"heading",titleClass:"font-bold",type:"heading",...o}),h}_getRenderedItem(t,e){return e}static getFileIcon(t,e){if(!e)return null;const n=typeof e;return n==="string"?e:n==="function"?e.call(this,t):e[t.extension]||"file"}static getDefaultIconMap(){return[["file-image",["png","jpg","jpeg","gif","bmp","webp","tiff","ico","svg"]],["file-audio",["mp3","wav","flac","ogg","m4a","wma","aac","aiff","alac"]],["file-video",["mp4","avi","mkv","mov","flv","wmv","webm"]],["file-archive",["zip","rar","7z","tar","gz","bz2","xz"]],["file-code",["js","ts","jsx","tsx","html","css","scss","less","json","xml","yml","yaml","toml","ini","markdown"]],["file-pdf",["pdf"]],["file-log",["log"]],["markdown",["md"]],["file-word",["doc","docx"]],["file-excel",["xls","xlsx"]],["file-powerpoint",["ppt","pptx"]],["file-text",["txt","csv"]]].reduce((e,[n,s])=>(s.forEach(r=>{e[r]=n}),e),{})}};Vi.NAME="file-list",Vi.defaultProps={...me.defaultProps,fileSizeFormat:"({size})",fileIcon:Vi.getDefaultIconMap()},Vi.TAG="div",Vi.defaultItemProps={component:"div"};let P_=Vi,hc=class extends mt{};hc.NAME="FileList",hc.Component=P_;const A0="",af=i=>i.replace(/([[\]])/g,"\\$1");class uc extends zt{constructor(){super(...arguments),this._disabled=!1,this._timer=0}init(){this.$element.on("submit",this.onSubmit.bind(this)).on("input mousedown change",this.onInput.bind(this))}enable(t=!0,e=0){if(this._resetTimer(),e){this._timer=window.setTimeout(()=>{this.enable(t),this._timer=0},e);return}this.$element.toggleClass("loading",!t),this.$element.find('.btn-submit,button[type="submit"]').toggleClass("disabled",!t).prop("disabled",!t),this._disabled=!t}disable(){this.enable(!1)}onInput(t){const e=g(t.target).closest(".has-error");if(!e.length)return;let n=e.attr("name");n||(n=e.find(".pick-value").attr("name"));const s=n?`#${n.split("[")[0]}Tip,#${af(n)}Tip`:".form-tip";e.removeClass("has-error"),e.closest(".form-group,.form-batch-control").find(s).remove()}onSubmit(t){var o;if(t.preventDefault(),this._disabled)return;const{element:e}=this,n=g.extend({},this.options);this.emit("before",t,e,n);const s=()=>{this.$element.find(".ajax-form-tip").each(function(){const l=g(this);l.closest(".form-group,.form-batch-control").find(".has-error").removeClass("has-error"),l.remove()}),this.disable();const a=this._processData();this._send(a)},r=(o=n.beforeSubmit)==null?void 0:o.call(n,t,e,n);if(r!==!1){if(r instanceof Promise){r.then(a=>a&&s());return}s()}}submit(){this.element.submit()}reset(){this.element.reset()}destroy(){this._resetTimer()}_resetTimer(){this._timer&&(window.clearTimeout(this._timer),this._timer=0)}_processData(){const{$element:t,options:e}=this;let n=new FormData(this.element),{submitEmptySelectValue:s="",submitNoValueChecks:r}=e;const{submitDisabledValue:o=!0}=e;s!==!1&&(typeof s!="boolean"&&(s=""),t.find("select").each((l,h)=>{const f=g(h),d=f.attr("name");f.is("[disabled]")&&!o||n.has(d)||n.append(d,typeof s=="object"?s[d]:s)})),o&&t.find("[disabled][name]").each((l,h)=>{const f=g(h);if(f.hasClass("not-submit-disabled-value"))return;const d=f.attr("name");n.has(d)||n.append(d,f.val())}),r&&(r=typeof r=="string"?r:"",t.find('[type="checkbox"],[type="radio"]').not(":checked").each((l,h)=>{const f=g(h),d=f.attr("name");n.has(d)||f.is("[disabled]")&&!o||n.append(d,f.data("notCheckedValue")??r)}));const{beforeSend:a}=e;if(a){const l=a(n);l instanceof FormData&&(n=l)}return this.emit("send",n),n}_send(t){const{$element:e,options:n}=this;let s,r;const o=n.url||e.attr("action"),a={method:e.attr("method")||"POST",data:t,headers:e.closest(".modal").length?{"X-ZUI-Modal":"true"}:void 0,dataType:"json",jsonParser:JSON.parse},{optionsModifiers:l}=this.constructor;l.length&&l.forEach(f=>{const d=f.call(this,a);d&&d!==a&&g.extend(!0,a,d)});const h=g.ajax(o,a).success((f,d,m)=>{var y,b,S;f instanceof Blob?(xr(f,(S=(b=(y=m.headers.get("Content-Disposition"))==null?void 0:y.split(";")[1])==null?void 0:b.split("=")[1])==null?void 0:S.replace(/"/g,"")),r={result:"success"}):(r=f,(!r||typeof r!="object")&&(s=new Error("Invalid json format")))}).fail(f=>{s=f}).complete(()=>{var f,d;if(s)this.emit("error",s),console.warn("ZUI: send ajax form failed",s),n.onError?n.onError(s):Vt.showError({size:"lg",error:[`<b>POST:</b> ${o}`,`<b>Error:</b> ${s.message.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}`,`<b>Response:</b> ${h.data}`].join("<br>")});else{const m=(f=n.onResult)==null?void 0:f.call(this,r);if(m===!1)return;m&&(r=g.extend(r,m)),this._handleResult(r)}this.emit("complete",r,s),(d=n.onComplete)==null||d.call(n,r,s),this.enable(!0,s||(r==null?void 0:r.result)!=="success"?0:5e3)})}_showValidateMessage(t){var n;let e;Object.entries(t).forEach(([s,r])=>{Array.isArray(r)&&(r=r.join(""));const o=af(s),{$element:a}=this;let l=a.find(`#${o}`);if(l.length||(l=a.find(`[name="${o}"]`)),!l.length&&!s.includes("[")&&(l=a.find(`[name="${o}[]"]`)),!l.length){Vt.alert(r);return}l.hasClass("pick-value")&&(l=l.closest(".pick")),l.addClass("has-error");const h=l.closest(".form-group,.form-batch-control,td");if(h.length){let f=h.find(`#${o}Tip`);f.length||(f=g(`<div class="form-tip ajax-form-tip text-danger pre-line" id="${s}Tip"></div>`).appendTo(h)),f.empty().text(r)}else Vt.alert(r);e||(e=l)}),e&&((n=e[0])==null||n.focus())}_handleResult(t){var l,h;const{options:e}=this,{message:n}=t,s=t.result==="success";if(s){if(this.emit("success",t),((l=e.onSuccess)==null?void 0:l.call(e,t))===!1)return;typeof n=="string"&&n.length&&xn.show({content:n,type:"success"})}else{if(this.emit("fail",t),((h=e.onFail)==null?void 0:h.call(e,t))===!1)return;n&&(typeof n=="string"&&n.length?Vt.alert(n):typeof n=="object"&&this._showValidateMessage(n))}const r=e.closeModal??t.closeModal;r&&(r!=="onlySuccess"||s)&&Vt.hide(typeof r=="string"&&r!=="onlySuccess"?r:void 0);const o=e.callback??t.callback;if(o){const f=[["options",e],["result",t]];if(typeof o=="string"){const d=g.runJS(o,...f);typeof d=="function"&&!o.endsWith(";")&&d(t)}else if(typeof o=="object"){const d=g.runJS(o.name,...f);typeof d=="function"&&d.apply(this,Array.isArray(o.params)?o.params:[o.params])}}const a=e.load??t.load??t.locate;a&&this.$element.trigger("locate.zt",a)}}uc.NAME="AjaxForm",uc.optionsModifiers=[];function dc(i,t){var a,l;const e=i.result==="success";if(e){if(((a=t.onSuccess)==null?void 0:a.call(t,i))===!1)return}else if(((l=t.onFail)==null?void 0:l.call(t,i))===!1)return;const{message:n}=i;n&&(t.onMessage?t.onMessage(n,i):typeof n=="string"&&n.length&&(e?xn.show({content:n,type:"success"}):Vt.alert(n)));const s=t.closeModal??i.closeModal;s&&Vt.hide(typeof s=="string"?s:void 0);const r=t.callback??i.callback;if(r){const h=[["options",t],["result",i]];if(typeof r=="string"){const f=g.runJS(r,...h);typeof f=="function"&&!r.endsWith(";")&&f(i)}else if(typeof r=="object"){const f=g.runJS(r.name,...h);typeof f=="function"&&f.apply(null,Array.isArray(r.params)?r.params:[r.params])}}const o=t.load??i.load??i.locate;o&&g(t.element||document).trigger("locate.zt",o)}function lf(i){return typeof i=="string"&&(i=i.split(",").reduce((t,e)=>{const[n,s]=e.trim().split(":");return t[n.trim()]=s.trim(),t},{})),Object.keys(i).reduce((t,e)=>{const n=e.endsWith("?"),s=n?e.substring(0):e;let r=i[s];if(typeof r=="string"){const[o,a]=r.split("~"),l=g(o);if(!l.length)return t;a==="checkedIDList"?r=l.closest("[data-zui-dtable]").dtable("getChecks"):l[0].hasAttribute("data-map-value")?r=l.dataset("mapValue"):l.closest(".pick").length?r=l.closest(".pick").find(".pick-value").val():l.is("input,select,textarea")?r=l.val():r=l.text()}return(n||r!=null&&r!==""&&(!Array.isArray(r)||r.length))&&(t[s]=r),t},{})}async function ci(i){if(i.confirm)return await Vt.confirm(i.confirm)?ci({...i,confirm:void 0}):[void 0,new Error("canceled")];if(i.beforeSubmit&&await i.beforeSubmit(i)===!1)return[void 0,new Error("canceled")];const{loadingClass:t,element:e}=i;e&&t&&g(e).addClass(t);const{data:n,dataMap:s}=i;let r;n&&(r=gr(n)),s&&(r=gr(lf(s),r));const{beforeSend:o}=i;if(o){const f=o(r);f instanceof FormData&&(r=f)}let a,l;return await new rs({url:i.url,method:i.method||"POST",body:r,headers:i.headers,dataType:"json"}).success(f=>{l=f,(!l||typeof l!="object")&&(a=new Error("Invalid json format"))}).fail(f=>{a=f,console.warn("ZUI: cannot submit ajax form",f)}).complete(()=>{var f,d;a?(f=i.onError)==null||f.call(i,a):dc(l,i),(d=i.onComplete)==null||d.call(i,l,a),e&&t&&g(e).removeClass(t)}).send(),[l,a]}g.extend(g,{ajaxSubmit:ci}),g(document).on("click.ajaxSubmit.zui",".ajax-submit",function(i){i.preventDefault();const t=g(this);if(t.is("[disabled],.disabled"))return;const e=t.data();!e.url&&t.is("a")&&(e.url=t.attr("href")||""),e.url&&(e.element=this[0],ci(e))});class A_ extends Tt{constructor(t){super(t),this.state={pinnedList:t.pinnedList||[]}}_handlePinnedChange(t){const{pinnedList:e}=this.state;e.includes(t)?e.splice(e.indexOf(t),1):e.push(t),this.setState({pinnedList:e})}_handleSave(){var t,e;(e=(t=this.props).onSave)==null||e.call(t,this.state.pinnedList)}render(t,e){const{tip:n,items:s,saveText:r=Nt.getLang("save"),resetText:o=Nt.getLang("reset"),cancelText:a=Nt.getLang("cancel"),pinnedIcon:l="pinned",unpinnedIcon:h="unpinned"}=t,{pinnedList:f}=e,d=new Set(f);return P("form",{className:"form-setting-form w-80 col gap-3"},P("div",{className:"text-gray mt-2"},n),P("div",{className:"divider opacity-5"}),P("div",{className:"row flex-wrap"},s.map(({text:m,value:y})=>{const b=d.has(y);return P("label",{className:"state size-sm ghost w-1/2 pl-1 pr-2 py-1 flex flex-nowrap gap-2 items-center rounded",onClick:this._handlePinnedChange.bind(this,y)},P(Ht,{icon:b?l:h,className:b?"text-primary":"text-gray-400"}),P("div",{className:`flex-auto text-clip${b?"":" text-gray"}`},m))})),P("div",{className:"row flex-nowrap gap-4 mt-2"},P(Et,{size:"md",className:"btn-wide",type:"primary",onClick:this._handleSave.bind(this)},r),P(Et,{size:"md",className:"btn-wide","data-dismiss":"popover"},a),P(Et,{size:"md",type:"primary-ghost",disabled:!f.length,onClick:()=>this.setState({pinnedList:[]})},o)))}}class cf extends Te{_getFormItems(){const t=this.$element.closest("form"),e=[],n=[];return t.find(".form-group.is-foldable[data-name]").each((s,r)=>{if(g(r).hasClass("hidden"))return;const o=g(r),a=o.data("name"),l=o.find(".form-label").first();let h=o.data("label");if(h===void 0){const f=l.find(".text");f.length&&(h=f.text())}h===void 0&&(h=l.text().trim()),e.push({value:a,text:h||a}),o.hasClass("is-pinned")&&n.push(a)}),{items:e,pinnedList:n}}_handleSave(t){const{customUrl:e,onSave:n}=this.options,s=()=>{(n==null?void 0:n(t))!==!1&&this.hide();const r=this.$element.closest("form");r.find(".form-group.is-foldable[data-name]").each((o,a)=>{const l=g(a),h=l.data("name");l.toggleClass("is-pinned",t.includes(h))}),r.toggleClass("no-foldable-items",!r.find(".form-group.is-foldable").not(".is-pinned,.hidden").length)};e?ci({url:e,data:{"fields[]":t},onSuccess:r=>{delete r.callback,s()}}):s()}_getRenderOptions(){const{title:t,tip:e,className:n,saveText:s,resetText:r,cancelText:o}=this.options,{items:a,pinnedList:l}=this._getFormItems();return{...super._getRenderOptions(),title:t,headingClass:"popover-heading transparent px-4 pt-4",contentClass:"px-4 pb-4",titleClass:"text-lg font-bold",content:P(A_,{tip:e,saveText:s,resetText:r,cancelText:o,items:a,pinnedList:l,onSave:this._handleSave.bind(this),onCancel:this.hide.bind(this)}),className:q("form-setting-popover",n)}}}cf.NAME="FormSetting";class hf extends zt{get mode(){return this.$container.hasClass("is-full")?"full":"lite"}get shownFoldItems(){return this.$container.hasClass("show-fold-items")}get $container(){let t=this._$container;if(!t){const{$element:e}=this;t=e.closest(".panel-form,.page-form"),t.length||(t=e),this._$container=t}return t}afterInit(){super.afterInit();const t=[],{$element:e}=this;e.children(".form-group[data-name]").each((a,l)=>{t.push(g(l).attr("data-name"))}),this._fields=t;const{fullModeOrders:n}=this.options;this._fullModefields=typeof n=="string"?[n]:n;let{preserve:s}=this.options;(s===!0||s===void 0)&&(s=e.attr("id")),this._preserveID=s||!1;const r=this.options.mode||(this._preserveID?ae.get(`FormGrid:${this._preserveID}:mode`,this.mode):this.mode);this.toggleMode(r,!1,!0);const{namespace:o}=this;this.$container.on(`click${o}`,".btn-full-form",()=>this.toggleMode("full")).on(`click${o}`,".btn-lite-form",()=>this.toggleMode("lite")).on(`click${o}`,".btn-toggle-fold",()=>this.toggleFold()),e.on(`change${o}`,"[name]",this._handleChange.bind(this)),e.toggleClass("no-foldable-items",!e.find(".form-group.is-foldable").not(".is-pinned,.hidden").length)}getField(t){const{$element:e}=this;let n=e.children(`.form-group[data-name="${t}"]`);if(!n.length)return;const s=e.children(`[data-wrap-before="${t}"]`),r=e.children(`[data-wrap-after="${t}"]`);let o=g();return s.length&&(o=o.add(s)),n.find("script").remove(),n=e.children(`.form-group[data-name="${t}"]`),o=o.add(n),r.length&&(o=o.add(r)),{name:t,wrapBefore:!!s.length,wrapAfter:!!r.length,foldable:n.hasClass("is-foldable"),$ele:n,$group:o}}destroy(){super.destroy(),this.$container.off(this.namespace)}toggleFold(t){t=t??!this.shownFoldItems,this.$container.toggleClass("show-fold-items",t)}openSetting(){this.$container.find(".btn-custom-form").trigger("click")}toggleMode(t,e,n){const s=this.mode;t=t||(s==="full"?"lite":"full"),!(s===t&&!e)&&(this.$container.toggleClass("is-full",t==="full").toggleClass("is-lite",t==="lite"),!n&&this._preserveID&&ae.set(`FormGrid:${this._preserveID}:mode`,t),this.updateOrders())}updateOrders(t,e){t&&(this._fields=t),e&&(this._fullModefields=typeof e=="string"?[e]:e);const{mode:n}=this;n==="full"?(e=this._fullModefields,Array.isArray(e)&&e.forEach(s=>{this.sortFields(s)})):this.sortFields()}sortFields(t){t=t||this._fields,typeof t=="string"&&(t=t.split(","));let e;t.forEach(r=>{const o=this.getField(r);if(o){if(e){const a=e.$group.last();if(o.$group.first()[0]===a[0])return;o.$group.insertAfter(a)}e=o}});const n=this.$element.children(".form-group.is-foldable").first(),s=this.$element.children(`[data-wrap-before="${n.attr("data-name")}"]`);this.$element.children(".panel-form-divider").insertBefore(s.length?s:n)}_handleChange(t){const{autoLoad:e,loadUrl:n}=this.options;if(!e)return;const s=g(t.target).closest("[name]");Object.keys(e).forEach(r=>{const o=e[r];".[#".includes(r[0])||(r=`[name="${r}"]`),s.closest(r).length&&window.loadForm(g.extend({url:n,target:s},typeof o=="string"?{items:o}:o))})}}hf.NAME="FormGrid";const I0="";class uf extends zt{init(){const{initGantt:t}=this.options;typeof t=="function"&&t()}destroy(){const{destroyGantt:t}=this.options;typeof t=="function"&&t(),super.destroy()}}uf.NAME="Gantt";const D0="",R0="";let df=class extends ee{constructor(){super(...arguments),this._searchBox=kt(),this._menu=kt(),this._handleChange=t=>{this.setState({value:t.trim()})},this._handleFocus=()=>{this.toggle(!0)},this._handleEenter=()=>{var e;const t=(e=this._menu.current)==null?void 0:e.getActiveKey();t&&this.search(t)},this._handleClickItem=t=>{this.search(t.item.key)}}search(t){var e,n;(e=this.props.onSearch)==null||e.call(this,t,this.state.value),this.toggle(!1,{value:""}),(n=this._searchBox.current)==null||n.blur()}componentDidUpdate(t,e){var s;super.componentDidUpdate(t,e);const n=this._menu.current;this.state.open&&n&&n.getActiveKey()===void 0&&((s=this._menu.current)==null||s.activeNext())}_getHotkeys(){return this._hotkeys||(this._hotkeys={activeNext:{keys:"ArrowDown",handler:()=>{var t;return(t=this._menu.current)==null?void 0:t.activeNext()}},activePrev:{keys:"ArrowUp",handler:()=>{var t;return(t=this._menu.current)==null?void 0:t.activePrev()}},enter:!0}),this._hotkeys}_renderTrigger(t){return P(Ai,{delay:0,ref:this._searchBox,placeholder:t.searchHint,onChange:this._handleChange,onFocus:this._handleFocus,hotkeys:this._getHotkeys(),onEnter:this._handleEenter,...t.searchBox})}_getItems(t,e){var m;const{items:n}=t,{value:s}=e,r=Number.isInteger(+s),o=(m=t.getSearchType)==null?void 0:m.call(this,s),a=[],l=n.reduce((y,b)=>(y.set(b.key,b),y),new Map),h="search",f=y=>{var b;return{html:((b=y.text)==null?void 0:b.replace("{0}",s))??s}};if(o&&r){const y=l.get(o);y&&a.push({...y,className:q(y.className,"w-full"),text:f(y)})}const d=l.get(h);return a.push({...d,className:q(d==null?void 0:d.className,"w-full"),text:d?f(d):s}),r&&n.forEach(y=>{y.key===h||y.key===o||a.push({...y,className:q(y.className,"w-1/2"),text:f(y)})}),a}_renderPop(t,e){return P(ve,{className:"row flex-wrap overflow-auto scrollbar-hover",items:this._getItems(t,e),onClickItem:this._handleClickItem,ref:this._menu,activeOnHover:!0,...t.menu})}};df.defaultProps={...ee.defaultProps,pickerName:"global-search",hidePopWhenEmpty:!0};class So extends mt{}So.NAME="GlobalSearch",So.Component=df,So.replace=!0;function I_(i,t=1e3){let e=null;return(...n)=>{e&&clearTimeout(e),e=setTimeout(()=>{i(...n),e=null},t)}}const ff=class _m extends zt{static async loadModule(){return this.Module||(this.Module=await g.getLib("g6")),this.Module}async afterInit(){const t=await _m.loadModule();if(this.destroyed)return;const{type:e="TreeGraph",width:n=this.$element.width(),height:s=this.$element.height()||500,responsive:r=!1,data:o,nodeFn:a,edgeFn:l,comboFn:h,...f}=this.options,d=new t[e]({container:this.element,width:n,height:s,...f});a&&d.node(a),l&&d.edge(l),h&&d.combo(h),d.data(o),d.render(),this.instance=d,r&&this.initResizeObserver()}initResizeObserver(){const t=I_(()=>{this.instance.changeSize(this.$element.width(),this.$element.height()),this.instance.render()},500);this.resizeObserver=new ResizeObserver(()=>{t()}),this.resizeObserver.observe(this.element)}destroy(){var t;this.options.responsive&&((t=this.resizeObserver)==null||t.disconnect()),this.instance.destroy(),super.destroy()}};ff.NAME="Graph";let pf=ff;g.registerLib("g6",{src:"graph/g6.min.js",check:"G6"}),pf.register();function mf(i){i=i||location.search,i[0]==="?"&&(i=i.substring(1));try{const t=new URLSearchParams(i),e={};for(const n of t.keys())e[n]=t.getAll(n).join(",");return e}catch{return{}}}function D_(i){if(!i)return{url:i};const{config:t}=window;if(/^https?:\/\//.test(i)){const l=window.location.origin;if(!i.includes(l))return{external:!0,url:i};i=(t.webRoot.endsWith("/")?"/":"")+i.substring((l+t.webRoot).length)}const e=i.split("#"),n=e[0].split("?"),s=n[1],r=s?mf(s):{};let o=n[0];const a={url:i,isOnlyBody:r.onlybody==="yes",vars:[],hash:e[1]||"",params:r,tid:r.tid||""};if(t.requestType==="GET"){a.moduleName=r[t.moduleVar]||"index",a.methodName=r[t.methodVar]||"index",a.viewType=r[t.viewVar]||t.defaultView;for(const l in r)l!==t.moduleVar&&l!==t.methodVar&&l!==t.viewVar&&l!=="onlybody"&&l!=="tid"&&a.vars.push([l,r[l]])}else{let l=o.lastIndexOf("/");l===o.length-1&&(o=o.substring(0,l),l=o.lastIndexOf("/")),l>=0&&(o=o.substring(l+1));const h=o.lastIndexOf(".");h>=0?(a.viewType=o.substring(h+1),o=o.substring(0,h)):a.viewType=t.defaultView;const f=o.split(t.requestFix);if(a.moduleName=f[0]||"index",a.methodName=f[1]||"index",f.length>2)for(let d=2;d<f.length;d++)a.vars.push(["",f[d]]),r["$"+(d-1)]=f[d]}return a}function An(i,t,e,n,s,r){if(typeof i=="object")return An(i.moduleName,i.methodName,i.vars,i.viewType,i.hash,i.params);const o=window.config||{};if(e){typeof e=="string"&&(e=e.split("&"));for(let h=0;h<e.length;h++){const f=e[h];if(typeof f=="string"){const d=f.split("=");e[h]=[d.shift(),d.join("=")]}}}const a=[],l=o.requestType==="GET";if(l){if(a.push(o.router,"?",o.moduleVar,"=",i,"&",o.methodVar,"=",t),e)for(let h=0;h<e.length;h++)a.push("&",e[h][0],"=",e[h][1]);n&&n!==o.defaultView&&a.push("&",o.viewVar,"=",n)}else{if(o.requestType=="PATH_INFO"&&a.push(o.webRoot,i,o.requestFix,t),o.requestType=="PATH_INFO2"&&a.push(o.webRoot,"index.php/",i,o.requestFix,t),e)for(let h=0;h<e.length;h++)a.push(o.requestFix+e[h][1]);n=n||o.defaultView,n&&a.push(".",n)}return r&&Object.keys(r).forEach(h=>{const f=r[h];h[0]!=="$"&&a.push(!l&&!a.includes("?")?"?":"&",h,"=",f)}),typeof s=="string"&&a.push(s.startsWith("#")?"":"#",s),a.join("")}let gf=class extends Ft{get actions(){return this.state.actions||this.props.actions||[]}getDefaultState(t){t=t||this.props;let{preserve:e,defaultReversed:n}=t;return e===!0&&(e=""),n===void 0&&typeof e=="string"&&(this._preserveID=`HistoryPanel.reversed${e.length?`:${e}`:""}`,n=ae.get(this._preserveID)),{actions:t.actions,expandMap:{},reversed:n}}resetState(t,e){const n=this.getDefaultState(t);e?this.state=n:this.changeState(n)}componentDidMount(){g.on(`load.HistoryPanel.${this.gid}.zt`,(t,{objectType:e,objectID:n})=>{e===this.props.objectType&&String(n)===String(this.props.objectID)&&this.load()}),this.state.actions||this.load()}componentWillUnmount(){g.off(`.HistoryPanel.${this.gid}.zt`)}componentDidUpdate(){(!this.state.actions||this._currentLoadID!==[this.props.objectType,this.props.objectID].join())&&!this.state.loading&&this.load()}async load(){const{objectType:t,objectID:e,fetcher:n=An("action","ajaxGetList",`objectType=${t}&objectID=${e}`)}=this.props,s=[t,e].join();if(this.state.loading)return;await this.changeState({loading:!0});const o={actions:await Xn(n,[{objectType:t,objectID:e}])||[],loading:!1},a=[this.props.objectType,this.props.objectID].join();a!==s?delete o.actions:this._currentLoadID=a,await this.changeState(o)}reverse(t){return t===void 0&&(t=!this.state.reversed),this.changeState({reversed:t},()=>{typeof this._preserveID=="string"&&ae.set(this._preserveID,t)})}toggle(t,e){return this.changeState(n=>{const{expandMap:s}=n;return e===void 0&&(e=!s[t]),{expandMap:{...s,[t]:e}}})}isAllExpanded(){const{expandMap:t}=this.state;return this.actions.every(e=>{const{history:n,historyChanges:s}=e;return!(n&&n.length||typeof s=="string"&&s.length)||t[e.id]})}toggleAll(t){return t===void 0&&(t=!this.isAllExpanded()),this.changeState({expandMap:t?this.actions.reduce((e,n)=>({...e,[n.id]:t}),{}):{}})}_getClassName(t){return[super._getClassName(t),"history-panel",t.panel?"panel":""]}_getChildren(t){const e=this._buildHeader(t),n=this._buildBody(t);return t.panel?[e?P("div",{key:"heading",className:"panel-heading"},e):null,P("div",{key:"body",className:"panel-body"},n)]:[e,n]}_buildAction(t,e,n,s){const{history:r,historyChanges:o}=t,a=r&&r.length||typeof o=="string"&&o.length,l=typeof t.comment=="string"&&t.comment.length,h=`${e+1}`,f={component:"li",key:String(t.id),"data-id":t.id,"data-action":t.action,className:["history-panel-action list-item item",a?n?"is-expanded":"is-collapsed":""],innerClass:"item-inner list-item-inner",avatar:{className:"text-gray ring canvas",background:"",size:16,circle:!0,...t.action==="finished"?{icon:{icon:"check",className:"text-success"}}:{children:P("span",{style:h.length>1?{transform:`scale(${1-h.length*.1})`}:void 0},h)}},title:{html:t.content},text:a?P(Et,{icon:n?"minus":"plus",type:"ghost",size:"xs",className:"history-panel-action-toggle ring text-gray scale-75",onClick:this.toggle.bind(this,t.id,void 0)}):null,children:a&&n||l?P("div",{className:"history-panel-action-content pl-6 col gap-1 mb-1"},a&&n?typeof o=="string"&&o.length?P("div",{key:"history",className:"history-panel-action-history pl-1",dangerouslySetInnerHTML:{__html:o}}):P("ul",{key:"history",className:"history-panel-action-history col pl-1"},r.map(d=>P("li",{key:d.id,className:"history-panel-history-item",dangerouslySetInnerHTML:{__html:d.content}}))):null,t.comment?P("div",{key:"comment",className:"article-content history-panel-action-comment px-3 py-2 surface relative"},t.commentEditable?P(Et,{key:"btn",type:"ghost",icon:"pencil",size:"sm",className:"comment-btn hover:text-primary absolute top-1 right-1","data-toggle":"comment","data-action-ID":t.id,url:s.editCommentUrl?s.editCommentUrl.replace("{actionID}",String(t.id)):void 0}):null,P("div",{key:"comment",dangerouslySetInnerHTML:{__html:t.comment}})):null):null};return P(qe,{...f})}_buildBody(t){const{actions:e}=this,{loading:n,expandMap:s,reversed:r}=this.state;return P("ul",{key:"actions",className:q("list history-panel-body load-indicator",{loading:n},r?"col-reverse":"col",t.bodyClass)},e.map((o,a)=>this._buildAction(o,a,s[o.id],t)))}_buildHeader(t){let{header:e}=t;if(!e)return null;const{title:n="History",toolbar:s=!0,commentBtn:r=!0}=t,o=[];if(s){const{reversed:a}=this.state,l=this.isAllExpanded(),{actions:h}=this,f={key:"toolbar",className:"history-panel-toolbar",gap:1,items:[h.length>1?{icon:a?"arrow-down":"arrow-up",type:"ghost",size:"xs",className:"ring text-gray scale-75",onClick:this.reverse.bind(this,void 0)}:null,h.some(d=>{const{history:m,historyChanges:y}=d;return m&&m.length||typeof y=="string"&&y.length})?{icon:l?"minus":"plus",type:"ghost",size:"xs",className:"ring text-gray scale-75",onClick:this.toggleAll.bind(this,void 0)}:null].filter(Boolean)};typeof s=="object"&&Object.assign(f,s),f.items&&(!Array.isArray(f.items)||f.items.length)&&o.push(P(Zt,{...f}))}if(r){const a={key:"commentBtn",type:"ghost",className:"comment-btn text-gray",size:"sm",url:t.commentUrl,icon:{icon:"message",className:"icon-sm text-primary"},"data-toggle":"comment","data-object-ID":t.objectID,"data-object-type":t.objectType};typeof r=="object"?Object.assign(a,r):typeof r=="string"&&(a.text=r),o.push(P(Et,{...a}))}return e={key:"header",className:"history-panel-header",title:n,titleClass:"font-bold mr-1",content:o,contentClass:"flex items-center flex-auto gap-2",...typeof e=="object"?e:{}},P(qe,{...e})}};gf.defaultProps={header:!0,panel:!0,preserve:!0};class Ns extends mt{static update(t){g.trigger("load.HistoryPanel",t)}}Ns.NAME="HistoryPanel",Ns.Component=gf,Ns.replace=!0,Ns.register();function fc(i){const{objectType:t,objectID:e,actionID:n,url:s,...r}=i;let o=s;return!o&&(n||t&&e)&&(o=An("action",n?"editComment":"comment",n?`actionID=${n}`:`objectType=${t}&objectID=${e}`)),Vt.open({id:`modal-comment-${n?`edit-${n}`:`${t}-${e}`}`,url:o,hideOthers:!1,...r})}g(document).on("click.zt",'[data-toggle="comment"]',i=>{i.preventDefault();const t=g(i.currentTarget);if(t.is(".disabled,:disabled"))return;const e=t.data();if(t.is("a")){const n=t.attr("href");n&&(e.url=n)}e.objectId?(e.objectID=+e.objectId,delete e.objectId):e.actionId&&(e.actionID=+e.actionId,delete e.actionId),delete e.toggle,fc(e)}),Object.assign(Vt,{comment:fc});const L0="",O0="";class pc extends zt{init(){this.clipWidth=this.options.defaultWidth,this.clipHeight=this.options.defaultHeight,this.initDom(),this.initSize(),this.bindEvents()}initDom(){this.$canvas=this.$element.find(".canvas"),this.$img=this.$canvas.find("img"),this.$btn=this.$element.find("button");const t=this.$img.prop("src"),{coverColor:e,coverOpacity:n}=this.options;this.$canvas.append([`<div class="cover" style="background: ${e}; opacity: ${n};"></div>`,`<div class="controller" style="width: ${this.clipWidth}px; height: ${this.clipHeight}px">`,["top","right","bottom","left","top-left","top-right","bottom-left","bottom-right"].map(s=>`<div class="control" data-type="${s}"></div>`).join(""),"</div>",'<div class="cliper">',`<img src="${t}"/>`,"</div>"].join("")),this.$controller=this.$canvas.find(".controller"),this.$cliper=this.$canvas.find(".cliper"),this.$chipImg=this.$cliper.find("img")}resetImage(t){this.$img.prop("src",t),this.$chipImg.prop("src",t),this.imgWidth=0,this.left=-1,this.initSize()}initSize(){const{minWidth:t,minHeight:e,ready:n,onSizeError:s}=this.options;if(this.imgWidth)return;const r=a=>{this.imgWidth=a.width,this.imgHeight=a.height,(a.width<t||a.height<e)&&(s==null||s({width:a.width,height:a.height}),this.options.minWidth=Math.min(a.width,t),this.options.minHeight=Math.min(a.height,e)),n==null||n(),this.width=Math.min(this.imgWidth,this.$element.width()),this.$canvas.css("width",this.width),this.height=this.$canvas.height(),(this.left===void 0||this.left<0)&&(this.left=Math.floor((this.width-this.$controller.width())/2),this.top=Math.floor((this.height-this.$controller.height())/2)),this.refreshSize()},o=this.$img[0];o.complete?r(o):o.onload=()=>{r(o)}}refreshSize(t){const{minWidth:e,minHeight:n,fixedRatio:s,defaultWidth:r,defaultHeight:o}=this.options;this.clipWidth=Math.max(e,Math.min(this.width,this.clipWidth)),this.clipHeight=Math.max(n,Math.min(this.height,this.clipHeight)),s&&(t&&t==="height"?(this.clipWidth=Math.max(e,Math.min(this.width,this.clipHeight*r/o)),this.clipHeight=this.clipWidth*o/r):(this.clipHeight=Math.max(n,Math.min(this.height,this.clipWidth*o/r)),this.clipWidth=this.clipHeight*r/o)),this.left=Math.min(this.width-this.clipWidth,Math.max(0,this.left)),this.top=Math.min(this.height-this.clipHeight,Math.max(0,this.top)),this.right=this.left+this.clipWidth,this.bottom=this.top+this.clipHeight,this.$controller.css({left:this.left,top:this.top,width:this.clipWidth,height:this.clipHeight}),this.$cliper.css("clip",`rect(${this.top}px, ${this.left+this.clipWidth}px, ${this.top+this.clipHeight}px, ${this.left}px)`)}getData(){return{originWidth:this.imgWidth,originHeight:this.imgHeight,scaleWidth:this.width,scaleHeight:this.height,width:this.right-this.left,height:this.bottom-this.top,left:this.left,top:this.top,right:this.right,bottom:this.bottom,scaled:this.imgWidth!==this.width||this.imgHeight!==this.height}}bindEvents(){this.$element.on("resize",this.initSize.bind(this)),this.$btn.on("click",t=>{var e,n;(n=(e=this.options).handleBtnClick)==null||n.call(e,t,this.getData())}),this.moveable=new bs(this.$controller,{selector:".control,.controller",move:!1,onMoveStart:()=>{this.startLeft=this.left,this.startTop=this.top,this.startClipWidth=this.clipWidth,this.startClipHeight=this.clipHeight},onMove:(t,e)=>{const n=g(e.target);if(n.is(".controller"))this.left=this.startLeft+e.deltaX,this.top=this.startTop+e.deltaY,this.refreshSize();else{const s=n.data("type");let r=!1;const{minWidth:o,minHeight:a}=this.options;switch(s){case"left":case"top-left":case"bottom-left":this.left=Math.min(this.right-o,Math.max(0,this.startLeft+e.deltaX)),this.clipWidth=this.right-this.left;break;case"right":case"top-right":case"bottom-right":this.clipWidth=Math.min(this.width-this.left,Math.max(o,this.startClipWidth+e.deltaX));break}switch(s){case"top":case"top-left":case"top-right":this.top=Math.min(this.bottom-a,Math.max(0,this.startTop+e.deltaY)),this.clipHeight=this.bottom-this.top,r=!0;break;case"bottom":case"bottom-left":case"bottom-right":this.clipHeight=Math.min(this.height-this.top,Math.max(a,this.startClipHeight+e.deltaY)),r=!0;break}this.refreshSize(r)}}})}destroy(){var t;(t=this.moveable)==null||t.destroy(),super.destroy()}}pc.NAME="ImgCutter",pc.DEFAULT={coverColor:"#000",coverOpacity:.6,defaultWidth:128,defaultHeight:128,minWidth:48,minHeight:48,fixedRatio:!0};const hi=class{static get images(){var t;return(t=this.Module)==null?void 0:t.images}static async loadModule(){return this.Module||(this.Module=await g.getLib("mammoth")),this.Module}};hi.convertToHtml=async function(i,t){const{convertToHtml:e}=await hi.loadModule();return e(i,t)},hi.extractRawText=async function(i){const{extractRawText:t}=await hi.loadModule();return t(i)},hi.embedStyleMap=async function(i,t){const{embedStyleMap:e}=await hi.loadModule();return e(i,t)};let R_=hi;g.registerLib("mammoth",{src:["mammoth/mammoth.browser.min.js"],check:"mammoth",type:"module"});const z0="";Object.assign(xn.TypeOptions,{success:{key:"zt-messager-success",icon:"check-circle",type:"success",close:!1},danger:{icon:"exclamation-sign",type:"danger",close:!1}}),Object.assign(xn,{success(i){return xn.show(i,"success")},fail(i){return xn.show(i,"danger")}}),Object.assign(xn.DEFAULT,{time:3e3,className:"messager-lite"});const F0="";function L_(i){return Vt.confirm({iconClass:"warning rounded-full center w-8 h-8 flex-none",type:"custom",custom:{className:"modal-reconfirm",closeBtn:!1},...i})}async function O_(i){const{sortable:t={},onSort:e,items:n,itemProps:s={icon:"move muted",innerClass:"border rounded px-2 canvas cursor-move hover:shadow"},list:r,header:o,message:a,footer:l,...h}=i;let f;const d=(y,b)=>{f=b,e==null||e(y,b)};if(await Vt.confirm({type:"custom",content:P("div",{className:"modal-body sort-view col gap-2"},P(gt,{className:"sort-view-header",content:o}),P(gt,{className:"sort-view-message muted",content:a}),P(Vr,{className:"space-y-2",sortable:t,items:n,itemProps:s,onSort:d,...r}),P(gt,{className:"sort-view-footer",content:l})),...h}))return f}Nt.addLang({zh_cn:{occurredError:"发生了错误"},zh_tw:{occurredError:"發生了錯誤"},en:{occurredError:"An error occurred"}});async function z_(i){const{title:t,mono:e,html:n=!0,copyBtn:s=!0,basePath:r,contentClass:o,error:a,...l}=i;let h=typeof a=="string"?a:(a==null?void 0:a.message)??"",f=e,d=t;n&&(r&&(h=h.split(r).join('<i class="icon icon-file-text opacity-50"></i>/')),h.startsWith(`<br />
`)&&(h=h.replace(`<br />
`,"")),h.startsWith("<!DOCTYPE html")&&(f===void 0&&(f=!1),d===void 0&&(d=g(h).filter("title").text())));const m=kt();return await Vt.confirm({title:d??Nt.getLang("occurredError"),message:"",type:"custom",custom:{className:"backdrop-blur border-2 border-canvas bg-opacity-80 rounded-xl",headerClass:"text-danger"},content:P("div",{ref:m,className:q("modal-body",f!==!1?" font-mono":"",o),style:{whiteSpace:f!==!1?"pre-line":"normal"},dangerouslySetInnerHTML:{__html:h}}),actions:[s?{key:"confirm",text:typeof s=="string"?s:Nt.getLang("copy"),icon:"copy",onClick:()=>{const b=m.current;if(navigator.clipboard)navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([b.innerText],{type:"text/plain"}),"text/html":new Blob([b.innerHTML],{type:"text/html"})})]);else{const S=document.createRange();S.selectNode(b),window.getSelection().removeAllRanges(),window.getSelection().addRange(S),document.execCommand("copy"),window.getSelection().removeAllRanges()}}}:null,{key:"cancel",text:Nt.getLang("close")}].filter(Boolean),...l})}Object.assign(Vt,{reconfirm:L_,sortView:O_,showError:z_}),Vt.DEFAULT.backdrop="static",Vt.DEFAULT.request={dataFilter:i=>{if(i[0]==="{")try{const t=JSON.parse(i);if(t.result)return dc(t,{closeModal:!0}),""}catch{}return i}},Kl.defaultProps.iframeBodyClass="body-modal";function yf({pri:i="",text:t,className:e}){return i=`${i}`.trim(),t===void 0&&(t=i==="0"||i===""?"":i),P("span",{className:q(`pri-${i}`,e)},t)}let Es=class extends ee{constructor(){super(...arguments),this._handleClearBtnClick=t=>{this.setValue(""),t.preventDefault()}}getDefaultState(t){const e=super.getDefaultState(t);if(e.value===void 0&&(t||this.props).required){const n=this._getItems().shift();n&&(e.value=n.value)}return e}_getTriggerProps(t,e){const n=super._getTriggerProps(t,e);return t.disabled&&(n.className=q(n.className,"disabled")),n}_renderTrigger(t,e){var l;const{value:n}=e,{placeholder:s,required:r}=t,o=n===void 0||n==="",a=!o&&!r;return[P("div",{className:"text"},o?P("span",{class:"placeholder"},s):this._renderItem(e.value,(l=this._getItems().find(({value:h})=>h===n))==null?void 0:l.text,"pri")),a?P(Et,{type:"button",class:"btn square btn-close size-xs ghost rounded-full",onClick:this._handleClearBtnClick},P("span",{class:"close"})):null,a?null:P("span",{key:"caret",class:"caret"})]}_getItems(){let{items:t=["",1,2,3,4]}=this.props;return Array.isArray(t)?t=t.map((e,n)=>typeof e=="object"?e:e?{text:`${e}`,value:`${n}`}:{text:"",value:""}):typeof t=="object"&&(t=Object.keys(t).map(e=>({value:e,text:t[e]}))),t=t.filter(({value:e})=>e!==""),t.sort((e,n)=>+e.value-+n.value),t}_renderItem(t,e,n){return P(yf,{key:n,pri:t,text:e})}_renderPop(){const{value:t}=this.state;return P("div",{className:"pick-pri-list"},this._getItems().map(({value:e,text:n})=>P("button",{key:e,type:"button",class:`btn w-full ${t===e?"primary-pale":"ghost"}`,"data-pick-value":e},this._renderItem(e,n))))}};Es.defaultProps={...ee.defaultProps,items:["",1,2,3,4],className:"pick-pri form-control",popClass:"pick-pri-pop popup",popWidth:"auto",popMinWidth:56};function _f({severity:i="",text:t,className:e}){i=`${i}`.trim(),t===void 0&&(t=i==="0"||i===""?"":i);const n=`${+t}`!=`${i}`;return P("span",{className:q(`severity${n?" severity-label":""}`,e),"data-severity":i},n?t:"")}let mc=class extends Es{_renderItem(t,e,n){return P(_f,{key:n,severity:t,text:e})}};mc.defaultProps={...Es.defaultProps,items:["",1,2,3,4]};class gc extends mt{}gc.NAME="PriPicker",gc.Component=Es;class yc extends mt{}yc.NAME="SeverityPicker",yc.Component=mc;const j0="",B0="";let vf=class extends Ft{constructor(t){super(t),this._syncPickerData=()=>{const n=this.getFormData();g(this.element).find(".pick-value[name]").each((s,r)=>{const o=g(r),a=o.attr("name"),l=n[a];o.val(l).trigger("syncValue")})},this._handleDeleteQueryClick=(n,s)=>{s.stopPropagation(),this.deleteQuery(n)},this._handleChange=n=>{const s=g(n.target),r=s.attr("name");r&&this.changeData(r,s.val())},this._handleSubmit=n=>{n.preventDefault(),this.submit()};const{setting:e}=t;this.state={showQueryPanel:!1,setting:e&&e.conditions?e:void 0},this.submit=this.submit.bind(this),this.reset=this.reset.bind(this)}get showMore(){var t;return this.state.more??((t=this.state.setting)==null?void 0:t.more)}get isShow(){return this.state.show??this.props.show}get loaded(){return!!this.state.setting}get groupItemCount(){var t;return((t=this.state.setting)==null?void 0:t.groupItemCount)||3}componentDidMount(){this.props.show&&this.show(),g.on("update.SearchForm.zt",(t,e)=>{e&&e.module===this.props.module&&this.load(e.reset??!0)}),g.on("addQuery.SearchForm.zt",(t,e)=>{e&&e.module===this.props.module&&this.addQuery(e.id,e.text)})}componentDidUpdate(t,e){const{container:n}=this.props;if(n){const s=g(n),r=this.state.show!==e.show;r&&s.toggleClass("show-search-form",this.state.show),(r||this.state.more!==e.more)&&s.trigger("layout.SearchForm.zt",this)}}componentWillUnmount(){g.off(".SearchForm.zt")}async load(t){if(this.state.loading)return;await this.changeState({loading:!0,...t?{data:void 0}:null});const e=this.props.url||An("search","buildForm",`module=${this.props.module}`);try{const n=await Xn(e);await this.changeState({setting:n,loading:!1,clickedReset:!1})}catch{await this.changeState({loading:!1,clickedReset:!1})}t&&this._syncPickerData()}async show(){await this.changeState({show:!0}),this.loaded||await this.load()}toggleQueryPanel(t){return t===void 0&&(t=!this.state.showQueryPanel),this.changeState({showQueryPanel:t})}toggle(t){return t===void 0&&(t=!this.isShow),t?this.show():this.hide()}toggleMore(t){return t===void 0&&(t=!this.showMore),this.changeState({more:t})}hide(){return this.changeState({show:!1})}getFormData(t){var s;t=t||this.state.setting;const e={groupAndOr:"or"},n=this.groupItemCount*2;for(let r=1;r<=n;r++)e[`field${r}`]=((s=this._conditionList[r-1])==null?void 0:s.value)??"",e[`operator${r}`]="=",e[`value${r}`]="",e[`andOr${r}`]="and";return{...e,...t.defaultData,...this.state.data}}getSubmitData(){const t=this._data;return{module:this.props.module,actionURL:this.state.setting.actionURL,groupItems:this.groupItemCount,formType:this.showMore?"more":"lite",...t}}submit(){var n;let t=this.getSubmitData();if(!t)return;const e=(n=this.props.beforeSearch)==null?void 0:n.call(this,t);e!==!1&&(e&&(t=e),ci({url:this.props.searchUrl||An("search","buildQuery"),data:t,onSuccess:s=>{var r;return((r=this.props.onSearch)==null?void 0:r.call(this,s))===!1||this._handleSearch(g.extend({success:()=>this.load()},typeof s.load=="string"?{url:s.load}:s.load)),!1}}))}reset(){return this.changeState(t=>{const e=new Array(this.groupItemCount*2).fill(0).reduce((n,s,r)=>(n[`value${r+1}`]="",n),{});return{clickedReset:!0,data:{...t.data,...e}}},this._syncPickerData)}applyQuery(t){var s;const{actionURL:e}=this.state.setting,n=e.replace("myQueryID",String(t));((s=this.props.onSearch)==null?void 0:s.call(this,{result:"success",load:n}))!==!1&&this._handleSearch({url:n,success:()=>this.load(!0)})}deleteQuery(t,e){const{deleteQueryConfirm:n,canDeleteQuery:s}=this.state.setting;if(!e&&n){Vt.confirm(n).then(o=>{o&&this.deleteQuery(t,!0)});return}const r=typeof s=="string"?s.replace("{id}",`${t}`):An("search","deleteQuery",`queryID=${t}`);ci({url:r,onSuccess:()=>{const o=this.state.setting,{savedQueryList:a=[]}=o;return this.changeState({setting:{...o,savedQueryList:a.filter(l=>l.id!==t)}}),!1}})}addQuery(t,e){const n=this.state.setting,{savedQueryList:s=[]}=n;s.some(r=>r.id===t)||this.changeState({showQueryPanel:!0,setting:{...n,savedQueryList:[{id:t,text:e},...s]}})}changeData(t,e){const n={[t]:e};if(t.startsWith("field")){const s=e,r=+t.substring(5),{defaultOperator:o,defaultValue:a=""}=this._conditionMap[s];o&&(n[`operator${r}`]=o),n[`value${r}`]=a}else if(t.startsWith("value")){const s=this.getFormData(),r=+t.substring(5),o=s[`field${r}`],{control:a}=this._conditionMap[o];if(a==="date"){const l=e.startsWith("$"),h=s[`operator${r}`];l&&h!=="between"?n[`operator${r}`]="between":!l&&h==="between"&&(n[`operator${r}`]="<=")}}this.changeState(s=>({data:{...s.data,...n}}),this._syncPickerData)}_handleSearch(t){const e=this.element.closest(".modal");let{searchLoader:n=e?{load:"modal",target:e}:"table"}=this.props;const s=g(this.element);let r=s.closest(".tab-pane");typeof n=="string"?(n={load:n},r.length||(r=s.closest("#main"))):e&&(r.length||(r=g(e)));const o=r.find("[data-zui-dtable]");return o.length&&(n.load="table",n.target=o.children(".dtable").attr("id")),typeof t=="string"?n.url=t:typeof t=="object"&&(n={...n,...t}),g.trigger("locate.zt",n),!1}_renderOperators(t,e){var s;const n=this._operatorList;return P(Pn,{name:t,items:n,required:!0,defaultValue:e??((s=n[0])==null?void 0:s.value),search:!1})}_renderControl(t,e,n,s){const r=this._conditionMap[t]||{},{control:o="text"}=r,{controlRenders:a}=this.constructor,l=a[o]||a.text;return o==="date"&&r.datePeriods===void 0&&s.datePeriods&&(r.datePeriods=s.datePeriods),l.call(this,r,e,n??"")}_renderField(t,e,n,s,r){var f;const{conditions:o}=s,a=e*n+t+1,l=!t;this._conditionList||(this._conditionList=o.map(({text:d,name:m})=>({text:d??m,value:m})));const h=r[`field${a}`]??((f=o[a])==null?void 0:f.name);return P("tr",{key:a,className:"search-form-field"},P("td",{className:q("is-andOr",l?"font-bold text-right nowrap":void 0)},l?(s.groupTitles||[])[e]:this._renderAndOrSelect(`andOr${a}`,r[`andOr${a}`],s)),P("td",{className:"is-condition"},P(Pn,{name:`field${a}`,items:this._conditionList,required:!0,defaultValue:h,popMinWidth:"100%",popWidth:"auto"})),P("td",{className:"is-operator"},this._renderOperators(`operator${a}`,r[`operator${a}`])),P("td",{className:"is-control",key:`${h}:${a}`},this._renderControl(h,`value${a}`,r[`value${a}`],s)))}_renderGroup(t,e,n){const{groupItemCount:s}=this,{showMore:r}=this,o=[],a=r?s:1;for(let l=0;l<a;l++)o.push(this._renderField(l,t,s,e,n));return P("div",{className:"search-form-group flex-1",key:t},P("table",{className:"table-fixed w-full"},P("tbody",null,o)))}_renderAndOrSelect(t,e,n){const{andText:s="And",orText:r="Or"}=n;return P(Pn,{name:t,items:[{value:"and",text:s},{value:"or",text:r}],defaultValue:e,required:!0,search:!1})}_renderForm(t,e){this._conditionMap={},this._conditionList=t.conditions.map(d=>{const{name:m,text:y}=d;return this._conditionMap[m]=d,{text:y??m,value:m}});const{showMore:n}=this;this._operatorList=(t.operators||"=,!=,>,>=,<,<=".split(",")).map(d=>typeof d=="string"?{text:d,value:d}:d);const s=this.getFormData(t);this._data=s;const{searchBtnText:r="Search",resetBtnText:o="Reset",saveQueryBtnText:a="Save",canSaveQuery:l}=t,{simple:h,noMore:f}=e;return P("form",{key:"form",className:"search-form-wrapper flex-auto py-3 px-2",onSubmit:this._handleSubmit},P("div",{className:"row items-center",onChange:this._handleChange},this._renderGroup(0,t,s),P("div",{className:"col flex-none items-center justify-center px-4 w-24"},this._renderAndOrSelect("groupAndOr",s.groupAndOr,t)),this._renderGroup(1,t,s)),P("div",{className:`toolbar gap-4 justify-center flex-nowrap ${h?"ml-4":"mt-3"}`},P(Et,{key:"submit",type:"primary",btnType:"submit"},r),h?null:P(Et,{key:"reset",onClick:this.reset},o),h&&f?null:P("div",{className:h?"":"absolute top-0 right-0"},h?null:P(Et,{key:"saveQuery",type:"ghost",className:"text-primary","data-toggle":"modal",disabled:!l||this.state.clickedReset,url:l?typeof l=="string"?l:An("search","saveQuery",`module=${e.module}`):void 0,"data-title":a},a),f?null:P(Et,{key:"toggle",type:"ghost",className:"text-primary",icon:n?"chevron-double-up":"chevron-double-down",onClick:this.toggleMore.bind(this,void 0)}))))}_renderQueryPanel(t,e){const{savedQueryList:n=[],saveQueryPanelWidth:s=200,saveQueryPanelTitle:r="Saved queries",canDeleteQuery:o}=e;return P("div",{key:"panel",className:q("search-form-query sidebar sidebar-right pt-3 transition-none",t?"is-expanded":"is-collapsed"),style:{minHeight:100,width:t?Bt(s):0,transition:"none"}},P("div",{class:"sidebar-gutter gutter gutter-border gutter-horz border-default",onClick:this.toggleQueryPanel.bind(this,void 0)},P("button",{class:"gutter-toggle",type:"button"},P("span",{class:"chevron-right"}))),t?P("div",{className:"search-form-query-panel pl-3 h-full col"},P("div",{className:"search-form-query-title font-bold mb-1.5 flex-none"},r),P("ul",{className:"search-form-query-list col items-start gap-1 overflow-auto scrollbar-hover pr-3 pb-2 pt-px pl-0"},n.map(({id:a,text:l,noDelete:h})=>P("li",{key:a,className:`search-form-query-item label gray-pale rounded-full state pl-2 hover:text-primary hover:primary-pale inline-flex gap-1 max-w-full ${o&&!h?"pr-0":"pr-2"}`,onClick:this.applyQuery.bind(this,a)},P("span",{className:"min-w-0 flex-auto overflow-hidden nowrap"},l),o&&!h?P(Et,{type:"ghost",className:"size-xs rounded-full flex-none"},P("i",{className:"close",onClick:this._handleDeleteQueryClick.bind(this,a)})):null)))):null)}_getProps(t){return{...super._getProps(t),"data-module":t.module}}_getClassName(t){const e=super._getClassName(t);if(!this.isShow)return[e,"search-form","hidden"];const{setting:n,showQueryPanel:s}=this.state,{showMore:r}=this,o=n==null?void 0:n.savedQueryList;return[e,"search-form",n?"is-loaded":"is-empty",{"is-lite":!r,"is-more":r,"is-simple":t.simple,"show-save-query":o&&s}]}_getChildren(t){if(!this.isShow)return null;const{setting:e,showQueryPanel:n,loading:s}=this.state,r=!t.simple&&e&&e.savedQueryList;return P("div",{className:q(`search-form-container row gap-3 load-indicator${s?" loading":""}`,t.innerClass),style:`max-height: ${76+44*(this.showMore?this.groupItemCount:1)}px`},e?this._renderForm(e,t):null,r?this._renderQueryPanel(n,e):null)}};vf.controlRenders={text:(i,t,e)=>P("input",{className:"form-control",type:"text",name:t,value:e,placeholder:i.placeholder,...i.controlProps}),select:(i,t,e)=>{const{items:n=[]}=i;return P(Pn,{name:t,items:n,defaultValue:e,placeholder:i.placeholder,popMinWidth:"100%",popWidth:"auto",...i.controlProps})},date:(i,t,e)=>{const{datePeriods:n}=i,s={};return n&&(s.menu=[...n],s.allowInvalid=!0,s.display=r=>{const o=n.find(a=>a.value===r);return o?o.text:r}),P(zi,{name:t,defaultValue:e,placeholder:i.placeholder,...s,...i.controlProps})},time:(i,t,e)=>P(so,{name:t,defaultValue:e,placeholder:i.placeholder,...i.controlProps}),datetime:(i,t,e)=>P(Hl,{name:t,defaultValue:e,placeholder:i.placeholder,...i.controlProps})};class Re extends mt{}Re.NAME="SearchForm",Re.Component=vf,Re.replace=!0,Re.toggleForm=_c,Re.update=bf,Re.addQuery=wf,Re.toggle={convertHref:!0,getOptions(i,t){const e=g(i);if(e.is("a")){const n=e.attr("href");n&&(!t.target&&"#.".includes(n[0])?t.target=n:t.url||(t.url=n))}return t},handler(i,t){_c({container:g(i).closest(t.container||".modal,#main"),...t})}},Re.register();function _c(i){typeof i=="string"?i={module:i}:i||(i={module:window.config.currentModule});const t=g(i.container||".modal,#main").first();if(!t.length)return;i.module||(i.module=window.config.currentModule);let e;if(i.target?e=g(i.target,t):(e=t.find(`[${Re.DATA_KEY}],.search-form`),i.module&&(e=e.filter(`[data-module="${i.module}"]`))),!e.length){let s=t.closest(".modal").find(".modal-body");s.length||(s=t.find(".main-content-cell")),s.length||(s=t.find("#mainContent")),e=g("<div/>").attr({"zui-key":"searchForm","data-module":i.module}).prependTo(s.length?s.first():t)}let n=e.zui(Re.NAME);return n?n.$.toggle(i.show):n=new Re(e,{container:t,show:!0,...i}),n}function bf(i,t){g.trigger("update.SearchForm.zt",{module:i,reset:t})}function wf(i){g.trigger("addQuery.SearchForm.zt",i)}const H0="";let Cf=class extends Tt{render(t){const{avatar:e,account:n,realname:s,user:r,...o}=t,a={code:r?r.account:n,text:r?r.realname??r.account:s??n,src:r?r.avatar:e,...o};return P(Ei,{...a})}};Cf.defaultProps={size:24,circle:!0};class xo extends mt{}xo.NAME="UserAvatar",xo.Component=Cf,xo.register();const F_={1:"error",2:"warning",4:"parse",8:"notice",16:"core-error",32:"core-warning",64:"compile-error",128:"compile-warning",256:"user-error",512:"user-warning",1024:"user-notice",2048:"strict",4096:"recoverable-error",8192:"deprecated",16384:"user-deprecated",32767:"all"};function kf(i){return typeof i=="number"&&(i=F_[i]),i}function Sf(i){return i=kf(i),i.includes("error")?"error":i.includes("warning")?"warning":"info"}function j_({errors:i,...t}){const e=i.reduce((n,s)=>(n[Sf(s.level)]++,n),{error:0,warning:0,info:0});return P("div",{class:"row items-stretch text-sm","data-hint":"PHP errors",...t},e.error?P("button",{type:"button",class:"state font-bold px-0.5 danger"},P("span",{class:"scale-95 font-bold inline-block text-opacity-70 text-canvas"},"ERR"),e.error):null,e.warning?P("button",{type:"button",class:"state font-bold px-0.5 danger bg-opacity-90"},P("span",{class:"scale-95 font-bold inline-block text-opacity-70 text-canvas"},"WAR"),e.warning):null,e.info?P("button",{type:"button",class:"state font-bold px-0.5 danger bg-opacity-80"},P("span",{class:"scale-95 font-bold inline-block text-opacity-70 text-canvas"},"INF"),e.info):null)}function Le(i,t,e,n){console.groupCollapsed(`%c${i} %c${t}`,"color: #fff; background-color: #9333ea; padding: 0 0.1em 0 0.25em; border-radius: 0.25em 0 0 0.25em;","color: #9333ea; background-color: #e9d5ff; padding: 0 0.5em; border-radius: 0 0.25em 0.25em 0;",n),console.table(e),console.groupEnd()}function In(i,t=400,e=100){return i<e?"success":i<t?"warning":"danger"}function He(i){return i<1e3?`${i.toFixed(0)}ms`:`${(i/1e3).toFixed(2)}s`}function xf({perf:i}){var o;const t=i.id==="page"?"页面":i.id==="#dtable"?"表格":"部分",e=[],{trace:n,xhprof:s}=i,r=n==null?void 0:n.request;if(i.requestEnd){i.clientCache&&e.push(P("div",{class:"px-0.5 state text-success","data-hint":`使用本地缓存渲染：${i.clientCache}`},P("i",{class:"icon-check-circle"})," 本地缓存"),P("div",{class:"muted"},"/"));const a=i.requestEnd-i.requestBegin;if(e.push(P("div",{class:`px-0.5 state text-${In(a,500,300)}`,"data-hint":"总加载时间 (好<300ms≤正常<500ms≤差)",onClick:Le.bind(null,"Trace","Perf",i,i.id)},P("i",{class:"icon-history"})," ",He(a))),r){const h=r.timeUsed;e.push(P("div",{class:"muted"},"/"),P("div",{class:`px-0.5 state text-${In(h)}`,"data-hint":"服务器耗时 (好<300≤正常<500≤差)",onClick:Le.bind(null,"Trace","Request",r,i.id)},P("span",{class:"scale-95 font-bold inline-block"},"S"),He(h)))}if(i.dataSize){if(r){const h=a-r.timeUsed;e.push(P("div",{class:"muted"},"/"),P("div",{class:`px-0.5 state text-${In(h,600,200)}`,"data-hint":"网络用时 (好<200≤正常<600≤差)",onClick:Le.bind(null,"Trace","Request",r,i.id)},P("span",{class:"scale-95 font-bold inline-block"},"N"),He(h)))}if(e.push(P("div",{class:"px-0.5 state","data-hint":"下载大小",onClick:Le.bind(null,"Trace","Perf",i,i.id)},P("span",{class:"muted"},P("i",{class:"icon icon-cube"})," ",fe(i.dataSize,1)))),r){const h=a-r.timeUsed,f=1e3*i.dataSize/h;e.push(P("div",{class:"muted"},"/"),P("div",{class:`px-0.5 state text-${f<102400?"danger":f<1024e3?"warning":"success"}`,"data-hint":"下载速度(B<100KB≤正常<1MB≤G)",onClick:Le.bind(null,"Trace","Request",r,i.id)},P("i",{class:"icon icon-arrow-down"}),fe(f,1),"/s"))}}if(i.renderEnd&&i.renderBegin){const h=i.renderEnd-i.renderBegin,f=In(h,200,50);e.push(P("div",{class:"muted"},"/"),P("div",{class:`px-0.5 state text-${f}`,"data-hint":"浏览器渲染用时 (好<50≤正常<200≤差)",onClick:Le.bind(null,"Trace","Perf",i,i.id)},P("i",{class:`icon-${f==="danger"?"frown":f==="warning"?"meh":"smile"}`}),He(h)))}if(r){const{memory:h,querys:f}=r;typeof h=="number"&&e.push(P("div",{class:"muted"},"/"),P("div",{class:`px-0.5 state text-${In(h,1024e3,102400)}`,"data-hint":"服务器内存占用 (好<10KB≤正常<100KB≤差)",onClick:Le.bind(null,"Trace","Request",r,i.id)},P("span",{class:"scale-95 font-bold inline-block"},"M"),fe(h))),typeof f=="number"&&e.push(P("div",{class:"muted"},"/"),P("div",{class:`px-0.5 state text-${In(f,30,10)}`,"data-hint":"SQL执行次数 (好<30≤正常<10≤差)",onClick:Le.bind(null,"SQL Query",`${((o=n.sqlQuery)==null?void 0:o.length)??0} queries`,n.sqlQuery,i.id)},P("span",{class:"scale-95 font-bold inline-block"},"Q"),f))}n!=null&&n.files&&e.push(P("div",{class:"muted"},"/"),P("div",{class:"px-0.5 state","data-hint":"服务器加载PHP文件数目",onClick:Le.bind(null,"Trace",`${n.files.length} php files`,n.files,i.id)},P("span",{class:"muted"},P("i",{class:"icon-file icon-sm scale-75"}),n.files.length)));const l=n==null?void 0:n.profiles;if(l!=null&&l.length){let h=0,f={Duration:0};if(l.forEach(d=>{d.Duration>.3&&h++,d.Duration>f.Duration&&(f=d)}),e.push(P("div",{class:`px-0.5 state text-${In(h,3,1)}`,"data-hint":"服务器最慢SQL数 (好<3≤正常<1≤差)",onClick:Le.bind(null,"SQL Query",`${l.length} SQL profiles`,l,i.id)},P("span",{class:"scale-95 font-bold inline-block"},"LQ"),h)),f.Duration){const d=f.Duration*1e3;e.push(P("div",{class:`px-0.5 state text-${In(d,600,300)}`,"data-hint":"服务器最慢SQL耗时 (好<600≤正常<300≤差)",onClick:Le.bind(null,"SQL Query",`Slowest SQL query: ${d}ms`,f,i.id)},P("span",{class:"scale-95 font-bold inline-block"},"MLQ"),He(d)))}}}else e.push(P("div",{class:"muted px-0.5"},"loading..."));return P("div",{class:"zin-perf-btn-list row items-center bg-black text-sm"},P("div",{class:"px-1 bg-canvas bg-opacity-20 self-stretch flex items-center","data-hint":`请求 ${i.id} URL: ${i.url}`},P("span",{class:"muted"},t)),e,s?P("a",{class:"state text-secondary px-0.5",href:s,target:"_blank","data-hint":"打开 xhprof 报告"},"XHP"):null)}function B_(i){Le("Trace","Error",i,i.message),navigator.clipboard.writeText(`vim +${i.line} ${i.file}`)}function H_({errors:i=[],show:t,basePath:e}){i.length||(t=!1);const n=i.map(s=>{const r=kf(s.level),o=Sf(r),a=o==="error"?"danger":o==="info"?"important":"warning";return P("div",{class:`zin-error-item state ${a}-pale text-fore px-2 py-1 ring ring-darker`,onClick:B_.bind(null,s)},P("div",{class:"zin-error-msg font-bold text-base"},P("strong",{class:`text-${a}`,style:"text-transform: uppercase;"},r)," ",s.message),P("div",{class:"zin-error-info text-sm opacity-60 break-all"},P("strong",null,"vim +",s.line)," ",P("span",{className:"underline"},e?s.file.substring(e.length):s.file)))});return P("div",{class:`zin-errors-panel canvas absolute bottom-full left-0 mono shadow-xl ring rounded fade-from-bottom ${t?"in":"events-none"}`},n)}const W0="";let W_=class extends Tt{constructor(t){var e,n;super(t),this.state={showPanel:t.defaultShow??!0,showZinbar:!!((n=(e=t.defaultData)==null?void 0:e.errors)!=null&&n.length||!ae.get("Zinbar:hidden")),...t.defaultData},this.togglePanel=this.togglePanel.bind(this),this.handleClickOutside=this.handleClickOutside.bind(this)}componentDidMount(){document.addEventListener("click",this.handleClickOutside)}componentDidUpdate(){var o,a,l,h;const{pagePerf:t}=this.state;let e="",n="";const s=(a=(o=t==null?void 0:t.trace)==null?void 0:o.sqlQuery)==null?void 0:a.length,r=(h=(l=t==null?void 0:t.trace)==null?void 0:l.request)==null?void 0:h.timeUsed;if(r&&t.renderEnd){const f=t.renderEnd-t.renderBegin,d=r+f,m=[];let y="",b="";d>=500?(y="danger",m.push(`处理时间${He(d)}超过500ms（后端${He(r)}，前端${He(f)}）`)):d>=300&&(y="warning",m.push(`处理时间${He(d)}超过300ms（后端${He(r)}，前端${He(f)}）`)),s&&(s>=60?(b="danger",m.push(`SQL查询超过60次（实际${s}）`)):s>=40&&(b="warning",m.push(`SQL查询超过40次（实际${s}）`))),(y||b)&&(e=y==="danger"||b==="danger"?"danger":"warning",n=[e==="danger"?"页面有性能问题":"页面有优化空间",...m].join("，"))}g("body").z({perf:e,perfMessage:n})}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutside)}handleClickOutside(t){const e=t.target;this.state.showPanel&&!e.closest(".zinbar")&&this.setState({showPanel:!1})}update(t,e,n){this.setState(s=>{const r=!(t!=null&&t.id)||t.id==="page",o={};return r?(t&&(o.pagePerf={...s.pagePerf,...t}),e&&(o.errors=e)):(t&&(o.partPerf={...s.partPerf,...t}),e&&(o.errors=[...s.errors??[],...e??[]])),n&&(o.basePath=n),o})}togglePanel(){this.setState({showPanel:!this.state.showPanel})}toggleZinbar(){const t=!this.state.showZinbar;this.setState({showZinbar:t},()=>{ae.set("Zinbar:hidden",!t)})}render(){const{errors:t,pagePerf:e,partPerf:n,showZinbar:s,basePath:r}=this.state,{fixed:o}=this.props,a=t==null?void 0:t.length;return P("div",{className:q("zinbar row h-5 items-stretch gap-px inverse bg-opacity-50",o?"relative":"fixed right-0 bottom-0",{collapse:!s}),style:{zIndex:9999}},P("button",{type:"button","data-hint":s?"折叠":"展开",className:`w-4 ${a&&!s?"danger":"bg-inverse"} flex items-center justify-center`,style:{marginLeft:-15},onClick:this.toggleZinbar.bind(this)},P("span",{class:s?"caret-right":"caret-left"})),a?P(j_,{errors:t,onClick:this.togglePanel}):null,e?P(xf,{perf:e}):null,n?P(xf,{perf:n}):null,P(H_,{show:this.state.showPanel,basePath:r,errors:t}))}};class vc extends mt{}vc.NAME="Zinbar",vc.Component=W_;let $f=class extends Ft{_renderContent(t){const{subtitle:e,subtitleClass:n,content:s,contentClass:r}=t;if(!(!e&&!s))return[w("div",{className:q("card-content",r),children:[e?w("div",{className:q("card-subtitle",n),children:w(gt,{content:e})},"subtitle"):null,s?w(gt,{content:s},"extraContent"):null]},"content")]}_renderHeading(t){const{icon:e,prefix:n,prefixClass:s,title:r,titleClass:o,titleUrl:a,titleAttrs:l,suffix:h,suffixClass:f,heading:d,headingClass:m}=t;if(!e&&!n&&!r&&!h&&!d)return;const y=a?"a":"span";return w("div",{className:q("card-heading",m),children:[e?w(Ht,{className:"card-icon",icon:e},"icon"):null,n?w(gt,{className:q("card-prefix",s),content:n},"prefix"):null,r?w(y,{className:q("card-title",o),href:a,...l,children:w(gt,{content:r})},"title"):null,h?w(gt,{className:q("card-suffix",f),content:h},"suffix"):null,d?w(gt,{content:d},"extraHeading"):null]})}_renderHeader(t){const{header:e,headerClass:n}=t;if(e)return w("div",{className:q("card-header",n),children:w(gt,{content:e},"header")})}_renderFooter(t){const{footer:e,footerClass:n,footActions:s}=t;if(e||s)return w("div",{className:q("card-footer",n),children:[w(gt,{content:e},"footer"),Zt.render(s,[t],{key:"foot-actions",relativeTarget:t,className:"card-foot-actions",size:"sm"},this)]})}_renderActions(t){return Zt.render(t.actions,[t],{key:"actions",relativeTarget:t,className:"card-actions",size:"sm"},this)}_renderList(t){const{items:e}=t;if(!e)return;const n=vt({key:"list",className:"card-list"},typeof e=="object"?e:{items:e});return w(me,{...n})}_renderAvatar(t){const{avatar:e}=t;if(e){const n=typeof e=="function"?e.call(this,t):e;if(n)return n.className=q("item-avatar",n.className),w(Ei,{...n},"avatar")}}_getClassName(t){return["card",t.className,t.selected?"selected":""]}_getChildren(t){return[this._renderActions(t),this._renderHeader(t),this._renderAvatar(t),this._renderHeading(t),this._renderContent(t),this._renderList(t),this._renderFooter(t),t.children]}};class Tf extends $f{_getClassName(t){return t.className}_getChildren(t){const{innerAttrs:e,innerClass:n,selected:s,innerComponent:r="div"}=t,o=vt({className:q("card",n,s?"selected":"")},e);return w(r,{...o,children:super._getChildren(t)})}}let qi=class extends me{_getClassName(t){return[super._getClassName(t),t.countPerRow?"card-grid":""]}_getProps(t){const{gap:e,countPerRow:n}=t;return vt({style:{"--list-gap":e?Bt(e):void 0,"--list-count-per-row":n}},super._getProps(t))}_getRenderedItem(t,e){return e}};qi.NAME="card-list",qi.TAG="div",qi.ItemComponents={...me.ItemComponents,default:Tf,item:Tf},qi.defaultItemProps={component:"div"};class $o extends mt{}$o.NAME="Card",$o.Component=$f,$o.replace=!0;class bc extends mt{}bc.NAME="CardList",bc.Component=qi;const K0="",U0="";class Gi extends Xe{_getLayoutOptions(){const t=super._getLayoutOptions();return this.options.element||(t[0]={getBoundingClientRect:this._getClickBounding}),t}}Gi.NAME="ContextMenu",Gi.DEFAULT={...Xe.DEFAULT,name:"contextmenu",trigger:"contextmenu"},Gi.register();const V0="",q0="";function K_(i){const{left:t,className:e,top:n,id:s,onMenuBtnClick:r,title:o,width:a,height:l,content:h,loading:f,draggable:d=!0}=i;return w("div",{class:"dashboard-block-cell",style:{left:t,top:n,width:a,height:l},children:w("div",{className:q("dashboard-block load-indicator",f&&!h?"loading":"",r?"has-more-menu":"",e),draggable:d,"data-id":s,children:[w("div",{class:"dashboard-block-header",children:[w("div",{class:"dashboard-block-title",children:o}),r?w("div",{class:"dashboard-block-actions toolbar",children:w("button",{class:"toolbar-item dashboard-block-action btn square ghost rounded size-sm","data-type":"more",onClick:r,children:w("div",{class:"more-vert"})})}):null]}),g.isPlainObject(h)&&h.html?w(kn,{className:"dashboard-block-body",executeScript:!0,...h}):w("div",{class:"dashboard-block-body",children:h})]})})}const G0="",Y0="",wc=([i,t,e,n],[s,r,o,a])=>!(i+e<=s||s+o<=i||t+n<=r||r+a<=t),Nf=(i,t)=>i[1]===t[1]?i[0]-t[0]:i[1]-t[1],To="Dashboard:Block.cache:";let Ef=class extends Tt{constructor(t){super(t),this._ref=kt(),this._loadTimer=0,this._map=new Map,this._oldMap=new Map,this.tryLoadNext=()=>{clearTimeout(this._loadTimer),this._loadTimer=window.setTimeout(()=>this.loadNext(),100)},this._checkLayout=()=>{const{onLayoutChange:e}=this.props;if(!e)return;const{blocks:n}=this.state,s={};let r=!1;n.forEach(o=>{const[a,l,h,f]=this._map.get(o.id),d=this._oldMap.get(o.id);(!d||d[0]!==a||d[1]!==l||d[2]!==h||d[3]!==f)&&(r=!0,s[o.id]={left:a,top:l,width:h,height:f},this._oldMap.set(o.id,[a,l,h,f]))}),r&&e(s)},this._handleMenuClick=e=>{const n=e.target.closest(".dashboard-block");if(!n)return;const s=n.dataset.id;if(!s)return;const r=this.getBlock(s);if(!r||!r.menu)return;const{menu:o}=r,{onClickMenu:a}=this.props;Gi.show({triggerEvent:e,element:e.currentTarget,placement:"bottom-end",menu:{onClickItem:l=>{var h;((h=l.item.data)==null?void 0:h.type)==="refresh"&&this.load(s),a&&a.call(this,l,r)},...o}})},this.state={blocks:this._initBlocks(t.blocks)}}getBlock(t){return this.state.blocks.find(e=>e.id===t)}update(t,e){const{id:n}=t,{blocks:s}=this.state,r=s.findIndex(a=>a.id===n);if(r<0)return;const o=s[r];t.fetch&&t.fetch!==o.fetch&&t.needLoad===void 0&&(t.needLoad=!0),s[r]={...o,...t},this.setState({blocks:s},e)}delete(t){const{blocks:e}=this.state,n=e.findIndex(s=>s.id===t);n<0||(e.splice(n,1),this.setState({blocks:e}))}add(t){t=Array.isArray(t)?t:[t],this.setState({blocks:[...this.state.blocks,...this._initBlocks(t)]})}load(t,e){const n=this.getBlock(t);!n||n.loading||(e=e||n.fetch,e&&this.update({id:t,loading:!0,needLoad:!1},async()=>{try{const s=await g.fetch(e,[t,n],({url:r})=>({url:$t(r,n),dataType:"html"}));this.update({id:t,loading:!1,content:{html:s}},()=>{var r;this._setCache(t,s),(r=this.props.onLoad)==null||r.call(this,n)})}catch(s){const r=w("div",{class:"panel center text-danger p-5",children:["Error: ",s.message]});this.update({id:t,loading:!1,content:r},()=>{var o;(o=this.props.onLoadFail)==null||o.call(this,s,n)})}}))}reset(t){this.setState({blocks:this._initBlocks(t)})}loadNext(){const{blocks:t}=this.state;let e="";for(const n of t){if(n.loading)return;if(!n.visible&&this._isVisible(n.id))return this.update({id:n.id,visible:!0});if(n.needLoad&&n.visible){e=n.id;break}}e.length&&requestAnimationFrame(()=>this.load(e))}_isVisible(t){return!this.props.onlyLoadVisible||!!g(this._ref.current).find(`.dashboard-block[data-id="${t}"]`).isVisible()}_setCache(t,e){const{cache:n}=this.props;if(n)try{typeof n=="string"?ae.set(`${To}${n}:${t}`,e):ae.session.set(`${To}${t}`,e)}catch(s){console.warn("ZUI: Failed to cache block content.",{id:t,html:e,error:s})}}_getCache(t){const{cache:e}=this.props;if(!e)return;const n=typeof e=="string"?ae.get(`${To}${e}:${t}`):ae.session.get(`${To}${t}`);if(n)return{html:n}}_initBlocks(t){const{blockFetch:e,blockMenu:n,grid:s}=this.props;return t.map(o=>{const{id:a,size:l,width:h,height:f,left:d=-1,top:m=-1,fetch:y=e,menu:b=n,content:S,...x}=o,[k,T]=this._getBlockSize(h&&f?{width:h,height:f}:l);return{id:`${a}`,width:k,height:T,left:Math.min(d,s-k),top:m,fetch:y,menu:b,content:S??this._getCache(`${a}`),loading:!1,needLoad:!!y,...x}})}_getBlockSize(t){const{blockDefaultSize:e,blockSizeMap:n}=this.props;return t=t??e,typeof t=="string"&&(t=n[t]),t=t||e,Array.isArray(t)||(t=[t.width,t.height]),t}_layout(){const{blocks:t,dragging:e,dropping:n}=this.state,s=this._map;if(s.size){const a=[0,0,0,0];t.sort((l,h)=>Nf(s.get(l.id)||a,s.get(h.id)||a))}s.clear(),e&&n&&s.set(e,n),t.forEach(a=>{a.id!==e&&this._layoutBlock(a)});const r=Array.from(s.entries());r.sort((a,l)=>Nf(a[1],l[1]));let o=0;return r.forEach(([a,l])=>{let h=l[1]-1;for(;h>=0&&this._canMove([l[0],h,l[2],l[3]],a);)h--;h++,l[1]=h,o=Math.max(o,h+l[3])}),n&&(o=Math.max(o,n[1]+n[3])),{blocks:t,height:o}}_initDraggable(){const t=this._ref.current;this._draggable=new vs(t,{selector:".dashboard-block",target:()=>t,beforeDrag:(e,n)=>{const s=n.getBoundingClientRect();if(e.clientY-s.top>48)return e.preventDefault(),!1;this._dragOffset=[e.clientX-s.left,e.clientY-s.top]},onDragStart:(e,n)=>{const s=n.dataset.id;s!==void 0&&(this._dragging=this._map.get(s),this.setState({dragging:s}))},onDragOver:e=>{const{cellHeight:n,grid:s}=this.props,r=t.getBoundingClientRect(),[,,o,a]=this._dragging,[l,h]=this._dragOffset,f=Math.min(s-o,Math.max(0,Math.round((e.clientX-r.left-l)/(r.width/s)))),d=Math.max(0,Math.round((e.clientY-r.top-h)/n)),m=this.state.dropping;m&&m[0]===f&&m[1]===d||this.setState({dropping:[f,d,o,a]})},onDragEnd:()=>{const{dragging:e,dropping:n}=this.state,s={dragging:void 0,dropping:void 0},r={};if(e&&n){const{blocks:o}=this.state;o.forEach((a,l)=>{const[h,f]=e===a.id?n:this._map.get(a.id);(a.left!==h||a.top!==f)&&(o[l]={...a,left:h,top:f},r[a.id]={left:h,top:f})}),s.blocks=o}this.setState(s,this._checkLayout),this._dragging=void 0,this._dragOffset=void 0}})}_layoutBlock(t){const{id:e,left:n,top:s,width:r,height:o}=t,a=[n,s,r,o];n<0||s<0?this._appendBlock(e,a):this._insertBlock(e,a)}_canMove(t,e){const{dropping:n}=this.state;if(n&&wc(t,n))return!1;for(const[s,r]of this._map.entries())if(s!==e&&wc(r,t))return!1;return!0}_canPlace(t){const{dragging:e}=this.state;return this._canMove(t,e)}_insertBlock(t,e){const{dropping:n}=this.state;for(n&&wc(e,n)&&(e[1]=n[1]+n[3]);!this._canPlace(e);)e[1]=e[1]+1;this._map.set(t,e)}_appendBlock(t,e){const[n,s,r,o]=e;let a=s;if(n>=0&&s>=0){if(this._canPlace(e)){this._map.set(t,[n,s,r,o]);return}a=-1}let l=n<0?0:n,h=a<0?0:a,f=!1;const d=this.props.grid;for(;!f;){if(this._canPlace([l,h,r,o])){f=!0;break}n<0?(l+=1,l+r>d&&(l=0,h+=1)):h+=1}this._map.set(t,[l,h,r,o])}componentDidMount(){this.loadNext(),g(window).on("scroll",this.tryLoadNext),this._initDraggable();for(const[t,e]of this._map.entries())this._oldMap.set(t,[...e])}componentDidUpdate(t){t.blocks!==this.props.blocks?this.setState({blocks:this._initBlocks(this.props.blocks)}):this.loadNext()}componentWillUnmount(){clearTimeout(this._loadTimer),g(window).off("scroll",this.tryLoadNext),this._draggable.destroy()}render(){const{blocks:t,height:e}=this._layout(),{cellHeight:n,grid:s,emptyBlockContent:r}=this.props,{dropping:o,dragging:a}=this.state,l=this._map;return w("div",{class:"dashboard",children:w("div",{class:"dashboard-blocks",style:{height:e*n},ref:this._ref,children:[o?w("div",{className:"dashboard-drop-shadow",style:{left:`${100*o[0]/s}%`,top:n*o[1],width:`${100*o[2]/s}%`,height:n*o[3]}},"dropping"):null,t.map((h,f)=>{const{id:d,menu:m,content:y,title:b}=h,[S,x,k,T]=d===a&&o?o:l.get(d)||[0,0,h.width,h.height];return w(K_,{id:d,index:f,left:`${100*S/s}%`,top:n*x,width:`${100*k/s}%`,height:n*T,content:y??r,title:b,className:q(h.needLoad?"need-load":"",y?"has-content":""),onMenuBtnClick:m?this._handleMenuClick:void 0},h.id)})]})})}};Ef.defaultProps={responsive:!1,cache:!0,blocks:[],grid:3,gap:16,cellHeight:64,blockDefaultSize:[1,3],blockMenu:{items:[{text:"Refresh",data:{type:"refresh"}}]},onlyLoadVisible:!0,blockSizeMap:{xs:[1,3],sm:[1,4],md:[1,5],lg:[1,6],xl:[1,8],xsWide:[2,3],smWide:[2,4],mdWide:[2,5],lgWide:[2,6],xlWide:[2,8],xsLong:[3,3],smLong:[3,4],mdLong:[3,5],lgLong:[3,6],xlLong:[3,8]}};class Cc extends mt{}Cc.NAME="Dashboard",Cc.Component=Ef;const Q0="";class Mf extends Tt{constructor(e){super(e);Pe(this,On,void 0);Pe(this,zn,void 0);ze(this,On,0),ze(this,zn,null),this._handleWheel=n=>{const{wheelContainer:s}=this.props,r=n.target;if(!(!r||!s)&&(typeof s=="string"&&r.closest(s)||typeof s=="object")){const o=(this.props.type==="horz"?n.deltaX:n.deltaY)*(this.props.wheelSpeed??1);this.scrollOffset(o)&&n.preventDefault()}},this._handleMouseMove=n=>{const{dragStart:s}=this.state;s&&(we(this,On)&&cancelAnimationFrame(we(this,On)),ze(this,On,requestAnimationFrame(()=>{const r=this.props.type==="horz"?n.clientX-s.x:n.clientY-s.y;this.scroll(s.offset+r*this.props.scrollSize/this.props.clientSize),ze(this,On,0)})),n.preventDefault())},this._handleMouseUp=()=>{this.state.dragStart&&this.setState({dragStart:!1})},this._handleMouseDown=n=>{this.state.dragStart||this.setState({dragStart:{x:n.clientX,y:n.clientY,offset:this.scrollPos}}),n.preventDefault(),n.stopPropagation()},this._handleClick=n=>{const s=n.currentTarget;if(!s)return;const r=s.getBoundingClientRect(),{type:o,clientSize:a,scrollSize:l}=this.props,h=(o==="horz"?n.clientX-r.left:n.clientY-r.top)-this.barSize/2;this.scroll(h*l/a),n.preventDefault()},this.state={scrollPos:this.props.defaultScrollPos??0,dragStart:!1}}get scrollPos(){return this.props.scrollPos??this.state.scrollPos}get controlled(){return this.props.scrollPos!==void 0}get maxScrollPos(){const{scrollSize:e,clientSize:n}=this.props;return Math.max(0,e-n)}get barSize(){const{clientSize:e,scrollSize:n,size:s=12,minBarSize:r=3*s}=this.props;return Math.max(Math.round(e*e/n),r)}componentDidMount(){document.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp);const{wheelContainer:e}=this.props;e&&(ze(this,zn,typeof e=="string"?document:e.current),we(this,zn).addEventListener("wheel",this._handleWheel,{passive:!1}))}componentWillUnmount(){document.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),we(this,zn)&&we(this,zn).removeEventListener("wheel",this._handleWheel)}scroll(e){return e=Math.max(0,Math.min(Math.round(e),this.maxScrollPos)),e===this.scrollPos?!1:(this.controlled?this._afterScroll(e):this.setState({scrollPos:e},this._afterScroll.bind(this,e)),!0)}scrollOffset(e){return this.scroll(this.scrollPos+e)}_afterScroll(e){const{onScroll:n}=this.props;n&&n(e,this.props.type??"vert")}render(){const{clientSize:e,type:n,size:s=12,className:r,style:o,left:a,top:l,bottom:h,right:f}=this.props,{maxScrollPos:d,scrollPos:m}=this,{dragStart:y}=this.state,b={left:a,top:l,bottom:h,right:f,...o},S={};return n==="horz"?(b.height=s,b.width=e,S.width=this.barSize,S.left=Math.round(Math.min(d,m)*(e-S.width)/d)):(b.width=s,b.height=e,S.height=this.barSize,S.top=Math.round(Math.min(d,m)*(e-S.height)/d)),w("div",{className:q("scrollbar",r,{"is-vert":n==="vert","is-horz":n==="horz","is-dragging":y}),style:b,onMouseDown:this._handleClick,children:w("div",{className:"scrollbar-bar",style:S,onMouseDown:this._handleMouseDown})})}}On=new WeakMap,zn=new WeakMap;const No=new Map,Eo=[];function Pf(i,t){const{name:e}=i;if(!(t!=null&&t.override)&&No.has(e))throw new Error(`DTable: Plugin with name ${e} already exists`);No.set(e,i),t!=null&&t.buildIn&&!Eo.includes(e)&&Eo.push(e)}function Kt(i,t){Pf(i,t);const e=n=>{if(!n)return i;const{defaultOptions:s,...r}=i;return{...r,defaultOptions:{...s,...n}}};return e.plugin=i,e}function Af(i){return No.delete(i)}function U_(i){if(typeof i=="string"){const t=No.get(i);return t||console.warn(`DTable: Cannot found plugin "${i}"`),t}if(typeof i=="function"&&"plugin"in i)return i.plugin;if(typeof i=="object")return i;console.warn("DTable: Invalid plugin",i)}function If(i,t,e){return t.forEach(n=>{var r;if(!n)return;const s=U_(n);s&&(e.has(s.name)||((r=s.plugins)!=null&&r.length&&If(i,s.plugins,e),i.push(s),e.add(s.name)))}),i}function V_(i=[],t=!0){if(t&&Eo.length&&i.unshift(...Eo),!(i!=null&&i.length))return[];const e=If([],i,new Set),n=[],s=e.reduce((r,o,a)=>{var l;return r.set(o.name,a*1e3),(l=o.requireAfter)!=null&&l.length&&n.push(o),r},new Map);return n.length&&(n.forEach(r=>{const o=r.requireAfter.reduce((a,l)=>(s.has(l)&&a.push(s.get(l)),a),[]);o.length&&s.set(r.name,Math.max(...o)+1)}),e.sort((r,o)=>s.get(r.name)-s.get(o.name))),e}function Df(){return{cols:[],data:[],rowKey:"id",width:"100%",height:"auto",rowHeight:35,defaultColWidth:80,minColWidth:24,maxColWidth:9999,header:!0,footer:void 0,headerHeight:0,footerHeight:0,rowHover:!0,colHover:!1,cellHover:!1,bordered:!1,striped:!0,responsive:!1,scrollbarHover:!0,horzScrollbarPos:"outside"}}function Rf(i,t,e){return i&&(t&&(i=Math.max(t,i)),e&&(i=Math.min(e,i))),i}function Lf(i,t){return typeof i=="string"&&(i=i.endsWith("%")?parseFloat(i)/100:parseFloat(i)),typeof t=="number"&&(typeof i!="number"||isNaN(i))&&(i=t),i}function kc(i,t=!1,e=0){if(!i.list.length)return;if(t&&i.widthSetting&&(i.widthSetting=Math.min(i.widthSetting,i.width)),e&&(!i.widthSetting||i.widthSetting>e)&&i.width>e&&(i.widthSetting=e),i.widthSetting&&i.width!==i.widthSetting){i.width=i.widthSetting;const s=i.width-i.totalWidth;if(!t&&s>0||t&&s!==0){const r=i.flexList.length?i.flexList:i.list,o=r.reduce((a,l)=>a+(l.flex||1),0);r.forEach(a=>{const l=Math[s<0?"max":"min"](s,Math.ceil(s*((a.flex||1)/o)));a.realWidth=a.width+l})}}let n=0;i.list.forEach((s,r)=>{s.realWidth||(s.realWidth=s.width),s.left=n,s.sideIndex=r,n+=s.realWidth})}function Of(i){return i?i==="left"?"left":"right":"center"}function q_(i,t,e,n){const{defaultColWidth:s,minColWidth:r,maxColWidth:o,fixedLeftWidth:a=0,fixedRightWidth:l=0}=t,h=B=>(typeof B=="function"&&(B=B.call(i)),B=Lf(B,0),B<1&&(B=Math.round(B*n)),B),f={width:0,list:[],flexList:[],widthSetting:0,totalWidth:0},d={...f,list:[],flexList:[],widthSetting:h(a)},m={...f,list:[],flexList:[],widthSetting:h(l)},y={left:d,center:f,right:m},b=[],S={};let x=!1;const k=[],T={};if(e.forEach(B=>{const{colTypes:K,onAddCol:G}=B;K&&Object.entries(K).forEach(([Q,Z])=>{T[Q]||(T[Q]=[]),T[Q].push(Z)}),G&&k.push(G)}),t.cols.forEach((B,K)=>{if(B.hidden)return;const{type:G="",name:Q}=B,Z={fixed:!1,flex:!1,width:s,minWidth:r,maxWidth:o,...B,type:G},tt={name:Q,type:G,setting:Z,flex:0,left:0,width:0,realWidth:0,visible:!0,index:K,side:Of(Z.fixed),sideIndex:0,order:Z.order,border:Z.border},X=T[G];X&&X.forEach(Dt=>{const ht=typeof Dt=="function"?Dt.call(i,Z):Dt;ht&&Object.assign(Z,ht,B)});const{flex:et,minWidth:ct=r,maxWidth:pt=o}=Z,xt=Lf(Z.width||s,s);tt.flex=et===!0?1:typeof et=="number"?et:0,tt.width=Rf(xt<1?Math.round(xt*n):xt,ct,pt),tt.side=Of(Z.fixed),k.forEach(Dt=>Dt.call(i,tt)),b.push(tt),S[tt.name]=tt;const Rt=y[tt.side];Rt.list.push(tt),Rt.totalWidth+=tt.width,Rt.width=Rt.totalWidth,tt.flex&&Rt.flexList.push(tt),typeof tt.order=="number"&&(x=!0)}),x){const B=(K,G)=>(K.order??K.index)-(G.order??G.index);b.sort(B),d.list.sort(B),f.list.sort(B),m.list.sort(B)}kc(m,!0);const j=n-m.width-Math.max(40,r);return kc(d,!0,j),f.widthSetting=n-d.width-m.width,kc(f),{list:b,map:S,...y}}function G_(i){var ht;const{col:t,className:e,height:n,row:s,onRenderCell:r,style:o,outerStyle:a,children:l,outerClass:h,width:f,left:d,top:m,...y}=i,b={left:d??t.left,top:m??s.top,width:f??t.realWidth,height:n,...a},{align:S,cellStyle:x,cellClass:k,className:T}=t.setting,j={justifyContent:S?S==="left"?"start":S==="right"?"end":S:void 0,...x,...o},{name:B,border:K}=t,G=["dtable-cell",h,e,T,{"has-border-left":K===!0||K==="left","has-border-right":K===!0||K==="right"}],Q=["dtable-cell-content",k],Z=(ht=s.data)==null?void 0:ht[B],tt=[l??Z??""],X=r?r(tt,{row:s,col:t,value:Z},i,P):tt,et=[],ct=[],pt={},xt={};let Rt="div";X==null||X.forEach(J=>{if(typeof J=="object"&&J&&!E.isValidElement(J)&&("html"in J||"className"in J||"style"in J||"attrs"in J||"children"in J||"tagName"in J)){const _t=J.outer?et:ct;J.html?_t.push(w("div",{className:q("dtable-cell-html",J.className),style:J.style,dangerouslySetInnerHTML:{__html:J.html},...J.attrs??{}})):(J.style&&Object.assign(J.outer?b:j,J.style),J.className&&(J.outer?G:Q).push(J.className),J.children&&_t.push(J.children),J.attrs&&Object.assign(J.outer?pt:xt,J.attrs)),J.tagName&&!J.outer&&(Rt=J.tagName)}else(typeof J!="object"||E.isValidElement(J))&&ct.push(J)});const Dt=Rt;return w("div",{className:q(G),style:b,"data-col":B,"data-row":s.id,"data-type":t.type||null,...y,...pt,children:[ct.length>0&&w(Dt,{className:q(Q),style:j,...xt,children:ct}),et]})}function Sc({rows:i=[],cols:t,rowHeight:e,scrollLeft:n=0,scrollTop:s=0,left:r=0,top:o=0,width:a,height:l="100%",className:h,CellComponent:f=G_,cellClass:d,onRenderCell:m}){var x;const y=Array.isArray(i)?i:[i],b=((x=y[0])==null?void 0:x.top)??0,S=y.length;return w("div",{className:q("dtable-cells",h),style:{top:o,left:r,width:a,height:l},children:w("div",{className:"dtable-cells-container",style:{left:-n,top:-s+b},children:y.reduce((k,T,j)=>{const B=t.length;return t.forEach((K,G)=>{k.push(w(f,{className:q(`is-${T.index%2?"odd":"even"}-row`,G?"":"is-first-in-row",G===B-1?"is-last-in-row":"",j?"":"is-first-row",j===S-1?"is-last-row":"",d),col:K,row:T,top:T.top-b,height:e,onRenderCell:m},`${T.index}:${K.name}`))}),k},[])})})}function zf({top:i,height:t,rowHeight:e,rows:n,cols:{left:s,center:r,right:o},scrollLeft:a,scrollTop:l,className:h,cellClass:f,style:d,onRenderCell:m,children:y}){let b=null;s.list.length&&(b=w(Sc,{className:"dtable-fixed-left",rows:n,scrollTop:l,cols:s.list,width:s.width,rowHeight:e,cellClass:f,onRenderCell:m},"left"));let S=null;r.list.length&&(S=w(Sc,{rows:n,className:"dtable-scroll-center",scrollLeft:a,scrollTop:l,cols:r.list,left:s.width,width:r.width,rowHeight:e,cellClass:f,onRenderCell:m},"center"));let x=null;return o.list.length&&(x=w(Sc,{className:"dtable-fixed-right",rows:n,scrollTop:l,cols:o.list,left:s.width+r.width,width:o.width,rowHeight:e,cellClass:f,onRenderCell:m},"right")),w("div",{className:q("dtable-block",h),style:{...d,top:i,height:t},children:[b,S,x,y]})}var Ff=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)},Yt=(i,t,e)=>(Ff(i,t,"read from private field"),e?e.call(i):t.get(i)),ne=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},Ne=(i,t,e)=>(Ff(i,t,"access private method"),e),Dn,Ms,Ps,xc,jf,$c,Bf,Tc,Hf,Nc,Wf,Mo,Ec,Po,Ao,Mc,Pc,Ac,Ic,As,Io,Do,Dc,Rc,Kf,Lc,Uf;let Oc=class extends Tt{constructor(t){super(t),ne(this,xc),ne(this,$c),ne(this,Tc),ne(this,Nc),ne(this,Mo),ne(this,As),ne(this,Do),ne(this,Rc),ne(this,Lc),this.ref=kt(),this._rafId=0,this._needRender=!1,this._plugins=[],this._lastUsedPlugins=new Map,this._events=new Map,this._data={},this._i18nMaps=[],this._hover={in:!1},this.updateLayout=()=>{this._rafId&&cancelAnimationFrame(this._rafId),this._rafId=requestAnimationFrame(()=>{const{element:e}=this;e&&!wn(e)&&this.update({dirtyType:"layout"}),this._rafId=0})},ne(this,Dn,(e,n)=>{n=n||e.type;const s=this._events.get(n);if(s!=null&&s.length){for(const r of s)if(r.call(this,e)===!1){e.stopPropagation(),e.preventDefault();break}}}),ne(this,Ms,e=>{Yt(this,Dn).call(this,e,`window_${e.type}`)}),ne(this,Ps,e=>{Yt(this,Dn).call(this,e,`document_${e.type}`)}),ne(this,Po,(e,n,s,r)=>{const{row:o,col:a}=n;n.value=this.getCellValue(o,a),e[0]=n.value;const l=o.id==="HEADER"?"onRenderHeaderCell":"onRenderCell";return a.setting[l]&&(e=a.setting[l].call(this,e,n,s,r)),this._plugins.forEach(h=>{h[l]&&(e=h[l].call(this,e,n,s,r))}),this.options[l]&&(e=this.options[l].call(this,e,n,s,r)),e}),ne(this,Ao,(e,n)=>{n==="horz"?this.scroll({scrollLeft:e}):this.scroll({scrollTop:e})}),ne(this,Mc,e=>{var a,l,h;const n=this.getPointerInfo(e);if(!n)return;const{rowID:s,colName:r,cellElement:o}=n;if(s==="HEADER")o&&((a=this.options.onHeaderCellClick)==null||a.call(this,e,{colName:r,element:o}),this._plugins.forEach(f=>{var d;(d=f.onHeaderCellClick)==null||d.call(this,e,{colName:r,element:o})}));else{const f=this.layout.visibleRows.find(d=>d.id===s);if(o){if(((l=this.options.onCellClick)==null?void 0:l.call(this,e,{colName:r,rowID:s,rowInfo:f,element:o}))===!0)return;for(const d of this._plugins)if(((h=d.onCellClick)==null?void 0:h.call(this,e,{colName:r,rowID:s,rowInfo:f,element:o}))===!0)return}}}),ne(this,Pc,e=>{const n=e.key.toLowerCase();if(["pageup","pagedown","home","end"].includes(n))return!this.scroll({to:n.replace("page","")})}),ne(this,Ac,e=>{const n=g(e.target).closest(".dtable-cell");if(!n.length)return Ne(this,As,Io).call(this,!1);Ne(this,As,Io).call(this,[n.attr("data-row"),n.attr("data-col")])}),ne(this,Ic,()=>{Ne(this,As,Io).call(this,!1)}),this._id=t.id??`dtable-${_e()}`,this.state={scrollTop:0,scrollLeft:0,renderCount:0},this._allPlugins=Object.freeze(V_(t.plugins)),this._allPlugins.forEach(e=>{const{methods:n,data:s,state:r}=e;n&&Object.entries(n).forEach(([o,a])=>{typeof a=="function"&&Object.assign(this,{[o]:a.bind(this)})}),s&&Object.assign(this._data,s.call(this)),r&&Object.assign(this.state,r.call(this))}),Ne(this,Do,Dc).call(this),this._plugins.forEach(e=>{var n;(n=e.onCreate)==null||n.call(this,e)})}get options(){var t;return((t=this._layout)==null?void 0:t.options)||this._options||Df()}get plugins(){return this._plugins}get layout(){return this._layout}get id(){return this._id}get data(){return this._data}get element(){return this.ref.current}get parent(){var t;return this.props.parent??((t=this.element)==null?void 0:t.parentElement)}get hoverInfo(){return this._hover}componentWillReceiveProps(){this._options=void 0}componentDidMount(){this._needRender?this.forceUpdate():Ne(this,Mo,Ec).call(this),this.on("click",Yt(this,Mc)),this.on("keydown",Yt(this,Pc));const{options:t}=this;(t.rowHover||t.colHover)&&(this.on("mouseover",Yt(this,Ac)),this.on("mouseleave",Yt(this,Ic)));let{responsive:e}=t;if(e){e===!0&&(e="window,parent");const n=e.split(",");if(typeof ResizeObserver<"u"){const s=[],r=new ResizeObserver(this.updateLayout);this._rob=r;const{parent:o}=this;n.forEach(a=>{a!=="window"&&(a==="parent"?o&&r.observe(o):a[0]==="~"?s.push(a.slice(1)):g(a).each((l,h)=>r.observe(h)))}),s.length&&this.on(s.join(" "),this.updateLayout)}n.includes("window")&&this.on("window_resize",this.updateLayout)}this._checkPluginsState()}componentDidUpdate(){Ne(this,Mo,Ec).call(this),this._checkPluginsState(),this._plugins.forEach(t=>{var e;(e=t.onUpdated)==null||e.call(this)})}componentWillUnmount(){var e;(e=this._rob)==null||e.disconnect();const{element:t}=this;if(t)for(const n of this._events.keys())n.startsWith("window_")?window.removeEventListener(n.replace("window_",""),Yt(this,Ms)):n.startsWith("document_")?document.removeEventListener(n.replace("document_",""),Yt(this,Ps)):t.removeEventListener(n,Yt(this,Dn));this._plugins.forEach(n=>{var s;(s=n.onUnmounted)==null||s.call(this)}),this._allPlugins.forEach(n=>{var s;(s=n.onDestory)==null||s.call(this)}),this._data={},this._events.clear(),this._noAnimation&&clearTimeout(this._noAnimation),this._rafId&&cancelAnimationFrame(this._rafId)}resetState(t,e){this._options=void 0,this._layout=void 0,t=t||this.props;const n={};this._plugins.forEach(s=>{const{resetState:r,state:o}=s;r&&(typeof r=="function"?Object.assign(n,r.call(this,t)):o&&Object.assign(n,o.call(this)))}),Object.keys(n).length&&this.setState(n)}on(t,e,n){var r;n&&(t=`${n}_${t}`);const s=this._events.get(t);s?s.push(e):(this._events.set(t,[e]),t.startsWith("window_")?window.addEventListener(t.replace("window_",""),Yt(this,Ms)):t.startsWith("document_")?document.addEventListener(t.replace("document_",""),Yt(this,Ps)):(r=this.element)==null||r.addEventListener(t,Yt(this,Dn)))}off(t,e,n){var o;n&&(t=`${n}_${t}`);const s=this._events.get(t);if(!s)return;const r=s.indexOf(e);r>=0&&s.splice(r,1),s.length||(this._events.delete(t),t.startsWith("window_")?window.removeEventListener(t.replace("window_",""),Yt(this,Ms)):t.startsWith("document_")?document.removeEventListener(t.replace("document_",""),Yt(this,Ps)):(o=this.element)==null||o.removeEventListener(t,Yt(this,Dn)))}emitCustomEvent(t,e){Yt(this,Dn).call(this,e instanceof Event?e:new CustomEvent(t,{detail:e}),t)}disableAnimation(t=200){var e;this._noAnimation&&clearTimeout(this._noAnimation),(e=this.element)==null||e.classList.add("no-animation"),this._noAnimation=window.setTimeout(()=>{var n;this._noAnimation=void 0,(n=this.element)==null||n.classList.remove("no-animation")},t)}scroll(t,e){const{scrollLeft:n,scrollTop:s,rowsHeightTotal:r,rowsHeight:o,rowHeight:a,cols:{center:{totalWidth:l,width:h}}}=this.layout,{to:f}=t;let{scrollLeft:d,scrollTop:m}=t;if(f==="up"||f==="down")m=s+(f==="down"?1:-1)*Math.floor(o/a)*a;else if(f==="left"||f==="right")d=n+(f==="right"?1:-1)*h;else if(f==="top")m=0;else if(f==="bottom")m=r-o;else if(f==="begin")d=0;else if(f==="end")d=l-h;else{const{offsetLeft:b,offsetTop:S}=t;typeof b=="number"&&(d=n+b),typeof S=="number"&&(m=s+S)}const y={};return typeof d=="number"&&(d=Math.max(0,Math.min(d,l-h)),d!==n&&(y.scrollLeft=d)),typeof m=="number"&&(m=Math.max(0,Math.min(m,r-o)),m!==s&&(y.scrollTop=m)),Object.keys(y).length?(this.setState(y,()=>{var b;(b=this.options.onScroll)==null||b.call(this,y),e==null||e.call(this,!0)}),!0):(e==null||e.call(this,!1),!1)}getColInfo(t){if(t===void 0)return;if(typeof t=="object")return t;const{cols:e}=this.layout;return typeof t=="number"?e.list[t]:e.map[t]}getRowInfo(t){if(t===void 0)return;if(typeof t=="object")return t;if(t===-1||t==="HEADER")return{id:"HEADER",index:-1,top:0};const{rows:e,rowsMap:n,allRows:s}=this.layout;return typeof t=="number"?e[t]:n[t]||s.find(r=>r.id===t)}getCellValue(t,e){var a;const n=typeof t=="object"?t:this.getRowInfo(t);if(!n)return;const s=typeof e=="object"?e:this.getColInfo(e);if(!s)return;let r=n.id==="HEADER"?s.setting.title:(a=n.data)==null?void 0:a[s.name];const{cellValueGetter:o}=this.options;return o&&(r=o.call(this,n,s,r)),r}getRowInfoByIndex(t){return this.layout.rows[t]}update(t={},e){if(!this._options)return;typeof t=="function"&&(e=t,t={});const{dirtyType:n,state:s}=t;if(n==="layout")this._layout=void 0;else if(n==="options"){if(this._options=void 0,!this._layout)return;this._layout=void 0}this.setState(s||(r=>({renderCount:r.renderCount+1})),e)}getPointerInfo(t){const e=t.target;if(!e||e.closest(".no-cell-event"))return;const n=g(e).closest(".dtable-cell");if(!n.length)return;const s=n.attr("data-row"),r=n.attr("data-col");if(!(typeof r!="string"||typeof s!="string"))return{cellElement:n[0],colName:r,rowID:s,target:e}}componentDidCatch(t,e){console.error(`[ZUI] DTable ${this.id} Error:`,t,e)}i18n(t,e,n){return Nt(this._i18nMaps,t,e,n,this.options.lang)??`{i18n:${t}}`}getPlugin(t){return this.plugins.find(e=>e.name===t)}_checkPluginsState(){const t=new Set(this._lastUsedPlugins.keys());this._plugins.forEach(e=>{var s;if(t.has(e.name)){t.delete(e.name);return}let{events:n}=e;n&&(typeof n=="function"&&(n=n.call(this)),Object.entries(n).forEach(([r,o])=>{o&&this.on(r,o)})),(s=e.onMounted)==null||s.call(this),this._lastUsedPlugins.set(e.name,e)}),t.size&&t.forEach(e=>{var s;const n=this._lastUsedPlugins.get(e);(s=n==null?void 0:n.onUnmounted)==null||s.call(this),this._lastUsedPlugins.delete(e)})}render(){let t=Ne(this,Lc,Uf).call(this);const{className:e,rowHover:n,colHover:s,cellHover:r,bordered:o,striped:a,scrollbarHover:l,beforeRender:h,emptyTip:f,style:d}=this.options,m={...d},y=["dtable",e,{"dtable-hover-row":n,"dtable-hover-col":s,"dtable-hover-cell":r,"dtable-bordered":o,"dtable-striped":a,"scrollbar-hover":l,"no-animation":this._noAnimation}],b=[];if(t){const S=!t.rows.length;if(h){const x=h.call(this,t);x&&(t=x)}this._plugins.forEach(x=>{var T;const k=(T=x.beforeRender)==null?void 0:T.call(this,t);k&&(t=k)}),m.width=t.width,m.height=t.height,m["--dtable-row-height"]=`${t.rowHeight}px`,m["--dtable-header-height"]=`${t.headerHeight}px`,y.push(t.className,S?"dtable-is-empty":"",{"dtable-has-scroll-y":t.rowsHeightTotal>t.rowsHeight,"dtable-scrolled-down":t.scrollTop>0,"dtable-scrolled-bottom":t.scrollTop>=t.rowsHeightTotal-t.rowsHeight,"dtable-scrolled-right":t.scrollLeft>0,"dtable-scrolled-end":t.scrollLeft>=t.cols.center.totalWidth-t.cols.center.width}),t.children&&b.push(...t.children),S&&f?(delete m.height,b.push(w("div",{className:"dtable-empty-tip",children:w(gt,{content:f,generatorThis:this,generatorArgs:[t]})},"empty-tip"))):(b.push(Ne(this,xc,jf).call(this,t),Ne(this,$c,Bf).call(this,t),Ne(this,Tc,Hf).call(this,t)),t.scrollable&&b.push(Ne(this,Nc,Wf).call(this,t))),this._plugins.forEach(x=>{var T;const k=(T=x.onRender)==null?void 0:T.call(this,t);k&&(k.style&&Object.assign(m,k.style),k.className&&y.push(k.className),k.children&&b.push(k.children))})}return w("div",{id:this._id,className:q(y),style:m,ref:this.ref,tabIndex:-1,children:b})}};Dn=new WeakMap,Ms=new WeakMap,Ps=new WeakMap,xc=new WeakSet,jf=function(i){const{header:t,cols:e,headerHeight:n,scrollLeft:s,headerChildren:r}=i;if(!t)return null;if(t===!0)return w(zf,{className:"dtable-header",cols:e,height:n,scrollLeft:s,rowHeight:n,scrollTop:0,cellClass:"dtable-header-cell",rows:{id:"HEADER",index:-1,top:0},top:0,onRenderCell:Yt(this,Po),children:r},"header");const o=Array.isArray(t)?t:[t];return w(dl,{className:"dtable-header",style:{height:n},renders:o,generateArgs:[i],generatorThis:this,children:r},"header")},$c=new WeakSet,Bf=function(i){const{headerHeight:t,rowsHeight:e,visibleRows:n,rowHeight:s,cols:r,scrollLeft:o,scrollTop:a,bodyChildren:l}=i;return w(zf,{className:"dtable-body",top:t,height:e,rows:n,rowHeight:s,scrollLeft:o,scrollTop:a,cols:r,onRenderCell:Yt(this,Po),children:l},"body")},Tc=new WeakSet,Hf=function(i){let{footer:t}=i;if(typeof t=="function"&&(t=t.call(this,i)),!t)return null;const e=Array.isArray(t)?t:[t];return w(dl,{className:"dtable-footer",style:{height:i.footerHeight,top:i.rowsHeight+i.headerHeight},renders:e,generateArgs:[i],generatorThis:this,generators:i.footerGenerators,children:i.footerChildren},"footer")},Nc=new WeakSet,Wf=function(i){const t=[],{scrollLeft:e,cols:{left:{width:n},center:{width:s,totalWidth:r}},scrollTop:o,rowsHeight:a,rowsHeightTotal:l,footerHeight:h,headerHeight:f}=i,{scrollbarSize:d=12,horzScrollbarPos:m,vertScrollbarPos:y}=this.options;return r>s&&t.push(w(Mf,{type:"horz",scrollPos:e,scrollSize:r,clientSize:s,onScroll:Yt(this,Ao),left:n,bottom:(m==="inside"?0:-d)+h,size:d,wheelContainer:this.ref},"horz"),w("div",{className:"dtable-scroll-shadow is-left",style:{left:n,height:f+a}}),w("div",{className:"dtable-scroll-shadow is-right",style:{left:n+s,height:f+a}})),l>a&&t.push(w(Mf,{type:"vert",scrollPos:o,scrollSize:l,clientSize:a,onScroll:Yt(this,Ao),right:y==="outside"?-d:0,size:d,top:f,wheelContainer:this.ref},"vert")),t.length?t:null},Mo=new WeakSet,Ec=function(){var i;this._needRender=!1,this._plugins.forEach(t=>{var e;return(e=t.afterRender)==null?void 0:e.call(this)}),(i=this.options.afterRender)==null||i.call(this)},Po=new WeakMap,Ao=new WeakMap,Mc=new WeakMap,Pc=new WeakMap,Ac=new WeakMap,Ic=new WeakMap,As=new WeakSet,Io=function(i){const{element:t,options:e}=this;if(!t)return;const n=g(t),s=i?{in:!0,row:i[0],col:i[1]}:{in:!1};e.colHover==="header"&&s.row!=="HEADER"&&(s.col=void 0);const r=this._hover;s.in!==r.in&&n.toggleClass("dtable-hover",s.in),s.row!==r.row&&(n.find(".is-hover-row").removeClass("is-hover-row"),s.row&&n.find(`.dtable-cell[data-row="${s.row}"]`).addClass("is-hover-row")),s.col!==r.col&&(n.find(".is-hover-col").removeClass("is-hover-col"),s.col&&n.find(`.dtable-cell[data-col="${s.col}"]`).addClass("is-hover-col")),this._hover=s},Do=new WeakSet,Dc=function(){if(this._options)return!1;const t={...Df(),...this._allPlugins.reduce((e,n)=>{const{defaultOptions:s}=n;return s&&Object.assign(e,s),e},{}),...this.props};return this._options=t,this._plugins=this._allPlugins.reduce((e,n)=>{const{options:s}=n;let r=t;return s&&(r=Object.assign({...r},typeof s=="function"?s.call(this,t):s)),r!==t&&Object.assign(t,r),e.push(n),e},[]).filter(e=>{const{when:n}=e;return!n||n.call(this,t)}),this._i18nMaps=[this.options.i18n,...this.plugins.map(e=>e.i18n)].filter(Boolean),!0},Rc=new WeakSet,Kf=function(){var Z,tt;const{plugins:i}=this;let t=this._options;const e={flex:w("div",{style:"flex:auto"}),divider:w("div",{style:"width:1px;margin:var(--space);background:var(--color-border);height:50%"})};i.forEach(X=>{var ct;const et=(ct=X.beforeLayout)==null?void 0:ct.call(this,t);et&&(t={...t,...et}),Object.assign(e,X.footer)});let n=t.width,s=0;if(typeof n=="function"&&(n=n.call(this)),n==="100%"){const{parent:X}=this;if(X)s=X.clientWidth;else{this._needRender=!0;return}}const r=q_(this,t,i,s),{data:o,rowKey:a="id",rowHeight:l=35}=t,h=[],f=(X,et,ct)=>{var xt,Rt;const pt={data:ct??{[a]:X},id:X,index:h.length,top:0};if(ct||(pt.lazy=!0),h.push(pt),((xt=t.onAddRow)==null?void 0:xt.call(this,pt,et))!==!1){for(const Dt of i)if(((Rt=Dt.onAddRow)==null?void 0:Rt.call(this,pt,et))===!1)return}};if(typeof o=="number")for(let X=0;X<o;X++)f(`${X}`,X);else Array.isArray(o)&&o.forEach((X,et)=>{typeof X=="object"?f(`${X[a]??""}`,et,X):f(`${X??""}`,et)});let d=h;const m={};if(t.onAddRows){const X=t.onAddRows.call(this,d,r);X&&(d=X)}for(const X of i){const et=(Z=X.onAddRows)==null?void 0:Z.call(this,d,r);et&&(d=et)}d.forEach((X,et)=>{m[X.id]=X,X.index=et,X.top=X.index*l});const{header:y,footer:b}=t,S=y?t.headerHeight||l:0,x=b?t.footerHeight||l:0;let k=t.height,T=0;const j=d.length*l,B=S+x+j;if(typeof k=="function"&&(k=k.call(this,B)),k==="auto")T=B;else if(typeof k=="object")T=Math.min(k.max,Math.max(k.min,B));else if(k==="100%"){const{parent:X}=this;if(X)T=X.clientHeight;else{T=0,this._needRender=!0;return}}else T=k;const K=T-S-x,G={options:t,allRows:h,width:s,height:T,rows:d,rowsMap:m,rowHeight:l,rowsHeight:K,rowsHeightTotal:j,header:y,footer:b,footerGenerators:e,headerHeight:S,footerHeight:x,cols:r},Q=(tt=t.onLayout)==null?void 0:tt.call(this,G);Q&&Object.assign(G,Q),i.forEach(X=>{if(X.onLayout){const et=X.onLayout.call(this,G);et&&Object.assign(G,et)}}),this._layout=G},Lc=new WeakSet,Uf=function(){(Ne(this,Do,Dc).call(this)||!this._layout)&&Ne(this,Rc,Kf).call(this);const{layout:i}=this;if(!i)return;const{cols:{center:t}}=i;let{scrollLeft:e}=this.state;e=Math.min(Math.max(0,t.totalWidth-t.width),e);let n=0;t.list.forEach(b=>{b.left=n,n+=b.realWidth,b.visible=b.left+b.realWidth>=e&&b.left<=e+t.width});const{rowsHeightTotal:s,rowsHeight:r,rows:o,rowHeight:a}=i,l=Math.min(Math.max(0,s-r),this.state.scrollTop),h=Math.floor(l/a),f=l+r,d=Math.min(o.length,Math.ceil(f/a)),m=[],{rowDataGetter:y}=this.options;for(let b=h;b<d;b++){const S=o[b];S.lazy&&y&&(S.data=y([S.id])[0],S.lazy=!1),m.push(S)}return Object.assign(i,{visibleRows:m,scrollTop:l,scrollLeft:e,headerChildren:[],bodyChildren:[],footerChildren:[],children:[],className:"",scrollable:!0}),i},Oc.addPlugin=Pf,Oc.removePlugin=Af;function zc(i,t,e,n){if(typeof i=="function"&&(i=i(t)),typeof i=="string"&&i.length&&(i={url:i}),!i)return e;const{url:s,...r}=i,{setting:o}=t.col,a={};return o&&Object.keys(o).forEach(l=>{l.startsWith("data-")&&(a[l]=o[l])}),w("a",{href:$t(s,t.row.data),...n,...r,...a,children:e})}function Fc(i,t,e){if(i==null)return;const n=t.row.data;return e=e??(n==null?void 0:n[t.col.name]),typeof i=="function"?i(e,t):$t(i,{...n,0:e})}function Vf(i,t,e,n){var s;return e?(e=e??((s=t.row.data)==null?void 0:s[t.col.name]),e==="0000-00-00 00:00:00"||e==="0000-00-00"?n??"":i===!1?e:(i===!0&&(i="[yyyy-]MM-dd hh:mm"),typeof i=="function"&&(i=i(e,t)),Ae(e,i,n??e))):n??e}function qf(i,t){const{link:e}=t.col.setting,n=zc(e,t,i[0]);return n&&(i[0]=n),i}function Gf(i,t){const{format:e,digits:n}=t.col.setting;let s=i[0];return typeof n=="number"&&!Number.isNaN(Number(s))&&(s=Number(s),n>=0&&(s=s.toFixed(n))),e&&(s=Fc(e,t,s)),i[0]=s,i}function Yf(i,t){const{map:e,mapSplitter:n=",",mapJoiner:s}=t.col.setting;if(e){let r=i[0];typeof r=="string"&&n&&(r=r.split(n)),typeof e=="function"?i[0]=e(r,t):typeof e=="object"&&(Array.isArray(r)||(r=[r]),i[0]=r.map(o=>e[o]??o).join(s??n))}return i}function Qf(i,t,e){const n={};return typeof i=="function"?Object.assign(n,i(e)):Object.keys(i).forEach(s=>{var o;const r=(o=e.row.data)==null?void 0:o[i[s]];r!==void 0&&(n[s]=r)}),Object.keys(n).length&&t.push({style:n}),t}function Xf(i,t,e="[yyyy-]MM-dd hh:mm"){const{formatDate:n=e,invalidDate:s}=t.col.setting;return i[0]=Vf(n,t,i[0],s),i}function jc(i,t,e=!1){const{html:n=e}=t.col.setting;if(n===!1)return i;const s=i[0],r=n===!0?s:Fc(n,t,s);return i[0]={html:r},i}const Y_=Kt({name:"rich",colTypes:{html:{onRenderCell(i,t){return jc(i,t,!0)}},progress:{align:"center",onRenderCell(i,{col:t}){const{progressType:e,barColor:n,barBgColor:s,barHeight:r=6,barWidth:o=64,circleSize:a=24,circleBorderSize:l=1,circleBgColor:h="var(--color-border)",circleColor:f="var(--color-success-500)"}=t.setting,d=i[0];return i[0]=e==="bar"?w(Hr,{className:"rounded-full",width:o,height:r,color:n||f,background:s,percent:d}):w(Wr,{percent:d,size:a,circleWidth:l,circleBg:h,circleColor:f,text:!0}),i}},datetime:{formatDate:"[yyyy-]MM-dd hh:mm"},date:{formatDate:"yyyy-MM-dd"},time:{formatDate:"hh:mm"}},onRenderCell(i,t){const{formatDate:e,html:n,hint:s,styleMap:r}=t.col.setting;if(e&&(i=Xf(i,t,e)),i=Yf(i,t),i=Gf(i,t),n?i=jc(i,t):i=qf(i,t),s){let o=t.value;typeof s=="function"?o=s.call(this,t):typeof s=="string"?o=$t(s,t.row.data):typeof i[0]=="string"&&(o=i[0]),i.push({attrs:{title:o}})}return r&&(i=Qf(r,i,t)),i}},{buildIn:!0}),Q_={default:(i,t,e)=>{var r,o;const n=(r=i.data)==null?void 0:r[e.name],s=(o=t.data)==null?void 0:o[e.name];return n===s?0:n==null?1:String(n).localeCompare(String(s))},date:(i,t,e)=>{var r,o;const n=Wt(((r=i.data)==null?void 0:r[e.name])??0),s=Wt(((o=t.data)==null?void 0:o[e.name])??0);return n.getTime()-s.getTime()},number:(i,t,e)=>{var r,o;const n=(r=i.data)==null?void 0:r[e.name],s=(o=t.data)==null?void 0:o[e.name];return Number.parseFloat(n)-Number.parseFloat(s)}},X_=Kt({name:"sort",defaultOptions:{sort:!1},when:i=>!!i.sort,onCreate(){const{sortBy:i}=this.options;i&&(this.state.sortBy=Array.isArray(i)?i:[i])},onAddRows(i,t){const{sortBy:e}=this.state;if(!e||!e.length)return;const{sort:n}=this.options,s={...Q_,...typeof n=="function"?{default:n}:typeof n=="object"?n:{}};return[...i].sort((r,o)=>{for(const{name:a,order:l}of e){const h=t.map[a];if(!h)continue;let f=h.setting.sort;if(f===!0?f=s.default:typeof f=="string"&&(f=s[f]),!f)continue;const d=f.call(this,r,o,h);if(d)return l==="asc"?d:-d}return 0})},onHeaderCellClick(i,t){if(!i.target.closest(".dtable-sort-link"))return;const e=this.getColInfo(t.colName);if(!e||!e.setting.sort)return;const{sortBy:n=[]}=this.state,s=n.findIndex(a=>a.name===e.name),{multiSort:r}=this.options;let o="asc";if(s>=0){const a=n[s].order;a==="asc"?o="desc":a==="desc"&&(o="none"),r&&n.splice(s,1)}r||(n.length=0),this.update({dirtyType:"layout",state:{sortBy:[{name:t.colName,order:o},...n].filter(a=>a.order!=="none")}})},onRenderHeaderCell(i,t){var l;const{col:e}=t,{sortBy:n}=this.state;if(!e.setting.sort)return i;const o=((l=n==null?void 0:n.find(h=>h.name===e.name))==null?void 0:l.order)||"none",a=w("div",{className:`dtable-sort dtable-sort-${o}`});return i[0]=w("a",{className:"dtable-sort-link",href:"javascript:;",children:[i[0],a]}),i.push({outer:!0,attrs:{"data-sort":o}}),i}},{buildIn:!0}),Z_={html:{component:kn}},Zf=Kt({name:"custom",onRenderCell(i,t){const{col:e}=t;let{custom:n}=e.setting;if(typeof n=="function"&&(n=n.call(this,t)),!n)return i;const s=Array.isArray(n)?n:[n],{customMap:r}=this.options;return s.forEach(o=>{let a;typeof o=="string"?a=o.startsWith("<")?{component:kn,props:{html:$t(o,{value:t.value,...t.row.data,$value:t.value})}}:{component:o}:a=o;let{component:l}=a;const h=[a];typeof l=="string"&&h.unshift(Z_[l],r==null?void 0:r[l]);const f={};h.forEach(m=>{if(m){const{props:y}=m;y&&g.extend(f,typeof y=="function"?y.call(this,t):y),l=m.component||l}},{props:{}});const d=l;i[0]={outer:!0,className:"dtable-custom-cell",children:w(d,{...f})}}),i}}),tC="";function J_(i,t){var a,l;typeof i=="boolean"&&(t=i,i=void 0);const e=this.state.checkedRows,n={},{canRowCheckable:s,allowCheckDisabled:r}=this.options,o=(h,f)=>{const d=s?s.call(this,h):!0;!d||!r&&d==="disabled"||!!e[h]===f||(f?e[h]=!0:delete e[h],n[h]=f)};if(i===void 0?(t===void 0&&(t=!Jf.call(this)),(a=this.layout)==null||a.allRows.forEach(({id:h})=>{o(h,!!t)})):(Array.isArray(i)||(i=[i]),i.forEach(h=>{o(h,t??!e[h])})),Object.keys(n).length){const h=(l=this.options.beforeCheckRows)==null?void 0:l.call(this,i,n,e);h&&Object.keys(h).forEach(f=>{const d=s?s.call(this,f):!0;!d||!r&&d==="disabled"||(h[f]?e[f]=!0:delete e[f])}),this.setState({checkedRows:{...e}},()=>{var f;(f=this.options.onCheckChange)==null||f.call(this,n)})}return n}function tv(i){return this.state.checkedRows[i]??!1}function Jf(){var s,r;const i=(s=this.layout)==null?void 0:s.allRows.length;if(!i)return!1;const t=this.getChecks().length,{canRowCheckable:e,allowCheckDisabled:n}=this.options;return e?t===((r=this.layout)==null?void 0:r.allRows.reduce((o,a)=>{const l=e?e.call(this,a.id):!0;return o+(!l||!n&&l==="disabled"?0:1)},0)):t===i}function ev(){var t;const i=new Set((t=this.layout)==null?void 0:t.allRows.map(e=>e.id));return Object.keys(this.state.checkedRows).filter(e=>i.has(e))}function nv(i){const{checkable:t}=this.options;i===void 0&&(i=!t),t!==i&&this.setState({forceCheckable:i})}function tp(i,t,e=!1,n=void 0){return w(zr,{className:"dtable-checkbox",checked:i,disabled:e,label:n})}const ep='input[type="checkbox"],.dtable-checkbox',iv=Kt({name:"checkable",defaultOptions:{checkable:"auto",checkboxRender:tp},when:i=>!!i.checkable,options(i){const{forceCheckable:t}=this.state;return t!==void 0?i.checkable=t:i.checkable==="auto"&&(i.checkable=!!i.cols.some(e=>e.checkbox)),i},state(){return{checkedRows:{}}},methods:{toggleCheckRows:J_,isRowChecked:tv,isAllRowChecked:Jf,getChecks:ev,toggleCheckable:nv},i18n:{zh_cn:{checkedCountInfo:"已选择 {selected} 项",totalCountInfo:"共 {total} 项"},zh_tw:{checkedCountInfo:"已選擇 {selected} 項",totalCountInfo:"共 {total} 項"},en:{checkedCountInfo:"Selected {selected} items",totalCountInfo:"Total {total} items"}},footer:{checkbox(){const i=this.isAllRowChecked();return[w("div",{style:{paddingRight:"calc(3*var(--space))",display:"flex",alignItems:"center"},onClick:()=>this.toggleCheckRows(),children:tp(i,void 0,!1,this.options.checkboxLabel)})]},checkedInfo(i,t){const e=this.getChecks(),{checkInfo:n}=this.options;if(n)return[w(gt,{className:"dtable-check-info",content:n.call(this,e)})];const s=e.length,r=[];return s&&r.push(this.i18n("checkedCountInfo",{selected:s})),r.push(this.i18n("totalCountInfo",{total:t.allRows.length})),[w("div",{className:"dtable-check-info",children:r.join(", ")})]}},onCreate(){const{checkedRows:i}=this.options;i&&this.setState(t=>({checkedRows:{...t.checkedRows,...i.reduce((e,n)=>(e[n]=!0,e),{})}}))},onRenderCell(i,{row:t,col:e}){var h;const{id:n}=t,{canRowCheckable:s}=this.options,r=s?s.call(this,n):!0;if(!r)return i;const{checkbox:o}=e.setting,a=typeof o=="function"?o.call(this,n):o,l=this.isRowChecked(n);if(a){const f=(h=this.options.checkboxRender)==null?void 0:h.call(this,l,n,r==="disabled");i.push(f,{outer:!0,className:"has-checkbox"})}return l&&i.push({outer:!0,className:"is-checked"}),i},onRenderHeaderCell(i,{row:t,col:e}){var o;const{id:n}=t,{checkbox:s}=e.setting;if(typeof s=="function"?s.call(this,n):s){const a=this.isAllRowChecked(),l=(o=this.options.checkboxRender)==null?void 0:o.call(this,a,n);i.push(l,{outer:!0,className:"has-checkbox"})}return i},onHeaderCellClick(i){if(this.data.disableCheckable)return;const t=i.target;if(!t)return;const e=t.closest(ep);e&&this.toggleCheckRows(e.checked)},onCellClick(i,{rowID:t}){if(this.data.disableCheckable)return;const e=g(i.target);if(!e.length||e.closest("btn,a,button.not-checkable,.form-control,.btn").length)return;(e.closest(ep).not(".disabled").length||this.options.checkOnClickRow)&&this.toggleCheckRows(t)}}),sv=Kt({name:"store",defaultOptions:{store:!0},when:i=>!!i.store,data(){return{store:new ps(`DTable:${this.id}`)}}}),iC="",sC="";var np=(i=>(i.unknown="",i.collapsed="collapsed",i.expanded="expanded",i.hidden="hidden",i.normal="normal",i))(np||{});function Ro(i){const t=this.data.nestedMap.get(i);if(!t||t.state!=="")return t??{state:"normal",level:-1};if(!t.parent&&!t.children)return t.state="normal",t;const e=t.children&&this.state.nestedState[i];let n=!1,{parent:s}=t;for(;s;){const r=Ro.call(this,s);if(r.state!=="expanded"){n=!0;break}s=r.parent}return t.state=n?"hidden":e?"collapsed":t.children?"expanded":"normal",t.level=t.parent?Ro.call(this,t.parent).level+1:0,t}function rv(i){return i!==void 0?Ro.call(this,i):this.data.nestedMap}function ov(i,t){let{nestedState:e}=this.state;const{nestedMap:n}=this.data;if(i==="HEADER")if(t===void 0&&(t=!ip.call(this)),t){const s=n.entries();for(const[r,o]of s)o.state==="expanded"&&(e[r]=!0)}else e={};else{const s=Array.isArray(i)?i:[i];t===void 0&&(t=!e[s[0]]),s.forEach(r=>{const o=n.get(r);t&&(o!=null&&o.children)?e[r]=!0:delete e[r]})}this.update({dirtyType:"layout",state:{nestedState:{...e}}},()=>{const{onNestedChange:s,preserveNested:r}=this.options;s==null||s.call(this),r&&this.data.store.set("nestedState",e)})}function ip(){const i=this.data.nestedMap.values();for(const t of i)if(t.state==="expanded")return!1;return!0}function sp(i,t=1,e,n=0){var s;e||(e=[...i.keys()]);for(const r of e){const o=i.get(r);o&&(o.level===n&&(o.order=t++),(s=o.children)!=null&&s.length&&(t=sp(i,t,o.children,n+1)))}return t}function rp(i,t,e,n){const s=i.getNestedRowInfo(t);return!s||s.state===""||!s.children||s.children.forEach(r=>{n[r]=e,rp(i,r,e,n)}),s}function op(i,t,e,n,s){var a;const r=i.getNestedRowInfo(t);if(!r||r.state==="")return;((a=r.children)==null?void 0:a.every(l=>{const h=!!(n[l]!==void 0?n[l]:s[l]);return e===h}))&&(n[t]=e),r.parent&&op(i,r.parent,e,n,s)}const Lo="dtable-nested-toggle",av=Kt({name:"nested",plugins:[sv],requireAfter:["sortable"],defaultOptions:{nested:"auto",nestedParentKey:"parent",asParentKey:"asParent",nestedIndent:20,canSortTo(i,t){const{nestedMap:e}=this.data,n=e.get(i.id),s=e.get(t.id);return(n==null?void 0:n.parent)===(s==null?void 0:s.parent)},beforeCheckRows(i,t,e){if(!this.options.checkable||!(i!=null&&i.length)||this.options.noNestedCheck)return;const n={};return Object.entries(t).forEach(([s,r])=>{const o=rp(this,s,r,n);o!=null&&o.parent&&op(this,o.parent,r,n,e)}),n}},options(i){return i.nested==="auto"&&(i.nested=!!i.cols.some(t=>t.nestedToggle)),i},when:i=>!!i.nested,data(){return{nestedMap:new Map,nestedRowMap:new Map}},state(){return{nestedState:{}}},methods:{getNestedInfo:rv,toggleRow:ov,isAllCollapsed:ip,getNestedRowInfo:Ro},onCreate(){let{defaultNestedState:i}=this.options;if(this.options.preserveNested){const t=this.data.store.get("nestedState");t&&(i=t)}this.state.nestedState=i||{}},beforeLayout(){this.data.nestedMap.clear(),this.data.nestedRowMap.clear()},onAddRow(i){this.data.nestedRowMap.set(i.id,i)},onAddRows(i){const{nestedMap:t,nestedRowMap:e}=this.data;i.forEach(r=>{var h,f;const o=t.get(r.id)??{state:"",level:0};let a=((h=r.data)==null?void 0:h[this.options.nestedParentKey??"parent"])??[];Array.isArray(a)||(a=[a]);let l;for(a=[...a];a.length;){let d=a.pop();if(d===void 0)continue;if(d=String(d),e.get(d)){l=d;break}}if(o.parent=l==="0"?void 0:l,(f=r.data)!=null&&f[this.options.asParentKey??"asParent"]&&(o.children=[]),t.set(r.id,o),l){let d=t.get(l);d||(d={state:"",level:0},t.set(l,d)),d.children||(d.children=[]),d.children.push(r.id)}});const n=new Map,s=i.length*100;return i=i.filter(r=>{const o=this.getNestedRowInfo(r.id);return n.set(r.id,o),o.state!=="hidden"}),sp(n),i.sort((r,o)=>{const a=n.get(r.id),l=n.get(o.id);return((a==null?void 0:a.order)??s+r.index)-((l==null?void 0:l.order)??s+o.index)}),i},onRenderCell(i,t){var h;const{row:e,col:n}=t,{id:s,data:r}=e,{nestedToggle:o,childLabel:a}=n.setting,l=this.getNestedRowInfo(s);if(a){const f=Number(r[this.options.nestedParentKey||"parent"]);if(!Number.isNaN(f)&&f>0){let d;typeof a=="string"?d=w("span",{className:"dtable-child-label label rounded-full size-sm gray-pale",children:$t(a,r)}):d=w(gt,{className:"dtable-child-label",content:a,generatorThis:t}),i.unshift(d)}}if(o&&(l.children||l.parent)&&i.push(((h=this.options.onRenderNestedToggle)==null?void 0:h.call(this,l,s,n,r))??w("a",{className:`${Lo} state${l.children?"":" is-no-child"}`,children:w("span",{className:"toggle-icon"})}),{outer:!0,className:`is-${l.state}`}),l.level){let{nestedIndent:f=o}=n.setting;f&&(f===!0&&(f=this.options.nestedIndent??12),i.push(w("div",{className:"dtable-nested-indent",style:{width:f*l.level+"px"}})))}return i},onRenderHeaderCell(i,{row:t,col:e}){var s;const{id:n}=t;return e.setting.nestedToggle&&i.push(((s=this.options.onRenderNestedToggle)==null?void 0:s.call(this,void 0,n,e,void 0))??w("a",{className:`${Lo} state`,children:w("span",{className:"toggle-icon"})}),{outer:!0,className:`is-${this.isAllCollapsed()?"collapsed":"expanded"}`}),i},onHeaderCellClick(i){const t=i.target;if(!(!t||!t.closest(`.${Lo}`)))return this.toggleRow("HEADER"),!0},onCellClick(i,{rowID:t}){const e=i.target;if(!(!e||!this.getNestedRowInfo(t).children||!e.closest(`.${Lo}`)))return this.toggleRow(t),!0}});function Bc(i,{row:t,col:e}){const{data:n}=t,s=n?n[e.name]:void 0;if(!(s!=null&&s.length))return i;const{avatarClass:r="rounded-full",avatarKey:o=`${e.name}Avatar`,avatarCodeKey:a,avatarNameKey:l=`${e.name}Name`}=e.setting;let{avatarProps:h={}}=e.setting;typeof h=="function"&&(h=h(e,t));const f=(n?n[l]:s)||i[0],d={size:"xs",src:n?n[o]:void 0,text:f,code:a?n?n[a]:void 0:s,...h,className:q(r,h.className,"flex-none")};if(i[0]=w(Ei,{...d}),e.type==="avatarBtn"){const{avatarBtnProps:m}=e.setting,y=typeof m=="function"?m(e,t):m;i[0]=w("button",{type:"button",className:"btn btn-avatar",...y,children:[i[0],w("div",{children:f})]})}else e.type==="avatarName"&&(i[0]=w("div",{className:"flex items-center gap-1",children:[i[0],w("span",{children:f})]}));return i}const lv=Kt({name:"avatar",colTypes:{avatar:{onRenderCell:Bc},avatarBtn:{onRenderCell:Bc},avatarName:{onRenderCell:Bc}}},{buildIn:!0}),cv=Kt({name:"sort-type",defaultOptions:{sortType:!0},when:i=>!!i.sortType&&!i.sort,onRenderHeaderCell(i,t){const{col:e}=t,{setting:n}=e;let{sortType:s}=n;if(e.setting.sort!==void 0||s===!1)return i;const{sortLink:r,orderBy:o}=this.options;if(o&&o[e.name]!==void 0&&(s=o[e.name]),s){const a=s===!0?"none":s,l=w("div",{className:`dtable-sort dtable-sort-${a}`});i.push({outer:!0,attrs:{"data-sort":a}});let{sortLink:h=r}=n;if(h){const f=a==="asc"?"desc":"asc";typeof h=="function"&&(h=h.call(this,e,f,a)),typeof h=="string"&&(h={url:h});const{url:d,...m}=h;i[0]=w("a",{className:"dtable-sort-link",href:$t(d,{...n,sortType:f}),...m,children:[typeof i[0]!="object"||E.isValidElement(i[0])?i[0]:e.name,l]})}else i.push(l)}return i}},{buildIn:!0}),Hc=i=>{i.length!==1&&i.forEach((t,e)=>{!e||t.border!==void 0||t.setting.group===i[e-1].setting.group||(t.border="left")})},hv=Kt({name:"group",defaultOptions:{groupDivider:!0},when:i=>!!i.groupDivider,onLayout(i){if(!this.options.groupDivider)return;const{cols:t}=i;Hc(t.left.list),Hc(t.center.list),Hc(t.right.list)}}),cC="",uv=Kt({name:"header-group",defaultOptions:{headerGroup:!0},data(){return{headerGroups:new Map}},when:i=>!!i.headerGroup,beforeLayout(i){const{headerGroups:t}=this.data;t.clear();const{cols:e}=i;if(!(e!=null&&e.length))return;const n={};return e.forEach((s,r)=>{const{headerGroup:o}=s;if(!o){n[s.name]=r;return}let a=t.get(o);a?a.cols.push(s.name):(a={cols:[s.name],index:r},t.set(o,a)),n[s.name]=a.index+a.cols.length/e.length}),e.sort((s,r)=>n[s.name]-n[r.name]),{headerHeight:!i.headerHeight&&i.rowHeight?i.rowHeight*2:void 0,cols:e}},onRenderHeaderCell(i,{col:t}){const{headerGroup:e}=t.setting;if(e){const n=this.data.headerGroups.get(e),s=this.layout.headerHeight/2;if(t.name===n.cols[0]){const r=n.cols.reduce((a,l)=>{var h;return a+(((h=this.getColInfo(l))==null?void 0:h.realWidth)??0)},0),o={height:s-1,width:r-1};i.push(w("div",{class:"dtable-header-group",style:o,children:e}))}i.push({className:"dtable-header-as-group",style:{paddingTop:s}})}return i}}),dv=Kt({name:"cellspan",when:i=>!!i.getCellSpan,data(){return{cellSpanMap:new Map,overlayedCellSet:new Set}},onLayout(i){const{getCellSpan:t}=this.options;if(!t)return;const{cellSpanMap:e,overlayedCellSet:n}=this.data,{rows:s,cols:r,rowHeight:o}=i;e.clear(),n.clear();const a=(l,h,f)=>{const{index:d}=h;l.forEach((m,y)=>{const{index:b}=m,S=`C${b}R${d}`;if(n.has(S))return;const x=t.call(this,{row:h,col:m});if(!x)return;const k=Math.min(x.colSpan||1,l.length-y),T=Math.min(x.rowSpan||1,s.length-f);if(k<=1&&T<=1)return;let j=0;for(let B=0;B<k;B++){j+=l[y+B].realWidth;for(let K=0;K<T;K++){const G=`C${b+B}R${d+K}`;G!==S&&n.add(G)}}e.set(S,{colSpan:k,rowSpan:T,width:j,height:o*T})})};s.forEach((l,h)=>{["left","center","right"].forEach(f=>{a(r[f].list,l,h)})})},onRenderCell(i,{row:t,col:e}){const n=`C${e.index}R${t.index}`;if(this.data.overlayedCellSet.has(n))i.push({outer:!0,style:{display:"none",className:"cellspan-overlayed-cell"}});else{const s=this.data.cellSpanMap.get(n);s&&i.push({outer:!0,style:{width:s.width,height:s.height}})}return i}}),Oo=Kt({name:"mousemove",events:{click(i){this.data.ignoreNextClick&&(i.preventDefault(),this.data.ignoreNextClick=void 0)},mousedown(){this.data.ignoreNextClick&&clearTimeout(this.data.ignoreNextClick)},mousemove(i){this.data.mmRafID&&(cancelAnimationFrame(this.data.mmRafID),this.data.mmRafID=0),this.data.mmRafID=requestAnimationFrame(()=>{this.emitCustomEvent("mousemovesmooth",i)}),i.preventDefault()},document_mousemove(i){this.data.dmmRafID&&(cancelAnimationFrame(this.data.dmmRafID),this.data.dmmRafID=0),this.data.dmmRafID=requestAnimationFrame(()=>{this.emitCustomEvent("document_mousemovesmooth",i)})}},methods:{ignoreNextClick(i=10){this.data.ignoreNextClick=window.setTimeout(()=>{this.data.ignoreNextClick=void 0},i)}}});function fv(){var j,B,K,G;const{scrollToMouse:i}=this.data;if(!i)return this.stopScrollToMouse();const{position:t,startTime:e,delay:n}=i;if(!t||Date.now()-e<n)return;const s=(B=(j=this.ref.current)==null?void 0:j.querySelector(".dtable-body"))==null?void 0:B.getBoundingClientRect();if(!s)return;const r=(G=(K=this.ref.current)==null?void 0:K.querySelector(".dtable-scroll-center"))==null?void 0:G.getBoundingClientRect(),{maxStep:o,detectPadding:a,speed:l,side:h}=i,{x:f,y:d}=t,{top:m,bottom:y}=s,{left:b,right:S}=r||s;let x=0;f<b-a?x=-Math.max(o,b-a-f):f>S-a&&(x=Math.max(o,f-(S-a)));let k=0;if(d<m-a?k=-Math.max(o,m-a-d):d>y-a&&(k=Math.max(o,d-(y-a))),h){const Q=new Set((Array.isArray(h)?h:[h]).reduce((Z,tt)=>(tt==="x"?Z.push("left","right"):tt==="y"?Z.push("top","bottom"):Z.push(tt),Z),[]));(!Q.has("left")&&x<0||!Q.has("right")&&x>0)&&(x=0),(!Q.has("top")&&k<0||!Q.has("bottom")&&k>0)&&(k=0)}const T={};x!==0&&(T.scrollLeft=this.layout.scrollLeft+l*x),k!==0&&(T.scrollTop=this.layout.scrollTop+l*k),this.scroll(T)}const ap=Kt({name:"autoscroll",plugins:[Oo],events:{document_mousemovesmooth(i){if(!this.data.scrollToMouse)return;const{clientX:t,clientY:e}=i;this.data.scrollToMouse.position={x:t,y:e}}},methods:{scrollTo({col:i,row:t,extra:e=2}){const n=this.getColInfo(i),s=this.getRowInfo(t);if(!n&&!s)return!1;const r={},{layout:o}=this;if(n){const{scrollLeft:a,cols:l}=o,h=n.left+n.realWidth;n.left<a?r.scrollLeft=n.left-e:h>l.center.width+a&&(r.scrollLeft=h-l.center.width+e)}if(s){const{scrollTop:a,rowHeight:l,rowsHeight:h}=o,f=s.top+l;s.top<a?r.scrollTop=s.top-e:f>h+a&&(r.scrollTop=f-h+e)}return this.scroll(r),!0},startScrollToMouse(i){const t={interval:60,speed:.5,delay:200,maxStep:this.options.rowHeight,onlyInside:!1,detectPadding:30,startTime:Date.now(),...i};this.data.scrollToMouse=t,clearInterval(this.data.scrollToTimer),this.data.scrollToTimer=window.setInterval(fv.bind(this),t.interval)},stopScrollToMouse(){clearInterval(this.data.scrollToTimer),this.data.scrollToMouse=void 0}},onUnmounted(){clearInterval(this.data.scrollToTimer)}}),pC="",pv=Kt({name:"sortable",defaultOptions:{sortable:!0},when:i=>!!i.sortable,plugins:[Oo,ap],resetState:!0,state(){return{rowOrders:void 0,sortingFrom:void 0,sortingPos:void 0,sortingTo:void 0,sortingSide:void 0}},events:{click(i){i.target.closest(".dtable-sort-link")&&(this.state.rowOrders=void 0)},mousedown(i){var a;if(this.data.disableSortable)return;const{sortHandler:t=".dtable-cell"}=this.options;if(!g(i.target).closest(t).length)return;const s=this.getPointerInfo(i);if(!s||s.rowID==="HEADER")return;const r=this.getRowInfo(s.rowID);if(!r||((a=this.options.onSortStart)==null?void 0:a.call(this,r,i))===!1)return;i.preventDefault();const o=i.clientY;this.data.sortableInfo={from:r,offset:o-s.cellElement.getBoundingClientRect().top,startMouseY:o,lastMouseY:o}},document_mouseup(i){var n;const{sortableInfo:t}=this.data;if(!t)return;this.stopScrollToMouse();const e=this.getSortingState(i);if(e){let s,r;const{sortingFrom:o,sortingTo:a,sortingSide:l}=e;if(a&&l){const h=this.layout.rows.map(y=>y.id),f=[...h],d=o.index,m=a.index;if(!(d===m+1&&l==="after")&&!(d===m-1&&l==="before")){const y=h.splice(d,1);h.splice(m,0,y[0]),s={},r=[],h.forEach((b,S)=>{s[b]=S,r.push(b)}),(f.join()===r.join()||((n=this.options.onSort)==null?void 0:n.call(this,o,a,l,r))===!1)&&(s=void 0,r=void 0)}}(a||Math.abs(t.lastMouseY-t.startMouseY)>4)&&this.ignoreNextClick(),this.disableAnimation(),this.update({dirtyType:"layout",state:h=>g.extend({sortingFrom:void 0,sortingPos:void 0,sortingTo:void 0,sortingSide:void 0},s?{rowOrders:{...h.rowOrders,...s}}:null)},()=>{var h;(h=this.options.onSortEnd)==null||h.call(this,o,a,l,r),setTimeout(()=>{this.data.disableCheckable=void 0},50)})}this.data.sortableInfo=void 0},document_mousemovesmooth(i){const{sortableInfo:t}=this.data;if(!t)return;const e=this.getSortingState(i);e&&(t.state||(this.startScrollToMouse({side:"y"}),this.data.disableCheckable=!0),t.lastMouseY=i.clientY,t.state=e,this.setState(e))}},methods:{getSortingState(i){var G;const{disableSortable:t,sortableInfo:e}=this.data;if(t||!e)return;const{headerHeight:n,footerHeight:s,visibleRows:r,scrollTop:o,rowHeight:a}=this.layout,l=this.element.getBoundingClientRect(),h=l.width,f=l.height-n-s,d=i.clientX-l.left,m=i.clientY-l.top-n;if(d<0||d>h||m<0||m>f)return e.state;const y=m+o,b=r.find(Q=>Q.top<=y&&Q.top+a>y);if(!b)return e.state;const S=e.from,x=b.id!==S.id?b.id:void 0,k=x?this.getRowInfo(x):void 0,T=m,j=y<b.top+a/2?"before":"after";return k&&((G=this.options.canSortTo)==null?void 0:G.call(this,S,k,j))!==!1?{sortingFrom:S,sortingPos:T,sortingTo:k,sortingSide:j}:{sortingFrom:S,sortingPos:T,sortingTo:void 0,sortingSide:void 0}}},onAddRows(i){const{rowOrders:t}=this.state;if(!t)return;const e=i.length*100;return i=i.sort((n,s)=>{const r=t[n.id]??e+n.index,o=t[s.id]??e+s.index;return r-o}),i},beforeRender(i){const{sortingFrom:t}=this.state,{visibleRows:e}=i;t&&(e.some(n=>n.id===t.id)||(i.visibleRows=[...e,t]),i.className=q(i.className,"dtable-sorting"))},onRenderCell(i,t,e){const{sortingFrom:n,sortingPos:s,sortingTo:r,sortingSide:o}=this.state;if(!n)return i;const a=t.row,l={},h=[];if(n.id===a.id)l.top=s-this.data.sortableInfo.offset+((e.top??a.top)-(a.top-this.layout.scrollTop)),h.push("is-sorting-from");else if(r){const f=r.id===a.id;f&&h.push(`text-primary is-sorting-to is-sorting-to-${o}`),n.index>a.index&&(f&&o==="before"||a.index>r.index)?h.push("is-sorting-before"):n.index<a.index&&(f&&o==="after"||a.index<r.index)&&h.push("is-sorting-after")}return h.length&&i.push({outer:!0,style:l,className:h}),i}}),mv=Object.freeze(Object.defineProperty({__proto__:null,NestedRowState:np,avatar:lv,cellspan:dv,checkable:iv,custom:Zf,group:hv,headerGroup:uv,nested:av,renderDatetime:Vf,renderDatetimeCell:Xf,renderFormat:Fc,renderFormatCell:Gf,renderHtmlCell:jc,renderLink:zc,renderLinkCell:qf,renderMapCell:Yf,renderStyleMapCell:Qf,rich:Y_,sort:X_,sortType:cv,sortable:pv},Symbol.toStringTag,{value:"Module"}));class Yi extends mt{setOptions(t,e){return t=super.setOptions(t,e),t.parent||(t.parent=this.element),t}}Yi.NAME="DTable",Yi.Component=Oc,Yi.definePlugin=Kt,Yi.removePlugin=Af,Yi.plugins=mv;const gC="",yC="",_C="",vC="",bC="",wC="",CC="";class Wc extends Ft{_getClassName(t){return["kanban-header-col",t.className,t.subCols?"has-subs":"",t.parentName!==void 0?"is-sub":""]}_getProps(t){const{width:e,color:n,name:s,gapLeft:r,gapRight:o}=t;return vt(super._getProps(t),{style:{"--kanban-col-color":n,"--kanban-col-width":Bt(e),"--kanban-col-gap-left":Bt(r),"--kanban-col-gap-right":Bt(o)},"z-col":s})}_getChildren(t){const{prefix:e,prefixClass:n,title:s,titleClass:r,titleAlign:o="center",subtitle:a,subtitleClass:l,icon:h,trailingIcon:f,actions:d,subCols:m}=t;return[w("div",{className:`kanban-header-col-wrapper is-align-${o}`,children:[w("div",{className:"kanban-header-title",children:[h?w(Ht,{className:"as-leading-icon",icon:h},"icon"):null,e?w("span",{className:q("as-prefix",n),children:w(gt,{content:e})},"prefix"):null,s?w("span",{className:q("as-title",r),title:typeof s=="string"?s:void 0,children:w(gt,{content:s})},"title"):null,a?w("span",{className:q("as-subtitle",l),children:w(gt,{content:a})},"subtitle"):null,f?w(Ht,{className:"as-trailing-icon",icon:f},"trailingIcon"):null]},"title"),Zt.render(d,[t],{key:"actions",className:"kanban-header-col-actions",size:"sm"},this)]},"wrapper"),m?w("div",{className:"kanban-header-sub-cols",children:m.map((y,b)=>w(Wc,{index:b,...y},y.name))},"subs"):null]}}class gv extends Tt{constructor(){super(...arguments),this._ref=kt()}componentDidMount(){this._ref.current&&(this._sticky=nl.ensure(this._ref.current,{scrollContainer:".kanban-list"}))}componentWillUnmount(){var t;(t=this._sticky)==null||t.destroy()}render(t){return w("div",{className:"kanban-header",ref:this._ref,children:[w("div",{className:"kanban-header-lane-name"},"name"),w("div",{className:"kanban-header-cols",children:t.cols.map((e,n)=>w(Wc,{index:n,...e},e.name))},"cols")]})}}class lp extends Tt{constructor(){super(...arguments),this._listRef=kt(),this._renderItem=t=>{const{itemRender:e,lane:n,name:s}=this.props;return e.call(this,{item:t,lane:n,col:s})},this._handleScroll=t=>{const{current:e}=this._listRef;e&&g(e).trigger("laneColScroll",t)}}componentDidMount(){const{current:t}=this._listRef;t&&(this._ob=new ResizeObserver(e=>{g(this._listRef.current).trigger("laneColResize",e[0])}),this._ob.observe(t))}componentWillUnmount(){var t;(t=this._ob)==null||t.disconnect()}render(t){const{items:e}=t,{width:n,color:s,content:r,contentClass:o,itemRender:a,itemGap:l,watchSize:h,name:f,lane:d,itemCountPerRow:m,gapLeft:y,gapRight:b,laneColClass:S}=t,x={"--kanban-col-color":s,"--kanban-col-width":Bt(n),"--kanban-col-gap-left":Bt(y),"--kanban-col-gap-right":Bt(b)};return w("div",{className:q("kanban-lane-col",S),style:x,"z-lane":d,"z-col":f,children:[r?w("div",{className:q("kanban-col-content",o),children:w(gt,{content:r,generatorThis:this,generatorArgs:[t]})}):null,w("div",{className:"kanban-items scrollbar-thin scrollbar-hover",onScroll:this._handleScroll,children:w(qi,{forwardRef:h?this._listRef:void 0,itemProps:{className:"kanban-item card-list-item"},items:e,itemRender:a?this._renderItem:void 0,countPerRow:m,gap:l},"list")})]})}}lp.defaultProps={watchSize:!0};class yv extends Ft{_getClassName(t){const{className:e,index:n,maxHeight:s,height:r}=t;return["kanban-lane",e,{"is-first":!n,"is-auto-height":!s&&(!r||r==="auto")}]}_getProps(t){const{height:e,minHeight:n,maxHeight:s,color:r,name:o,gapTop:a,gapBottom:l}=t;return vt(super._getProps(t),{style:{"--kanban-lane-color":r,height:Bt(e),minHeight:Bt(n),maxHeight:Bt(s),"--kanban-col-gap-top":Bt(a),"--kanban-col-gap-bottom":Bt(l)},"z-lane":o})}_renderCol(t,e,n,s,r){if(r){const o=r(t,e);o&&(e={...e,...o})}return w(lp,{itemRender:n,lane:t.name,items:s[e.name],...e},e.name)}_getChildren(t){const{title:e,titleClass:n,actions:s,cols:r,items:o={},hideName:a,itemRender:l,getLaneCol:h}=t;return[a?null:w("div",{className:"kanban-lane-name",children:[Zt.render(s,[t],{key:"actions",className:"kanban-lane-actions",size:"sm"},this),w("div",{className:q("kanban-lane-title",n),title:typeof e=="string"?e:void 0,children:w(gt,{content:e})},"title")]},"name"),w("div",{className:"kanban-lane-cols",children:r.reduce((f,d)=>(d.subCols?d.subCols.forEach(m=>{f.push(this._renderCol(t,m,l,o,h))}):f.push(this._renderCol(t,d,l,o,h)),f),[])},"cols")]}}function _v(i){const{lanes:t,cols:e,items:n={},itemRender:s,hideLaneName:r,getLaneCol:o}=i;return w("div",{className:"kanban-body",children:t.map((a,l)=>w(yv,{index:l,cols:e,items:n[a.name],hideName:r,itemRender:s,getLaneCol:o,...a},a.name))})}const Ee=12,vv={left:"right",right:"left",top:"bottom",bottom:"top","":""},Rn=({from:i,to:t,fromKanban:e,toKanban:n})=>`${e?`${e}_`:""}${i}-${n?`${n}_`:""}${t}`;function cp(i,t){return t==="top"?{x:i.x+i.width/2,y:i.y}:t==="left"?{x:i.x,y:i.y+i.height/2}:t==="right"?{x:i.x+i.width,y:i.y+i.height/2}:{x:i.x+i.width/2,y:i.y+i.height}}function bv(i,t){return(i.x-t.x)*(i.x-t.x)+(i.y-t.y)*(i.y-t.y)}function wv(i,t,e,n){const s=e?[e]:["left","right","top","bottom"],r=n?[n]:["left","right","top","bottom"];let o=Number.MAX_SAFE_INTEGER,a={x:0,y:0},l={x:0,y:0};return s.forEach(h=>{r.forEach(f=>{const d=cp(i,h),m=cp(t,f),y=bv(d,m)*(vv[h]===f?1:2);y<o&&(o=y,e=h,n=f,a=d,l=m)})}),{fromSide:e,toSide:n,fromPos:a,toPos:l}}function Cv(i,t){return{x:(i.x+t.x)/2,y:(i.y+t.y)/2}}function hp(i,t){return{x:Math.min(i.x,t.x),y:Math.min(i.y,t.y),width:Math.abs(i.x-t.x),height:Math.abs(i.y-t.y)}}function up(i,t,e){const n={id:`marker-${t}-${e}-${i}`,orient:"auto",markerUnits:"strokeWidth",refX:t==="start"?0:6,refY:3,markerWidth:6,markerHeight:6,path:{d:"",fill:"currentColor"}};return i==="arrow"?t==="start"?n.path.d="M6,0 L6,6 L0,3 z":n.path.d="M0,0 L0,6 L6,3 z":i==="dot"?n.path.d="M3,3 m-3,0 a 3,3 0 1,1 6,0 a 3,3 0 1,1 -6,0":i==="square"?n.path.d="M0,0 L0,6 L6,6 L6,0 z":i==="diamond"&&(n.path.d="M3,0 L6,3 L3,6 L0,3 z"),n}function kv(i,t,e,n,s="curve",r=2,o=1){const{x:a,y:l,width:h,height:f}=hp(i,t),d=Ee-a,m=Ee-l;if(s==="curve"){const y=h*(1+Math.max(-.3,Math.min(.3,1-h/50)))*o,b=f*(1+Math.max(-.3,Math.min(.3,1-f/50)))*o,S=r*5,x={a1x:i.x+(e==="left"?-S:e==="right"?S:0),a1y:i.y+(e==="top"?-S:e==="bottom"?S:0),ax:i.x+(e==="left"?-y:e==="right"?y:0),ay:i.y+(e==="top"?-b:e==="bottom"?b:0),bx:t.x+(n==="left"?-(y-S):n==="right"?y-S:0),by:t.y+(n==="top"?-(b-S):n==="bottom"?b-S:0),b1x:t.x+(n==="left"?-S:n==="right"?S:0),b1y:t.y+(n==="top"?-S:n==="bottom"?S:0)};return`M ${i.x+d} ${i.y+m} L ${x.a1x+d} ${x.a1y+m} C ${x.ax+d} ${x.ay+m} ${x.bx+d} ${x.by+m} ${x.b1x+d} ${x.b1y+m} L ${t.x+d} ${t.y+m}`}if(s==="fold"){const y=Cv(i,t),b=h/2,S=f/2,x={ax:i.x+(e==="left"?-b:e==="right"?b:0),ay:i.y+(e==="top"?-S:e==="bottom"?S:0),bx:t.x+(n==="left"?-b:n==="right"?b:0),by:t.y+(n==="top"?-S:n==="bottom"?S:0)};return`M ${i.x+d} ${i.y+m} L ${x.ax+d} ${x.ay+m} L ${y.x+d} ${y.y+m} L ${x.bx+d} ${x.by+m} L ${t.x+d} ${t.y+m}`}return`M ${i.x+d} ${i.y+m} L ${t.x+d} ${t.y+m}`}function Sv(i){const{fromRect:t,toRect:e}=i,n=Rn(i),s={x:t.left,y:t.top,width:t.right-t.left,height:t.bottom-t.top},r={x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top},{fromSide:o,toSide:a,fromPos:l,toPos:h}=wv(s,r),f=hp(l,h),{x:d,y:m,width:y,height:b}=f;l.x+=Ee-d,l.y+=Ee-m,h.x+=Ee-d,h.y+=Ee-m;const{weight:S=1.5,fromPoint:x,toPoint:k="arrow"}=i,T={left:`${0-Ee}px`,top:`${0-Ee}px`,width:`${y+2*Ee}px`,height:`${b+2*Ee}px`},j={"stroke-width":S,fill:"transparent",stroke:"currentColor","stroke-linejoin":"round","marker-start":x&&x!=="none"?`url(#marker-start-${n}-${x})`:void 0,"marker-end":k&&k!=="none"?`url(#marker-end-${n}-${k})`:void 0,d:kv(l,h,o,a,i.shape,S)},B={"stroke-width":S+5,"stroke-linejoin":"round",fill:"transparent",stroke:"currentColor",d:j.d,class:"opacity-0"},K={width:y+2*Ee,height:b+2*Ee},G=[];return i.lineStyle==="dashed"?j["stroke-dasharray"]=`${S*3} ${S*3}`:i.lineStyle==="dotted"&&(j["stroke-dasharray"]=`${S} ${S}`),x&&x!=="none"&&G.push(up(x,"start",n)),k&&k!=="none"&&G.push(up(k,"end",n)),{x:d,y:m,width:y,height:b,fromSide:o,toSide:a,fromPos:l,toPos:h,nodeStyle:T,svgPathProps:j,svgPathBackProps:B,svgProps:K,markers:G,padding:Ee}}class dp extends Tt{constructor(){super(...arguments),this.state={},this._handleMouseHover=t=>{this.setState({hover:t.type==="mouseenter"})},this._onDelete=()=>{var t;(t=this.props.onDelete)==null||t.call(this,this.props)}}render(t,e){const{text:n,textSize:s,color:r,onDelete:o,weight:a=1.5,from:l,to:h}=t,{hover:f}=e,{x:d,y:m,padding:y,width:b,height:S,svgProps:x,markers:k,svgPathProps:T,svgPathBackProps:j,fromPos:B}=Sv(t);return w("div",{className:q("kanban-link",f?"is-hover":""),style:{left:d,top:m,width:b,height:S,color:r,"--kanban-link-weight":a},"z-from":l,"z-to":h,onMouseEnter:o?this._handleMouseHover:void 0,onMouseLeave:o?this._handleMouseHover:void 0,children:[w("svg",{...x,xmlns:"http://www.w3.org/2000/svg",version:"1.1",children:[k.length?w("defs",{children:k.map(({path:K,id:G,...Q})=>w("marker",{...Q,id:G,children:w("path",{...K})},G))}):null,w("path",{...j}),w("path",{...T})]}),w("div",{className:"kanban-link-start-point",style:{left:B.x-y,top:B.y-y}}),o?w("div",{className:"kanban-link-delete-btn",children:w("button",{type:"button",className:"btn rounded-full size-sm square primary",onClick:this._onDelete,children:w("i",{className:"close"})})}):null,n?w("div",{className:"kanban-link-text",style:{fontSize:`${s||12}px`},children:n}):null]})}}const Is=".kanban";class xv extends Tt{constructor(){super(...arguments),this._ref=kt(),this.state={}}componentDidMount(){const t=this._ref.current,{container:e=".kanban"}=this.props,n=t.closest(e),s=g(n);this._container=n,this._multiKanban=s.find(".kanban").length>1;const r=".kanban-item,.kanban-link-editor-from";s.on(`mouseenter${Is}`,r,o=>{if(this.state.dragPos)return;clearTimeout(this._leaveTimer);const a=g(o.target).closest(r),l=a.z("key");this.state.from===l||a.hasClass("is-dragging")||this.setState({from:l,fromKanban:this._multiKanban?a.closest(".kanban").z("key"):void 0,to:void 0,fromRect:this._getRect(a.children()[0]),dragPos:void 0})}).on(`mouseleave${Is}`,r,()=>{this.state.dragPos||(clearTimeout(this._leaveTimer),this._leaveTimer=window.setTimeout(()=>{this._cancelHover(),this._leaveTimer=0},200))}).on(`dragstart${Is}`,".kanban-item",()=>{this.state.dragPos||this._cancelHover()}).on(`laneColScroll${Is}`,o=>{const{from:a}=this.state;a&&this.setState({fromRect:this._getRect(g(o.target).find(`.kanban-item[z-key="${a}"]`).children()[0])})}),this._moveable=new bs(t,{selector:".kanban-link-editor-point",move:"none",onMoveStart:()=>{if(!this.state.from)return!1;s.addClass("is-adding-link")},onMove:o=>{const{top:a,left:l}=n.getBoundingClientRect(),h={left:o.clientX-l+n.scrollLeft,top:o.clientY-a+n.scrollTop};let f,d,m;const y=g(o.target).closest(r);y.length&&f!==this.state.from&&(f=y.attr("z-key"),m=this._multiKanban?y.closest(".kanban").z("key"):void 0,d=this._getRect(y.children()[0])),this.setState({dragPos:h,to:f,toKanban:m,toRect:d})},onMoveEnd:()=>{const{from:o,fromKanban:a,to:l,toKanban:h}=this.state,{onAddLink:f}=this.props;(o!==l||a!==h)&&f&&o!==void 0&&l!==void 0&&(f==null||f.call(this,{from:o,fromKanban:a,to:l,toKanban:h})),this._cancelHover(),s.removeClass("is-adding-link")}})}componentWillUnmount(){var e;const t=(e=this._ref.current)==null?void 0:e.closest(".kanban");t&&g(t).off(Is),this._raf&&cancelAnimationFrame(this._raf)}_getRect(t){const e=t.getBoundingClientRect(),n=this._container,{top:s,left:r}=n.getBoundingClientRect();return{left:e.left-r+n.scrollLeft,top:e.top-s+n.scrollTop,width:e.width,height:e.height}}_cancelHover(){this.setState({from:void 0,to:void 0,fromRect:void 0,dragPos:void 0})}_renderLink(t){const{fromRect:e,toRect:n,from:s,to:r="",dragPos:o}=t;if(!e||!s||!o)return null;const a=n?{left:n.left,top:n.top,right:n.left+n.width,bottom:n.top+n.height}:{left:o.left,top:o.top,right:o.left,bottom:o.top};return w(dp,{from:s,to:r,lineStyle:"dotted",color:"var(--color-primary-500)",fromRect:{left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},toRect:a},"link")}render(t,e){const{from:n,fromRect:s,to:r,toRect:o}=e;let a,l;return n&&s&&(a=w("div",{className:"kanban-link-editor-from not-moveable","z-key":n,style:s,children:[w("div",{className:"kanban-link-editor-point is-left"}),w("div",{className:"kanban-link-editor-point is-top"}),w("div",{className:"kanban-link-editor-point is-right"}),w("div",{className:"kanban-link-editor-point is-bottom"})]})),r&&o&&(l=w("div",{className:"kanban-link-editor-to","z-key":r,style:o})),w("div",{className:q("kanban-link-editor"),ref:this._ref,children:[a,l,this._renderLink(e)]})}}const Kc=".kanban";class fp extends Tt{constructor(){super(...arguments),this._ref=kt(),this._watchSet=new Set,this.state={layout:{},scrollTop:0,scrollLeft:0}}componentDidMount(){var s;const{container:t=".kanban"}=this.props,e=(s=this._ref.current)==null?void 0:s.closest(t),n=g(e);this._multiKanban=n.find(".kanban").length>1,n.on(`laneColResize${Kc} laneColScroll${Kc}`,()=>{this._tryUpdateLayout()}),this._container=e,this._tryUpdateLayout()}componentWillUnmount(){const t=this._container;t&&g(t).off(Kc),this._raf&&cancelAnimationFrame(this._raf)}componentDidUpdate(t){(t.links!==this.props.links||t.filters!==this.props.filters)&&this._tryUpdateLayout()}_tryUpdateLayout(){this._raf&&cancelAnimationFrame(this._raf),this._raf=requestAnimationFrame(()=>{this._updateLayout(),this._raf=0})}_updateLayout(){const t=[...this._watchSet],e=this._container,n=g(e),{top:s,left:r}=e.getBoundingClientRect(),o=e.scrollTop-s,a=e.scrollLeft-r,l={};t.forEach(h=>{const[f,d]=h.split("_"),m=n.find(`${this._multiKanban?`.kanban[z-key="${f}"] `:""}.kanban-item[z-key="${d}"]`).children()[0];if(m&&hs(m,{container:".kanban-lane-col"})){const{top:y,left:b,bottom:S,right:x}=m.getBoundingClientRect();l[h]={top:y+o,left:b+a,bottom:S+o,right:x+a}}}),this.setState({layout:l})}_renderLink(t){const{layout:e}=this.state,{from:n,fromKanban:s="",to:r,toKanban:o=""}=t,a=`${s}_${n}`,l=`${o}_${r}`,h=e[a],f=e[l];return this._watchSet.add(a),this._watchSet.add(l),!h||!f?null:w(dp,{...t,fromRect:h,toRect:f,onDelete:this.props.onDeleteLink},`${n}-${r}`)}_renderLinks(t){const{links:e,filters:n}=t,s=new Set(n),r=o=>{const{from:a,to:l,fromKanban:h="",toKanban:f=""}=o;return this._multiKanban?s.has(`${h}_${a}`)||s.has(`${f}_${l}`)||s.has(h)||s.has(f)||s.has(Rn(o)):s.has(a)||s.has(l)||s.has(`${a}-${l}`)};return e.reduce((o,a)=>{if(!n||r(a)){const l=this._renderLink(a);l&&o.push(l)}return o},[])}_renderEditor(t){const{editLinks:e,onAddLink:n,container:s}=t;return e?w(xv,{container:s,onAddLink:n},"editor"):null}render(t){return this._watchSet.clear(),w("div",{className:"kanban-links",ref:this._ref,children:[this._renderLinks(t),this._renderEditor(t)]})}}function $v(i,t,e){if(!i||!i.length)return[];const{getCol:n,colProps:s,itemCountPerRow:r,itemGap:o}=t;let a=!1;const l=[],h=new Map;return i=i.reduce((f,d,m)=>{if(d=vt({itemGap:o,itemCountPerRow:r},s,d),n){const y=n.call(this,d);y!==!1&&(d=y||d)}return d.deleted||(typeof d.order=="number"?a=!0:d.order=m,typeof d.name!="string"&&(d.name=String(d.name)),e==null||e.call(this,d),d.parentName!==void 0?(d.parentName=String(d.parentName),l.push(d)):(h.set(d.name,d),f.push(d))),f},[]),l.forEach(f=>{const d=h.get(f.parentName);d&&(d.subCols=un(d.subCols,[f],"name"))}),a&&(i.sort(Ds),[...h.values()].forEach(f=>{f.subCols&&f.subCols.sort(Ds)})),i}function Tv(i,t,e){if(!i||!i.length)return[];const{getLane:n,laneProps:s}=t;let r=!1;return i=i.reduce((o,a,l)=>{if(s&&(a=vt({},s,a)),n){const h=n.call(this,a);h!==!1&&(a=h||a)}return a.deleted||(typeof a.order=="number"?r=!0:a.order=l,a.color===void 0&&(a.color=`hsl(${43*pl(a.name)%360}deg 40% 50%)`),typeof a.name!="string"&&(a.name=String(a.name)),e==null||e.call(this,a),o.push(a)),o},[]),r&&i.sort(Ds),i}function pp(i,t,e,n,s){if(!(i!=null&&i.length))return[];const{itemProps:r,getItem:o}=n;let a=!1;return i=i.reduce((l,h)=>{r&&(h=vt({},r,h));const f=(o==null?void 0:o.call(this,{col:e.name,lane:t.name,item:h,laneInfo:t,colInfo:e}))??h;return f!==!1&&!f.deleted&&(typeof f.order=="number"?a=!0:f.order=l.length-1,l.push(f),s==null||s.call(this,f)),l},[]),a&&i.sort(Ds),i}function Ds(i,t){return i.order-t.order}function un(i,t,e="key"){if(!i)return t?[...t]:[];const n=[...i];if(t){let s=0;const r=n.reduce((o,a,l)=>(o.set(String(a[e]??l),l),s=Math.max(a.order??l,s),o),new Map);t.forEach(o=>{const a=String(o[e]);r.has(a)?n[r.get(a)]={...n[r.get(a)],...o}:n.push({order:s++,...o})})}return n}function mp(i,t){return Array.isArray(i)?i.map(e=>({...e,[t]:String(e[t])})):Object.keys(i).reduce((e,n)=>{const s=i[n];return Object.keys(s).forEach(r=>{e.push(...(s[r]||[]).map(o=>({...o,lane:n,col:r,[t]:String(o[t])})))}),e},[])}function gp(i,t){const{items:e=[],...n}=i;return{items:mp(e,t),...n}}function Uc(i,t,e){var a;const n=un(i.lanes,t.lanes,"name"),s=un(i.cols,t.cols,"name"),r=un(i.links,(a=t.links)==null?void 0:a.map(l=>(l[e]===void 0&&(l[e]=Rn(l)),l)),e),o=un(i.items,mp(t.items||[],e),e);return{lanes:n,cols:s,items:o,links:r}}let Rs=class extends Ft{constructor(){super(...arguments),this._ref=kt(),this._raf=0,this._data=new Zn(this._getData.bind(this),()=>{const{getCol:t,colProps:e,itemCountPerRow:n,itemGap:s,getLane:r,laneProps:o,itemProps:a,getItem:l,getLink:h,linkProps:f,responsive:d}=this.props;return[this._kanbanData,t,e,n,s,r,o,a,l,f,h,d]}),this._kanbanData=new Zn(()=>{const{itemKey:t,props:e}=this,{data:n}=e,{data:s,changes:r}=this.state,o=(s||La(n)?s:gp(n,t))||{};return r?Uc(o,r,t):o},()=>{const{data:t,changes:e,selected:n}=this.state;return[t,e,n,this.props.data]}),this._handleGlobalClick=t=>{g(t.target).closest(".kanban-item").length||this.select([])},this._onAddLink=async t=>{const{onAddLink:e}=this.props;t[this.itemKey]=Rn(t),await(e==null?void 0:e.call(this,t))!==!1&&this.addLink(t)},this._onDeleteLink=async t=>{const{onDeleteLink:e}=this.props;await(e==null?void 0:e.call(this,t))!==!1&&this.deleteLink(t)},this._handleMouseMove=t=>{this._hoverTimer&&clearTimeout(this._hoverTimer);const e=this._getElementInfo(t.target),n=(e==null?void 0:e.type)==="item"?e.key:void 0;this._hoverTimer=window.setTimeout(()=>{n!==this.state.hover&&this.setState({hover:n},()=>{g(this._ref.current).trigger("kanbanItemHover",{kanban:this.props.key,hover:n})}),this._hoverTimer=0},!n&&this.state.hover?0:20)},this._handleClick=t=>{if(t.target.closest("a,button"))return;const{onClickItem:e,selectable:n}=this.props,s=this._getElementInfo(t.target);e&&(s==null?void 0:s.type)==="item"&&e.call(this,t,s)===!1||n&&(s==null?void 0:s.type)==="item"&&this.select(s.key,!0)}}get data(){return this._data.cache}get itemKey(){return this.props.itemKey||"id"}componentDidMount(){this._afterRender(!0),this.tryLoad(),this._initDraggable();const{responsive:t,selectable:e}=this.props,n=this._ref.current;if(n&&t){const s=new ResizeObserver(this.updateLayout.bind(this));g(typeof t!="boolean"?t:n.closest(".kanban-list")||n.parentElement).each((o,a)=>{s.observe(a)}),this._rob=s,this.state.containerWidth||this.updateLayout()}e&&g(document).on("click.kanban",this._handleGlobalClick)}componentDidUpdate(){this._afterRender(!1),this.tryLoad()}componentWillUnmount(){var t,e,n;(t=this.props.beforeDestroy)==null||t.call(this),(e=this._draggable)==null||e.destroy(),(n=this._rob)==null||n.disconnect(),this.props.selectable&&g(document).off("click.kanban",this._handleGlobalClick)}getDefaultState(t){return{loading:!1,selected:(t||this.props).defaultSelected,data:void 0,changes:void 0,loadFailed:void 0}}load(){const{data:t,onLoad:e,onLoadFail:n}=this.props;this._loadedSetting=t,this.setState({loading:!0},async()=>{const s={loading:!1};try{const r=gp(await Xn(t,[this],{throws:!0}),this.itemKey);s.data=(e==null?void 0:e.call(this,r))||r}catch(r){s.loadFailed=(typeof n=="function"?n.call(this,r):n)||String(r)}this.setState(s)})}updateLayout(){this._raf&&cancelAnimationFrame(this._raf),this._raf=requestAnimationFrame(()=>{this._raf=0;const t=this._ref.current;if(t){const{responsive:e,laneNameWidth:n=20}=this.props,s=g(typeof e!="boolean"?e:t.closest(".kanban-list")||t.parentElement),r=s[0];let o=s.width()-n-(r.offsetWidth-r.clientWidth);const a=t.closest(".kanban-region");a&&(o-=a.clientWidth-g(a).width()),this.setState({containerWidth:o})}})}tryLoad(){const{loading:t}=this.state,{data:e}=this.props;t||!e||!La(e)||e===this._loadedSetting||this.load()}getCol(t){return this.data.colMap.get(String(t))}getLane(t){return t=String(t),this.data.lanes.find(e=>e.name===t)}getItem(t){return this.data.map.get(String(t))}update(t){return this.changeState(e=>({changes:Uc({...e.changes},t,this.itemKey)}))}createSnap(){return{date:Date.now(),kanban:this,data:g.extend(!0,{},this._data),restore(){this.kanban.changeState({changes:this.data})}}}addItem(t,e,n){return this.updateItem(t,e,n)}updateItem(t,e,n){const s=Array.isArray(t)?t:[t];return this.update({items:e||n?s.map(r=>({...r,lane:e??r.lane,col:n??r.col})):s})}deleteItem(t){return this.updateItem(Array.isArray(t)?t.map(e=>({[this.props.itemKey||"id"]:e,deleted:!0})):{[this.itemKey]:t,deleted:!0})}updateLane(t){return this.update({lanes:Array.isArray(t)?t:[t]})}addLane(t){return this.updateLane(t)}deleteLane(t){return this.updateLane(Array.isArray(t)?t.map(e=>({name:e,deleted:!0})):{name:t,deleted:!0})}updateCol(t){return this.update({cols:Array.isArray(t)?t:[t]})}addCol(t){return this.updateCol(t)}deleteCol(t){return this.updateCol(Array.isArray(t)?t.map(e=>({name:e,deleted:!0})):{name:t,deleted:!0})}updateLink(t,e){return this.update({links:(Array.isArray(t)?t:[t]).map(n=>({deleted:!1,...n,...e,[this.itemKey]:Rn(n)}))})}addLink(t){return this.updateLink(t)}deleteLink(t){return this.updateLink(t,{deleted:!0})}select(t,e){let n=Array.isArray(t)?t:t?[t]:[],s=this.state.selected||[];const{onSelect:r}=this.props;return this.changeState(o=>{if(s=o.selected||[],e){const a=new Set(s),l=new Set;return n.forEach(h=>{a.has(h)?a.delete(h):l.add(h)}),n=[...a,...l],{selected:n}}return{selected:n}},()=>{r==null||r(n,s),g(this._ref.current).trigger("kanbanItemSelected",{kanban:this.props.key,selected:n,oldSelected:s})})}_getElementInfo(t){const e=g(t),n=e.closest(".kanban-item");if(n.length){const a=n.attr("z-key");if(a){const l=this.getItem(a);if(l)return{type:"item",key:a,element:t,item:l,lane:l.lane,col:l.col}}}if(e.closest(".kanban-new-item").length)return{type:"newItem",element:t};const r=e.closest(".kanban-header-col,.kanban-lane-col");if(r.length)return{type:"col",element:t,col:r.attr("z-col"),lane:r.attr("z-lane")};const o=e.closest(".kanban-lane").attr("z-lane");if(o!==void 0)return{type:"lane",element:t,lane:o}}_getDropInfo(t,e,n){const s=this._getElementInfo(e);if(!s)return;const r=this._getElementInfo(n);if(!r||r.element.closest(".kanban")!==this.element)return;let o;if(s.type==="item"&&r.type==="col")o="inside";else{const a=n.getBoundingClientRect();s.type==="col"?o=t.clientX<a.left+a.width/2?"before":"after":o=t.clientY<a.top+a.height/2?"before":"after"}return{side:o,event:t,drag:s,drop:r}}_getDropChanges(t){const{drag:e,drop:n}=t,s=this.data,r={},{itemKey:o}=this,a={list:[],lane:n.lane,col:n.col};if(e.type==="item"){const l=e.item,h=s.items[n.lane][n.col],f=[...h],d={[o]:l[o],order:l.order},m=n.col===l.col,y=n.lane===l.lane;if(m&&y&&l[o]===n.item[o])return{changes:r,data:a};m||(d.col=n.col),y||(d.lane=n.lane);let b=!1;if(n.type==="col"&&(!y||!m))f.push(d),b=!0;else if(n.type==="item"){const S=n.item,x=n.col!==l.col||n.lane!==l.lane?-1:f.findIndex(T=>T[o]===l[o]);x>=0&&f.splice(x,1);const k=f.findIndex(T=>T[o]===S[o]);f.splice(t.side==="before"?k:k+1,0,d),b=!0}if(b){r.items=[];let S=-1;f.forEach((x,k)=>{const T=Math.max(0,S+1,x.order??k),j=h[k];S=T,(j!==x||T!==j.order)&&(x={...x,order:T}),x!==j&&r.items.push(x),a.list.push(x[o])})}}else if(e.type==="newItem"){const{onDropNewItem:l}=this.props;let h;if(l?h=l.call(this,t):(h=g(e.element).data(),h!=null&&h.item&&(h=h.item)),h={lane:n.lane,col:n.col,...h},h!=null&&h[o]){const d=[...s.items[n.lane][n.col]];d.push(h),r.items=d,a.list.push(h[o])}}return{changes:r,data:a}}_initDraggable(){const{draggable:t}=this.props,e=this._ref.current;if(!t||!e)return;const{dragTypes:n=["item","newItem"],onDragStart:s,onDrop:r,canDrop:o,dropRules:a}=this.props,l=typeof n=="string"?n.split(","):n,h={item:".kanban-item",lane:".kanban-lane-name",col:".kanban-header-col",newItem:".kanban-new-item"},f=typeof t=="object"?t:{},d=(y,b)=>{g(y).attr({"z-drag-type":b?b.drag.type:null,"z-drop-type":b?b.drop.type:null,"z-drop-side":b?b.side:null})},m={...f,selector:f.selector||l.map(y=>h[y]||"").filter(Boolean).join(","),target:f.target||(y=>{const b=this._getElementInfo(y);if(!b)return;const S={lane:".kanban-lane",col:".kanban-header-col",item:".kanban-item,.kanban-items",newItem:".kanban-item,.kanban-items"}[b.type];return g(e).find(S)}),canDrop:f.canDrop||o||a?(y,b,S)=>{const x=this._getElementInfo(b);if(!x)return!1;const k=this._getElementInfo(S);if(!k||k.element.closest(".kanban")!==this.element)return!1;if(x.type==="item"&&a){const T=x.col,j=k.col,B=x.lane,K=k.lane,G=a[`${B}:${T}`]??a[T];return typeof G=="boolean"?G:!G||G.includes(j)||G.includes(`${K}:${j}`)||G.includes(`${K}:`)}if(o)return o.call(this,x,k)}:void 0,onDragStart:(y,b)=>{var x;const S=this._getElementInfo(b);return S?s?s.call(this,{event:y,drag:S}):(x=f.onDragStart)==null?void 0:x.call(this,y,b):!1},onDragOver:(y,b,S)=>{const x=this._getDropInfo(y,b,S);x&&d(S,x)},onDragLeave:(y,b,S)=>{d(S)},onDrop:(y,b,S)=>{var k;d(S);const x=this._getDropInfo(y,b,S);if(!x)return!1;if(r){const{changes:T,data:j}=this._getDropChanges(x);if(Object.keys(T).length){x.data=j;const B=this.createSnap();r.call(this,T,x,B.restore)!==!1&&this.update(T)}}return(k=f.onDrop)==null?void 0:k.call(this,y,b,S)}};this._draggable=new vs(e,m)}_afterRender(t){var e;(e=this.props.afterRender)==null||e.call(this,t)}_getData(){const{itemKey:t,props:e}=this,n=this._kanbanData.value;let s=!1;const{items:r=[]}=n,o={},a=new Map,l=$v.call(this,n.cols,e,x=>{x.parentName!==void 0&&(s=!0),a.set(x.name,x)}),h=Tv.call(this,n.lanes,e,x=>{o[x.name]=l.reduce((k,T)=>(T.subCols?T.subCols.forEach(j=>{k[j.name]=[]}):k[T.name]=[],k),{})}),f=new Set,d=r.reduce((x,k)=>{if(k.deleted)return f.add(k[t]),x;x.set(k[t],k);const T=o[k.lane];if(T){const j=T[k.col];j&&j.push(k)}return x},new Map),{selected:m=[]}=this.state,y=new Set(m),b=x=>{x.selected=y.has(x[t])};h.forEach(x=>{const k=o[x.name];k&&l.forEach(T=>{var j;k[T.name]=pp.call(this,k[T.name],x,T,e,b),(j=T.subCols)==null||j.forEach(B=>{k[B.name]=pp.call(this,k[B.name],x,B,e,b)})})});let{links:S=[]}=n;return S=S.reduce((x,k)=>{var T;if(!k.deleted&&d.has(k.from)&&d.has(k.to)&&!f.has(k.from)&&!f.has(k.to)){k[t]===void 0&&(k[t]=Rn(k));const j=((T=e.getLink)==null?void 0:T.call(this,k))??k;j!==!1&&!j.deleted&&x.push(j)}return x},[]),{cols:l,lanes:h,items:o,map:d,colMap:a,links:S,hasSubCols:s}}_layoutCols(t,e){const{containerWidth:n=0}=this.state,{colsGap:s=8,minColWidth:r=150,maxColWidth:o=600,colWidth:a=200}=e,l=[];let h=0;const f=d=>{const{minWidth:m=r,maxWidth:y=o}=d;let{width:b=a}=d;typeof b=="function"&&(b=b.call(this,d));const S=b==="auto";if(S)b=m;else{const[x,k]=ii(b);k==="%"?b=n*x/100:b=x}return b=Math.min(y,Math.max(m,b)),h+=b+(h?s:0),d={...d,width:b,maxWidth:y,minWidth:m},S&&l.push(d),d};if(t=t.map(d=>d.subCols?{...d,subCols:d.subCols.map(f)}:f(d)),l.length&&h<n){const d=Math.floor((n-h)/l.length);l.forEach(m=>{m.width=Math.min(m.maxWidth,Math.max(m.minWidth,m.width+d))})}return t}_layoutLanes(t,e){const{laneHeight:n,maxLaneHeight:s,minLaneHeight:r}=e;return!n&&!s&&!r?t:t.map(o=>({height:typeof n=="function"?n.call(this,o):n,maxHeight:s,minHeight:r,...o}))}_getClassName(t){return["kanban",t.className,t.sticky?"kanban-sticky":"",this.data.hasSubCols?"has-sub-cols":""]}_getProps(t){const{laneNameWidth:e,colsGap:n,lanesGap:s,selectable:r,onClickItem:o,showLinkOnHover:a}=t;return vt(super._getProps(t),{ref:this._ref,style:{"--kanban-lane-name-width":e,"--kanban-cols-gap":Bt(n),"--kanban-lanes-gap":Bt(s)},onClick:o||r?this._handleClick:void 0,onMouseMove:a?this._handleMouseMove:void 0})}_renderLinks(t){const{links:e=[]}=this.data,{editLinks:n}=t;if(!n&&!e.length)return;const{showLinkOnHover:s,showLinkOnSelected:r}=t;let o;if(r||s){o=[];const{selected:a,hover:l}=this.state;r&&a&&o.push(...a),s&&l&&o.push(l),o=[...new Set(o)]}return w(fp,{links:e,filters:o,editLinks:n,onDeleteLink:n?this._onDeleteLink:void 0,onAddLink:n?this._onAddLink:void 0},"links")}_getChildren(t){const e=this._data.value,{cols:n,lanes:s,items:r}=e,{laneNameWidth:o}=t,a=this._layoutCols(n,t),l=this._layoutLanes(s,t);return[w(gv,{cols:a},"header"),w(_v,{itemRender:t.itemRender,getLaneCol:t.getLaneCol,cols:a,lanes:l,items:r,hideLaneName:o===0},"body"),this._renderLinks(t),t.children]}};Rs.defaultProps={draggable:!0,sticky:!0,responsive:!0,itemKey:"id",colWidth:200,colsGap:8},Rs.customProps=["onDrop","onDragStart"];class yp extends Ft{constructor(){super(...arguments),this._kanbanRefs=new Map,this._needUpdateData=new Map,this._handleClickHeading=t=>{g(t.target).closest("a,.btn,button").not(".kanban-region-toggle").length||this.setState(e=>({collapsed:!e.collapsed}))}}componentDidUpdate(){if(this.state.collapsed)return;const t=this._needUpdateData;[...t.keys()].forEach(e=>{const n=this.getKanban(e);n&&(n.update(t.get(e)),t.delete(e))})}getDefaultState(t){return{collapsed:(t||this.props).collapsed,heading:void 0,items:void 0}}resetState(t,e){this._kanbanRefs.forEach(n=>{var s;return(s=n.current)==null?void 0:s.resetState()}),super.resetState(t,e)}getKanban(t){var e;return(e=this._kanbanRefs.get(String(t)))==null?void 0:e.current}toggle(t){this.setState(e=>({collapsed:t===void 0?!e.collapsed:!t}))}update(t){const{items:e}=t;return e&&(t={...t},t.items=e.map((n,s)=>{const r=String(n.key||s);return n.deleted?{key:r,deleted:!0}:(n.data&&typeof n.data=="object"&&this.getKanban(r)&&(this._needUpdateKanban(r,n.data),n={...n},delete n.data),n)})),new Promise(n=>{this.setState(t.items?s=>({...t,items:un(s.items,t.items)}):t,n)})}_needUpdateKanban(t,e){const n=this._needUpdateData,s=n.get(t),{kanbanItemKey:r="key"}=this.props;n.set(t,Uc(s||{},e,r))}_buildItems(t){const{items:e=[],kanbanProps:n,kanbanItemKey:s="key"}=t;let{items:r}=this.state;r?(r=un(e,r,s).filter(h=>!h.deleted),r.sort(Ds)):r=e;const o=this._kanbanRefs,a=new Set(o.keys()),l=r.map((h,f)=>{if(h.deleted)return null;const d=vt({className:"kanban-region-item",key:f},typeof n=="function"?n.call(this,h,f):n,h),m=String(d.key);let y=o.get(m);return y||(y=kt(),o.set(m,y)),d.ref=y,a.delete(m),w(Rs,{"z-key":m,...d})});return a.forEach(h=>{o.delete(h)}),l}_getClassName(t){return["kanban-region",t.className,this.state.collapsed?"is-collapsed":"is-expanded",t.heading?"has-heading":""]}_getChildren(t){const{heading:e,toggleFromHeading:n}=t,{collapsed:s,heading:r}=this.state,o=vt({className:"kanban-heading",onClick:n?this._handleClickHeading:void 0},typeof e=="function"?e.call(this):e,r);return[e&&w(qe,{...o},"heading"),s?null:this._buildItems(t)]}}const Vc=".kanban";let _p=class extends Ft{constructor(){super(...arguments),this.state={},this._ref=kt(),this._kanbanRefs=new Map,this._onAddLink=async t=>{const{onAddLink:e,linkItemKey:n}=this.props;t[n]=Rn(t),await(e==null?void 0:e.call(this,t))!==!1&&this.addLink(t)},this._onDeleteLink=async t=>{const{onDeleteLink:e}=this.props;await(e==null?void 0:e.call(this,t))!==!1&&this.deleteLink(t)}}componentDidMount(){const t=this._ref.current;if(t){const{moveable:e,responsive:n,showLinkOnSelected:s,showLinkOnHover:r}=this.props;if(e&&(this._moveable=new bs(t,g.extend({selector:"self",move:"scroll",onMoveStart:(o,a)=>{const{bottom:l,right:h}=a.getBoundingClientRect();return o.clientY<l&&o.clientY>l-20||o.clientX<h&&o.clientX>h-20?!1:!g(o.target).closest("a,input,.btn,.state,.kanban-item,.not-moveable").length}},typeof e=="object"?e:null))),s&&g(t).on(`kanbanItemSelected${Vc}`,(o,a)=>{this.setState(l=>({selected:{...l.selected,[a.kanban]:a.selected}}))}),r&&g(t).on(`kanbanItemHover${Vc}`,(o,{kanban:a,hover:l})=>{this.setState({hover:l===void 0?l:`${a}_${l}`})}),n){const o=new ResizeObserver(this._tryUpdateLayout.bind(this));(typeof n!="boolean"?g(n):g(t).parent()).each((l,h)=>{o.observe(h)}),this._rob=o}}}componentWillUnmount(){var e,n;(e=this._moveable)==null||e.destroy(),(n=this._rob)==null||n.disconnect();const t=this._ref.current;t&&g(t).off(Vc)}getDefaultState(t){return{linkChanges:void 0}}resetState(t,e){this._kanbanRefs.forEach(n=>{var s;(s=n.current)==null||s.resetState()}),super.resetState(t,e)}getKanban(t){const e=String(t),n=this._kanbanRefs;if(n.has(e))return n.get(e).current;let s=null;const r=Array.from(n.values());for(const o of r){const a=o.current;if(a instanceof yp&&(s=a.getKanban(t),s))break}return s||null}updateKanban(t,e){const n=this.getKanban(t);return n?n.update(e):Promise.reject(new Error(`[ZUI] Kanban not found: ${t}`))}updateLayout(){const t=this._ref.current;if(!t)return;const e=g(t),n=e.width(),s=e.height();this.setState({width:n,height:s})}updateLink(t,e){return this.changeState(n=>{let s=Array.isArray(t)?t:[t];return e&&(s=s.map(r=>({...r,...e}))),{linkChanges:un(n.linkChanges,s,this.props.linkItemKey)}})}addLink(t){return this.updateLink(t)}deleteLink(t){return this.updateLink(t,{deleted:!0})}_tryUpdateLayout(){this._layoutTimer&&cancelAnimationFrame(this._layoutTimer),this._layoutTimer=requestAnimationFrame(()=>{this.updateLayout(),this._layoutTimer=0})}_getClassName(t){return["kanban-list",t.className,t.sticky?"has-sticky":"",t.moveable?"is-moveable":"",t.scrollbarHover?"scrollbar-hover":""]}_getProps(t){const{width:e,height:n}=t,s=typeof e=="function"?e.call(this):e,r=typeof n=="function"?n.call(this):n,{width:o,height:a}=this.state??{};return vt(super._getProps(t),{ref:this._ref,style:{width:s,height:r,"--kanban-list-width":`${o||e}px`,"--kanban-list-height":`${a||n}px`}})}_getLinks(t){const{linkChanges:e=[]}=this.state,{links:n=[],getLink:s,linkItemKey:r}=t;return un(n,e,this.props.linkItemKey).reduce((o,a)=>{const l=s==null?void 0:s.call(this,a);return l!==!1&&(a=l||a,a.deleted||(a[r]||(a[r]=Rn(a)),o.push(a))),o},[])}_renderLinks(t){const e=this._getLinks(t),{editLinks:n}=t;if(!n&&!e.length)return;const{showLinkOnHover:s,showLinkOnSelected:r}=t;let o;if(e.length&&(r||s)){o=[];const{selected:a={},hover:l}=this.state;r&&a&&Object.keys(a).forEach(h=>{const f=a[h];f.length&&o.push(...f.map(d=>`${h}_${d}`))}),s&&l&&o.push(l),o=[...new Set(o)]}return w(fp,{container:".kanban-list",links:e,filters:o,editLinks:n,onDeleteLink:n?this._onDeleteLink:void 0,onAddLink:n?this._onAddLink:void 0},"links")}_getChildren(t){const{items:e=[],kanbanProps:n,showLinkOnSelected:s,showLinkOnHover:r,selectable:o,editLinks:a}=t,l=this._kanbanRefs,h=new Set(l.keys()),f=[...e.map((m,y)=>{n&&(m=typeof n=="function"?n.call(this,m,y):g.extend({},n,m));const b=String(m.key??y);let S=l.get(b);S||(S=kt(),l.set(b,S)),h.delete(b);const x=m.heading!==void 0||m.items;return(s||r||o)&&(x?m.kanbanProps={showLinkOnSelected:s,showLinkOnHover:r,selectable:o,...m.kanbanProps}:m={showLinkOnSelected:s,showLinkOnHover:r,selectable:o,...m}),a&&(x?m.items=(m.items||[]).map(T=>({...T,editLinks:!1})):m={...m,editLinks:!1}),w(x?yp:Rs,{ref:S,sticky:t.sticky,...m,"z-key":b},b)}),t.children];h.forEach(m=>{l.delete(m)});const d=this._renderLinks(t);return d&&f.push(d),f}};_p.defaultProps={moveable:!0,sticky:!0,responsive:!0,scrollbarHover:!0,linkItemKey:"id"};class Ls extends mt{}Ls.NAME="Kanban",Ls.replace=!0,Ls.Component=Rs,Ls.register();class Os extends mt{update(t,e){if(t=Array.isArray(t)?t:[t],e)return this.render({items:t});const n=this.options.items||[],s=new Map(n.map((o,a)=>[o.key,a])),r=[...n];return t.forEach(o=>{if(s.has(o.key)){const a=s.get(o.key);r[a]={...n[a],...o}}else r.push(o)}),this.render({items:r.filter(o=>!o.deleted)})}}Os.NAME="KanbanList",Os.replace=!0,Os.Component=_p,Os.register();const kC="",SC="",xC="",$C="",TC="",NC="",EC="",MC="",PC="",AC="",Nv="nav",qc='[data-toggle="tab"]',Ev="active";class zs extends zt{constructor(){super(...arguments),this._timer=0}active(t){const e=this.$element,n=e.find(qc);let s=t?g(t).closest(qc):n.filter(`.${Ev}`);if(!s.length&&(s=e.find(qc).first(),!s.length))return;n.removeClass("active"),s.addClass("active");const r=s.attr("href")||s.data("target"),o=s.data("name")||r,a=g(r);a.length&&(a.parent().children(".tab-pane").removeClass("active in"),a.addClass("active").trigger("show",[o]),this.emit("show",o),this._timer&&clearTimeout(this._timer),this._timer=setTimeout(()=>{a.addClass("in").trigger("shown",[o]),this.emit("shown",o),this._timer=0},10))}}zs.NAME="Tabs",zs.toggle={name:"tab",handler(i,t){const e=g(i),n=e.closest(`.${Nv}`);n.length&&zs.ensure(n,t).active(e)}},zs.register();function Mv(i){const[t,e]=i.split(":"),n=t[0]==="-"?{name:t.substring(1),disabled:!0}:{name:t};return e!=null&&e.length&&(n.type="dropdown",n.items=e.split(",").reduce((s,r)=>(r=r.trim(),r.length&&s.push(r[0]==="-"?{name:r.substring(1),disabled:!0}:{name:r}),s),[])),n}const Pv=(i,t)=>{var s;i.url&&(i.url=$t(i.url,t.row.data));const e={row:t.row.id,col:t.col.name},n=((s=i.dropdown)==null?void 0:s.items)||i.items;return n&&n.forEach(r=>(r.url&&(r.url=$t(r.url,t.row.data)),r.data=e,r)),i.data=e,i},vp=i=>i?(typeof i=="string"&&(i=i.split("|")),i.map(t=>typeof t=="string"?Mv(t):t).filter(Boolean)):[],Av=Kt({name:"actions",colTypes:{actions:{onRenderCell(i,t){var f;const{row:e,col:n}=t,s=vp(((f=e.data)==null?void 0:f[n.name])||n.setting.actions);if(!s.length)return i;const{actionsSetting:r,actionsMap:o,actionsCreator:a=this.options.actionsCreator,actionItemCreator:l=this.options.actionItemCreator||Pv}=n.setting,h={items:(a==null?void 0:a(t))??s.map(d=>{const{name:m,...y}=d;if(o&&m){Object.assign(y,o[m],{...y});const{buildProps:S}=y;typeof S=="function"&&(delete y.buildProps,Object.assign(y,S(i,t)))}const{items:b}=y;if(y.disabled&&(delete y.url,delete y["data-toggle"]),b&&y.type==="dropdown"){const{dropdown:S={placement:"bottom-end"}}=y;S.menu={className:"menu-dtable-actions"},S.items=b.map(x=>{const k=typeof x=="string"?{name:x}:{...x};return k.name&&o&&o[k.name]&&Object.assign(k,o[k.name],{...k}),k.disabled?(delete k.url,delete k["data-toggle"]):k.url&&(k.url=$t(k.url,e.data)),k}),y.dropdown=S,delete y.items}return l?l(y,t):y}),btnProps:{btnType:"ghost",size:"sm",className:"text-primary"},...r};return i[0]=w(Zt,{...h}),i}}},beforeLayout(i){!Array.isArray(i.data)||!i.data.length||i.cols.forEach((t,e)=>{if(t.type!=="actions"||t.width)return;const{actionsMap:n={}}=t,r=vp(i.data[0][t.name]).reduce((o,a)=>{const l=a.name?n[a.name]:null;return l&&l.type==="dropdown"&&l.caret&&!l.text?o+16:o+24},24);i.cols[e]={...t,width:r}})}}),Iv=Kt({name:"toolbar",footer:{toolbar(){const{footToolbar:i,showToolbarOnChecked:t}=this.options;return t&&!this.getChecks().length?[]:[i?w(Zt,{gap:2,...Array.isArray(i)?{items:i}:i}):null]}}}),RC="",bp=function(i,t){var s,r;const{col:e}=t,{sortColFrom:n}=this.state;if(n){n.name===e.name&&i.push({outer:!0,className:"is-sorting-from-col"});const o=(r=(s=this.data.sortColInfo)==null?void 0:s.colOffsetMap)==null?void 0:r[e.name];typeof o=="number"&&i.push({outer:!0,className:"is-sorting-col-move",style:{left:e.left+o}})}return i},Dv=Kt({name:"sort-col",when:i=>!!i.sortCol,plugins:[Oo,ap],resetState:!0,state(){return{colOrders:{},sortColFrom:void 0,sortingColPos:void 0,sortingColTo:void 0,sortingColSide:void 0}},events:{mousedown(i){var r;if(this.data.disableSortCol)return;const t=this.getPointerInfo(i);if(!t||t.rowID!=="HEADER")return;const e=this.getColInfo(t.colName);if(!e||((r=this.options.onSortColStart)==null?void 0:r.call(this,e,i))===!1)return;g(i.target).closest("a,button,img").attr("draggable","false").length&&i.preventDefault(),i.preventDefault();const n=i.clientX,{cellElement:s}=t;this.data.sortColInfo={from:e,element:s,offset:n-s.getBoundingClientRect().left,startMouseX:n,lastMouseX:n},g(s).zuiCall("ContextMenu.hide")},document_mouseup(i){var n;const{sortColInfo:t}=this.data;if(!t)return;this.stopScrollToMouse();const e=this.getSortingColState(i);if(e){let s,r;const{from:o,to:a,side:l}=e;if(a){if(o.name===a.name)s={};else if(l){const h=this.layout.cols[o.side].list,f=o.sideIndex,d=a.sideIndex,m=h.splice(f,1);h.splice(d+(l==="after"?1:0),0,m[0]),s={},r=[],h.forEach(({name:y},b)=>{s[y]=b+1,r.push(y)}),((n=this.options.onSortCol)==null?void 0:n.call(this,o,a,l,r))===!1&&(s=void 0,r=void 0)}Math.abs(t.lastMouseX-t.startMouseX)>4&&this.ignoreNextClick()}this.disableAnimation(),this.update({dirtyType:"layout",state:g.extend({sortColFrom:void 0,sortingColPos:void 0,sortingColTo:void 0,sortingColSide:void 0},s?{colOrders:{...this.state.colOrders,...s}}:null)},()=>{var h;(h=this.options.onSortColEnd)==null||h.call(this,o,a,l,r)})}this.data.sortColInfo=void 0},document_mousemovesmooth(i){const{sortColInfo:t}=this.data;if(!t)return;const e=this.getSortingColState(i);e&&(t.state||this.startScrollToMouse({side:"x"}),t.lastMouseX=i.clientX,t.state=e,this.setState({sortColFrom:e.from,sortingColPos:e.pos,sortingColTo:e.to,sortingColSide:e.side}))}},methods:{getSortingColState(i){var x;const{disableSortCol:t,sortColInfo:e}=this.data;if(t||!e)return;const{from:n,element:s}=e,o=g(s).closest(".dtable-cells")[0].getBoundingClientRect(),a=i.clientX-o.left,{cols:l,scrollLeft:h}=this.layout,f=l[n.side].list;if(f.length<=1)return e.state;const d=h+a,m=f.find(k=>k.visible&&k.left<=d&&k.left+k.width>d);if(!m)return e.state;const y=d<m.left+m.width/2?"before":"after";return n.side===m.side&&((x=this.options.canSortColTo)==null?void 0:x.call(this,n,m,y))!==!1?{from:n,pos:a+h,to:m,side:n.name!==m.name?y:void 0}:{from:n,pos:a,to:void 0,side:void 0}}},onAddCol(i){const{colOrders:t={}}=this.state,e=t[i.name];e!==void 0&&(i.order=e)},beforeRender(i){const{sortColFrom:t,sortingColTo:e,sortingColSide:n}=this.state;if(t&&e){i.className=q(i.className,"has-sorting-col");const s=[...i.cols[t.side].list],r=t.sideIndex,o=e.sideIndex,a=s.splice(r,1);s.splice(o+(n==="after"?1:0),0,a[0]);let l=0;const h={};s.forEach(f=>{const d=l-f.left;d&&(h[f.name]=d),l+=f.realWidth}),this.data.sortColInfo.colOffsetMap=h}},onRenderHeaderCell(i,t,e,n){const{sortCol:s}=this.options;return s&&(this.layout.cols[t.col.side].list.length>1&&(s===!0||Array.isArray(s)&&s.includes(t.col.name)||typeof s=="function"&&s.call(this,t.col))&&i.push({outer:!0,className:"is-sortable-col"}),i=bp.call(this,i,t,e,n)),i},onRenderCell:bp}),OC="";function wp(i,t,e){const{colResizing:n}=i.state;if(!n)return;const s=Math.round(t.clientX-n.startX);if(!s&&!e)return;const r={};e&&(r.colResizing=void 0);const{colName:o}=n;let a=i.getColInfo(o);if(!a)return i.update({dirtyType:"layout",state:r});r.colsSizes={...i.state.colsSizes,[o]:n.startSize+s},i.update({dirtyType:"layout",state:r},e?()=>{var l;if(a=i.getColInfo(o),a){const h=i.data.colOriginSize.get(o);(l=i.options.onColResize)==null||l.call(i,o,a.width-h,a)}}:void 0),t.stopPropagation(),t.preventDefault()}const Rv=Kt({name:"resize",when:i=>!!i.colResize,plugins:[Oo],resetState(i){var t;return{colsSizes:(t=i.cols)==null?void 0:t.reduce((e,n)=>(n.extraWidth!==void 0&&(e[n.name]=n.extraWidth),e),{})}},state(){var i;return{colsSizes:(i=this.props.cols)==null?void 0:i.reduce((t,e)=>(e.extraWidth!==void 0&&(t[e.name]=e.extraWidth),t),{})}},data(){return{colOriginSize:new Map}},events:{mousedown(i){const t=i.target.closest(".dtable-col-splitter");if(!t)return;const e=t.closest(".dtable-cell"),n=e==null?void 0:e.dataset.col;if(n)return this.setState({colResizing:{colName:n,startSize:this.state.colsSizes[n]??0,startX:i.clientX}},()=>{g(e).zuiCall("ContextMenu.hide")}),!1},dblclick(i){var s;const t=i.target.closest(".dtable-col-splitter");if(!t)return;const e=(s=t.closest(".dtable-cell"))==null?void 0:s.dataset.col;if(!e)return;const{colsSizes:n}=this.state;n[e]&&(delete n[e],this.update({dirtyType:"layout",state:{colResizing:void 0,colsSizes:{...n}}},()=>{var r;(r=this.options.onColResize)==null||r.call(this,e,0,this.getColInfo(e))}))},document_mouseup(i){if(this.state.colResizing)return wp(this,i,!0),!1},document_mousemovesmooth(i){if(this.state.colResizing)return wp(this,i),!1}},methods:{isColResizable(i){if(typeof i=="string"&&(i=this.getColInfo(i)),!i||i.side!=="left"&&i.sideIndex===this.layout.cols[i.side].list.length-1)return;let t=i.setting.colResize??this.options.colResize;return typeof t=="function"&&(t=t.call(this,i.name)),!!t}},onRenderHeaderCell(i,{col:t}){var e;return this.isColResizable(t)&&(i.push({className:"has-col-splitter",children:w("div",{className:"dtable-col-splitter no-cell-event"}),outer:!0}),((e=this.state.colResizing)==null?void 0:e.colName)===t.name&&i.push({className:"has-col-resizing",outer:!0})),i},onRenderCell(i,{col:t}){var e;return((e=this.state.colResizing)==null?void 0:e.colName)===t.name&&i.push({className:"is-col-resizing",outer:!0}),i},onAddCol(i){const t=this.state.colsSizes[i.name]??i.setting.extraWidth;typeof t=="number"&&(this.data.colOriginSize.set(i.name,i.width),i.width=Rf(i.width+t,i.setting.minWidth,i.setting.maxWidth))},onRender(){if(this.state.colResizing)return{className:"has-col-resizing"}}}),FC="",Lv=Kt({name:"contextmenu",when:i=>!!i.contextmenu,events:{contextmenu(i){const t=this.getPointerInfo(i);if(!t)return;const e=this.getContextMenuItems(i,t);if(!e||!e.length)return;i.preventDefault();const n=g(t.cellElement).addClass("has-contextmenu-show");t.cellElement.classList.add("active"),Gi.show({items:e,key:`dtable-ctx-${this.id}`,triggerEvent:i,hideOthers:!0,onHide(){n.removeClass("has-contextmenu-show")}})}},methods:{getContextMenuItems(i,t){const{contextmenu:e}=this.options;if(typeof e=="function")return e.call(this,i,t);if(!e||Array.isArray(e))return e;const{header:n,cell:s}=e;return t.rowID==="HEADER"?typeof n=="function"?n.call(this,i,t):n:typeof s=="function"?s.call(this,i,t):s}}});function Cp(i,t){if(typeof t=="string"&&(t=i.getColInfo.call(i,t)),!t)return{};const{colBorders:e}=i.state,{side:n,sideIndex:s}=t,r=i.layout.cols[n].list,o=s>0?r[s-1]:null,a=r[s+1];return{prevName:o==null?void 0:o.name,nextName:a==null?void 0:a.name,prev:o?e[o.name]??o.setting.border:void 0,next:a?e[a.name]??a.setting.border:void 0}}function Qi(i,t){return i===t||i===!0}const Ov=Kt({name:"custom-col",when:i=>!!i.customCol,plugins:[Lv],resetState:!0,options(i){return i.customCol&&!i.contextmenu&&(i.contextmenu={header:(t,e)=>{var r,o;const n=this.getColBorder(e.colName),s=a=>{const l={width:"12px",margin:"0 2px",height:"12px",border:"1px dotted var(--color-border-strong)"},h="2px solid var(--color-border-strong)";return a==="left"?l.borderLeft=h:a==="right"?l.borderRight=h:a===!0&&(l.borderLeft=h,l.borderRight=h),w("span",{style:l})};return[{icon:s(n),text:this.i18n("setDivider"),items:[{text:this.i18n("leftDivider"),icon:s("left"),selected:n==="left",onClick:()=>this.setColBorder(e.colName,"left")},{text:this.i18n("rightDivider"),icon:s("right"),selected:n==="right",onClick:()=>this.setColBorder(e.colName,"right")},{text:this.i18n("allDivider"),icon:s(!0),selected:n===!0,onClick:()=>this.setColBorder(e.colName,!0)},{text:this.i18n("noDivider"),icon:s(!1),selected:!n,onClick:()=>this.setColBorder(e.colName,!1)}]},{text:this.i18n("hideCol"),icon:"eye-off",disabled:((r=this.getColInfo(e.colName))==null?void 0:r.setting.required)||!((o=this.options.canSetColVisibility)!=null&&o.call(this,e.colName,!1)),onClick:()=>this.setColVisibility(e.colName,!1)}]}}),i},state(){return{colBorders:{},colVisibility:{}}},methods:{getColBorder(i,t=!0){const e=this.getColInfo(i);if(!e)return!1;const{colBorders:n}=this.state,s=n[i]??e.setting.border;if(s===!0||!t)return s;const{prev:r,next:o}=Cp(this,e),a=s==="left"||Qi(r,"right"),l=s==="right"||Qi(o,"left");return a&&l?!0:a?"left":l?"right":!1},setColBorder(i,t){if(this.getColBorder(i,!1)===t)return;const{onSetColBorder:n}=this.options,{prev:s,next:r,prevName:o,nextName:a}=Cp(this,i);this.update({dirtyType:"layout",state:l=>{const h={...l.colBorders,[i]:t};return!Qi(t,"left")&&Qi(s,"right")&&(h[o]=!1),!Qi(t,"right")&&Qi(r,"left")&&(h[a]=!1),{colBorders:h}}},n?()=>{n.call(this,i,t,this.state.colBorders)}:void 0)},setColVisibility(i,t){const{onSetColVisibility:e}=this.options;this.update({dirtyType:"options",state:n=>({colVisibility:{...n.colVisibility,[i]:t}})},e?()=>{e.call(this,i,t)}:void 0)}},onAddCol(i){const{colBorders:t}=this.state;t[i.name]!==void 0&&(i.border=t[i.name])},beforeLayout(i){const{colVisibility:t}=this.state;Object.keys(t).length&&i.cols&&(i.cols=i.cols.map(e=>(t[e.name]!==void 0&&(e={...e,hidden:!t[e.name]}),e)))},i18n:{zh_cn:{setDivider:"设置分割线",leftDivider:"左侧",rightDivider:"右侧",allDivider:"两侧",noDivider:"无",hideCol:"隐藏此列"},zh_tw:{setDivider:"設置分割線",leftDivider:"左側",rightDivider:"右側",allDivider:"兩側",noDivider:"無",hideCol:"隱藏此列"},en:{setDivider:"Set divider",leftDivider:"Left Side",rightDivider:"Right Side",allDivider:"Both Sides",noDivider:"No Divider",hideCol:"Hide this column"}}}),zv=Kt({name:"pager",footer:{pager(){const{footPager:i}=this.options;return i?(Array.isArray(i.items)&&i.items.forEach(t=>{t.type==="size-menu"&&t.caret===void 0&&(t.caret="up")}),[w(Ki,{...i})]):[]}}}),WC="";function Gc(i,t,e){if(e){if(typeof e=="object"){const n=e[i];return typeof n=="string"?n:typeof n=="object"&&n?n.realname:void 0}if(typeof e=="function")return e(i,t)}}function kp(i,t,e){let n;if(typeof i=="function"?n=i(t,e):typeof i=="object"&&(n=i[t]),n)return P(Ht,{className:"dtable-cell-icon",icon:n})}const Sp={name:"zentao",plugins:["group","checkable","nested",Av,Iv,zv,Dv,Rv,Ov],defaultOptions:{colHover:"header",rowHeight:36,striped:!1,responsive:"window,parent,.search-form,~document_layout",checkable:"auto",nested:"auto",width:"100%",footer:void 0,showToolbarOnChecked:!0,checkOnClickRow:!0,groupDivider:!0,preserveNested:!0,extraHeight:"+",height(i){var r;const t=(r=this.element)==null?void 0:r.closest(".modal-dialog"),e=g(t||"body");let n=this.options.extraHeight;typeof n=="string"&&(n[0]==="+"&&(n=(t?".modal-header,.modal-footer,.search-form,36,#featureBar,":"#header,#mainMenu,#mainNavbar,.search-form,")+n.slice(1)),n=n.split(",")),Array.isArray(n)||(n=[n]);const s=n.reduce((o,a)=>a?typeof a=="number"||/^\d+$/.test(a)?o+Number(a):o+(e.find(a).outerHeight()||0):o,0);return Math.min(i,window.innerHeight-(t?64:1)-s)}},options(i){var l;const{checkable:t,footToolbar:e,footPager:n,footer:s}=i;if(s===void 0){const h=[];if(t&&h.push("checkbox"),e){const f=Array.isArray(e)?{items:e}:e;h.push("toolbar"),f.btnProps=g.extend({btnType:"primary",size:"sm"},f.btnProps),i.footToolbar=f}t&&h.push("checkedInfo"),n&&h.push("flex","pager"),h.length&&(i.footer=h)}const r={"data-load":"table","data-selector":"dtable","data-target":i.id,...i.loadOptions},o=i.loadPartial||((l=this.parent||this.element)==null?void 0:l.closest(".modal"));o&&(r["data-partial"]=!0),n&&(n.btnProps=g.extend({type:"ghost",size:"sm"},n.btnProps),n.items&&n.items.forEach(h=>{h.type==="size-menu"?g.extend(!0,h,{itemProps:o?{...r,...h.itemProps}:{"data-app":"current",...h.itemProps},placement:"top"}):h.type==="link"&&g.extend(h,r)}));let{sortLink:a}=i;if(a&&(typeof a=="string"&&(a={url:a}),typeof a=="object"&&(a=g.extend(r,a)),i.sortLink=a),i.customCols){i.colResize===void 0&&(i.colResize=!0),i.sortCol===void 0&&(i.sortCol=!0);const h=()=>{this.trySaveColsSetting()};i.sortCol&&!i.onSortColEnd&&(i.onSortColEnd=h),i.colResize&&!i.on&&(i.onColResize=h),i.customCol===void 0&&(i.customCol=!0),i.customCol&&(i.onSetColBorder||(i.onSetColBorder=h),i.onSetColVisibility||(i.onSetColVisibility=h),i.canSetColVisibility||(i.canSetColVisibility=f=>{const d=this.getColInfo(f);return!d||d.side!=="center"?!1:this.layout.cols[d.side].list.length>1}))}return i},i18n:{zh_cn:{unassigned:"未指派"},zh_tw:{unassigned:"未指派"},en:{unassigned:"Unassigned"}},colTypes:{id:{width:60,fixed:"left",align:"center",sortType:!0,maxWidth:120},checkID:{width:80,fixed:"left",align:"left",sortType:!0,checkbox:!0,maxWidth:160},title:{width:.44,fixed:"left",align:"left",sortType:!0,flex:1,hint:!0,maxWidth:600},shortTitle:{width:.2,align:"left",sortType:!0,fixed:"left",checkbox:!0,flex:1,hint:!0,maxWidth:250},nestedTitle:{width:.5,align:"left",sortType:!0,fixed:"left",flex:1,nestedToggle:!0,nestedIndent:20,hint:!0,maxWidth:650},shortNestedTitle:{width:.33,align:"left",sortType:!0,fixed:"left",flex:1,nestedToggle:!0,nestedIndent:20,hint:!0,maxWidth:300},status:{width:80,align:"center",sortType:!0,onRenderCell(i,{col:t,row:e}){var o,a;const n=(o=e.data)==null?void 0:o[t.name];let s,r;return typeof n=="string"?(s=n,r=(a=t.setting.statusMap)==null?void 0:a[n]):typeof n=="object"&&n&&({name:s,label:r}=n),i[0]=P("span",{class:`${t.setting.statusClassPrefix??"status-"}${s}`},r??s),i}},user:{width:80,align:"center",sortType:!0,onRenderCell(i,{col:t,row:e,value:n}){const{userMap:s=this.options.userMap,userJoiner:r=" "}=t.setting;if(Array.isArray(n))i[0]=n.map(o=>Gc(o,e,s)).filter(Boolean).join(r);else{const o=Gc(n,e,s);o!==void 0&&(i[0]=o)}return i}},assign:{width:108,align:"left",sortType:!0,cellClass:"px-1.5",onRenderCell(i,t){const{col:e,row:n,value:s}=t,{options:r}=this,{userMap:o=r.userMap,currentUser:a=r.currentUser,assignLink:l,unassignedText:h=r.unassignedText||this.i18n("unassigned")}=e.setting,f=!s,d=s==="closed",m=f?h:Gc(s,n,o)??s;return i[0]=zc(l,t,[P("i",{className:"icon icon-hand-right"}),P("span",null,m)],{"data-toggle":d?void 0:"modal",className:`dtable-assign-btn${a===s?" is-me":""}${f?" is-unassigned":""}${d?" disabled":""}`}),i}},avatar:{width:44,align:"center",sortType:!0},avatarName:{width:108,align:"left",sortType:!0},avatarBtn:{width:108,align:"left",sortType:!0},category:{width:80,align:"center",flex:1,hint:!0},desc:{width:160,align:"left",flex:1,hint:!0},text:{width:136,align:"left",flex:1,hint:!0},icon:{width:52,align:"center",cellClass:"px-1",onRenderCell(i,{row:t,col:e,value:n}){const{iconRender:s}=e.setting,r=kp(s,n,t);return r&&(i[0]=r),i}},pri:{width:68,align:"center",cellClass:"px-1",sortType:!0,onRenderCell(i,{col:t,value:e}){const{priList:n=this.options.priList||{}}=t.setting,s=n[e]??e;return i[0]=P(yf,{pri:e,text:s}),i}},severity:{width:92,align:"center",cellClass:"px-1",sortType:!0,onRenderCell(i,{col:t,value:e}){const{severityList:n=this.options.severityList||{}}=t.setting,s=n[e]??e;return i[0]=P(_f,{severity:e,text:s}),i}},burn:{width:88,align:"center",onRenderCell(i,{col:t}){const e=i[0];if(!e)return i;const{burn:n}=t.setting,s={data:e,className:"border-b",width:64,height:24,responsive:!1,...n};return i[0]=P(ac,{...s}),i}},date:{width:96,align:"center",sortType:!0},time:{width:64,align:"center",sortType:!0},datetime:{width:128,align:"center",sortType:!0},progress:{width:64,align:"center",sortType:!0},money:{width:96,align:"right",sortType:!0},count:{width:92,align:"right",sortType:!0},number:{width:64,align:"center",sortType:!0,digits:-1},percent:{width:64,align:"center",sortType:!0,format(i){return typeof i=="string"&&i.endsWith("%")?i:`${i}%`}},actions:{minWidth:120,align:"left",fixed:"right"}},methods:{trySaveColsSetting(){this.data.saveColsSettingTimer&&clearTimeout(this.data.saveColsSettingTimer),this.data.saveColsSettingTimer=window.setTimeout(()=>{this.saveColsSetting(),this.data.saveColsSettingTimer=0},200)},getColsSetting(){const{colOrders:i,colsSizes:t,colBorders:e,colVisibility:n}=this.state,s={},r=(o,a)=>{const l=s[o];l?Object.assign(l,a):s[o]={id:o,...a}};return i&&Object.keys(i).forEach(o=>{r(o,{order:i[o]})}),t&&Object.keys(t).forEach(o=>{r(o,{extraWidth:t[o]})}),e&&Object.keys(e).forEach(o=>{r(o,{border:e[o]})}),n&&Object.keys(n).forEach(o=>{r(o,{show:n[o]})}),Object.values(s)},async saveColsSetting(){const i=this.getColsSetting();if(!i.length)return;const{saveFieldsUrl:t}=this.options.customCols||{};if(!t)return;const e=JSON.stringify(i);e!==this.data.lastSavedColsSetting&&(this.data.lastSavedColsSetting=e,await g.post(t,{fields:e}))}},onRenderCell(i,{row:t,col:e,value:n}){const{iconRender:s}=e.setting;if(s&&e.type!=="icon"){const r=kp(s,n,t);r&&i.push(r)}return i},onRender(){const{customCols:i}=this.options;if(!i)return;const{custom:t,setGlobal:e,reset:n,resetGlobal:s}=i;return{children:P("div",{className:"absolute gap-1.5 pr-1.5 top-0 right-0 z-20 row items-center",style:"background:var(--dtable-header-bg);height: calc(var(--dtable-header-height) - 2px)"},P("div",{className:"w-px border-l h-5"}),P("a",{className:"btn ghost square size-sm rounded","data-toggle":"dropdown","data-placement":"bottom-end"},P("i",{class:"icon icon-cog-outline"})),P("menu",{class:"dropdown-menu menu"},t&&P("li",{class:"menu-item"},P("a",{href:t.url,"data-toggle":"modal"},t.text)),e&&P("li",{class:"menu-item"},P("a",{class:"ajax-submit",href:e.url},e.text)),n&&P("li",{class:"menu-item"},P("a",{class:"ajax-submit",href:n.url},n.text)),s&&P("li",{class:"menu-item"},P("a",{class:"ajax-submit",href:s.url},s.text))))}},onUpdated(){const{updateCheckedRows:i}=this.options;i&&i!==this.data.updateCheckedRows&&(this.data.updateCheckedRows=i,this.toggleCheckRows(i,!0))}},Fv=Kt(Sp,{buildIn:!0}),KC="",Fs=i=>`${i.col.name}[${i.row.id}]`,js=(i,t,e,n="value")=>{const s=Fs(t),r=i.data.formData[s]??t.value;return{[n]:r,className:"form-control",onChange:o=>i.setFormData(s,o instanceof Event?o.currentTarget.value:o),...e}};function Yc(i){const t=Fs(i);let e=this.data.pickRefs.get(t);return e||(e=kt(),this.data.pickRefs.set(t,e)),js(this,i,{ref:e},"defaultValue")}const jv={input:{component:"input",props(i){return js(this,i,{type:"text"})}},select:{component:function(i){const{items:t,defaultValue:e,...n}=i;return P("select",{...n},t.map(s=>P("option",{key:s.value,value:s.value},s.text)))},props(i){return js(this,i)}},picker:{component:Pn,props:Yc},datePicker:{component:zi,props(i){return js(this,i,{className:"flex-auto",icon:"calendar"},"defaultValue")}},timePicker:{component:so,props(i){return js(this,i,{className:"flex-auto",icon:"time"},"defaultValue")}},priPicker:{component:Es,props:Yc},severityPicker:{component:mc,props:Yc}},Bv=Kt({name:"form",plugins:[Zf],data(){return{formData:{},pickRefs:new Map}},colTypes:{control:{custom(i){let{control:t}=i.col.setting;if(typeof t=="function"&&(t=t.call(this,i)),!t)return;typeof t=="string"&&(t={type:t});const{controlMap:e}=this.options,{type:n}=t,s={name:Fs(i)};let r;if([jv[n],e==null?void 0:e[n],t].forEach(o=>{if(o){const{props:a}=o;a&&g.extend(s,typeof a=="function"?a.call(this,i):a),r=o.component||r}}),!!r)return{component:r,props:s}}}},methods:{setFormData(i,t,e){var r,o;const{formData:n}=this.data;n[i]=t,e||(r=this.options.onFormChange)==null||r.call(this,i,t,n);const s=this.data.pickRefs.get(i);s&&((o=s.current)==null||o.setValue(t))},getFormData(i=!0){let{formData:t}=this.data;if(!i)return t;const{rows:e,cols:n}=this.layout,s=e.reduce((r,o)=>(n.list.forEach(a=>{var l;a.setting.control&&(r[Fs({col:a,row:o})]=(l=o.data)==null?void 0:l[a.name])}),r),{});return t=g.extend(s,t),i===!0?t:t[i]},resetFormData(){this.data.formData={};const{rows:i,cols:t}=this.layout;i.forEach(e=>{t.list.forEach(n=>{var r,o;if(!n.setting.control)return;const s=this.data.pickRefs.get(Fs({col:n,row:e}));s&&((o=s.current)==null||o.setValue(((r=e.data)==null?void 0:r[n.name])??""))})})}}}),VC="",qC="",GC="",YC="",QC="",XC="",ZC="",JC="",tk="",ek="",nk="",ik="",sk="",rk="",ok="",ak="";var xp=11;function Hv(i,t){var e=t.attributes,n,s,r,o,a;if(!(t.nodeType===xp||i.nodeType===xp)){for(var l=e.length-1;l>=0;l--)n=e[l],s=n.name,r=n.namespaceURI,o=n.value,r?(s=n.localName||s,a=i.getAttributeNS(r,s),a!==o&&(n.prefix==="xmlns"&&(s=n.name),i.setAttributeNS(r,s,o))):(a=i.getAttribute(s),a!==o&&i.setAttribute(s,o));for(var h=i.attributes,f=h.length-1;f>=0;f--)n=h[f],s=n.name,r=n.namespaceURI,r?(s=n.localName||s,t.hasAttributeNS(r,s)||i.removeAttributeNS(r,s)):t.hasAttribute(s)||i.removeAttribute(s)}}var zo,Wv="http://www.w3.org/1999/xhtml",be=typeof document>"u"?void 0:document,Kv=!!be&&"content"in be.createElement("template"),Uv=!!be&&be.createRange&&"createContextualFragment"in be.createRange();function Vv(i){var t=be.createElement("template");return t.innerHTML=i,t.content.childNodes[0]}function qv(i){zo||(zo=be.createRange(),zo.selectNode(be.body));var t=zo.createContextualFragment(i);return t.childNodes[0]}function Gv(i){var t=be.createElement("body");return t.innerHTML=i,t.childNodes[0]}function Yv(i){return i=i.trim(),Kv?Vv(i):Uv?qv(i):Gv(i)}function Fo(i,t){var e=i.nodeName,n=t.nodeName,s,r;return e===n?!0:(s=e.charCodeAt(0),r=n.charCodeAt(0),s<=90&&r>=97?e===n.toUpperCase():r<=90&&s>=97?n===e.toUpperCase():!1)}function Qv(i,t){return!t||t===Wv?be.createElement(i):be.createElementNS(t,i)}function Xv(i,t){for(var e=i.firstChild;e;){var n=e.nextSibling;t.appendChild(e),e=n}return t}function Qc(i,t,e){i[e]!==t[e]&&(i[e]=t[e],i[e]?i.setAttribute(e,""):i.removeAttribute(e))}var $p={OPTION:function(i,t){var e=i.parentNode;if(e){var n=e.nodeName.toUpperCase();n==="OPTGROUP"&&(e=e.parentNode,n=e&&e.nodeName.toUpperCase()),n==="SELECT"&&!e.hasAttribute("multiple")&&(i.hasAttribute("selected")&&!t.selected&&(i.setAttribute("selected","selected"),i.removeAttribute("selected")),e.selectedIndex=-1)}Qc(i,t,"selected")},INPUT:function(i,t){Qc(i,t,"checked"),Qc(i,t,"disabled"),i.value!==t.value&&(i.value=t.value),t.hasAttribute("value")||i.removeAttribute("value")},TEXTAREA:function(i,t){var e=t.value;i.value!==e&&(i.value=e);var n=i.firstChild;if(n){var s=n.nodeValue;if(s==e||!e&&s==i.placeholder)return;n.nodeValue=e}},SELECT:function(i,t){if(!t.hasAttribute("multiple")){for(var e=-1,n=0,s=i.firstChild,r,o;s;)if(o=s.nodeName&&s.nodeName.toUpperCase(),o==="OPTGROUP")r=s,s=r.firstChild;else{if(o==="OPTION"){if(s.hasAttribute("selected")){e=n;break}n++}s=s.nextSibling,!s&&r&&(s=r.nextSibling,r=null)}i.selectedIndex=e}}},Bs=1,Tp=11,Np=3,Ep=8;function Ln(){}function Zv(i){if(i)return i.getAttribute&&i.getAttribute("id")||i.id}function Jv(i){return function(e,n,s){if(s||(s={}),typeof n=="string")if(e.nodeName==="#document"||e.nodeName==="HTML"||e.nodeName==="BODY"){var r=n;n=be.createElement("html"),n.innerHTML=r}else n=Yv(n);else n.nodeType===Tp&&(n=n.firstElementChild);var o=s.getNodeKey||Zv,a=s.onBeforeNodeAdded||Ln,l=s.onNodeAdded||Ln,h=s.onBeforeElUpdated||Ln,f=s.onElUpdated||Ln,d=s.onBeforeNodeDiscarded||Ln,m=s.onNodeDiscarded||Ln,y=s.onBeforeElChildrenUpdated||Ln,b=s.skipFromChildren||Ln,S=s.addChild||function(ht,J){return ht.appendChild(J)},x=s.childrenOnly===!0,k=Object.create(null),T=[];function j(ht){T.push(ht)}function B(ht,J){if(ht.nodeType===Bs)for(var _t=ht.firstChild;_t;){var yt=void 0;J&&(yt=o(_t))?j(yt):(m(_t),_t.firstChild&&B(_t,J)),_t=_t.nextSibling}}function K(ht,J,_t){d(ht)!==!1&&(J&&J.removeChild(ht),m(ht),B(ht,_t))}function G(ht){if(ht.nodeType===Bs||ht.nodeType===Tp)for(var J=ht.firstChild;J;){var _t=o(J);_t&&(k[_t]=J),G(J),J=J.nextSibling}}G(e);function Q(ht){l(ht);for(var J=ht.firstChild;J;){var _t=J.nextSibling,yt=o(J);if(yt){var Mt=k[yt];Mt&&Fo(J,Mt)?(J.parentNode.replaceChild(Mt,J),tt(Mt,J)):Q(J)}else Q(J);J=_t}}function Z(ht,J,_t){for(;J;){var yt=J.nextSibling;(_t=o(J))?j(_t):K(J,ht,!0),J=yt}}function tt(ht,J,_t){var yt=o(J);if(yt&&delete k[yt],!_t){var Mt=h(ht,J);if(Mt===!1||(Mt instanceof HTMLElement&&(ht=Mt),i(ht,J),f(ht),y(ht,J)===!1))return}ht.nodeName!=="TEXTAREA"?X(ht,J):$p.TEXTAREA(ht,J)}function X(ht,J){var _t=b(ht,J),yt=J.firstChild,Mt=ht.firstChild,Fn,le,dn,fn,ge;t:for(;yt;){for(fn=yt.nextSibling,Fn=o(yt);!_t&&Mt;){if(dn=Mt.nextSibling,yt.isSameNode&&yt.isSameNode(Mt)){yt=fn,Mt=dn;continue t}le=o(Mt);var jn=Mt.nodeType,Ze=void 0;if(jn===yt.nodeType&&(jn===Bs?(Fn?Fn!==le&&((ge=k[Fn])?dn===ge?Ze=!1:(ht.insertBefore(ge,Mt),le?j(le):K(Mt,ht,!0),Mt=ge,le=o(Mt)):Ze=!1):le&&(Ze=!1),Ze=Ze!==!1&&Fo(Mt,yt),Ze&&tt(Mt,yt)):(jn===Np||jn==Ep)&&(Ze=!0,Mt.nodeValue!==yt.nodeValue&&(Mt.nodeValue=yt.nodeValue))),Ze){yt=fn,Mt=dn;continue t}le?j(le):K(Mt,ht,!0),Mt=dn}if(Fn&&(ge=k[Fn])&&Fo(ge,yt))_t||S(ht,ge),tt(ge,yt);else{var dt=a(yt);dt!==!1&&(dt&&(yt=dt),yt.actualize&&(yt=yt.actualize(ht.ownerDocument||be)),S(ht,yt),Q(yt))}yt=fn,Mt=dn}Z(ht,Mt,le);var Gs=$p[ht.nodeName];Gs&&Gs(ht,J)}var et=e,ct=et.nodeType,pt=n.nodeType;if(!x){if(ct===Bs)pt===Bs?Fo(e,n)||(m(e),et=Xv(e,Qv(n.nodeName,n.namespaceURI))):et=n;else if(ct===Np||ct===Ep){if(pt===ct)return et.nodeValue!==n.nodeValue&&(et.nodeValue=n.nodeValue),et;et=n}}if(et===n)m(e);else{if(n.isSameNode&&n.isSameNode(et))return;if(tt(et,n,x),T)for(var xt=0,Rt=T.length;xt<Rt;xt++){var Dt=k[T[xt]];Dt&&K(Dt,Dt.parentNode,!1)}}return!x&&et!==e&&e.parentNode&&(et.actualize&&(et=et.actualize(e.ownerDocument||be)),e.parentNode.replaceChild(et,e)),et}}var tb=Jv(Hv);function Xc(i,t,e={}){const n=g(i);if(typeof t=="string"&&!t.length){e.childrenOnly?n.empty():n.replaceWith(document.createTextNode(""));return}if(t===null){n.remove();return}const s="z-zui-inited",{getNodeKey:r,onElUpdated:o,onBeforeElUpdated:a,onBeforeElChildrenUpdated:l,executeScript:h=!0,...f}=e,d=new Set;tb(i,t,{...f,getNodeKey:function(m){const y=r==null?void 0:r(m);if(y!==void 0)return y;if(m instanceof Element&&m.tagName==="BODY")return m.tagName;if(m.getAttribute)return m.getAttribute("zui-key")??m.id},onBeforeElUpdated(m,y){const b=a==null?void 0:a(m,y);if(b!==void 0)return b;if(m.classList.contains("preserve-on-morph"))return!1;if(m.classList.contains("no-morph")||m.tagName==="ZEN-EDITOR"||m.tagName.includes("-")&&m.isEqualNode(y))return m.replaceWith(y),!1;const S=g(m);if((m.hasAttribute("zui-create")||m.hasAttribute("data-zui"))&&(!y.childNodes.length||S.zui()instanceof mt)){if(m.isEqualNode(y))d.add(m);else{let x=!0;Array.from(y.attributes).forEach(k=>{const{name:T,value:j}=k;T==="class"?S.addClass(j):m.getAttribute(T)!==j&&((T==="zui-create"||T.startsWith("zui-create-"))&&(x=!1),m.setAttribute(T,j))}),x&&d.add(m)}return!1}return!0},onBeforeElChildrenUpdated(m,y){const b=l==null?void 0:l(m,y);return b!==void 0?b:m.classList.contains("no-morph")?!1:!m.tagName.includes("-")},onElUpdated(m){if(o==null||o(m),m.tagName==="SCRIPT"&&h){const y=m.textContent;y&&g(m).addClass("zui-js-run").parent().runJS(y)}else{m.hasAttribute(s)&&m.removeAttribute(s);const y=os(m);Object.values(y).forEach(b=>{if(b instanceof zt){const{ATTR_KEY:S,DATA_KEY:x}=b.constructor;m.setAttribute(S,""),m.setAttribute(x,`${b.gid}`)}})}}}),n.zuiInit({update:"reset",beforeCreate:m=>!d.has(m)}),d.forEach(m=>{g(m).trigger("skipMorph")}),h&&n.find("script:not(.zui-js-run)").each((m,y)=>{if(g(y).hasClass("zui-js-run"))return;const b=y.textContent;b&&n.runJS(b)})}g.fn.morph=function(i,t){return this.each((e,n)=>{Xc(n,i,t)})},g.fn.morphInner=function(i,t){return this.each((e,n)=>{Xc(n,i,{...t,childrenOnly:!0})})};function Zc(i){const t=g(i);t.css({minHeight:0}).css({minHeight:Math.max(32,t[0].scrollHeight)})}g.fn.autoHeight=function(){return this.each(function(){const i=g(this);i.data("auto-height")||i.on("input paste change",function(){Zc(this)}).data("auto-height",!0),Zc(i),setTimeout(()=>Zc(i),100)})},g.fn._append=g.fn.append,g.fn._prepend=g.fn.prepend,g.fn._before=g.fn.before,g.fn._after=g.fn.after,g.fn._html=g.fn.html;function jo(i,t){return typeof t=="string"&&(t.includes("zui-create")||t.includes("zui-init"))&&i.zuiInit(),i}function eb(i){return!!i&&i.nodeType===1}g.extend(g.fn,{append(...i){return jo(this._append(...i),i.join(""))},prepend(...i){return jo(this._prepend(...i),i.join(""))},before(...i){const t=this.parent();return this._before(...i),jo(t,i.join("")),this},after(...i){const t=this.parent();return this._after(...i),jo(t,i.join("")),this},html(i,t){if(!arguments.length)return this[0]&&this[0].innerHTML;if(i===void 0)return this;const e=/<script[\s>]/.test(i);return typeof t=="boolean"&&(t={zuiInit:t}),this.each((n,s)=>{eb(s)&&(e?g(s).empty()._append(i):s.innerHTML=i,(t==null?void 0:t.zuiInit)!==!1&&g(s).zuiInit())})}});const nb=Object.freeze(Object.defineProperty({__proto__:null,createLink:An,parseLink:D_,parseUrlParams:mf},Symbol.toStringTag,{value:"Module"}));window.$&&Object.assign(window.$,{...nb,parseRawData:za}),E.$=g,E.Ajax=rs,E.AjaxForm=uc,E.Avatar=xl,E.BUILD=1727419450521,E.BUILD_MODE=bm,E.BatchForm=oc,E.BtnGroup=$l,E.Burn=lc,E.Bus=Nu,E.Card=$o,E.CardList=bc,E.ColorPicker=Bl,E.CommonList=fs,E.Component=zt,E.ComponentFromReact=mt,E.Computed=Zn,E.ContextMenu=Gi,E.CustomContent=gt,E.CustomRender=dl,E.DTable=Yi,E.Dashboard=Cc,E.DataHub=wd,E.DatePicker=oo,E.DatetimePicker=ao,E.Dexie=ws,E.Draggable=vs,E.Dropdown=Xe,E.Dropmenu=cc,E.ECharts=of,E.Entity=Sy,E.FileList=hc,E.FileSelector=fo,E.FormGrid=hf,E.FormSetting=cf,E.Gantt=uf,E.GlobalSearch=So,E.Graph=pf,E.HElement=Ft,E.HElementSignals=ad,E.HistoryPanel=Ns,E.HtmlContent=kn,E.Icon=Ht,E.ImageSelector=po,E.ImgCutter=pc,E.Kanban=Ls,E.KanbanList=Os,E.List=ms,E.Mammoth=R_,E.Menu=jr,E.Messager=xn,E.Modal=Vt,E.ModalBase=ji,E.ModalTrigger=Hi,E.Moveable=bs,E.Nav=Ql,E.NestedList=gs,E.Pager=Zl,E.Pick=yo,E.Picker=_o,E.Popover=Te,E.PopoverPanel=mo,E.Portal=fl,E.PriPicker=gc,E.ProgressCircle=Kr,E.PropModSymbol=xy,E.PropModification=$y,E.RangeSet=Cy,E.ReactComponent=Tt,E.SearchBox=vo,E.SearchForm=Re,E.SearchMenu=Br,E.SearchTree=ic,E.SeverityPicker=yc,E.Sidebar=ec,E.Signal=te,E.Sortable=Ur,E.SortableList=Gr,E.SortableTree=Yr,E.Sticky=nl,E.TIME_DAY=Pi,E.Tabs=zs,E.TimePicker=ro,E.Toolbar=nc,E.Tooltip=Ui,E.Tree=wo,E.Upload=Co,E.UploadImgs=sc,E.UserAvatar=xo,E.VERSION=vm,E.Zinbar=vc,E.addDate=md,E.addQueryToSearchForm=wf,E.ajaxSubmit=ci,E.batch=Zu,E.bindCommands=sl,E.bindHotkeys=Xa,E.bus=Ve,E.cash=g,E.classes=q,E.clearData=dg,E.cmp=ky,E.computed=id,E.convertBytes=ki,E.cookie=gd,E.create=tl,E.createDate=Wt,E.createFormData=gr,E.createPortal=hd,E.createRef=kt,E.deepGet=Ia,E.deepGetPath=hu,E.defineFn=Tg,E.delay=as,E.disableScroll=$u,E.dom=Dg,E.downloadFile=xr,E.effect=Dr,E.enterFullscreen=Au,E.evalValue=Jn,E.fetchData=Xn,E.form=Bv,E.formatBytes=fe,E.formatDate=Ae,E.formatDateSpan=ly,E.formatString=$t,E.getClassList=Oa,E.getComponent=cs,E.getFullscreenElement=$r,E.getHotkeysMap=Qa,E.getReactComponent=od,E.getUniqueCode=pl,E.getZData=$i,E.h=P,E.hotkeys=xg,E.i18n=Nt,E.initGlobalComponents=el,E.isDiff=yr,E.isFetchSetting=La,E.isSameDay=Sn,E.isSameMonth=yl,E.isSameWeek=sy,E.isSameYear=Fr,E.isToday=ry,E.isTomorrow=ay,E.isValidDate=_l,E.isYesterday=oy,E.liveQuery=vy,E.mapFormData=lf,E.mergeProps=vt,E.mergeRanges=by,E.morph=Xc,E.nextGid=_e,E.parseRawData=za,E.parseSize=ii,E.processSubmitResult=dc,E.rangesOverlap=wy,E.reactComponents=ul,E.registerComponent=Iu,E.registerGlobalListener=Tu,E.registerReactComponent=oe,E.removeUndefinedProps=qa,E.render=ni,E.renderCustomContent=Lr,E.renderCustomResult=ld,E.replacePrefix=Ty,E.setZData=Fa,E.shareData=fu,E.showCommentModal=fc,E.signal=Ir,E.store=ae,E.storeData=_r,E.takeData=os,E.toCssSize=Bt,E.toggleFullscreen=Ja,E.toggleSearchForm=_c,E.unbindCommands=Ru,E.unbindHotkeys=Za,E.untracked=jg,E.updateSearchForm=bf,E.zentao=Fv,E.zentaoPlugin=Sp,Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})});
